{
  "id": "8928",
  "title": "win7pe installer / recovery idea!",
  "isPinned": false,
  "isFirstTopic": false,
  "isLocked": false,
  "tags": [],
  "forumNotes": [
    {
      "id": "77030",
      "timestamp": "2009-09-03T10:45:55+00:00",
      "author": "dylan80",
      "content": "Hey guys this isnt winbuilder related, but this place is the only place ive ever researched n stuff.  \n\nwhile brainstorming and testing winpe ideas i decided to devise a recovery disk based on the windows 7 installer, keeping everything intact apart from the boot.wim. Like adding ms dart 6.0 for eg, which btw worked flawlessly.   \n\nI managed to modify the boot up via winpeshl.ini file so that it prompts me to start network and then loads straight into the recovery environment where i can access all the options including ms dart 6.0.  \n\nI noticed that setup can be launched from within the recovery environment, and seems to work well. The problem is that after the initial locale options it gives me an error:  \n\nA required cd/dvd drive device driver is missing.  \n\nIf the dvd drive driver is missing, how am i running anything off this drive at all? like the pe/installer. Anyway swapping the image or physical cd for an original allows the installation to proceed.  \n\nHow cool would it be when you have exhausted the other recovery options to then go straight into a upg or clean install, all while having access to ur other pe apps... could even play cards or something lol.  \n\nHow can i resolve this driver issue without swapping out dvd\u0027s? i really want a single medium solution for installing / recovering. I have tried running the setup from the sources directory, the ram drive root and the cd root/sources. I always get the driver error. I have also tried modifying winpeshl.ini to run the installer instead of recovery environment, starting from sources and also root. Still get the driver error.   \n\nI read elsewhere that its to do with the sata/ide controller of the mobo, and have exhausted the suggestions. The fact that i have recreated the original medium it should install like the original?  \n\nIve been testing in virtual box as well as my own hardware, here is a sample of my winpeshl.ini in its current state:  \n\n\\[LaunchApps\\]  \n%windir%\\\\system32\\\\netstart.exe,-prompt  \n%SYSTEMDRIVE%\\\\sources\\\\recovery\\\\recenv.exe  \n\nMy other curiosity is that the boot.wim contains 2 images, 1 tagged as windows pe the other tagged as the installer. I assumed anything i added in winpe image would show in the recovery environment, but it doesnt. Ive been working mostly in image 2 where my modifications actually show. Not sure what the deal with this is.  \n\nOnly other thing i havent fully tried is pull the winpe straight out of the waik for 7 and as usual mount with gimagx to add all the installer files, and the recovery/dart files and the winpeshl.ini  \n\nwell thats about all for now, time to sleep. I hope somebody can help.   \n"
    },
    {
      "id": "77032",
      "timestamp": "2009-09-03T10:56:19+00:00",
      "author": "maanu",
      "content": "nice idea .  \n\ni got this error when i was trying to boot the iso with G4D as hd32 or 0xff .  \n\nbut when i extracted the iso at the root , it did not give me the missing cd /dvd error .   \n\nno matter i used dvd or usb , it gave me same error while iso emulation . but simply chainloading bootmgr went fine.   \n"
    },
    {
      "id": "77037",
      "timestamp": "2009-09-03T12:18:11+00:00",
      "author": "dylan80",
      "content": "hi, thx for the tip maanu.  \n\ni wasnt entirely sure what you meant by extract the iso at the root, so i went ahead and added the contents of the original cd to the boot.wim merging the sources folder and adding the support and upgrade folders, obviously leaving out the boot files and keeping them on the iso.  \n\nI\u0027m still getting the driver error.  \n\nWould chainloading with g4d really make the difference?  \n\nwould it make any difference whether i use winpeshl.ini to boot striaght into recovery or into the installer?  \n\nUpdate: WOOT! it worked, when i dumped the cd source into the boot.wim i figured id delete em off the cd. bad idea i guess.... well after putting them back on it works :smile:   \n"
    },
    {
      "id": "77043",
      "timestamp": "2009-09-03T12:58:40+00:00",
      "author": "maanu",
      "content": "so i suppose u did not use grub4dos ? if yes then ignore my last post,  \n\nanyways good to know that it actually worked for u . can u plz confirm if msdart 6.0 tools work on 7 RTM ?   \n"
    },
    {
      "id": "77053",
      "timestamp": "2009-09-03T14:53:30+00:00",
      "author": "dylan80",
      "content": "Yeah i should have mentioned that i did NOT use g4d. all i did was restore the cd root contents so that they are in the boot.wim as well as on the cd, other thing is that i did not add the install.wim and the assosiated cfg files into the boot.wim. keeping the boot.wim at a runnable size. Also ms dart does work for windows 7, at least 99%. The main point here is that its running on a simple win7pe with better driver support, the win7 re and theres also a 64bit version. also im fairly sure that theres a new version of ms dart for win7 on the way, with all this dirty work out of the way it\u0027ll be a simple upg when its released. Where else can you get a 64bit win7pe that loads fast, into a decent shell that contains all the recovery tools you could need including a maleware scanner? this is a simple solution with no fuss. imo all the winbuilder projects are a pain to get them working the way you want them too (no offence). I even got spybot up n running via erdlogon. This is the be all and end all.   \n"
    }
  ]
}