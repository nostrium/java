{
  "id": "10222",
  "title": "booting a partition to which HDD image of windows 7 was restored",
  "isPinned": false,
  "isFirstTopic": false,
  "isLocked": false,
  "tags": [],
  "forumNotes": [
    {
      "id": "89307",
      "timestamp": "2010-01-22T06:59:58+00:00",
      "author": "Cybergrace",
      "content": "Guys i know i am asking a very huge series of questions.But its very easy once you start reading.To make things simple,i have used this convention : italicized text is the explanation and my doubts are in ordinary text format  \n\n*I have 2 primary partitions c: and d:(windows xp pro sp3 is installed on c:)\ni created a vm(virtual machine) and installed windows 7 into the 1st partition of the vm after partitioning the 40 gig vmdk file into two 20 gig partitions.Then i installed \"easus todobackup\" into the vm and made a sector-by-sector copy of the 1st partition of the vm and saved the resulting file(which is close to 19 gig) into the 2nd partition of the vm.\nI then took that 19 gig file out of the vm and saved it to c:(the 1st partition of the real pc) and restored the partition image to d: using easus todobackup.\nThe mbr of the real HDD contains the xp bootloader and so wont boot into the windows 7 in d:\ni have added grub4dos folder to root of c: and modified boot.ini to contain an entry to it.*   \n\nconsider the following:  \nBios loads mbr--\\\u003embr contains xp bootloader--\\\u003eboot sector of c:(which contains NTLDR)is loaded--\\\u003eboot.ini is loaded and boot menu is displayed--\\\u003egrub4dos entry is selected and command line interface is displayed--\\\u003ecommands are typed to chainload a file in c: which contains the windows 7 bootloader--\\\u003ewindows 7 in d: boots up and when i check out the disk management console,the d: on which windows 7 is present is reported as c:(boot,sys).  \n\nI would like to know if the scheme described above is possible or not.If possible,please list the commands i need to use.I would also like to know if there is an alternate scheme to the one described above to boot into windows 7(as long as it does not require me to:  \n1)install grub4dos code into mbr of real hdd using grubinst.exe  \n2)carry bootfiles or bootloader in a cd or pendrive).  \n\n*\\[I am continuing the explanation below on the assumption that there is no such alternate scheme\\]\nafter booting into windows 7 using the scheme described above,i plan to encrypt the partition in which it resides using diskcryptor.*   \nBefore starting the encryption,diskcryptor asks where i want to store the bootloader.What happens if i instruct it to store it to the hdd mbr?I mean will it be stored to the file-based mbr which was used by grub4dos or the real hdd mbr?  \n\nForgetting about encryption altogether,what happens if i use \"mbrwiz\" to view the contents of mbr?Will it provide me details of the file-based mbr or the real hdd mbr?  \n\nIn case its not possible to store the diskcryptor bootloader to the file-based mbr,i want to knw if the following scheme is possible(if possible,please list the commands i need to use):  \nBios loads mbr--\\\u003embr contains xp bootloader--\\\u003eboot sector of c:(which contains NTLDR)is loaded--\\\u003eboot.ini is loaded and boot menu is displayed--\\\u003egrub4dos entry is selected and command line interface is displayed--\\\u003ecommands are typed to chainload an iso file in c:(diskcryptor bootloader.iso)--\\\u003epassword to decrypt the partition is typed(usually after this is done,the boot menu containing OS entries is displayed(as long as the bootloader is started from hdd mbr or cd rom).Now i dont know what will happen as the bootloader ie the iso file is being started from some place in c:)--\\\u003ereturn to grub4dos command line interface and chainload file-based mbr which contains windows 7 bootloader--\\\u003ewindows 7 in d: boots up and when i check out the disk management console,the d: on which windows 7 is present is reported as c:(boot,sys)   \n"
    },
    {
      "id": "89311",
      "timestamp": "2010-01-22T09:05:02+00:00",
      "author": "Wonko the Sane",
      "content": "The question is:  \nis \"D:\" a Primary partition or a Logical Volume inside extended? ![:whistling:](http://reboot.pro/public/style_emoticons/default/happy22.gif)  \n\nI mean, you can have this chain:  \nMBR-\\\u003eC: active-\\\u003ePBR on C:-\\\u003eNTLDR-\\\u003eBOOT.INI-\\\u003egrldr-\\\u003emenu.lst-\\\u003ePBR on D:-\\\u003eBOOTMGR-\\\u003eBCD-\\\u003eWindows 7 on D:  \nWhich is what your initial idea or:  \nMBR-\\\u003eC: active-\\\u003ePBR on C:-\\\u003eNTLDR-\\\u003eBOOT.INI-\\\u003egrldr-\\\u003emenu.lst-\\\u003eBOOTMGR -\\\u003eBCD-\\\u003eWindows 7 on D:  \nor  \nMBR-\\\u003eC: active-\\\u003egrldr PBR on C:-\\\u003egrldr-\\\u003emenu.lst-\\\u003eBOOTMGR-\\\u003eBCD-\\\u003eWindows 7 on D:  \nor  \nMBR-\\\u003eC: active-\\\u003eWin 7 PBR on C:-\\\u003eBOOTMGR-\\\u003eBCD-\\\u003eWindows 7 on D:  \nor  \nMBR-\\\u003eD: active-\\\u003eWin 7 PBR on D:-\\\u003eBOOTMGR-\\\u003eBCD-\\\u003eWindows 7 on D:  \n\n\u003cbr /\u003e\n\nThe MBR is made of two parts, \"CODE\" and \"DATA\".  \nThe CODE can be changed, i.e. the CODE of the grub4dos MBR and that of the XP MBR and that of the Windows 7 MBR (or that of the diskvcryptor MBR) are different, but the DATA remains the same.  \nA \"normal\" MBR simply does two things:  \n\n* finds in the partition table DATA an Active Partition\n* chainloads the PBR (or bootsctor of that partition)\n\n(nothing more, nothing less)  \n\nThe grub4dos MBR has a number of more advanced functions, but basically it initially \"ignores\" anything in the MBR DATA and passes control to grldr, which will allow you choices to chainload something else, that can also be the same DATA initially ignored.  \n\nThe diskcryptor (I presume, based on how similar software behaves) is more similar to grub4dos;  \n\n* it loads, inintially ignoring the DATA\n* verifies the password\n* loads the whatever is needed to unencrypt the whatever is encrypted\n* it continued chainloading the same DATA initially ignored\n\n\u003cbr /\u003e\n\nIn a nutshell:  \n\n* a normal MBR CODE loads a PBR based on the DATA in the MBR itself\n* an \"advanced\" MBR CODE can (among other things) load a PBR based on the DATA in the MBR itself **AFTER** having performed some action\n\n\u003cbr /\u003e\n\nIn such a setting you should be able to use one of the above listed approaches, BUT, use Occam\u0027s Razor. ![:ranting2:](http://reboot.pro/public/style_emoticons/default/ranting2.gif)  \n\nUse the simplest ones:  \nMBR-\\\u003eC: active-\\\u003eWin 7 PBR on C:-\\\u003eBOOTMGR-\\\u003eBCD-\\\u003eWindows 7 on D:  \nor  \nMBR-\\\u003eD: active-\\\u003eWin 7 PBR on D:-\\\u003eBOOTMGR-\\\u003eBCD-\\\u003eWindows 7 on D:  \n\nin a \"normal\" dual boot XP+Windows 7 there is not any reason to have grub4dos \"in the middle\", you simply load the Windows 7 loader which can load the XP (and if needed load grldr.mbr).  \n\nThe makers of the encryption software surely have tested their setup with the above \"standard\" approach, and there are more probabilities it will work flawless.  \n\nTo change the C: partition PBR to invoke BOOTMGR instead of NTLDR you can use BOOTSECT.EXE (part of Vista/Windows 7), also in the recovery environment.  \n\nAnother possibility is, if the D: partition is a Primary one, to make it active, using mbrwiz, or mbrfix or any other tool, including windows Disk Management, as I presume that it already has a PBR invoking BOOTMGR.  \n\nWonko   \n"
    },
    {
      "id": "89322",
      "timestamp": "2010-01-22T11:59:55+00:00",
      "author": "Cybergrace",
      "content": "thank you Wonko the Sane.I am very close to being able to boot into win 7 ![:whistling:](http://reboot.pro/public/style_emoticons/default/happy22.gif)   \n\n\"D:\" is a Primary partition not a Logical Volume inside extended  \n\ni would have Used the simplest ones:  \nMBR-\\\u003eC: active-\\\u003eWin 7 PBR on C:-\\\u003eBOOTMGR-\\\u003eBCD-\\\u003eWindows 7 on D:  \nor  \nMBR-\\\u003eD: active-\\\u003eWin 7 PBR on D:-\\\u003eBOOTMGR-\\\u003eBCD-\\\u003eWindows 7 on D:  \n\nBut the thing is i want to hide the existence of windows 7(thats why i installed windows 7 by doing a sector-to-sector copy paste instead of using some media like cd or pendrive-using any such conventional way to install windows 7 would have modified MBR and i did not want that to happen.I know the MBR can be deleted and replaced but deleted data can be recovered and so its risky.In a nutshell i want to be able to deny that i ever installed/attempted to install windows 7 on my system).Hence,after having installed windows 7 in this manner without touching the MBR or leaving any trail,my next step is to encrypt the partition completely.  \n\nD: partition is a Primary one and it already has a PBR invoking BOOTMGR but if i make it active the existence of the operating system will be revealed  \n\nthe first and last schemes you mentioned is ideal for my use:  \n\nMBR-\\\u003eC: active-\\\u003ePBR on C:-\\\u003eNTLDR-\\\u003eBOOT.INI-\\\u003egrldr-\\\u003emenu.lst-\\\u003ePBR on D:-\\\u003eBOOTMGR-\\\u003eBCD-\\\u003eWindows 7 on D:  \n\nTo change the C: partition PBR to invoke BOOTMGR instead of NTLDR you can use BOOTSECT.EXE (part of Vista/Windows 7), also in the recovery environment.I particularly liked this idea.  \n\n\u003cbr /\u003e\n\nSo i\u0027ll tweak things a little bit and try the following:  \nStep 1:installing xp sp3 to 1st partition of a virtual HDD of a virtual machine  \nStep 2:restore windows 7 image to 2nd partition of the virtual HDD  \nStep 3:rename BOOTMGR(in the 2nd partition of the virtual HDD) as NTLDR   \nStep 4:modify boot.ini(in the 1st partition of the virtual HDD) to contain an entry to windows 7  \n\nplease list the commands i\u0027ll need to do the following:  \nMBR-\\\u003eC: active-\\\u003ePBR on C:-\\\u003eNTLDR-\\\u003eBOOT.INI-\\\u003egrldr-\\\u003emenu.lst-\\\u003ePBR on D:-\\\u003eBOOTMGR-\\\u003eBCD-\\\u003eWindows 7 on D:   \n"
    },
    {
      "id": "89336",
      "timestamp": "2010-01-22T14:43:42+00:00",
      "author": "Wonko the Sane",
      "content": "\u003e But the thing is i want to hide the existence of windows 7\nI.e. the **\"main\"** requirement that you completely omitted to mention in your previous post. ![:ranting2:](http://reboot.pro/public/style_emoticons/default/ranting2.gif)  \n\n\u003e I know the MBR can be deleted and replaced but deleted data can be recovered and so its risky.\nNO! ![:ranting2:](http://reboot.pro/public/style_emoticons/default/ranting2.gif)   \nDeleted filesystem data (and NOT overwritten) ***may*** be recovered.  \nDeleted AND overwritten data (such as the MBR) CANNOT be recovered.  \n\n\u003e In a nutshell i want to be able to deny that i ever installed/attempted to install windows 7 on my system).Hence,after having installed windows 7 in this manner without touching the MBR or leaving any trail,my next step is to encrypt the partition completely.\n\n***Hence*** my sock! ![:ranting2:](http://reboot.pro/public/style_emoticons/default/ranting2.gif)  \n\n* You have an entry in BOOT.INI pointing to grldr.\n* You probably have a menu.lst pointing to the encrypted partition.\n* You have an entry in the MBR partition table pointing to the (non-active) encrypted partition.\n* You have an encrypted partition, \"normal\" people, that has nothing to hide\" do not place encrypted partitions on their HD.\n\n\u003cbr /\u003e\n\nYou have to think about to whom you will deny that, and in which circumstances. ![:ranting2:](http://reboot.pro/public/style_emoticons/default/ranting2.gif)   \n\nAny forensic investigator will \"spot\" the encrypted partition and in most countries you can go to jail if you refuse (on a Judge order) to reveal the encryption password.  \n\nIf under menace, you should also make sure that your encryption scheme/app has \"palausible deniability\" features:  \n[http://en.wikipedia....able_encryption](http://en.wikipedia.org/wiki/Deniable_encryption \"External link\")  \n\n[http://www.truecrypt.org/](http://www.truecrypt.org/ \"External link\")  \n[http://www.truecrypt...ble-deniability](http://www.truecrypt.org/docs/?s\u003dplausible-deniability \"External link\")  \n\n[http://www.freeotfe.org/features.html](http://www.freeotfe.org/features.html \"External link\")  \n[http://www.freeotfe....deniability.htm](http://www.freeotfe.org/docs/Main/plausible_deniability.htm \"External link\")  \n\n\u003cbr /\u003e\n\n\u003e So i\u0027ll tweak things a little bit and try the following:  \n\u003e Step 1:installing xp sp3 to 1st partition of a virtual HDD of a virtual machine  \n\u003e Step 2:restore windows 7 image to 2nd partition of the virtual HDD  \n\u003e Step 3:rename BOOTMGR(in the 2nd partition of the virtual HDD) as NTLDR   \n\u003e Step 4:modify boot.ini(in the 1st partition of the virtual HDD) to contain an entry to windows 7\nI am failing to see what the VM has to do with the whole thing. ![:whistling:](http://reboot.pro/public/style_emoticons/default/happy22.gif)  \n\n\u003e please list the commands i\u0027ll need to do the following:  \n\u003e MBR-\\\u003eC: active-\\\u003ePBR on C:-\\\u003eNTLDR-\\\u003eBOOT.INI-\\\u003egrldr-\\\u003emenu.lst-\\\u003ePBR on D:-\\\u003eBOOTMGR-\\\u003eBCD-\\\u003eWindows 7 on D:\nOn grub4dos command line (or as an entry in menu.lst, where the final **boot** command is unneeded):  \n\n```\nroot \u0026#40;hd0,1\u0026#41;\n\nchainloader +1\n\nboot\n```\n\nfor:  \nMBR-\\\u003eC: active-\\\u003ePBR on C:-\\\u003eNTLDR-\\\u003eBOOT.INI-\\\u003egrldr-\\\u003emenu.lst-\\\u003ePBR on D:-\\\u003eBOOTMGR-\\\u003eBCD-\\\u003eWindows 7 on D:  \n\nor:  \n\n```\nfind --set-root /bootmgr\n\nchainloader /bootmgr\n\nboot\n```\n\nfor:  \nMBR-\\\u003eC: active-\\\u003ePBR on C:-\\\u003eNTLDR-\\\u003eBOOT.INI-\\\u003egrldr-\\\u003emenu.lst-\\\u003eBOOTMGR-\\\u003eBCD-\\\u003eWindows 7 on D:  \n\nHowever, cannot say the encrypting program you use, most partition encryption software use the MBR as pre-boot authentication code, so cannot say if the above can work, in such a setup the unecryption on the fly must be performed from the PBR of the encrypted partition.  \n\nIt is possible that you will need a much more sophisticated approach.  \nA seemingly unrelated thread that may give you some ideas is here:  \n[http://www.boot-land...?...ic\u003d7138\\\u0026hl\u003d](http://www.boot-land.net/forums/index.php?showtopic\u003d7138\u0026hl\u003d \"External link\")  \n\n![:ranting2:](http://reboot.pro/public/style_emoticons/default/ranting2.gif)  \n\nWonko   \n"
    },
    {
      "id": "89390",
      "timestamp": "2010-01-23T05:27:34+00:00",
      "author": "Cybergrace",
      "content": "Thanks a lot wonko the sane.Those commands were immensely helpful. ![:whistling:](http://reboot.pro/public/style_emoticons/default/happy22.gif)   \n\n\u003e I.e. the \"main\" requirement that you completely omitted to mention in your previous post\nactually i missed out on this very important requirement all the time ![:ranting2:](http://reboot.pro/public/style_emoticons/default/ranting2.gif)   \n\u003e Deleted filesystem data (and NOT overwritten) may be recovered.  \n\u003e Deleted AND overwritten data (such as the MBR) CANNOT be recovered.\ni used to believe this until i heard of [magnetic force microscopy](http://diskcryptor.net/index.php/DiskCryptor_console_en \"External link\")  \nthe following is an extract from the webpage pointed to by the link above  \n\u003e The \"wipe mode\" parameter allows to utilize safe data wipe algorithms, to destroy the original contents of the partition, in order to prevent the data recovery using magnetic force microscopy.\n\u003e You have to think about to whom you will deny that, and in which circumstances.\nactually i might have to deny to not-so-tech-savvy-but-moderately-resourceful(in terms of both money and government authority)professionals;which is the reason why i am not using plausible deniability.A forensic investigator will not be called upon unless encryption is detected.Using plausible deniability apps like truecrypt is like telling them that i use encryption.If I use diskcryptor and dont have the diskcryptor bootloader in the MBR,nothing suspicious is thrown at the screen while booting the computer.I can claim that an unformatted partition can be the result of corruption due to  \npartition resizing efforts(considering that they are not-so-tech-savvy)  \n\u003e I am failing to see what the VM has to do with the whole thing.\nI simply use VM for the purpose of testing so that the real HDD mbr is not modified etc   \n"
    },
    {
      "id": "89409",
      "timestamp": "2010-01-23T12:20:44+00:00",
      "author": "Wonko the Sane",
      "content": "\u003e i used to believe this until i heard of [magnetic force microscopy](http://diskcryptor.net/index.php/DiskCryptor_console_en \"External link\")  \n\u003e the following is an extract from the webpage pointed to by the link above\n\nYou might want to read some more and change your idea. ![:whistling:](http://reboot.pro/public/style_emoticons/default/happy22.gif)  \n\nThe whole thing is a MYTH, and a BUSTED one.  \n\n[http://www.msfn.org/...pe-t125900.html](http://www.msfn.org/board/hard-drive-secure-deletion-wipe-t125900.html \"External link\")  \n[http://www.forensicf...m...opic\\\u0026t\u003d2065](http://www.forensicfocus.com/index.php?name\u003dForums\u0026file\u003dviewtopic\u0026t\u003d2065 \"External link\")  \n\nAn overwritten sector is ***overwritten*** and what was there before CANNOT be read anymore.  \n\nOf course you are perfectly free to remain with your idea of the MYTH being true ![:ranting2:](http://reboot.pro/public/style_emoticons/default/ranting2.gif), but do check in my signature the \"But ... then, why?\" ![:ranting2:](http://reboot.pro/public/style_emoticons/default/ranting2.gif)  \n\nYour link points to the command line page of diskcryptor. ![:cheers:](http://reboot.pro/public/style_emoticons/default/cheers.gif)  \n\n![:worship:](http://reboot.pro/public/style_emoticons/default/worship.gif)  \n\nWonko   \n"
    }
  ]
}