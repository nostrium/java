{
  "id": "21950",
  "title": "Install Windows 10 from iso with wimboot",
  "isPinned": false,
  "isFirstTopic": false,
  "isLocked": false,
  "tags": [],
  "forumNotes": [
    {
      "id": "209366",
      "timestamp": "2019-02-18T11:54:40+00:00",
      "author": "nierewa",
      "content": "Hi,\n\nI found this [tutorial](https://www.rmprepusb.com/tutorials/145-grub2winiso \"External link\") to install windows directly from iso.\n\nOn my USB Drive I have:\n\nimages\n\n\\|-win10.iso\n\nwimboot \\* this folder with files download from tutorial site (grub2_wimboot.zip)\n\n\\|-ImgDisk\n\n\\|-startup.bat\n\n\\|-winpeshl.ini\n\n\\|-wimboot\n\nautounattend.xml \\*from Easy2Boot\n\nunatted.xml \\*from Easy2Boot\n\ngrldr\n\nmenu.lst\n\nmenu.lst:\n\n```\ntitle Install Windows10 using wimboot method\nmap /images/Win10.iso (0xff)\nmap --hook\nroot (0xff)\n# the root path now points to the files inside the ISO file\n# hd0,0 is the USB drive that we booted from\nkernel (hd0,0)/wimboot/wimboot\ninitrd @startup.bat\u003d(hd0,0)/wimboot/startup.bat @winpeshl.ini\u003d(hd0,0)/wimboot/winpeshl.ini @bcd\u003d/boot/bcd @boot.sdi\u003d/boot/boot.sdi @boot.wim\u003d/sources/boot.wim @Win10.iso.tag\u003d/boot/bcd\nmap (hd0) (hd1)\nmap (hd1) (hd0)\nmap --hook\nboot\n```\n\nstartup.bat:\n\n```\n@echo off\nTITLE %~dpnx0 (WIMBOOT startup.bat)\nwpeinit.exe\nREM prevent wpeinit from running again\nren X:\\windows\\system32\\wpeinit.exe wpeinit.exe.old\n\nfor %%I in (C D E F G H I J K L M N O P Q R S T U V W X Y Z) do if exist %%I:\\wimboot\\startup.bat set USBDRIVE\u003d%%I:\nIF \"%USBDRIVE%\"\u003d\u003d\"\" (\necho ERROR - COULD NOT FIND E2B DRIVE!\npause\ngoto :EOF\n)\n\ncd %USBDRIVE%\\\n%USBDRIVE%\ncolor 1f\n@echo off\ncls\nSET BIT\u003d32\nif \"%PROCESSOR_ARCHITECTURE%\"\u003d\u003d\"AMD64\" SET BIT\u003d64\n\necho LOADISO\nFOR /L %%A IN (0,1,5000) DO ECHO NOTHING \u003e nul\ncls\n@echo FOUND USB DRIVE AT DRIVE %USBDRIVE%\ncd /d %USBDRIVE%\\\n\n:: get path of the ISO into ISONAME\n:: SET \"MYISO\u003d\\images\\WIN10.iso\"\nfor /f %%a in ( \u0027dir /b X:\\Windows\\System32\\*.iso.tag\u0027 ) do set MYISO\u003d%%a\nset MYISO\u003d%MYISO:~,-4%\n\n:: find the ISO\nset UPATH\u003d\\%MYISO%\nif exist %USBDRIVE%%UPATH% set MYISO\u003d%UPATH%\necho Loading %USBDRIVE%%MYISO% \n\nREM Load ISO using ImDisk\nTITLE LOAD WINDOWS ISO USING IMDISK\ncall \\wimboot\\imdisk\\IMDISK_install.cmd\ncall \\wimboot\\imdisk\\IMDISK_instiso.cmd\n\nREM Find mounted DVD drive\nset DVDDRIVE\u003d\nFOR %%D IN (A B C D E F G H I J K L M N O P Q R S T U V W X Y Z) DO (\nDIR %%D:\\SOURCES\\install.*  \u003e nul 2\u003e\u00261 \u0026\u0026 (call set DVDDRIVE\u003d%%D:) \u0026\u0026 echo FOUND %%D:\\SOURCES\\install.*\n)\nFOR %%D IN (A B C D E F G H I J K L M N O P Q R S T U V W X Y Z) DO (\nDIR %%D:\\SOURCES\\x86\\install.*  \u003e nul 2\u003e\u00261 \u0026\u0026 (call set DVDDRIVE\u003d%%D:) \u0026\u0026 echo FOUND %%D:\\SOURCES\\x86\\install.*\n)\nFOR %%D IN (A B C D E F G H I J K L M N O P Q R S T U V W X Y Z) DO (\nDIR %%D:\\SOURCES\\x64\\install.*  \u003e nul 2\u003e\u00261 \u0026\u0026 (call set DVDDRIVE\u003d%%D:) \u0026\u0026 echo FOUND %%D:\\SOURCES\\x64\\install.*\n)\nFOR %%D IN (A B C D E F G H I J K L M N O P Q R S T U V W X Y Z) DO (\nDIR %%D:\\x86\\SOURCES\\install.*  \u003e nul 2\u003e\u00261 \u0026\u0026 (call set DVDDRIVE\u003d%%D:) \u0026\u0026 echo FOUND %%D:\\x86\\SOURCES\\install.*\n)\nFOR %%D IN (A B C D E F G H I J K L M N O P Q R S T U V W X Y Z) DO (\nDIR %%D:\\x64\\SOURCES\\install.*  \u003e nul 2\u003e\u00261 \u0026\u0026 (call set DVDDRIVE\u003d%%D:) \u0026\u0026 echo FOUND %%D:\\x64\\SOURCES\\install.*\n)\n\n:ENDSEARCH\nIF \"%DVDDRIVE%\"\u003d\u003d\"\" echo WARNING: VIRTUAL DRIVE DRIVE NOT FOUND!\nIF \"%DVDDRIVE%\"\u003d\u003d\"\" echo WARNING: install.* not found on any mounted volume.\nIF \"%DVDDRIVE%\"\u003d\u003d\"\" pause\necho.\nIF NOT \"%DVDDRIVE%\"\u003d\u003d\"\" echo ISO FILE MOUNTED AS %DVDDRIVE%\n\nREM startnet.cmd normally only contains wpeinit.exe, custom ISOs may contain other commands, so try to run them\nif exist X:\\WINDOWS\\SYSTEM32\\startnet.cmd call cmd /c  X:\\WINDOWS\\SYSTEM32\\startnet.cmd\nif not exist X:\\WINDOWS\\SYSTEM32\\startup.bat exit\nIF \"%DVDDRIVE%\"\u003d\u003d\"\" cmd\n\n%DVDDRIVE%\ncd \\\nset pp\u003d\\x86\nif /i \"%PROCESSOR_ARCHITECTURE%\"\u003d\u003d\"AMD64\" set pp\u003d\\x64\nif not exist %DVDDRIVE%%pp%\\setup.exe set pp\u003d\n\nMODE CON COLS\u003d30 LINES\u003d2\necho DO NOT CLOSE THIS WINDOW\nREM %DVDDRIVE%%pp%\\setup.exe /Unattend:%E2BDRIVE%\\AutoUnattend.xml\n%DVDDRIVE%%pp%\\setup.exe\n```\n\nTested with VirtualBox it seems to work but ended up with:\n\n```\nFOUND USB DRIVE AT DRIVE C:\nDatei nicht gefunden\nLoading C:~,-4\nImDisk driver installes successfully.\nMounting \"~,-4\" using ImDisk\nMounting ISO as Y:...\nCreating device...\nError creating virtual disk:\nDas System kann die angegebene Datei nicht finden.\nWARNING: VIRTUAL DRIVE DRIVE NOT FOUND!\nWARNING: install.* not found on any mounted volume.\nDrücken Sie eine beliebige Taste .  .  .\n\nC:\\\u003ewpeinit\nDer Befehl \"wpeinit\" ist entweder falsch geschrieben oder\nkonnte nicht gefunden werden.\nMicrosoft Windows [Version 10.0.17134.112]\nZur Verarbeitung dieses Befehls sind nicht genügend Speicherressourcen verfügbar.\n```\n\nSame if I test on \"real\" computer.\n\nCan somebody tell me what\u0027s wrong or managed someone to install from Windows ISO?\n\nThanks\n\n\u003cbr /\u003e\n\n"
    },
    {
      "id": "209367",
      "timestamp": "2019-02-18T12:07:04+00:00",
      "author": "steve6375",
      "content": "You have\n\n:: find the ISO  \nset UPATH\u003d\\\\%MYISO%\n\nso it is expecting the ISO to be in the root of the USB drive but you have placed it in \\\\images folder.\n\nCheck X:\\\\Windows\\\\system32\\\\Win10.iso.tag exists\n\nP.S. When you have a problem, use**echo on** (not @echo off) at top of file and place\n\n**pause**\n\nat various lines so you can see results ;-)\n\n**Edited by steve6375, 18 February 2019 - 12:18 PM.**\n"
    },
    {
      "id": "209368",
      "timestamp": "2019-02-18T12:33:29+00:00",
      "author": "nierewa",
      "content": "Hi,\n\nthanks for your reply.  \nI changed to:\n\n```\n:: get path of the ISO into ISONAME\n:: SET \"MYISO\u003d\\images\\WIN10.iso\"\n\nset MYISO\u003d\\images\\WIN10.iso:~,-4%\n\n:: find the ISO\nset UPATH\u003d\\images\\WIN10.iso\nif exist %USBDRIVE%%UPATH% set MYISO\u003d%UPATH%\necho Loading %USBDRIVE%%MYISO% \n```\n\nThat works. Installer startet succesfully.\n\nNo I wait for \"Aktion wird abgeschlossen\"\n\n![install_waiting.png](http://nierewa.bplaced.net/images/install_waiting.png)\n\nI\u0027m hopefully waiting.....\n\n**Edited by nierewa, 18 February 2019 - 12:45 PM.**\n"
    },
    {
      "id": "209370",
      "timestamp": "2019-02-18T20:15:20+00:00",
      "author": "steve6375",
      "content": "well, you have hard-coded the name of the ISO.\n\nTo make it work with a variety of ISOs you should use the original code in the article\n\nand just change the set UPATH line to\n\nset UPATH\u003d\\\\IMAGES\\\\%MYISO%\n\nI have updated the RMPrepUSB article slightly with newer code\n\nThe line\n\nset MYISO\u003d%MYISO:\\~,-4%\n\nshould convert MYISO which should be Win10.iso.tag to Win10.iso (it deletes the last 4 characters)\n\n"
    },
    {
      "id": "209378",
      "timestamp": "2019-02-19T08:43:39+00:00",
      "author": "nierewa",
      "content": "Hi, here\u0027s an update.\n\nTwo errors accurd by testing on \"real\" Notebook:\n\n1. There\u0027s an error in the autounattend.xml\n\nI fixed it in this way\n\n```\n\u003c?xml version\u003d\"1.0\" encoding\u003d\"utf-8\" ?\u003e\n\u003cunattend xmlns\u003d\"urn:schemas-microsoft-com:unattend\"\u003e\n\n\u003csettings pass\u003d\"windowsPE\"\u003e\n\n\u003ccomponent name\u003d\"Microsoft-Windows-Setup\" processorArchitecture\u003d\"amd64\" publicKeyToken\u003d\"31bf3856ad364e35\" language\u003d\"neutral\" versionScope\u003d\"nonSxS\" xmlns:wcm\u003d\"http://schemas.microsoft.com/WMIConfig/2002/State\" xmlns:xsi\u003d\"http://www.w3.org/2001/XMLSchema-instance\"\u003e\n\u003cRunSynchronous\u003e\n\u003cRunSynchronousCommand wcm:action\u003d\"add\"\u003e\n\u003cOrder\u003e1\u003c/Order\u003e\n\u003cPath\u003ecmd /q /c \"FOR %i IN (C D E F G H I J K L N M O P Q R S T U V W X Y Z) DO IF EXIST %i:\\multiboot\\Windows10Home32_64Aniversary\\remount.cmd cmd /k %i:\\multiboot\\Windows10Home32_64Aniversary\\remount.cmd\"\u003c/Path\u003e\n\u003cDescription\u003eLaunch Remount\u003c/Description\u003e\n\u003c/RunSynchronousCommand\u003e\n\u003c/RunSynchronous\u003e\n\u003cUserData\u003e\n\u003cAcceptEula\u003etrue\u003c/AcceptEula\u003e\n\u003cProductKey\u003e\n\u003cKey\u003e\u003c/Key\u003e\n\u003c/ProductKey\u003e\n\u003c/UserData\u003e\n\u003c/component\u003e\n\u003ccomponent name\u003d\"Microsoft-Windows-Setup\" processorArchitecture\u003d\"x86\" publicKeyToken\u003d\"31bf3856ad364e35\" language\u003d\"neutral\" versionScope\u003d\"nonSxS\" xmlns:wcm\u003d\"http://schemas.microsoft.com/WMIConfig/2002/State\" xmlns:xsi\u003d\"http://www.w3.org/2001/XMLSchema-instance\"\u003e\n\u003cRunSynchronous\u003e\n\u003cRunSynchronousCommand wcm:action\u003d\"add\"\u003e\n\u003cOrder\u003e1\u003c/Order\u003e\n\u003cPath\u003ecmd /q /c \"FOR %i IN (C D E F G H I J K L N M O P Q R S T U V W X Y Z) DO IF EXIST %i:\\multiboot\\Windows10Home32_64Aniversary\\remount.cmd cmd /k %i:\\multiboot\\Windows10Home32_64Aniversary\\remount.cmd\"\u003c/Path\u003e\n\u003cDescription\u003eLaunch Remount\u003c/Description\u003e\n\u003c/RunSynchronousCommand\u003e\n\u003c/RunSynchronous\u003e\n\u003cUserData\u003e\n\u003cAcceptEula\u003etrue\u003c/AcceptEula\u003e\n\u003cProductKey\u003e\n\u003cKey\u003e\u003c/Key\u003e\n\u003c/ProductKey\u003e\n\u003c/UserData\u003e\n\u003c/component\u003e\n\u003c/settings\u003e\n\u003c/unattend\u003e\n```\n\n2. No Touchpad during installation and after\n\n3. I\u0027ve made an iso with media creation tool for both architektures (7GB). During boot I\u0027ve get an error \"file not found\"  \nWith an 3GB iso it works.\n\n"
    },
    {
      "id": "209379",
      "timestamp": "2019-02-19T08:50:53+00:00",
      "author": "steve6375",
      "content": "1. What was the problem? Why is remount.cmd required?\n\n2. It will depend on integrated Windows drivers\n\n3. If dual architecture, then you need to ask which boot.wim to boot from x86 or x64 version. E2B does this, it uses grub4dos code...\n\n```\n#check if dual architecture\nset pp\u003d/x64\nset DUAL\u003d\nif exist (0xff)/x86/sources/boot.wim if exist (0xff)/x64/sources/boot.wim set DUAL\u003d1 || set pp\u003d\nif exist DUAL echo -e \\n\\nDUAL ARCHITECTURE ISO (x86 + x64):\ncheckrange 0,1 is64bit \u0026\u0026 if exist DUAL set pp\u003d/x86\ncheckrange 2,3 is64bit \u0026\u0026 if exist DUAL set pp\u003dY \u0026\u0026 if exist DUAL set /p pp\u003dx64 ([Y]/N)? :\necho\nif exist DUAL if /i \"%pp%\"\u003d\u003d\"Y\" set pp\u003d/x64 || set pp\u003d/x86\nif not exist DUAL set pp\u003d\nif not exist (0xff)%pp%/sources/boot.wim set pp\u003d \u0026\u0026 echo ERROR: %pp%/sources/boot.wim not found!\nif not exist (0xff)%pp%/boot/bcd set pp\u003d \u0026\u0026 echo ERROR: %pp%/boot/bcd not found!\nif not exist (0xff)%pp%/boot/boot.sdi set pp\u003d \u0026\u0026 echo ERROR: %pp%/boot/boot.sdi not found!\nroot (0xff) \u003e nul\nkernel (hd0,0)/_ISO/e2b/grub/wimboot \ninitrd @startupe2b.bat\u003d%E2B%/_ISO/e2b/grub/startupe2b.bat @winpeshl.ini\u003d%E2B%/_ISO/e2b/grub/winpeshl.ini @bcd\u003d%pp%/boot/bcd @boot.sdi\u003d%pp%/boot/boot.sdi @boot.wim\u003d%pp%/sources/boot.wim\n```\n\n\u003cbr /\u003e\n\n"
    },
    {
      "id": "209390",
      "timestamp": "2019-02-19T18:47:58+00:00",
      "author": "nierewa",
      "content": "I have changed something until now.\n\nIn Folder /images I have two ISO-files.  \nWin10_1809_x86 and Win10_1809_x64.\n\nThe menu.lst looks so:\n\n```\ntitle Install Windows10x64 1809 using wimboot method\nmap /images/Win10_1809_x64.iso (0xff)\nmap --hook\nroot (0xff)\n# the root path now points to the files inside the ISO file\n# hd0,0 is the USB drive that we booted from\nkernel (hd0,0)/wimboot\ninitrd @startup.bat\u003d(hd0,0)/startup.bat @winpeshl.ini\u003d(hd0,0)/winpeshl.ini @bcd\u003d/boot/bcd @boot.sdi\u003d/boot/boot.sdi @boot.wim\u003d/sources/boot.wim @/images/Win10_1809_x64.iso.tag\u003d/boot/bcd\nmap (hd0) (hd1)\nmap (hd1) (hd0)\nmap --hook\nboot\n\ntitle Install Windows10x86 1809 using wimboot method\nmap /images/Win10_1809_x86.iso (0xff)\nmap --hook\nroot (0xff)\n# the root path now points to the files inside the ISO file\n# hd0,0 is the USB drive that we booted from\nkernel (hd0,0)/wimboot\ninitrd @startup.bat\u003d(hd0,0)/startup.bat @winpeshl.ini\u003d(hd0,0)/winpeshl.ini @bcd\u003d/boot/bcd @boot.sdi\u003d/boot/boot.sdi @boot.wim\u003d/sources/boot.wim @/images/Win10_1809_x86.iso.tag\u003d/boot/bcd\nmap (hd0) (hd1)\nmap (hd1) (hd0)\nmap --hook\nboot\n```\n\nChange the the startup.bat for steve6375 advice to:\n\n```\n@echo off\nTITLE %~dpnx0 (WIMBOOT startup.bat)\nwpeinit.exe\nREM prevent wpeinit from running again\nren X:\\windows\\system32\\wpeinit.exe wpeinit.exe.old\n\nfor %%I in (C D E F G H I J K L M N O P Q R S T U V W X Y Z) do if exist %%I:\\wimboot\\startup.bat set USBDRIVE\u003d%%I:\nIF \"%USBDRIVE%\"\u003d\u003d\"\" (\necho ERROR - COULD NOT FIND E2B DRIVE!\npause\ngoto :EOF\n)\n\ncd %USBDRIVE%\\\n%USBDRIVE%\ncolor 1f\n@echo off\ncls\nSET BIT\u003d32\nif \"%PROCESSOR_ARCHITECTURE%\"\u003d\u003d\"AMD64\" SET BIT\u003d64\n\necho LOADISO\nFOR /L %%A IN (0,1,5000) DO ECHO NOTHING \u003e nul\ncls\n@echo FOUND USB DRIVE AT DRIVE %USBDRIVE%\ncd /d %USBDRIVE%\\\n\n:: get path of the ISO into ISONAME\n:: SET \"MYISO\u003d\\_ISO\\MAINMENU\\WINDOWS\\Windows10Prox64.iso\"\nfor /f %%a in ( \u0027dir /b X:\\Windows\\System32\\*.iso.tag\u0027 ) do set MYISO\u003d%%a\nset MYISO\u003d%MYISO:~,-4%\n\n:: find the ISO in \\_ISO\\MAINMENU\\WINDOWS\nset UPATH\u003d\\images\\%MYISO%\nif exist %USBDRIVE%%UPATH% set MYISO\u003d%UPATH%\necho Loading %USBDRIVE%%MYISO%\n\nREM Load ISO using ImDisk\nTITLE LOAD WINDOWS ISO USING IMDISK\ncall \\wimboot\\imdisk\\IMDISK_install.cmd\ncall \\wimboot\\imdisk\\IMDISK_instiso.cmd\n\nREM Find mounted DVD drive\nset DVDDRIVE\u003d\nFOR %%D IN (A B C D E F G H I J K L M N O P Q R S T U V W X Y Z) DO (\nDIR %%D:\\SOURCES\\install.* \u003e nul 2\u003e\u00261 \u0026\u0026 (call set DVDDRIVE\u003d%%D:) \u0026\u0026 echo FOUND %%D:\\SOURCES\\install.*\n)\nFOR %%D IN (A B C D E F G H I J K L M N O P Q R S T U V W X Y Z) DO (\nDIR %%D:\\SOURCES\\x86\\install.* \u003e nul 2\u003e\u00261 \u0026\u0026 (call set DVDDRIVE\u003d%%D:) \u0026\u0026 echo FOUND %%D:\\SOURCES\\x86\\install.*\n)\nFOR %%D IN (A B C D E F G H I J K L M N O P Q R S T U V W X Y Z) DO (\nDIR %%D:\\SOURCES\\x64\\install.* \u003e nul 2\u003e\u00261 \u0026\u0026 (call set DVDDRIVE\u003d%%D:) \u0026\u0026 echo FOUND %%D:\\SOURCES\\x64\\install.*\n)\nFOR %%D IN (A B C D E F G H I J K L M N O P Q R S T U V W X Y Z) DO (\nDIR %%D:\\x86\\SOURCES\\install.* \u003e nul 2\u003e\u00261 \u0026\u0026 (call set DVDDRIVE\u003d%%D:) \u0026\u0026 echo FOUND %%D:\\x86\\SOURCES\\install.*\n)\nFOR %%D IN (A B C D E F G H I J K L M N O P Q R S T U V W X Y Z) DO (\nDIR %%D:\\x64\\SOURCES\\install.* \u003e nul 2\u003e\u00261 \u0026\u0026 (call set DVDDRIVE\u003d%%D:) \u0026\u0026 echo FOUND %%D:\\x64\\SOURCES\\install.*\n)\n\n:ENDSEARCH\nIF \"%DVDDRIVE%\"\u003d\u003d\"\" echo WARNING: VIRTUAL DRIVE DRIVE NOT FOUND!\nIF \"%DVDDRIVE%\"\u003d\u003d\"\" echo WARNING: install.* not found on any mounted volume.\nIF \"%DVDDRIVE%\"\u003d\u003d\"\" pause\necho.\nIF NOT \"%DVDDRIVE%\"\u003d\u003d\"\" echo ISO FILE MOUNTED AS %DVDDRIVE%\n\nREM startnet.cmd normally only contains wpeinit.exe, custom ISOs may contain other commands, so try to run them\nif exist X:\\WINDOWS\\SYSTEM32\\startnet.cmd call cmd /c X:\\WINDOWS\\SYSTEM32\\startnet.cmd\nif not exist X:\\WINDOWS\\SYSTEM32\\startup.bat exit\nIF \"%DVDDRIVE%\"\u003d\u003d\"\" cmd\n\n%DVDDRIVE%\ncd \\\nset pp\u003d\\x86\nif /i \"%PROCESSOR_ARCHITECTURE%\"\u003d\u003d\"AMD64\" set pp\u003d\\x64\nif not exist %DVDDRIVE%%pp%\\setup.exe set pp\u003d\n\nMODE CON COLS\u003d30 LINES\u003d2\necho DO NOT CLOSE THIS WINDOW\nREM %DVDDRIVE%%pp%\\setup.exe /Unattend:%E2BDRIVE%\\AutoUnattend.xml\n%DVDDRIVE%%pp%\\setup.exe\n```\n\nEnds up with\n\nError creating virtual disk:  \nDas System kann die angegebene Datei nicht finden.\n\n\u003e so it is expecting the ISO to be in the root of the USB drive but you have placed it in \\\\images folder.\n\u003e\n\u003e Check X:\\\\Windows\\\\system32\\\\Win10.iso.tag exists\n\nThere\u0027s no \\*.iso.tag file in this path.  \nI don\u0027t see the mistake I\u0027ve done ![:(](http://reboot.pro/public/style_emoticons/default/sad.png)\n\n"
    },
    {
      "id": "209391",
      "timestamp": "2019-02-19T18:54:07+00:00",
      "author": "steve6375",
      "content": "\u003e @/images/Win10_1809_x64.iso.tag\u003d/boot/bcd\n\u003e\n@ symbol defines the **filename** of the file that will be created in the X:\\\\WIndows\\\\System32 folder -\n\nIt should be\n\n```\n@Win10_1809_x64.iso.tag\u003d/boot/bcd\n```\n\nMaximum length of the filename after @ can be up to 31 characters\n\n"
    },
    {
      "id": "209392",
      "timestamp": "2019-02-19T19:03:47+00:00",
      "author": "nierewa",
      "content": "I\u0027ve changed it, but didn\u0027t work.  \nNo iso found, nothing in X:\\\\Windows\\\\system32\\\\\n\n"
    },
    {
      "id": "209393",
      "timestamp": "2019-02-19T19:10:11+00:00",
      "author": "steve6375",
      "content": "Try using\n\nkernel (hd0,0)/wimboot pause\n\nand check that wimboot is adding the files correctly\n\n[https://ipxe.org/wimboot](https://ipxe.org/wimboot \"External link\")\n\nP.S. you can always add lines to the bat file, e.g.\n\ndir X:\\\\Windows\\\\System32\\\\\\*.tag\n\npause\n\n"
    },
    {
      "id": "209394",
      "timestamp": "2019-02-19T19:37:45+00:00",
      "author": "nierewa",
      "content": "wimboot pause say:\n\n```\n...\n\nusing bootmgr.exe via 0x434a0 len 0xa2338\n... extracted bootmgr.exe\nusing win10_1809_x64.iso.tag via 0xd9597088 len 0x4000\nemulating drive 0x83\nentering bootmgr.exe with parameters at 0x2c4e0\n```\n\ndir X:\\\\Windows\\\\System32\\\\\\*.tag\n\npause ------\\\u003e Datei nicht gefunden\n\n"
    },
    {
      "id": "209395",
      "timestamp": "2019-02-19T19:41:56+00:00",
      "author": "steve6375",
      "content": "wimboot is 2017-05-2017?\n\n"
    },
    {
      "id": "209396",
      "timestamp": "2019-02-19T19:51:08+00:00",
      "author": "nierewa",
      "content": "The wimboot is from the grub2_wimboot I\u0027ve downloaded from the tutorial site.  \n2017-05-18\n\n"
    },
    {
      "id": "209397",
      "timestamp": "2019-02-19T20:04:25+00:00",
      "author": "steve6375",
      "content": "Try changing the order of the initrd line\n\nI tested your line and got the same problem\n\nThen I moved the .iso.tag file to the start of initrd and it worked OK!\n\nMaybe the boot.wim needs to be last ?\n\ninitrd @Win10_1809_x86.iso.tag\u003d/boot/bcd @startup.bat\u003d(hd0,0)/startup.bat @winpeshl.ini\u003d(hd0,0)/winpeshl.ini @bcd\u003d/boot/bcd @boot.sdi\u003d/boot/boot.sdi @boot.wim\u003d/sources/boot.wim\n\n"
    },
    {
      "id": "209400",
      "timestamp": "2019-02-19T21:31:21+00:00",
      "author": "nierewa",
      "content": "Man this is it.\n\nIt works.\n\nTime to test ![:D](http://reboot.pro/public/style_emoticons/default/biggrin.png)\n\n"
    },
    {
      "id": "209402",
      "timestamp": "2019-02-19T22:30:52+00:00",
      "author": "steve6375",
      "content": "I made a few tests,\n\nIt looks like the last files must be boot.wim and bcd\n\n```\n#FAILS initrd @boot.sdi\u003d/boot/boot.sdi @startup.bat\u003d(hd0,0)/startup.bat @winpeshl.ini\u003d(hd0,0)/winpeshl.ini  @boot.wim\u003d/sources/boot.wim  @bcd\u003d/boot/bcd @Win10x64UK_Oct_2018.iso.tag\u003d/boot/bcd\n#FAILS initrd @startup.bat\u003d(hd0,0)/startup.bat @winpeshl.ini\u003d(hd0,0)/winpeshl.ini  @boot.wim\u003d/sources/boot.wim  @bcd\u003d/boot/bcd @Win10x64UK_Oct_2018.iso.tag\u003d/boot/bcd @boot.sdi\u003d/boot/boot.sdi\n#FAILS initrd @winpeshl.ini\u003d(hd0,0)/winpeshl.ini  @boot.wim\u003d/sources/boot.wim  @bcd\u003d/boot/bcd @Win10x64UK_Oct_2018.iso.tag\u003d/boot/bcd @boot.sdi\u003d/boot/boot.sdi @startup.bat\u003d(hd0,0)/startup.bat\n#FAILS initrd @winpeshl.ini\u003d(hd0,0)/winpeshl.ini  @boot.wim\u003d/sources/boot.wim  @bcd\u003d/boot/bcd @Win10x64UK_Oct_2018.iso.tag\u003d/boot/bcd  @startup.bat\u003d(hd0,0)/startup.bat @boot.sdi\u003d/boot/boot.sdi\n#FAILS initrd @Win10x64UK_Oct_2018.iso.tag\u003d/boot/bcd  @startup.bat\u003d(hd0,0)/startup.bat @boot.sdi\u003d/boot/boot.sdi @boot.wim\u003d/sources/boot.wim @bcd\u003d/boot/bcd @winpeshl.ini\u003d(hd0,0)/winpeshl.ini\n#FAILS initrd @Win10x64UK_Oct_2018.iso.tag\u003d/boot/bcd @boot.sdi\u003d/boot/boot.sdi @boot.wim\u003d/sources/boot.wim @bcd\u003d/boot/bcd @winpeshl.ini\u003d(hd0,0)/winpeshl.ini  @startup.bat\u003d(hd0,0)/startup.bat\n#FAILS initrd @Win10x64UK_Oct_2018.iso.tag\u003d/boot/bcd @boot.sdi\u003d/boot/boot.sdi @boot.wim\u003d/sources/boot.wim @winpeshl.ini\u003d(hd0,0)/winpeshl.ini  @startup.bat\u003d(hd0,0)/startup.bat  @bcd\u003d/boot/bcd\n#FAILS initrd @boot.sdi\u003d/boot/boot.sdi @winpeshl.ini\u003d(hd0,0)/winpeshl.ini   @bcd\u003d/boot/bcd @Win10x64UK_Oct_2018.iso.tag\u003d/boot/bcd  @boot.wim\u003d/sources/boot.wim  @startup.bat\u003d(hd0,0)/startup.bat\n#FAILS initrd @boot.sdi\u003d/boot/boot.sdi @startup.bat\u003d(hd0,0)/startup.bat @winpeshl.ini\u003d(hd0,0)/winpeshl.ini @bcd\u003d/boot/bcd  @boot.wim\u003d/sources/boot.wim @Win10x64UK_Oct_2018.iso.tag\u003d/boot/bcd\n\n#WORKS initrd @Win10x64UK_Oct_2018.iso.tag\u003d/boot/bcd @bcd\u003d/boot/bcd @boot.sdi\u003d/boot/boot.sdi @startup.bat\u003d(hd0,0)/startup.bat @winpeshl.ini\u003d(hd0,0)/winpeshl.ini  @boot.wim\u003d/sources/boot.wim\n#WORKS initrd @Win10x64UK_Oct_2018.iso.tag\u003d/boot/bcd @boot.sdi\u003d/boot/boot.sdi @startup.bat\u003d(hd0,0)/startup.bat @winpeshl.ini\u003d(hd0,0)/winpeshl.ini  @boot.wim\u003d/sources/boot.wim  @bcd\u003d/boot/bcd\n#WORKS initrd @winpeshl.ini\u003d(hd0,0)/winpeshl.ini @bcd\u003d/boot/bcd @Win10x64UK_Oct_2018.iso.tag\u003d/boot/bcd  @startup.bat\u003d(hd0,0)/startup.bat @boot.sdi\u003d/boot/boot.sdi @boot.wim\u003d/sources/boot.wim\n#WORKS initrd @winpeshl.ini\u003d(hd0,0)/winpeshl.ini @Win10x64UK_Oct_2018.iso.tag\u003d/boot/bcd  @startup.bat\u003d(hd0,0)/startup.bat @boot.sdi\u003d/boot/boot.sdi @boot.wim\u003d/sources/boot.wim @bcd\u003d/boot/bcd\n#WORKS initrd @Win10x64UK_Oct_2018.iso.tag\u003d/boot/bcd @boot.sdi\u003d/boot/boot.sdi @bcd\u003d/boot/bcd @winpeshl.ini\u003d(hd0,0)/winpeshl.ini @startup.bat\u003d(hd0,0)/startup.bat @boot.wim\u003d/sources/boot.wim\n#WORKS initrd @Win10x64UK_Oct_2018.iso.tag\u003d/boot/bcd @boot.sdi\u003d/boot/boot.sdi @winpeshl.ini\u003d(hd0,0)/winpeshl.ini  @startup.bat\u003d(hd0,0)/startup.bat  @bcd\u003d/boot/bcd @boot.wim\u003d/sources/boot.wim\n#WORKS initrd @boot.sdi\u003d/boot/boot.sdi @winpeshl.ini\u003d(hd0,0)/winpeshl.ini @startup.bat\u003d(hd0,0)/startup.bat  @bcd\u003d/boot/bcd @Win10x64UK_Oct_2018.iso.tag\u003d/boot/bcd @boot.wim\u003d/sources/boot.wim\n#WORKS initrd @boot.sdi\u003d/boot/boot.sdi @winpeshl.ini\u003d(hd0,0)/winpeshl.ini @bcd\u003d/boot/bcd @Win10x64UK_Oct_2018.iso.tag\u003d/boot/bcd  @startup.bat\u003d(hd0,0)/startup.bat @boot.wim\u003d/sources/boot.wim\n#WORKS initrd @startup.bat\u003d(hd0,0)/startup.bat @winpeshl.ini\u003d(hd0,0)/winpeshl.ini @bcd\u003d/boot/bcd @Win10x64UK_Oct_2018.iso.tag\u003d/boot/bcd @boot.sdi\u003d/boot/boot.sdi @boot.wim\u003d/sources/boot.wim\n#WORKS initrd @bcd\u003d/boot/bcd @Win10x64UK_Oct_2018.iso.tag\u003d/boot/bcd @boot.sdi\u003d/boot/boot.sdi @startup.bat\u003d(hd0,0)/startup.bat @winpeshl.ini\u003d(hd0,0)/winpeshl.ini  @boot.wim\u003d/sources/boot.wim\n#WORKS initrd @boot.sdi\u003d/boot/boot.sdi @startup.bat\u003d(hd0,0)/startup.bat @winpeshl.ini\u003d(hd0,0)/winpeshl.ini @bcd\u003d/boot/bcd @Win10x64UK_Oct_2018.iso.tag\u003d/boot/bcd  @boot.wim\u003d/sources/boot.wim\n```\n\n\u003cbr /\u003e\n\n"
    },
    {
      "id": "209474",
      "timestamp": "2019-02-24T09:54:12+00:00",
      "author": "nierewa",
      "content": "\u003e It looks like the last files must be boot.wim and bcd\n\nHow did you figure it out. How get you this idea?\n\nIT WORKS ![:D](http://reboot.pro/public/style_emoticons/default/biggrin.png)  \nOnly some USB ports (USB 3 and USB2) ends up with \"ERROR - COULD NOT FIND E2B DRIVE!\"  \nOther ports on same PC works.  \n\nI found an unattend.xml on a mainboards support dvd:\n\n```\n\u003c?xml version\u003d\"1.0\" encoding\u003d\"utf-8\"?\u003e\n\u003cunattend xmlns\u003d\"urn:schemas-microsoft-com:unattend\"\u003e\n  \u003csettings pass\u003d\"windowsPE\"\u003e\n    \u003ccomponent name\u003d\"Microsoft-Windows-PnpCustomizationsWinPE\" processorArchitecture\u003d\"x86\" publicKeyToken\u003d\"31bf3856ad364e35\" language\u003d\"neutral\" versionScope\u003d\"nonSxS\" xmlns:wcm\u003d\"http://schemas.microsoft.com/WMIConfig/2002/State\" xmlns:xsi\u003d\"http://www.w3.org/2001/XMLSchema-instance\"\u003e\n      \u003cDriverPaths\u003e\n        \u003cPathAndCredentials wcm:action\u003d\"add\" wcm:keyValue\u003d\"u3311b21\"\u003e\n          \u003cPath\u003e%configsetroot%\\Win7\\usb3\\Asmedia\u003c/Path\u003e\n        \u003c/PathAndCredentials\u003e\n        \u003cPathAndCredentials wcm:action\u003d\"add\" wcm:keyValue\u003d\"u3318086\"\u003e\n          \u003cPath\u003e%configsetroot%\\Win7\\usb3\\Intel\\x86\u003c/Path\u003e\n        \u003c/PathAndCredentials\u003e\n        \u003cPathAndCredentials wcm:action\u003d\"add\" wcm:keyValue\u003d\"u3301022\"\u003e\n          \u003cPath\u003e%configsetroot%\\Win7\\usb3\\AMD\\USB30\\x86\u003c/Path\u003e\n        \u003c/PathAndCredentials\u003e\n        \u003cPathAndCredentials wcm:action\u003d\"add\" wcm:keyValue\u003d\"u3311022\"\u003e\n          \u003cPath\u003e%configsetroot%\\Win7\\usb3\\AMD\\USB31\\x86\u003c/Path\u003e\n        \u003c/PathAndCredentials\u003e\n      \u003c/DriverPaths\u003e\n\u003cUserData\u003e\n\u003cAcceptEula\u003etrue\u003c/AcceptEula\u003e\n\u003cProductKey\u003e\n\u003cKey\u003e\u003c/Key\u003e\n\u003c/ProductKey\u003e\n\u003c/UserData\u003e\n    \u003c/component\u003e\n    \u003ccomponent name\u003d\"Microsoft-Windows-PnpCustomizationsWinPE\" processorArchitecture\u003d\"amd64\" publicKeyToken\u003d\"31bf3856ad364e35\" language\u003d\"neutral\" versionScope\u003d\"nonSxS\" xmlns:wcm\u003d\"http://schemas.microsoft.com/WMIConfig/2002/State\" xmlns:xsi\u003d\"http://www.w3.org/2001/XMLSchema-instance\"\u003e\n      \u003cDriverPaths\u003e\n        \u003cPathAndCredentials wcm:action\u003d\"add\" wcm:keyValue\u003d\"u3311b21\"\u003e\n          \u003cPath\u003e%configsetroot%\\Win7\\usb3\\Asmedia\u003c/Path\u003e\n        \u003c/PathAndCredentials\u003e\n        \u003cPathAndCredentials wcm:action\u003d\"add\" wcm:keyValue\u003d\"u3318086\"\u003e\n          \u003cPath\u003e%configsetroot%\\Win7\\usb3\\Intel\\x64\u003c/Path\u003e\n        \u003c/PathAndCredentials\u003e\n        \u003cPathAndCredentials wcm:action\u003d\"add\" wcm:keyValue\u003d\"u3301022\"\u003e\n          \u003cPath\u003e%configsetroot%\\Win7\\usb3\\AMD\\USB30\\x64\u003c/Path\u003e\n        \u003c/PathAndCredentials\u003e\n        \u003cPathAndCredentials wcm:action\u003d\"add\" wcm:keyValue\u003d\"u3311022\"\u003e\n          \u003cPath\u003e%configsetroot%\\Win7\\usb3\\AMD\\USB31\\x64\u003c/Path\u003e\n        \u003c/PathAndCredentials\u003e\n      \u003c/DriverPaths\u003e\n    \u003c/component\u003e\n    \u003ccomponent name\u003d\"Microsoft-Windows-Setup\" processorArchitecture\u003d\"amd64\" publicKeyToken\u003d\"31bf3856ad364e35\" language\u003d\"neutral\" versionScope\u003d\"nonSxS\" xmlns:wcm\u003d\"http://schemas.microsoft.com/WMIConfig/2002/State\" xmlns:xsi\u003d\"http://www.w3.org/2001/XMLSchema-instance\"\u003e\n      \u003cUseConfigurationSet\u003etrue\u003c/UseConfigurationSet\u003e\n\u003cUserData\u003e\n\u003cAcceptEula\u003etrue\u003c/AcceptEula\u003e\n\u003cProductKey\u003e\n\u003cKey\u003e\u003c/Key\u003e\n\u003c/ProductKey\u003e\n\u003c/UserData\u003e\n    \u003c/component\u003e\n    \u003ccomponent name\u003d\"Microsoft-Windows-Setup\" processorArchitecture\u003d\"x86\" publicKeyToken\u003d\"31bf3856ad364e35\" language\u003d\"neutral\" versionScope\u003d\"nonSxS\" xmlns:wcm\u003d\"http://schemas.microsoft.com/WMIConfig/2002/State\" xmlns:xsi\u003d\"http://www.w3.org/2001/XMLSchema-instance\"\u003e\n      \u003cUseConfigurationSet\u003etrue\u003c/UseConfigurationSet\u003e\n    \u003c/component\u003e\n  \u003c/settings\u003e\n  \u003csettings pass\u003d\"offlineServicing\"\u003e\n    \u003ccomponent name\u003d\"Microsoft-Windows-PnpCustomizationsNonWinPE\" processorArchitecture\u003d\"x86\" publicKeyToken\u003d\"31bf3856ad364e35\" language\u003d\"neutral\" versionScope\u003d\"nonSxS\" xmlns:wcm\u003d\"http://schemas.microsoft.com/WMIConfig/2002/State\" xmlns:xsi\u003d\"http://www.w3.org/2001/XMLSchema-instance\"\u003e\n      \u003cDriverPaths\u003e\n        \u003cPathAndCredentials wcm:action\u003d\"add\" wcm:keyValue\u003d\"u3311b21\"\u003e\n          \u003cPath\u003e%configsetroot%\\Win7\\usb3\\Asmedia\u003c/Path\u003e\n        \u003c/PathAndCredentials\u003e\n        \u003cPathAndCredentials wcm:action\u003d\"add\" wcm:keyValue\u003d\"u3318086\"\u003e\n          \u003cPath\u003e%configsetroot%\\Win7\\usb3\\Intel\\x86\u003c/Path\u003e\n        \u003c/PathAndCredentials\u003e\n        \u003cPathAndCredentials wcm:action\u003d\"add\" wcm:keyValue\u003d\"u3301022\"\u003e\n          \u003cPath\u003e%configsetroot%\\Win7\\usb3\\AMD\\USB30\\x86\u003c/Path\u003e\n        \u003c/PathAndCredentials\u003e\n        \u003cPathAndCredentials wcm:action\u003d\"add\" wcm:keyValue\u003d\"u3311022\"\u003e\n          \u003cPath\u003e%configsetroot%\\Win7\\usb3\\AMD\\USB31\\x86\u003c/Path\u003e\n        \u003c/PathAndCredentials\u003e\n      \u003c/DriverPaths\u003e\n\u003cUserData\u003e\n\u003cAcceptEula\u003etrue\u003c/AcceptEula\u003e\n\u003cProductKey\u003e\n\u003cKey\u003e\u003c/Key\u003e\n\u003c/ProductKey\u003e\n\u003c/UserData\u003e\n    \u003c/component\u003e\n    \u003ccomponent name\u003d\"Microsoft-Windows-PnpCustomizationsNonWinPE\" processorArchitecture\u003d\"amd64\" publicKeyToken\u003d\"31bf3856ad364e35\" language\u003d\"neutral\" versionScope\u003d\"nonSxS\" xmlns:wcm\u003d\"http://schemas.microsoft.com/WMIConfig/2002/State\" xmlns:xsi\u003d\"http://www.w3.org/2001/XMLSchema-instance\"\u003e\n      \u003cDriverPaths\u003e\n        \u003cPathAndCredentials wcm:action\u003d\"add\" wcm:keyValue\u003d\"u3311b21\"\u003e\n          \u003cPath\u003e%configsetroot%\\Win7\\usb3\\Asmedia\u003c/Path\u003e\n        \u003c/PathAndCredentials\u003e\n        \u003cPathAndCredentials wcm:action\u003d\"add\" wcm:keyValue\u003d\"u3318086\"\u003e\n          \u003cPath\u003e%configsetroot%\\Win7\\usb3\\Intel\\x64\u003c/Path\u003e\n        \u003c/PathAndCredentials\u003e\n        \u003cPathAndCredentials wcm:action\u003d\"add\" wcm:keyValue\u003d\"u3301022\"\u003e\n          \u003cPath\u003e%configsetroot%\\Win7\\usb3\\AMD\\USB30\\x64\u003c/Path\u003e\n        \u003c/PathAndCredentials\u003e\n        \u003cPathAndCredentials wcm:action\u003d\"add\" wcm:keyValue\u003d\"u3311022\"\u003e\n          \u003cPath\u003e%configsetroot%\\Win7\\usb3\\AMD\\USB31\\x64\u003c/Path\u003e\n        \u003c/PathAndCredentials\u003e\n      \u003c/DriverPaths\u003e\n\u003cUserData\u003e\n\u003cAcceptEula\u003etrue\u003c/AcceptEula\u003e\n\u003cProductKey\u003e\n\u003cKey\u003e\u003c/Key\u003e\n\u003c/ProductKey\u003e\n\u003c/UserData\u003e\n    \u003c/component\u003e\n  \u003c/settings\u003e\n  \u003ccpi:offlineImage cpi:source\u003d\"wim:c:/windows7_wim/install.wim#Windows 7 HOMEPREMIUM\" xmlns:cpi\u003d\"urn:schemas-microsoft-com:cpi\" /\u003e\n\u003c/unattend\u003e\n\n```\n\nIt\u0027s installed USB driver, right?  \nCan this work? Where is %configroot%?\n\nThe root of the USB stick? (I\u0027ve copied drivers there)\n\n**Edited by nierewa, 24 February 2019 - 09:56 AM.**\n"
    },
    {
      "id": "209475",
      "timestamp": "2019-02-24T10:00:07+00:00",
      "author": "steve6375",
      "content": "\u003e It looks like the last files must be boot.wim and bcd\n\u003e\n\u003e How did you figure it out. How get you this idea?\n\u003e\nBecause my grub4dos menu worked and yours did not - the only difference I could see was that the order of the files was different.\n\nre. %configsetroot%\n\nI think this is added in by the Microsoft build tools and is not present in a standard retail install ISO?\n\n[https://docs.microso...nstallfrom-path](https://docs.microsoft.com/en-us/windows-hardware/customize/desktop/unattend/microsoft-windows-setup-imageinstall-dataimage-installfrom-path \"External link\")\n\n"
    },
    {
      "id": "209477",
      "timestamp": "2019-02-24T10:35:50+00:00",
      "author": "nierewa",
      "content": "Hmm, seems you are right.\n\nAre you think I can add USB 3.0 drivers in that way?  \nI have to change %configroot% to USB root,e.g.: \\\u003cPath\\\u003e%USBDRIVE%\\\\Win7\\\\usb3\\\\Asmedia\\\u003c/Path\\\u003e\n\nPerhaps it could solve the \"ERROR - COULD NOT FIND E2B DRIVE!\".\n\n"
    },
    {
      "id": "209478",
      "timestamp": "2019-02-24T10:37:03+00:00",
      "author": "steve6375",
      "content": "No.\n\n"
    },
    {
      "id": "209479",
      "timestamp": "2019-02-24T10:42:17+00:00",
      "author": "nierewa",
      "content": "Too bad.  \nThank you for your great help ![:thumbup:](http://reboot.pro/public/style_emoticons/default/thumbup.gif)\n\n"
    },
    {
      "id": "209503",
      "timestamp": "2019-02-25T01:25:10+00:00",
      "author": "Hillary22",
      "content": "\u003e You have\n\u003e\n\u003e :: find the ISO  \n\u003e set UPATH\u003d\\\\%MYISO%\n\u003e\n\u003e so it is expecting the ISO to be in the root of the USB drive but you have placed it in \\\\images folder.\n\u003e\n\u003e Check X:\\\\Windows\\\\system32\\\\Win10.iso.tag exists\n\u003e\n\u003e [transfers paris airports](http://www.shuttle-paris-airports.com/paris-shuttle \"External link\")\n\u003e\n\u003e P.S. When you have a problem, use**echo on** (not @echo off) at top of file and place\n\u003e\n\u003e **pause**\n\u003e\n\u003e at various lines so you can see results ;-)\n\nAhhh you\u0027re right , thank you very much\n\n"
    },
    {
      "id": "209807",
      "timestamp": "2019-03-14T03:08:17+00:00",
      "author": "nightmoldy",
      "content": "There are issues with Windows 10 1809 ISO, roll back to previous versions.\n\n"
    },
    {
      "id": "209924",
      "timestamp": "2019-03-18T07:13:55+00:00",
      "author": "Daomer",
      "content": "Making a bootable USB drive for installing Windows 10 will save you a lot of trouble,all you need to do is burn iso to an empty USB.\n\n"
    },
    {
      "id": "209985",
      "timestamp": "2019-03-20T10:08:10+00:00",
      "author": "Daomer",
      "content": "\u003e Making a bootable USB drive for installing Windows 10 will save you a lot of trouble,all you need is an empty USB.\n\nDo as it says :[https://www.uubyte.c...m-iso-file.html](https://www.uubyte.com/make-bootable-usb-from-iso-file.html \"External link\")\n\nI think it\u0027s so easy.\n\n"
    },
    {
      "id": "209366",
      "timestamp": "2019-02-18T11:54:40+00:00",
      "author": "nierewa",
      "content": "Hi,\n\nI found this [tutorial](https://www.rmprepusb.com/tutorials/145-grub2winiso \"External link\") to install windows directly from iso.\n\nOn my USB Drive I have:\n\nimages\n\n\\|-win10.iso\n\nwimboot \\* this folder with files download from tutorial site (grub2_wimboot.zip)\n\n\\|-ImgDisk\n\n\\|-startup.bat\n\n\\|-winpeshl.ini\n\n\\|-wimboot\n\nautounattend.xml \\*from Easy2Boot\n\nunatted.xml \\*from Easy2Boot\n\ngrldr\n\nmenu.lst\n\nmenu.lst:\n\n```\ntitle Install Windows10 using wimboot method\nmap /images/Win10.iso (0xff)\nmap --hook\nroot (0xff)\n# the root path now points to the files inside the ISO file\n# hd0,0 is the USB drive that we booted from\nkernel (hd0,0)/wimboot/wimboot\ninitrd @startup.bat\u003d(hd0,0)/wimboot/startup.bat @winpeshl.ini\u003d(hd0,0)/wimboot/winpeshl.ini @bcd\u003d/boot/bcd @boot.sdi\u003d/boot/boot.sdi @boot.wim\u003d/sources/boot.wim @Win10.iso.tag\u003d/boot/bcd\nmap (hd0) (hd1)\nmap (hd1) (hd0)\nmap --hook\nboot\n```\n\nstartup.bat:\n\n```\n@echo off\nTITLE %~dpnx0 (WIMBOOT startup.bat)\nwpeinit.exe\nREM prevent wpeinit from running again\nren X:\\windows\\system32\\wpeinit.exe wpeinit.exe.old\n\nfor %%I in (C D E F G H I J K L M N O P Q R S T U V W X Y Z) do if exist %%I:\\wimboot\\startup.bat set USBDRIVE\u003d%%I:\nIF \"%USBDRIVE%\"\u003d\u003d\"\" (\necho ERROR - COULD NOT FIND E2B DRIVE!\npause\ngoto :EOF\n)\n\ncd %USBDRIVE%\\\n%USBDRIVE%\ncolor 1f\n@echo off\ncls\nSET BIT\u003d32\nif \"%PROCESSOR_ARCHITECTURE%\"\u003d\u003d\"AMD64\" SET BIT\u003d64\n\necho LOADISO\nFOR /L %%A IN (0,1,5000) DO ECHO NOTHING \u003e nul\ncls\n@echo FOUND USB DRIVE AT DRIVE %USBDRIVE%\ncd /d %USBDRIVE%\\\n\n:: get path of the ISO into ISONAME\n:: SET \"MYISO\u003d\\images\\WIN10.iso\"\nfor /f %%a in ( \u0027dir /b X:\\Windows\\System32\\*.iso.tag\u0027 ) do set MYISO\u003d%%a\nset MYISO\u003d%MYISO:~,-4%\n\n:: find the ISO\nset UPATH\u003d\\%MYISO%\nif exist %USBDRIVE%%UPATH% set MYISO\u003d%UPATH%\necho Loading %USBDRIVE%%MYISO% \n\nREM Load ISO using ImDisk\nTITLE LOAD WINDOWS ISO USING IMDISK\ncall \\wimboot\\imdisk\\IMDISK_install.cmd\ncall \\wimboot\\imdisk\\IMDISK_instiso.cmd\n\nREM Find mounted DVD drive\nset DVDDRIVE\u003d\nFOR %%D IN (A B C D E F G H I J K L M N O P Q R S T U V W X Y Z) DO (\nDIR %%D:\\SOURCES\\install.*  \u003e nul 2\u003e\u00261 \u0026\u0026 (call set DVDDRIVE\u003d%%D:) \u0026\u0026 echo FOUND %%D:\\SOURCES\\install.*\n)\nFOR %%D IN (A B C D E F G H I J K L M N O P Q R S T U V W X Y Z) DO (\nDIR %%D:\\SOURCES\\x86\\install.*  \u003e nul 2\u003e\u00261 \u0026\u0026 (call set DVDDRIVE\u003d%%D:) \u0026\u0026 echo FOUND %%D:\\SOURCES\\x86\\install.*\n)\nFOR %%D IN (A B C D E F G H I J K L M N O P Q R S T U V W X Y Z) DO (\nDIR %%D:\\SOURCES\\x64\\install.*  \u003e nul 2\u003e\u00261 \u0026\u0026 (call set DVDDRIVE\u003d%%D:) \u0026\u0026 echo FOUND %%D:\\SOURCES\\x64\\install.*\n)\nFOR %%D IN (A B C D E F G H I J K L M N O P Q R S T U V W X Y Z) DO (\nDIR %%D:\\x86\\SOURCES\\install.*  \u003e nul 2\u003e\u00261 \u0026\u0026 (call set DVDDRIVE\u003d%%D:) \u0026\u0026 echo FOUND %%D:\\x86\\SOURCES\\install.*\n)\nFOR %%D IN (A B C D E F G H I J K L M N O P Q R S T U V W X Y Z) DO (\nDIR %%D:\\x64\\SOURCES\\install.*  \u003e nul 2\u003e\u00261 \u0026\u0026 (call set DVDDRIVE\u003d%%D:) \u0026\u0026 echo FOUND %%D:\\x64\\SOURCES\\install.*\n)\n\n:ENDSEARCH\nIF \"%DVDDRIVE%\"\u003d\u003d\"\" echo WARNING: VIRTUAL DRIVE DRIVE NOT FOUND!\nIF \"%DVDDRIVE%\"\u003d\u003d\"\" echo WARNING: install.* not found on any mounted volume.\nIF \"%DVDDRIVE%\"\u003d\u003d\"\" pause\necho.\nIF NOT \"%DVDDRIVE%\"\u003d\u003d\"\" echo ISO FILE MOUNTED AS %DVDDRIVE%\n\nREM startnet.cmd normally only contains wpeinit.exe, custom ISOs may contain other commands, so try to run them\nif exist X:\\WINDOWS\\SYSTEM32\\startnet.cmd call cmd /c  X:\\WINDOWS\\SYSTEM32\\startnet.cmd\nif not exist X:\\WINDOWS\\SYSTEM32\\startup.bat exit\nIF \"%DVDDRIVE%\"\u003d\u003d\"\" cmd\n\n%DVDDRIVE%\ncd \\\nset pp\u003d\\x86\nif /i \"%PROCESSOR_ARCHITECTURE%\"\u003d\u003d\"AMD64\" set pp\u003d\\x64\nif not exist %DVDDRIVE%%pp%\\setup.exe set pp\u003d\n\nMODE CON COLS\u003d30 LINES\u003d2\necho DO NOT CLOSE THIS WINDOW\nREM %DVDDRIVE%%pp%\\setup.exe /Unattend:%E2BDRIVE%\\AutoUnattend.xml\n%DVDDRIVE%%pp%\\setup.exe\n```\n\nTested with VirtualBox it seems to work but ended up with:\n\n```\nFOUND USB DRIVE AT DRIVE C:\nDatei nicht gefunden\nLoading C:~,-4\nImDisk driver installes successfully.\nMounting \"~,-4\" using ImDisk\nMounting ISO as Y:...\nCreating device...\nError creating virtual disk:\nDas System kann die angegebene Datei nicht finden.\nWARNING: VIRTUAL DRIVE DRIVE NOT FOUND!\nWARNING: install.* not found on any mounted volume.\nDrücken Sie eine beliebige Taste .  .  .\n\nC:\\\u003ewpeinit\nDer Befehl \"wpeinit\" ist entweder falsch geschrieben oder\nkonnte nicht gefunden werden.\nMicrosoft Windows [Version 10.0.17134.112]\nZur Verarbeitung dieses Befehls sind nicht genügend Speicherressourcen verfügbar.\n```\n\nSame if I test on \"real\" computer.\n\nCan somebody tell me what\u0027s wrong or managed someone to install from Windows ISO?\n\nThanks\n\n\u003cbr /\u003e\n\n"
    },
    {
      "id": "209367",
      "timestamp": "2019-02-18T12:07:04+00:00",
      "author": "steve6375",
      "content": "You have\n\n:: find the ISO  \nset UPATH\u003d\\\\%MYISO%\n\nso it is expecting the ISO to be in the root of the USB drive but you have placed it in \\\\images folder.\n\nCheck X:\\\\Windows\\\\system32\\\\Win10.iso.tag exists\n\nP.S. When you have a problem, use**echo on** (not @echo off) at top of file and place\n\n**pause**\n\nat various lines so you can see results ;-)\n\n**Edited by steve6375, 18 February 2019 - 12:18 PM.**\n"
    },
    {
      "id": "209368",
      "timestamp": "2019-02-18T12:33:29+00:00",
      "author": "nierewa",
      "content": "Hi,\n\nthanks for your reply.  \nI changed to:\n\n```\n:: get path of the ISO into ISONAME\n:: SET \"MYISO\u003d\\images\\WIN10.iso\"\n\nset MYISO\u003d\\images\\WIN10.iso:~,-4%\n\n:: find the ISO\nset UPATH\u003d\\images\\WIN10.iso\nif exist %USBDRIVE%%UPATH% set MYISO\u003d%UPATH%\necho Loading %USBDRIVE%%MYISO% \n```\n\nThat works. Installer startet succesfully.\n\nNo I wait for \"Aktion wird abgeschlossen\"\n\n![install_waiting.png](http://nierewa.bplaced.net/images/install_waiting.png)\n\nI\u0027m hopefully waiting.....\n\n**Edited by nierewa, 18 February 2019 - 12:45 PM.**\n"
    },
    {
      "id": "209370",
      "timestamp": "2019-02-18T20:15:20+00:00",
      "author": "steve6375",
      "content": "well, you have hard-coded the name of the ISO.\n\nTo make it work with a variety of ISOs you should use the original code in the article\n\nand just change the set UPATH line to\n\nset UPATH\u003d\\\\IMAGES\\\\%MYISO%\n\nI have updated the RMPrepUSB article slightly with newer code\n\nThe line\n\nset MYISO\u003d%MYISO:\\~,-4%\n\nshould convert MYISO which should be Win10.iso.tag to Win10.iso (it deletes the last 4 characters)\n\n"
    },
    {
      "id": "209378",
      "timestamp": "2019-02-19T08:43:39+00:00",
      "author": "nierewa",
      "content": "Hi, here\u0027s an update.\n\nTwo errors accurd by testing on \"real\" Notebook:\n\n1. There\u0027s an error in the autounattend.xml\n\nI fixed it in this way\n\n```\n\u003c?xml version\u003d\"1.0\" encoding\u003d\"utf-8\" ?\u003e\n\u003cunattend xmlns\u003d\"urn:schemas-microsoft-com:unattend\"\u003e\n\n\u003csettings pass\u003d\"windowsPE\"\u003e\n\n\u003ccomponent name\u003d\"Microsoft-Windows-Setup\" processorArchitecture\u003d\"amd64\" publicKeyToken\u003d\"31bf3856ad364e35\" language\u003d\"neutral\" versionScope\u003d\"nonSxS\" xmlns:wcm\u003d\"http://schemas.microsoft.com/WMIConfig/2002/State\" xmlns:xsi\u003d\"http://www.w3.org/2001/XMLSchema-instance\"\u003e\n\u003cRunSynchronous\u003e\n\u003cRunSynchronousCommand wcm:action\u003d\"add\"\u003e\n\u003cOrder\u003e1\u003c/Order\u003e\n\u003cPath\u003ecmd /q /c \"FOR %i IN (C D E F G H I J K L N M O P Q R S T U V W X Y Z) DO IF EXIST %i:\\multiboot\\Windows10Home32_64Aniversary\\remount.cmd cmd /k %i:\\multiboot\\Windows10Home32_64Aniversary\\remount.cmd\"\u003c/Path\u003e\n\u003cDescription\u003eLaunch Remount\u003c/Description\u003e\n\u003c/RunSynchronousCommand\u003e\n\u003c/RunSynchronous\u003e\n\u003cUserData\u003e\n\u003cAcceptEula\u003etrue\u003c/AcceptEula\u003e\n\u003cProductKey\u003e\n\u003cKey\u003e\u003c/Key\u003e\n\u003c/ProductKey\u003e\n\u003c/UserData\u003e\n\u003c/component\u003e\n\u003ccomponent name\u003d\"Microsoft-Windows-Setup\" processorArchitecture\u003d\"x86\" publicKeyToken\u003d\"31bf3856ad364e35\" language\u003d\"neutral\" versionScope\u003d\"nonSxS\" xmlns:wcm\u003d\"http://schemas.microsoft.com/WMIConfig/2002/State\" xmlns:xsi\u003d\"http://www.w3.org/2001/XMLSchema-instance\"\u003e\n\u003cRunSynchronous\u003e\n\u003cRunSynchronousCommand wcm:action\u003d\"add\"\u003e\n\u003cOrder\u003e1\u003c/Order\u003e\n\u003cPath\u003ecmd /q /c \"FOR %i IN (C D E F G H I J K L N M O P Q R S T U V W X Y Z) DO IF EXIST %i:\\multiboot\\Windows10Home32_64Aniversary\\remount.cmd cmd /k %i:\\multiboot\\Windows10Home32_64Aniversary\\remount.cmd\"\u003c/Path\u003e\n\u003cDescription\u003eLaunch Remount\u003c/Description\u003e\n\u003c/RunSynchronousCommand\u003e\n\u003c/RunSynchronous\u003e\n\u003cUserData\u003e\n\u003cAcceptEula\u003etrue\u003c/AcceptEula\u003e\n\u003cProductKey\u003e\n\u003cKey\u003e\u003c/Key\u003e\n\u003c/ProductKey\u003e\n\u003c/UserData\u003e\n\u003c/component\u003e\n\u003c/settings\u003e\n\u003c/unattend\u003e\n```\n\n2. No Touchpad during installation and after\n\n3. I\u0027ve made an iso with media creation tool for both architektures (7GB). During boot I\u0027ve get an error \"file not found\"  \nWith an 3GB iso it works.\n\n"
    },
    {
      "id": "209379",
      "timestamp": "2019-02-19T08:50:53+00:00",
      "author": "steve6375",
      "content": "1. What was the problem? Why is remount.cmd required?\n\n2. It will depend on integrated Windows drivers\n\n3. If dual architecture, then you need to ask which boot.wim to boot from x86 or x64 version. E2B does this, it uses grub4dos code...\n\n```\n#check if dual architecture\nset pp\u003d/x64\nset DUAL\u003d\nif exist (0xff)/x86/sources/boot.wim if exist (0xff)/x64/sources/boot.wim set DUAL\u003d1 || set pp\u003d\nif exist DUAL echo -e \\n\\nDUAL ARCHITECTURE ISO (x86 + x64):\ncheckrange 0,1 is64bit \u0026\u0026 if exist DUAL set pp\u003d/x86\ncheckrange 2,3 is64bit \u0026\u0026 if exist DUAL set pp\u003dY \u0026\u0026 if exist DUAL set /p pp\u003dx64 ([Y]/N)? :\necho\nif exist DUAL if /i \"%pp%\"\u003d\u003d\"Y\" set pp\u003d/x64 || set pp\u003d/x86\nif not exist DUAL set pp\u003d\nif not exist (0xff)%pp%/sources/boot.wim set pp\u003d \u0026\u0026 echo ERROR: %pp%/sources/boot.wim not found!\nif not exist (0xff)%pp%/boot/bcd set pp\u003d \u0026\u0026 echo ERROR: %pp%/boot/bcd not found!\nif not exist (0xff)%pp%/boot/boot.sdi set pp\u003d \u0026\u0026 echo ERROR: %pp%/boot/boot.sdi not found!\nroot (0xff) \u003e nul\nkernel (hd0,0)/_ISO/e2b/grub/wimboot \ninitrd @startupe2b.bat\u003d%E2B%/_ISO/e2b/grub/startupe2b.bat @winpeshl.ini\u003d%E2B%/_ISO/e2b/grub/winpeshl.ini @bcd\u003d%pp%/boot/bcd @boot.sdi\u003d%pp%/boot/boot.sdi @boot.wim\u003d%pp%/sources/boot.wim\n```\n\n\u003cbr /\u003e\n\n"
    },
    {
      "id": "209390",
      "timestamp": "2019-02-19T18:47:58+00:00",
      "author": "nierewa",
      "content": "I have changed something until now.\n\nIn Folder /images I have two ISO-files.  \nWin10_1809_x86 and Win10_1809_x64.\n\nThe menu.lst looks so:\n\n```\ntitle Install Windows10x64 1809 using wimboot method\nmap /images/Win10_1809_x64.iso (0xff)\nmap --hook\nroot (0xff)\n# the root path now points to the files inside the ISO file\n# hd0,0 is the USB drive that we booted from\nkernel (hd0,0)/wimboot\ninitrd @startup.bat\u003d(hd0,0)/startup.bat @winpeshl.ini\u003d(hd0,0)/winpeshl.ini @bcd\u003d/boot/bcd @boot.sdi\u003d/boot/boot.sdi @boot.wim\u003d/sources/boot.wim @/images/Win10_1809_x64.iso.tag\u003d/boot/bcd\nmap (hd0) (hd1)\nmap (hd1) (hd0)\nmap --hook\nboot\n\ntitle Install Windows10x86 1809 using wimboot method\nmap /images/Win10_1809_x86.iso (0xff)\nmap --hook\nroot (0xff)\n# the root path now points to the files inside the ISO file\n# hd0,0 is the USB drive that we booted from\nkernel (hd0,0)/wimboot\ninitrd @startup.bat\u003d(hd0,0)/startup.bat @winpeshl.ini\u003d(hd0,0)/winpeshl.ini @bcd\u003d/boot/bcd @boot.sdi\u003d/boot/boot.sdi @boot.wim\u003d/sources/boot.wim @/images/Win10_1809_x86.iso.tag\u003d/boot/bcd\nmap (hd0) (hd1)\nmap (hd1) (hd0)\nmap --hook\nboot\n```\n\nChange the the startup.bat for steve6375 advice to:\n\n```\n@echo off\nTITLE %~dpnx0 (WIMBOOT startup.bat)\nwpeinit.exe\nREM prevent wpeinit from running again\nren X:\\windows\\system32\\wpeinit.exe wpeinit.exe.old\n\nfor %%I in (C D E F G H I J K L M N O P Q R S T U V W X Y Z) do if exist %%I:\\wimboot\\startup.bat set USBDRIVE\u003d%%I:\nIF \"%USBDRIVE%\"\u003d\u003d\"\" (\necho ERROR - COULD NOT FIND E2B DRIVE!\npause\ngoto :EOF\n)\n\ncd %USBDRIVE%\\\n%USBDRIVE%\ncolor 1f\n@echo off\ncls\nSET BIT\u003d32\nif \"%PROCESSOR_ARCHITECTURE%\"\u003d\u003d\"AMD64\" SET BIT\u003d64\n\necho LOADISO\nFOR /L %%A IN (0,1,5000) DO ECHO NOTHING \u003e nul\ncls\n@echo FOUND USB DRIVE AT DRIVE %USBDRIVE%\ncd /d %USBDRIVE%\\\n\n:: get path of the ISO into ISONAME\n:: SET \"MYISO\u003d\\_ISO\\MAINMENU\\WINDOWS\\Windows10Prox64.iso\"\nfor /f %%a in ( \u0027dir /b X:\\Windows\\System32\\*.iso.tag\u0027 ) do set MYISO\u003d%%a\nset MYISO\u003d%MYISO:~,-4%\n\n:: find the ISO in \\_ISO\\MAINMENU\\WINDOWS\nset UPATH\u003d\\images\\%MYISO%\nif exist %USBDRIVE%%UPATH% set MYISO\u003d%UPATH%\necho Loading %USBDRIVE%%MYISO%\n\nREM Load ISO using ImDisk\nTITLE LOAD WINDOWS ISO USING IMDISK\ncall \\wimboot\\imdisk\\IMDISK_install.cmd\ncall \\wimboot\\imdisk\\IMDISK_instiso.cmd\n\nREM Find mounted DVD drive\nset DVDDRIVE\u003d\nFOR %%D IN (A B C D E F G H I J K L M N O P Q R S T U V W X Y Z) DO (\nDIR %%D:\\SOURCES\\install.* \u003e nul 2\u003e\u00261 \u0026\u0026 (call set DVDDRIVE\u003d%%D:) \u0026\u0026 echo FOUND %%D:\\SOURCES\\install.*\n)\nFOR %%D IN (A B C D E F G H I J K L M N O P Q R S T U V W X Y Z) DO (\nDIR %%D:\\SOURCES\\x86\\install.* \u003e nul 2\u003e\u00261 \u0026\u0026 (call set DVDDRIVE\u003d%%D:) \u0026\u0026 echo FOUND %%D:\\SOURCES\\x86\\install.*\n)\nFOR %%D IN (A B C D E F G H I J K L M N O P Q R S T U V W X Y Z) DO (\nDIR %%D:\\SOURCES\\x64\\install.* \u003e nul 2\u003e\u00261 \u0026\u0026 (call set DVDDRIVE\u003d%%D:) \u0026\u0026 echo FOUND %%D:\\SOURCES\\x64\\install.*\n)\nFOR %%D IN (A B C D E F G H I J K L M N O P Q R S T U V W X Y Z) DO (\nDIR %%D:\\x86\\SOURCES\\install.* \u003e nul 2\u003e\u00261 \u0026\u0026 (call set DVDDRIVE\u003d%%D:) \u0026\u0026 echo FOUND %%D:\\x86\\SOURCES\\install.*\n)\nFOR %%D IN (A B C D E F G H I J K L M N O P Q R S T U V W X Y Z) DO (\nDIR %%D:\\x64\\SOURCES\\install.* \u003e nul 2\u003e\u00261 \u0026\u0026 (call set DVDDRIVE\u003d%%D:) \u0026\u0026 echo FOUND %%D:\\x64\\SOURCES\\install.*\n)\n\n:ENDSEARCH\nIF \"%DVDDRIVE%\"\u003d\u003d\"\" echo WARNING: VIRTUAL DRIVE DRIVE NOT FOUND!\nIF \"%DVDDRIVE%\"\u003d\u003d\"\" echo WARNING: install.* not found on any mounted volume.\nIF \"%DVDDRIVE%\"\u003d\u003d\"\" pause\necho.\nIF NOT \"%DVDDRIVE%\"\u003d\u003d\"\" echo ISO FILE MOUNTED AS %DVDDRIVE%\n\nREM startnet.cmd normally only contains wpeinit.exe, custom ISOs may contain other commands, so try to run them\nif exist X:\\WINDOWS\\SYSTEM32\\startnet.cmd call cmd /c X:\\WINDOWS\\SYSTEM32\\startnet.cmd\nif not exist X:\\WINDOWS\\SYSTEM32\\startup.bat exit\nIF \"%DVDDRIVE%\"\u003d\u003d\"\" cmd\n\n%DVDDRIVE%\ncd \\\nset pp\u003d\\x86\nif /i \"%PROCESSOR_ARCHITECTURE%\"\u003d\u003d\"AMD64\" set pp\u003d\\x64\nif not exist %DVDDRIVE%%pp%\\setup.exe set pp\u003d\n\nMODE CON COLS\u003d30 LINES\u003d2\necho DO NOT CLOSE THIS WINDOW\nREM %DVDDRIVE%%pp%\\setup.exe /Unattend:%E2BDRIVE%\\AutoUnattend.xml\n%DVDDRIVE%%pp%\\setup.exe\n```\n\nEnds up with\n\nError creating virtual disk:  \nDas System kann die angegebene Datei nicht finden.\n\n\u003e so it is expecting the ISO to be in the root of the USB drive but you have placed it in \\\\images folder.\n\u003e\n\u003e Check X:\\\\Windows\\\\system32\\\\Win10.iso.tag exists\n\nThere\u0027s no \\*.iso.tag file in this path.  \nI don\u0027t see the mistake I\u0027ve done ![:(](http://reboot.pro/public/style_emoticons/default/sad.png)\n\n"
    },
    {
      "id": "209391",
      "timestamp": "2019-02-19T18:54:07+00:00",
      "author": "steve6375",
      "content": "\u003e @/images/Win10_1809_x64.iso.tag\u003d/boot/bcd\n\u003e\n@ symbol defines the **filename** of the file that will be created in the X:\\\\WIndows\\\\System32 folder -\n\nIt should be\n\n```\n@Win10_1809_x64.iso.tag\u003d/boot/bcd\n```\n\nMaximum length of the filename after @ can be up to 31 characters\n\n"
    },
    {
      "id": "209392",
      "timestamp": "2019-02-19T19:03:47+00:00",
      "author": "nierewa",
      "content": "I\u0027ve changed it, but didn\u0027t work.  \nNo iso found, nothing in X:\\\\Windows\\\\system32\\\\\n\n"
    },
    {
      "id": "209393",
      "timestamp": "2019-02-19T19:10:11+00:00",
      "author": "steve6375",
      "content": "Try using\n\nkernel (hd0,0)/wimboot pause\n\nand check that wimboot is adding the files correctly\n\n[https://ipxe.org/wimboot](https://ipxe.org/wimboot \"External link\")\n\nP.S. you can always add lines to the bat file, e.g.\n\ndir X:\\\\Windows\\\\System32\\\\\\*.tag\n\npause\n\n"
    },
    {
      "id": "209394",
      "timestamp": "2019-02-19T19:37:45+00:00",
      "author": "nierewa",
      "content": "wimboot pause say:\n\n```\n...\n\nusing bootmgr.exe via 0x434a0 len 0xa2338\n... extracted bootmgr.exe\nusing win10_1809_x64.iso.tag via 0xd9597088 len 0x4000\nemulating drive 0x83\nentering bootmgr.exe with parameters at 0x2c4e0\n```\n\ndir X:\\\\Windows\\\\System32\\\\\\*.tag\n\npause ------\\\u003e Datei nicht gefunden\n\n"
    },
    {
      "id": "209395",
      "timestamp": "2019-02-19T19:41:56+00:00",
      "author": "steve6375",
      "content": "wimboot is 2017-05-2017?\n\n"
    },
    {
      "id": "209396",
      "timestamp": "2019-02-19T19:51:08+00:00",
      "author": "nierewa",
      "content": "The wimboot is from the grub2_wimboot I\u0027ve downloaded from the tutorial site.  \n2017-05-18\n\n"
    },
    {
      "id": "209397",
      "timestamp": "2019-02-19T20:04:25+00:00",
      "author": "steve6375",
      "content": "Try changing the order of the initrd line\n\nI tested your line and got the same problem\n\nThen I moved the .iso.tag file to the start of initrd and it worked OK!\n\nMaybe the boot.wim needs to be last ?\n\ninitrd @Win10_1809_x86.iso.tag\u003d/boot/bcd @startup.bat\u003d(hd0,0)/startup.bat @winpeshl.ini\u003d(hd0,0)/winpeshl.ini @bcd\u003d/boot/bcd @boot.sdi\u003d/boot/boot.sdi @boot.wim\u003d/sources/boot.wim\n\n"
    },
    {
      "id": "209400",
      "timestamp": "2019-02-19T21:31:21+00:00",
      "author": "nierewa",
      "content": "Man this is it.\n\nIt works.\n\nTime to test ![:D](http://reboot.pro/public/style_emoticons/default/biggrin.png)\n\n"
    },
    {
      "id": "209402",
      "timestamp": "2019-02-19T22:30:52+00:00",
      "author": "steve6375",
      "content": "I made a few tests,\n\nIt looks like the last files must be boot.wim and bcd\n\n```\n#FAILS initrd @boot.sdi\u003d/boot/boot.sdi @startup.bat\u003d(hd0,0)/startup.bat @winpeshl.ini\u003d(hd0,0)/winpeshl.ini  @boot.wim\u003d/sources/boot.wim  @bcd\u003d/boot/bcd @Win10x64UK_Oct_2018.iso.tag\u003d/boot/bcd\n#FAILS initrd @startup.bat\u003d(hd0,0)/startup.bat @winpeshl.ini\u003d(hd0,0)/winpeshl.ini  @boot.wim\u003d/sources/boot.wim  @bcd\u003d/boot/bcd @Win10x64UK_Oct_2018.iso.tag\u003d/boot/bcd @boot.sdi\u003d/boot/boot.sdi\n#FAILS initrd @winpeshl.ini\u003d(hd0,0)/winpeshl.ini  @boot.wim\u003d/sources/boot.wim  @bcd\u003d/boot/bcd @Win10x64UK_Oct_2018.iso.tag\u003d/boot/bcd @boot.sdi\u003d/boot/boot.sdi @startup.bat\u003d(hd0,0)/startup.bat\n#FAILS initrd @winpeshl.ini\u003d(hd0,0)/winpeshl.ini  @boot.wim\u003d/sources/boot.wim  @bcd\u003d/boot/bcd @Win10x64UK_Oct_2018.iso.tag\u003d/boot/bcd  @startup.bat\u003d(hd0,0)/startup.bat @boot.sdi\u003d/boot/boot.sdi\n#FAILS initrd @Win10x64UK_Oct_2018.iso.tag\u003d/boot/bcd  @startup.bat\u003d(hd0,0)/startup.bat @boot.sdi\u003d/boot/boot.sdi @boot.wim\u003d/sources/boot.wim @bcd\u003d/boot/bcd @winpeshl.ini\u003d(hd0,0)/winpeshl.ini\n#FAILS initrd @Win10x64UK_Oct_2018.iso.tag\u003d/boot/bcd @boot.sdi\u003d/boot/boot.sdi @boot.wim\u003d/sources/boot.wim @bcd\u003d/boot/bcd @winpeshl.ini\u003d(hd0,0)/winpeshl.ini  @startup.bat\u003d(hd0,0)/startup.bat\n#FAILS initrd @Win10x64UK_Oct_2018.iso.tag\u003d/boot/bcd @boot.sdi\u003d/boot/boot.sdi @boot.wim\u003d/sources/boot.wim @winpeshl.ini\u003d(hd0,0)/winpeshl.ini  @startup.bat\u003d(hd0,0)/startup.bat  @bcd\u003d/boot/bcd\n#FAILS initrd @boot.sdi\u003d/boot/boot.sdi @winpeshl.ini\u003d(hd0,0)/winpeshl.ini   @bcd\u003d/boot/bcd @Win10x64UK_Oct_2018.iso.tag\u003d/boot/bcd  @boot.wim\u003d/sources/boot.wim  @startup.bat\u003d(hd0,0)/startup.bat\n#FAILS initrd @boot.sdi\u003d/boot/boot.sdi @startup.bat\u003d(hd0,0)/startup.bat @winpeshl.ini\u003d(hd0,0)/winpeshl.ini @bcd\u003d/boot/bcd  @boot.wim\u003d/sources/boot.wim @Win10x64UK_Oct_2018.iso.tag\u003d/boot/bcd\n\n#WORKS initrd @Win10x64UK_Oct_2018.iso.tag\u003d/boot/bcd @bcd\u003d/boot/bcd @boot.sdi\u003d/boot/boot.sdi @startup.bat\u003d(hd0,0)/startup.bat @winpeshl.ini\u003d(hd0,0)/winpeshl.ini  @boot.wim\u003d/sources/boot.wim\n#WORKS initrd @Win10x64UK_Oct_2018.iso.tag\u003d/boot/bcd @boot.sdi\u003d/boot/boot.sdi @startup.bat\u003d(hd0,0)/startup.bat @winpeshl.ini\u003d(hd0,0)/winpeshl.ini  @boot.wim\u003d/sources/boot.wim  @bcd\u003d/boot/bcd\n#WORKS initrd @winpeshl.ini\u003d(hd0,0)/winpeshl.ini @bcd\u003d/boot/bcd @Win10x64UK_Oct_2018.iso.tag\u003d/boot/bcd  @startup.bat\u003d(hd0,0)/startup.bat @boot.sdi\u003d/boot/boot.sdi @boot.wim\u003d/sources/boot.wim\n#WORKS initrd @winpeshl.ini\u003d(hd0,0)/winpeshl.ini @Win10x64UK_Oct_2018.iso.tag\u003d/boot/bcd  @startup.bat\u003d(hd0,0)/startup.bat @boot.sdi\u003d/boot/boot.sdi @boot.wim\u003d/sources/boot.wim @bcd\u003d/boot/bcd\n#WORKS initrd @Win10x64UK_Oct_2018.iso.tag\u003d/boot/bcd @boot.sdi\u003d/boot/boot.sdi @bcd\u003d/boot/bcd @winpeshl.ini\u003d(hd0,0)/winpeshl.ini @startup.bat\u003d(hd0,0)/startup.bat @boot.wim\u003d/sources/boot.wim\n#WORKS initrd @Win10x64UK_Oct_2018.iso.tag\u003d/boot/bcd @boot.sdi\u003d/boot/boot.sdi @winpeshl.ini\u003d(hd0,0)/winpeshl.ini  @startup.bat\u003d(hd0,0)/startup.bat  @bcd\u003d/boot/bcd @boot.wim\u003d/sources/boot.wim\n#WORKS initrd @boot.sdi\u003d/boot/boot.sdi @winpeshl.ini\u003d(hd0,0)/winpeshl.ini @startup.bat\u003d(hd0,0)/startup.bat  @bcd\u003d/boot/bcd @Win10x64UK_Oct_2018.iso.tag\u003d/boot/bcd @boot.wim\u003d/sources/boot.wim\n#WORKS initrd @boot.sdi\u003d/boot/boot.sdi @winpeshl.ini\u003d(hd0,0)/winpeshl.ini @bcd\u003d/boot/bcd @Win10x64UK_Oct_2018.iso.tag\u003d/boot/bcd  @startup.bat\u003d(hd0,0)/startup.bat @boot.wim\u003d/sources/boot.wim\n#WORKS initrd @startup.bat\u003d(hd0,0)/startup.bat @winpeshl.ini\u003d(hd0,0)/winpeshl.ini @bcd\u003d/boot/bcd @Win10x64UK_Oct_2018.iso.tag\u003d/boot/bcd @boot.sdi\u003d/boot/boot.sdi @boot.wim\u003d/sources/boot.wim\n#WORKS initrd @bcd\u003d/boot/bcd @Win10x64UK_Oct_2018.iso.tag\u003d/boot/bcd @boot.sdi\u003d/boot/boot.sdi @startup.bat\u003d(hd0,0)/startup.bat @winpeshl.ini\u003d(hd0,0)/winpeshl.ini  @boot.wim\u003d/sources/boot.wim\n#WORKS initrd @boot.sdi\u003d/boot/boot.sdi @startup.bat\u003d(hd0,0)/startup.bat @winpeshl.ini\u003d(hd0,0)/winpeshl.ini @bcd\u003d/boot/bcd @Win10x64UK_Oct_2018.iso.tag\u003d/boot/bcd  @boot.wim\u003d/sources/boot.wim\n```\n\n\u003cbr /\u003e\n\n"
    },
    {
      "id": "209474",
      "timestamp": "2019-02-24T09:54:12+00:00",
      "author": "nierewa",
      "content": "\u003e It looks like the last files must be boot.wim and bcd\n\nHow did you figure it out. How get you this idea?\n\nIT WORKS ![:D](http://reboot.pro/public/style_emoticons/default/biggrin.png)  \nOnly some USB ports (USB 3 and USB2) ends up with \"ERROR - COULD NOT FIND E2B DRIVE!\"  \nOther ports on same PC works.  \n\nI found an unattend.xml on a mainboards support dvd:\n\n```\n\u003c?xml version\u003d\"1.0\" encoding\u003d\"utf-8\"?\u003e\n\u003cunattend xmlns\u003d\"urn:schemas-microsoft-com:unattend\"\u003e\n  \u003csettings pass\u003d\"windowsPE\"\u003e\n    \u003ccomponent name\u003d\"Microsoft-Windows-PnpCustomizationsWinPE\" processorArchitecture\u003d\"x86\" publicKeyToken\u003d\"31bf3856ad364e35\" language\u003d\"neutral\" versionScope\u003d\"nonSxS\" xmlns:wcm\u003d\"http://schemas.microsoft.com/WMIConfig/2002/State\" xmlns:xsi\u003d\"http://www.w3.org/2001/XMLSchema-instance\"\u003e\n      \u003cDriverPaths\u003e\n        \u003cPathAndCredentials wcm:action\u003d\"add\" wcm:keyValue\u003d\"u3311b21\"\u003e\n          \u003cPath\u003e%configsetroot%\\Win7\\usb3\\Asmedia\u003c/Path\u003e\n        \u003c/PathAndCredentials\u003e\n        \u003cPathAndCredentials wcm:action\u003d\"add\" wcm:keyValue\u003d\"u3318086\"\u003e\n          \u003cPath\u003e%configsetroot%\\Win7\\usb3\\Intel\\x86\u003c/Path\u003e\n        \u003c/PathAndCredentials\u003e\n        \u003cPathAndCredentials wcm:action\u003d\"add\" wcm:keyValue\u003d\"u3301022\"\u003e\n          \u003cPath\u003e%configsetroot%\\Win7\\usb3\\AMD\\USB30\\x86\u003c/Path\u003e\n        \u003c/PathAndCredentials\u003e\n        \u003cPathAndCredentials wcm:action\u003d\"add\" wcm:keyValue\u003d\"u3311022\"\u003e\n          \u003cPath\u003e%configsetroot%\\Win7\\usb3\\AMD\\USB31\\x86\u003c/Path\u003e\n        \u003c/PathAndCredentials\u003e\n      \u003c/DriverPaths\u003e\n\u003cUserData\u003e\n\u003cAcceptEula\u003etrue\u003c/AcceptEula\u003e\n\u003cProductKey\u003e\n\u003cKey\u003e\u003c/Key\u003e\n\u003c/ProductKey\u003e\n\u003c/UserData\u003e\n    \u003c/component\u003e\n    \u003ccomponent name\u003d\"Microsoft-Windows-PnpCustomizationsWinPE\" processorArchitecture\u003d\"amd64\" publicKeyToken\u003d\"31bf3856ad364e35\" language\u003d\"neutral\" versionScope\u003d\"nonSxS\" xmlns:wcm\u003d\"http://schemas.microsoft.com/WMIConfig/2002/State\" xmlns:xsi\u003d\"http://www.w3.org/2001/XMLSchema-instance\"\u003e\n      \u003cDriverPaths\u003e\n        \u003cPathAndCredentials wcm:action\u003d\"add\" wcm:keyValue\u003d\"u3311b21\"\u003e\n          \u003cPath\u003e%configsetroot%\\Win7\\usb3\\Asmedia\u003c/Path\u003e\n        \u003c/PathAndCredentials\u003e\n        \u003cPathAndCredentials wcm:action\u003d\"add\" wcm:keyValue\u003d\"u3318086\"\u003e\n          \u003cPath\u003e%configsetroot%\\Win7\\usb3\\Intel\\x64\u003c/Path\u003e\n        \u003c/PathAndCredentials\u003e\n        \u003cPathAndCredentials wcm:action\u003d\"add\" wcm:keyValue\u003d\"u3301022\"\u003e\n          \u003cPath\u003e%configsetroot%\\Win7\\usb3\\AMD\\USB30\\x64\u003c/Path\u003e\n        \u003c/PathAndCredentials\u003e\n        \u003cPathAndCredentials wcm:action\u003d\"add\" wcm:keyValue\u003d\"u3311022\"\u003e\n          \u003cPath\u003e%configsetroot%\\Win7\\usb3\\AMD\\USB31\\x64\u003c/Path\u003e\n        \u003c/PathAndCredentials\u003e\n      \u003c/DriverPaths\u003e\n    \u003c/component\u003e\n    \u003ccomponent name\u003d\"Microsoft-Windows-Setup\" processorArchitecture\u003d\"amd64\" publicKeyToken\u003d\"31bf3856ad364e35\" language\u003d\"neutral\" versionScope\u003d\"nonSxS\" xmlns:wcm\u003d\"http://schemas.microsoft.com/WMIConfig/2002/State\" xmlns:xsi\u003d\"http://www.w3.org/2001/XMLSchema-instance\"\u003e\n      \u003cUseConfigurationSet\u003etrue\u003c/UseConfigurationSet\u003e\n\u003cUserData\u003e\n\u003cAcceptEula\u003etrue\u003c/AcceptEula\u003e\n\u003cProductKey\u003e\n\u003cKey\u003e\u003c/Key\u003e\n\u003c/ProductKey\u003e\n\u003c/UserData\u003e\n    \u003c/component\u003e\n    \u003ccomponent name\u003d\"Microsoft-Windows-Setup\" processorArchitecture\u003d\"x86\" publicKeyToken\u003d\"31bf3856ad364e35\" language\u003d\"neutral\" versionScope\u003d\"nonSxS\" xmlns:wcm\u003d\"http://schemas.microsoft.com/WMIConfig/2002/State\" xmlns:xsi\u003d\"http://www.w3.org/2001/XMLSchema-instance\"\u003e\n      \u003cUseConfigurationSet\u003etrue\u003c/UseConfigurationSet\u003e\n    \u003c/component\u003e\n  \u003c/settings\u003e\n  \u003csettings pass\u003d\"offlineServicing\"\u003e\n    \u003ccomponent name\u003d\"Microsoft-Windows-PnpCustomizationsNonWinPE\" processorArchitecture\u003d\"x86\" publicKeyToken\u003d\"31bf3856ad364e35\" language\u003d\"neutral\" versionScope\u003d\"nonSxS\" xmlns:wcm\u003d\"http://schemas.microsoft.com/WMIConfig/2002/State\" xmlns:xsi\u003d\"http://www.w3.org/2001/XMLSchema-instance\"\u003e\n      \u003cDriverPaths\u003e\n        \u003cPathAndCredentials wcm:action\u003d\"add\" wcm:keyValue\u003d\"u3311b21\"\u003e\n          \u003cPath\u003e%configsetroot%\\Win7\\usb3\\Asmedia\u003c/Path\u003e\n        \u003c/PathAndCredentials\u003e\n        \u003cPathAndCredentials wcm:action\u003d\"add\" wcm:keyValue\u003d\"u3318086\"\u003e\n          \u003cPath\u003e%configsetroot%\\Win7\\usb3\\Intel\\x86\u003c/Path\u003e\n        \u003c/PathAndCredentials\u003e\n        \u003cPathAndCredentials wcm:action\u003d\"add\" wcm:keyValue\u003d\"u3301022\"\u003e\n          \u003cPath\u003e%configsetroot%\\Win7\\usb3\\AMD\\USB30\\x86\u003c/Path\u003e\n        \u003c/PathAndCredentials\u003e\n        \u003cPathAndCredentials wcm:action\u003d\"add\" wcm:keyValue\u003d\"u3311022\"\u003e\n          \u003cPath\u003e%configsetroot%\\Win7\\usb3\\AMD\\USB31\\x86\u003c/Path\u003e\n        \u003c/PathAndCredentials\u003e\n      \u003c/DriverPaths\u003e\n\u003cUserData\u003e\n\u003cAcceptEula\u003etrue\u003c/AcceptEula\u003e\n\u003cProductKey\u003e\n\u003cKey\u003e\u003c/Key\u003e\n\u003c/ProductKey\u003e\n\u003c/UserData\u003e\n    \u003c/component\u003e\n    \u003ccomponent name\u003d\"Microsoft-Windows-PnpCustomizationsNonWinPE\" processorArchitecture\u003d\"amd64\" publicKeyToken\u003d\"31bf3856ad364e35\" language\u003d\"neutral\" versionScope\u003d\"nonSxS\" xmlns:wcm\u003d\"http://schemas.microsoft.com/WMIConfig/2002/State\" xmlns:xsi\u003d\"http://www.w3.org/2001/XMLSchema-instance\"\u003e\n      \u003cDriverPaths\u003e\n        \u003cPathAndCredentials wcm:action\u003d\"add\" wcm:keyValue\u003d\"u3311b21\"\u003e\n          \u003cPath\u003e%configsetroot%\\Win7\\usb3\\Asmedia\u003c/Path\u003e\n        \u003c/PathAndCredentials\u003e\n        \u003cPathAndCredentials wcm:action\u003d\"add\" wcm:keyValue\u003d\"u3318086\"\u003e\n          \u003cPath\u003e%configsetroot%\\Win7\\usb3\\Intel\\x64\u003c/Path\u003e\n        \u003c/PathAndCredentials\u003e\n        \u003cPathAndCredentials wcm:action\u003d\"add\" wcm:keyValue\u003d\"u3301022\"\u003e\n          \u003cPath\u003e%configsetroot%\\Win7\\usb3\\AMD\\USB30\\x64\u003c/Path\u003e\n        \u003c/PathAndCredentials\u003e\n        \u003cPathAndCredentials wcm:action\u003d\"add\" wcm:keyValue\u003d\"u3311022\"\u003e\n          \u003cPath\u003e%configsetroot%\\Win7\\usb3\\AMD\\USB31\\x64\u003c/Path\u003e\n        \u003c/PathAndCredentials\u003e\n      \u003c/DriverPaths\u003e\n\u003cUserData\u003e\n\u003cAcceptEula\u003etrue\u003c/AcceptEula\u003e\n\u003cProductKey\u003e\n\u003cKey\u003e\u003c/Key\u003e\n\u003c/ProductKey\u003e\n\u003c/UserData\u003e\n    \u003c/component\u003e\n  \u003c/settings\u003e\n  \u003ccpi:offlineImage cpi:source\u003d\"wim:c:/windows7_wim/install.wim#Windows 7 HOMEPREMIUM\" xmlns:cpi\u003d\"urn:schemas-microsoft-com:cpi\" /\u003e\n\u003c/unattend\u003e\n\n```\n\nIt\u0027s installed USB driver, right?  \nCan this work? Where is %configroot%?\n\nThe root of the USB stick? (I\u0027ve copied drivers there)\n\n**Edited by nierewa, 24 February 2019 - 09:56 AM.**\n"
    },
    {
      "id": "209475",
      "timestamp": "2019-02-24T10:00:07+00:00",
      "author": "steve6375",
      "content": "\u003e It looks like the last files must be boot.wim and bcd\n\u003e\n\u003e How did you figure it out. How get you this idea?\n\u003e\nBecause my grub4dos menu worked and yours did not - the only difference I could see was that the order of the files was different.\n\nre. %configsetroot%\n\nI think this is added in by the Microsoft build tools and is not present in a standard retail install ISO?\n\n[https://docs.microso...nstallfrom-path](https://docs.microsoft.com/en-us/windows-hardware/customize/desktop/unattend/microsoft-windows-setup-imageinstall-dataimage-installfrom-path \"External link\")\n\n"
    },
    {
      "id": "209477",
      "timestamp": "2019-02-24T10:35:50+00:00",
      "author": "nierewa",
      "content": "Hmm, seems you are right.\n\nAre you think I can add USB 3.0 drivers in that way?  \nI have to change %configroot% to USB root,e.g.: \\\u003cPath\\\u003e%USBDRIVE%\\\\Win7\\\\usb3\\\\Asmedia\\\u003c/Path\\\u003e\n\nPerhaps it could solve the \"ERROR - COULD NOT FIND E2B DRIVE!\".\n\n"
    },
    {
      "id": "209478",
      "timestamp": "2019-02-24T10:37:03+00:00",
      "author": "steve6375",
      "content": "No.\n\n"
    },
    {
      "id": "209479",
      "timestamp": "2019-02-24T10:42:17+00:00",
      "author": "nierewa",
      "content": "Too bad.  \nThank you for your great help ![:thumbup:](http://reboot.pro/public/style_emoticons/default/thumbup.gif)\n\n"
    },
    {
      "id": "209503",
      "timestamp": "2019-02-25T01:25:10+00:00",
      "author": "Hillary22",
      "content": "\u003e You have\n\u003e\n\u003e :: find the ISO  \n\u003e set UPATH\u003d\\\\%MYISO%\n\u003e\n\u003e so it is expecting the ISO to be in the root of the USB drive but you have placed it in \\\\images folder.\n\u003e\n\u003e Check X:\\\\Windows\\\\system32\\\\Win10.iso.tag exists\n\u003e\n\u003e [transfers paris airports](http://www.shuttle-paris-airports.com/paris-shuttle \"External link\")\n\u003e\n\u003e P.S. When you have a problem, use**echo on** (not @echo off) at top of file and place\n\u003e\n\u003e **pause**\n\u003e\n\u003e at various lines so you can see results ;-)\n\nAhhh you\u0027re right , thank you very much\n\n"
    },
    {
      "id": "209807",
      "timestamp": "2019-03-14T03:08:17+00:00",
      "author": "nightmoldy",
      "content": "There are issues with Windows 10 1809 ISO, roll back to previous versions.\n\n"
    },
    {
      "id": "209924",
      "timestamp": "2019-03-18T07:13:55+00:00",
      "author": "Daomer",
      "content": "Making a bootable USB drive for installing Windows 10 will save you a lot of trouble,all you need to do is burn iso to an empty USB.\n\n"
    },
    {
      "id": "209985",
      "timestamp": "2019-03-20T10:08:10+00:00",
      "author": "Daomer",
      "content": "\u003e Making a bootable USB drive for installing Windows 10 will save you a lot of trouble,all you need is an empty USB.\n\nDo as it says :[https://www.uubyte.c...m-iso-file.html](https://www.uubyte.com/make-bootable-usb-from-iso-file.html \"External link\")\n\nI think it\u0027s so easy.\n\n"
    },
    {
      "id": "211884",
      "timestamp": "2019-06-24T09:49:45+00:00",
      "author": "nierewa",
      "content": "Hi, there.  \nFirst of all, thanks for the help. However, I have one more question on this subject. I hope I am right here.  \n\nI use AIO boot, which is very cool I think  \nBut how can I enter the Windows 10 installation for UEFI here? I didn\u0027t find the right configuration file for the grub2 menu.  \n\nMy stick looks like this:  \nPartition 1: AIO with all AIO-files  \nPartition 2: the Windows 10 iso with wimboot, startup.bat etc.  \n\nAs I said legacy works great. I add root (hd0,1) for map \\\\images\\\\Win10_1809_x64.iso  \nBut it doesn\u0027t work with UEFI.  \n\nOr is there a way to use bootmgr for iso installation?  \n\nThanks again  \n\nTranslated with www.DeepL.com/Translator\n\n"
    },
    {
      "id": "211885",
      "timestamp": "2019-06-24T10:15:25+00:00",
      "author": "steve6375",
      "content": "I haven\u0027t got around to trying this yet,\n\nbut the grub2 UEFI menu would be similar to the MBR grub2 menu except it would have\n\n```\ninsmod wimboot\n```\n\nto load the wimboot module (you need to copy the two files into the \\\\boot\\\\grub\\\\x86_64-efi and i386-efi folders first).\n\nthen use a wimboot command line as detailed in the description, to run wimboot.\n\nsee [http://reboot.pro/to...ot/#entry211789](http://reboot.pro/topic/21929-install-windows-from-unmodified-windows-install-isos-by-using-grub2-and-wimboot/#entry211789 \"\")\n\n"
    },
    {
      "id": "211890",
      "timestamp": "2019-06-24T11:10:05+00:00",
      "author": "nierewa",
      "content": "\u003e (you need to copy the two files into the \\\\boot\\\\grub\\\\x86_64-efi and i386-efi folders first)\n\nWhich two files do you mean? The wimboot.mod I found in the given link\n\nThe problem is I don\u0027t know how to add an entry to grub2 menu.  \nWith AIOCreator it is easy to edit grub4dos and bcd menu, but I can\u0027t find a way to edit grub 2 menu\n\n"
    },
    {
      "id": "211891",
      "timestamp": "2019-06-24T11:20:26+00:00",
      "author": "steve6375",
      "content": "Well I suggest you ask the author of AIOBoot.\n\nTwo files\n\n\\\\boot\\\\grub\\\\x86_64-efi\\\\wimboot.mod\n\n\\\\boot\\\\grub\\\\i386-efi\\\\wimboot.mod\n\n"
    },
    {
      "id": "211940",
      "timestamp": "2019-06-27T10:46:35+00:00",
      "author": "nierewa",
      "content": "I found it.  \nNow I can add an entry.\n\nIs this the right way\n\n```\nmenuentry \"WIN10 Install\" --unrestricted --class Windows {\n\n    set isoname\u003dwin10.iso\n    loopback loop /$isoname\n    linux16 /wimboot\n    initrd16 newc:bcd:(loop)/boot/bcd \\\n    newc:Win10.iso.tag:(loop)/boot/bcd \\\n    newc:winpeshl.ini:/winpeshl.ini \\\n    newc:startup.bat.sdi:/startup.bat \\\n    newc:boot.sdi:(loop)/boot/boot.sdi \\\n    newc:boot.wim:(loop)/sources/boot.wim\n    drivemap -s hd0 hd1\n\n    boot\n\n)\n```\n\nThe stick looks this way\n\nPartition 1: AIO with all AIO-files  \nPartition 2: the Windows 10 iso with wimboot, startup.bat etc.\n\n\\|- images\n\n\\|-win10_1903_x64.iso\n\n\\|\n\n\\|- wimboot\n\n\\|-wimboot\n\n\\|-winpeshl.ini\n\n\\|-startup.bat\n\nSo I change the entry to:\n\n```\nmenuentry \"Windows 10 64bit installieren\" {\n\tset root\u003d(hd0,2)\n\tset isoname\u003dimages/Win10_1903_x64.iso\n    loopback loop $isoname\n    linux16 /wimboot/wimboot\n    initrd16 newc:bcd:(loop)/boot/bcd \\\n    newc:Win10_1903_x64.iso.tag:(loop)/boot/bcd \\\n    newc:winpeshl.ini:/wimboot/winpeshl.ini \\\n    newc:startup.bat.sdi:/wimboot/startup.bat \\\n    newc:boot.sdi:(loop)/boot/boot.sdi \\\n    newc:boot.wim:(loop)/sources/boot.wim\n    drivemap -s hd0 hd1\n    boot\n}\n```\n\nThe booting results in a screen with black spots an nothing else happens.\n\nCan you tell me what\u0027s wrong?\n\n"
    },
    {
      "id": "211941",
      "timestamp": "2019-06-27T10:52:31+00:00",
      "author": "steve6375",
      "content": "It should work for MBR booting. For UEFI booting it is totally wrong though.\n\n"
    },
    {
      "id": "211942",
      "timestamp": "2019-06-27T11:07:58+00:00",
      "author": "nierewa",
      "content": "I give up. That\u0027s to hard for me.\n\nMay you tell me how it work with UEFI please [![:white_flag:](http://reboot.pro/public/style_emoticons/default/character32.gif)](http://reboot.pro/index.php?s\u003d65e4b0059ea174f65c8409c44a83fe7b\u0026\u0026app\u003dforums\u0026module\u003dextras\u0026section\u003dlegends# \"\")\n\n"
    },
    {
      "id": "211943",
      "timestamp": "2019-06-27T12:11:45+00:00",
      "author": "steve6375",
      "content": "It doesn\u0027t! The pre-compiled wimboot.mod module does not work with any standard release of grub2 (only the special build by alive).\n\nThe special build by alive downloaded from [https://github.com/a...ub2-filemanager](https://github.com/a1ive/grub2-filemanager \"External link\") only seems to Secure UEFI boot but does not non-Secure UEFI boot (at least in my tests using Z87 PC and VBox).\n\nIf you use the Secure-Boot a1ive grub2 then you have to run MokManager to get it to work because it is not signed. MokManager does not run on my Z87 PC or VBox so I can\u0027t get grub2 to load.\n\nA1ive says I am welcome to compile my own special version of the wimboot module, but I am reluctant to try to get his/her special version compiling and test it as there are always issues with this sort of problem. If a new wimboot.mod was made, it would only non-Secure UEFI-boot but it could be used with any *standard* version of grub2 and use by many 1000s of people, but [he/she seems unwilling](https://github.com/aIive/builds/issues/1 \"External link\") to spend 30 mins of his/her time compiling a version for us.\n\nMy (untested) menu entry looks like this:\n\nloopback loop /WINDOWS/${filename}  \nset pp\u003d  \nif test -f (loop)/x64/sources/boot.wim; then set pp\u003d/x64; fi  \n# if $MBR32; then  \n# if test -f (loop)/x86/sources/boot.wim; then set pp\u003d/x86; fi  \n# fi  \ninsmod wimboot  \nwimboot \\\\  \n@:startup.bat://wimboot/startup.bat \\\\  \n@:winpeshl.ini:/wimboot/winpeshl.ini \\\\  \n@:$filename.tag:(loop)${pp}/boot/bcd \\\\  \n@:bootmgfw.efi:/wimboot/bootmgfw64.efi \\\\  \n@:boot.sdi:(loop)${pp}/boot/boot.sdi \\\\  \n@:boot.wim:(loop)${pp}/sources/boot.wim \\\\  \n@:bcd:(loop)${pp}/boot/bcd  \n#drivemap -s hd0 hd1  \nboot\n\nIt is suggested to use a standard Win7 \\\\EFI\\\\BOOT\\\\Bootx64.efi boot file for the bootmgfw.efi boot file - but I haven\u0027t got that far in testing.\n\nChinese blog [here](http://bbs.wuyou.net/forum.php?mod\u003dviewthread\u0026tid\u003d414244 \"External link\"). YTvideo [here](https://youtu.be/Ray2dCFIX5w \"External link\").\n\n**Edited by steve6375, 27 June 2019 - 01:46 PM.**\n"
    },
    {
      "id": "211949",
      "timestamp": "2019-06-28T08:10:40+00:00",
      "author": "nierewa",
      "content": "Nothing happens either.\n\nNo error or something else.\n\nThe entry changed in that way:\n\n```\nmenuentry \"Windows 10 64bit installieren\" {\n set root\u003d(hd0,2)\n\n//the pp is obsolete for me I think, because I only have one version to install\n  so I set pp to (loop)/sources\n\n loopback loop /images/Win10_1903_x64.iso\n  insmod wimboot\n  wimboot \\       --\u003e I don\u0027t now if this is right with the constelation I have\n  @:startup.bat://wimboot/startup.bat \\\n  @:winpeshl.ini:/wimboot/winpeshl.ini \\\n  @:Win10_1903_x64.iso.tag:(loop)/sources/boot/bcd \\\n  @:bootmgfw.efi:/wimboot/bootmgfw64.efi \\\n  @:boot.sdi:(loop)/sources/boot/boot.sdi \\\n  @:boot.wim:(loop)/sources/sources/boot.wim \\\n  @:bcd:(loop)/sources/boot/bcd\n  #drivemap -s hd0 hd1\n  boot\n```\n\nThanks for your help\n\n"
    },
    {
      "id": "211963",
      "timestamp": "2019-06-28T13:21:08+00:00",
      "author": "steve6375",
      "content": "I have had some success!\n\nI use a Win10 ISO as the source Windows file.\n\nBe sure to use the correct version of bootfmx64.efi !!!\n\nThe order that the files are loaded in is critical! If they are in the wrong order I get a 0xc000000f BSOD!\n\n```\nmenuentry \"${filenamex} EFI\" {\n  set isoname\u003d\"${filename}\" ; CHECK_MNU_FOLDER\n  loopback loop ${ifp}/WINDOWS/${filename}\n  set pp\u003d\n  if test -f (loop)/x64/sources/boot.wim; then set pp\u003d/x64; fi\n  if $EFI32; then\n   if test -f (loop)/x86/sources/boot.wim; then set pp\u003d/x86; fi\n  fi\n```\n\n```\n  echo Using ${pp}/sources/boot.wim...\n\n#NOTE: ORDER IS IMPORTANT! May get 0xC000000f error if order is wrong!\n  wimboot \\\n  @:startup.bat:/wimboot/startup.bat \\\n  @:winpeshl.ini:/wimboot/winpeshl.ini \\\n  @:$filename.tag:(loop)${pp}/efi/microsoft/boot/bcd \\\n  @:boot.wim:(loop)${pp}/sources/boot.wim \\\n  @:bootmgfw.efi:(loop)${pp}/efi/boot/bootx64.efi \\\n  @:bcd:(loop)${pp}/efi/microsoft/boot/bcd  \\\n  @:boot.sdi:(loop)${pp}/boot/boot.sdi\n  drivemap -s hd0 hd1\n  boot\n```\n\nFor instance, if the boot.wim is loaded last then you get a BSOD!\n\nAttached is a screenshot of the \\\\EFI\\\\BOOT files which are used for UEFI64. Bootx64 is a shim which loads grubx64 which then loads grubfmx64.efi.\n\ngrubfmx64.efi is some sort if file manager, it allows you to navigate to \\\\boot\\\\grub\\\\grub.cfg and then select \u0027Grub2\u0027 to load your grub.cfg file.\n\nOnce that is done you can use your own grub2 menu as above.\n\nThe winpeshl.ini and startup.bat worked and loaded the ISO as a virtual drive so I could choose an Edition and I got through to the Windows Setup \u0027Where do you want to install Windows\u0027 screen so it should now work OK.\n\nI have not tried Secure Boot.\n\nI do not know how to get rid of the file manager and just get it to run the grub.cfg file yet though....  \n\n#### Attached Thumbnails {#attach_wrap}\n\n* [![UEFIWIMBOOT2.JPG](http://reboot.pro/uploads/monthly_06_2019/post-17818-0-05333800-1561727536_thumb.jpg)](http://reboot.pro/uploads/monthly_06_2019/post-17818-0-05333800-1561727536.jpg \"UEFIWIMBOOT2.JPG - Size: 146.07KB\"){#ipb-attach-url-16750-0-58583700-1676066403}\n* [![UEFIWIMBOOT1.JPG](http://reboot.pro/uploads/monthly_06_2019/post-17818-0-60014400-1561727542_thumb.jpg)](http://reboot.pro/uploads/monthly_06_2019/post-17818-0-60014400-1561727542.jpg \"UEFIWIMBOOT1.JPG - Size: 48.79KB\"){#ipb-attach-url-16751-0-58592900-1676066403}\n\n**Edited by steve6375, 04 July 2019 - 09:31 AM.**\n"
    },
    {
      "id": "211975",
      "timestamp": "2019-06-29T05:10:20+00:00",
      "author": "steve6375",
      "content": "Here is a link to download for the files I use in \\\\EFI\\\\BOOT folder (loads the default \\\\boot\\\\grub\\\\grub.cfg file)\n\n[https://1drv.ms/u/s!...W-RDHY?e\u003diK0FnZ](https://1drv.ms/u/s!AqlrQcdsFA-Ksna0C0gwN1W-RDHY?e\u003diK0FnZ \"External link\")\n\nbootx64.efi is a stub\n\ngrubx64.efi is a loader\n\ngrubfmx64.efi is grub2 which will load your \\\\boot\\\\grub\\\\grub.cfg file\n\nIt is based on A1ive\u0027s grub2 build for filemanager.\n\n32-bit UEFI should also work.\n\nSecure Boot is untested.\n\n**Edited by steve6375, 29 June 2019 - 05:31 AM.**\n"
    },
    {
      "id": "211978",
      "timestamp": "2019-06-29T08:17:41+00:00",
      "author": "steve6375",
      "content": "More info on wimboot and grub2 [here](https://www.rmprepusb.com/tutorials/145-grub2winiso \"External link\") with updated grub2 files.  \n\nNote that you must keep the filename of the ISO short!   \n\n**Edited by steve6375, 29 June 2019 - 08:36 AM.**\n"
    },
    {
      "id": "211985",
      "timestamp": "2019-06-29T09:55:07+00:00",
      "author": "nierewa",
      "content": "First of all, many Thanks Steve.  \nI\u0027ll give many tries ![:D](http://reboot.pro/public/style_emoticons/default/biggrin.png) ![:D](http://reboot.pro/public/style_emoticons/default/biggrin.png)\n\n"
    },
    {
      "id": "211989",
      "timestamp": "2019-06-29T13:38:15+00:00",
      "author": "steve6375",
      "content": "I have updated [Tutorial 145](https://www.rmprepusb.com/tutorials/145-grub2winiso \"External link\") again.\n\nThere was a problem when using more than one .iso file in the same folder. If you are not using the E2B grub2 menu you might not have the issue anyway.\n\nAlso, I have improved the passing of the name and path of the ISO by using a null.cfg file (which is now added to the \\\\wimboot folder). It uses save_env to write a variable value to a file on the USB drive using\n\n```\nsave_env -f /wimboot/null.cfg installiso\n```\n\nThis is picked up later by startup.bat (save_env is one of the few commands that actually writes to a disk - the file must exist however and be a special size).\n\nUEFI booting seems to work well now.\n\nUnfortunately, for some strange reason, **I cannot now MBR boot** using \\\\wimboot\\\\wimboot. I have tried old images as well as new and they all hang after loading bootmgr. It is really annoying as it was working before and I have no idea what has caused it to no longer work as the grub2 legacy files have not changed and the wimboot file has not changed!\n\nAnyway, hopefully you will be able to get the UEFI working.\n\nIf you have got the MBR wimboot working, please let me know. Perhaps I changed something subtle and broke it. Wimboot seems very sensitive to boot order, file name lengths, etc.!\n\nP.S. Just got MBR + wimboot to work on an HP laptop using exactly the same USB drive (but it hung the first 3 times!) so it doesn\u0027t seem to like my Z87 or VBox for some reason (maybe memory map issues?).\n\n"
    },
    {
      "id": "211997",
      "timestamp": "2019-06-30T09:15:22+00:00",
      "author": "steve6375",
      "content": "update: my problems with MBR wimboot booting no longer working seems to be due to the late addition of the\n\n```\ndrivemap -s hd0 hd1\n```\n\nline into the menu.\n\nI think I added this because the boot code was being installed onto the USB drive instead of the internal hard disk.\n\nWhen test under VBox (where USB drive \u003d 0 and virtual HDD\u003d1) this seems to prevent bootmgr from booting but it is OK on a real system or if I remove the line then it boots under VBox OK.\n\n\u003cbr /\u003e\n\n"
    },
    {
      "id": "211998",
      "timestamp": "2019-06-30T15:34:45+00:00",
      "author": "steve6375",
      "content": "P.S. Tutorial 145 files have been updated again!\n\n"
    },
    {
      "id": "212001",
      "timestamp": "2019-07-01T10:57:27+00:00",
      "author": "nierewa",
      "content": "I changed the menuentry to:\n\n```\nmenuentry \"${filenamex} EFI\" {\n  loopback loop (hd0,msdos2)/images/Win10_1903_x64.iso\n\n  echo Using /sources/boot.wim...\n\n#NOTE: ORDER IS IMPORTANT! May get 0xC000000f error if order is wrong!\n  wimboot (hd0,2)/wimboot/wimboot\n  @:startup.bat://wimboot/startup.bat \\\n  @:winpeshl.ini:/wimboot/winpeshl.ini \\\n  @:Win10_1903_x64.iso.tag:(loop)/efi/microsoft/boot/bcd \\\n  @:boot.wim:(loop)/sources/boot.wim \\\n  @:bootmgfw.efi:(loop)/efi/boot/bootx64.efi \\\n  @:bcd:(loop)/efi/microsoft/boot/bcd  \\\n  @:boot.sdi:(loop)/boot/boot.sdi\n  drivemap -s hd0 hd1\n  boot\n }\n```\n\nThe pp\u003d Entry I don\u0027t need, because I\u0027ve got two images. One for x86 and one for x64.  \nThere is no folderstructur with x64 or x86 in it.\n\nBooting results in:\n\n```\nload (hd0,2)/wimboot/wimboot...Please wait...\n```\n\nNothing happens.  \nI think the problem I have are the two partitions.\n\nPartition 1: AIO with all AIO-files  \nPartition 2: the Windows 10 iso with wimboot, startup.bat etc.\n\n\\|- images\n\n\\|-win10_1903_x64.iso\n\n\\|-win10_1903_x86.iso\n\n\\|\n\n\\|- wimboot\n\n\\|-wimboot\n\n\\|-winpeshl.ini\n\n\\|-startup.bat\n\nDon\u0027t know how to fit the entry to this.  \n\n"
    },
    {
      "id": "212002",
      "timestamp": "2019-07-01T11:20:53+00:00",
      "author": "steve6375",
      "content": "use\n\n```\nFOR MBR wimboot (hd0,2)/wimboot/wimboot pause\n\nFOR UEFI  wimboot --pause \\\n```\n\nto see any errors in wimboot\n\ndrivemap -s hd0 hd1 doesnt work so delete it\n\nuse ls to see drive names (mine was (hd0,msdos1) (hd0,msdos2) etc.)\n\nkeep length of the iso filename short - e.g. Win10.iso\n\nThere is a new version which allows longer names - see my tutorial for latest download.\n\nif problems , try commenting out the bootmgfw.efi line - wimboot should find it\n\nlatest version does not use a .tag file - I use a null.cfg file and new startup.bat - see latest download for files.\n\n**Edited by steve6375, 04 July 2019 - 09:14 AM.**\n"
    },
    {
      "id": "212023",
      "timestamp": "2019-07-04T09:03:15+00:00",
      "author": "nierewa",
      "content": "After many tests and things to try out, it doesn\u0027t work ![:(](http://reboot.pro/public/style_emoticons/default/sad.png)\n\nIf downloaded GRUB2_WIMBOOT file and GRUB2_WIMBOOT_EFI_BOOT_FILES.  \nI extract the GRUB2_WIMBOOT_EFI_BOOT_FILES to **wimboot folder** on second partition.  \nThe GRUB2_WIMBOOT files also to the **wimboot folder**. wimboot file is date 18.05.2017\n\nI made a folder _ISO\\\\MAINMENU\\\\WINDOWS where I put the isos in (win10_1903_x64.iso and win10_1903_x32.iso)\n\nThe menu entry for e.g. 64bit is:\n\n```\nmenuentry \"${filenamex} EFI\" {\n  loopback loop (hd0,msdos2)/images/Win10_1903_x64.iso\n\n  echo Using /sources/boot.wim...\n\n#NOTE: ORDER IS IMPORTANT! May get 0xC000000f error if order is wrong!\n  wimboot (hd0,2)/wimboot/wimboot --pause\n  @:startup.bat://wimboot/startup.bat \\\n  @:winpeshl.ini:/wimboot/winpeshl.ini \\\n  @:Win10_1903_x64.iso.tag:(loop)/efi/microsoft/boot/bcd \\\n  @:boot.wim:(loop)/sources/boot.wim \\\n  @:bootmgfw.efi:(loop)/efi/boot/bootx64.efi \\\n  @:bcd:(loop)/efi/microsoft/boot/bcd  \\\n  @:boot.sdi:(loop)/boot/boot.sdi\n  boot\n }\n```\n\nNothing happens. In VirtualBox the message appears \"load (hd0,2)/wimboot/wimboot...Please wait...\"\n\nOn real PC it shows a screen with black dots an then restarts.\n\n"
    },
    {
      "id": "212024",
      "timestamp": "2019-07-04T09:09:01+00:00",
      "author": "steve6375",
      "content": "Your menu is wrong! (sorry didnt notice this before - my menu is in post #35 and was correct!)\n\n```\nwimboot (hd0,2)/wimboot/wimboot --pause\n```\n\n\\\\wimboot\\\\wimboot is the Legacy\\\\MBR program - we dont use this for UEFI.\n\nFor UEFI, the grub2 wimboot module is used and the parameters are passed to it on the command line.\n\nit should be\n\n```\nwimboot --pause \\\n```\n\nno path is needed because we use the UEFI grub2 module which is already loaded.\n\n**Edited by steve6375, 04 July 2019 - 09:17 AM.**\n"
    },
    {
      "id": "212025",
      "timestamp": "2019-07-04T09:25:59+00:00",
      "author": "nierewa",
      "content": "Ah, I see...  \nSame problem, well, not quite.\n\nNow you can see\n\nLoad --pause... Please wait\n\n"
    },
    {
      "id": "212026",
      "timestamp": "2019-07-04T09:26:54+00:00",
      "author": "steve6375",
      "content": "Can you show your menu ...\n\nCompare it with mine in post #35\n\ndid you forget the \\\\ at the end of the line?\n\n"
    },
    {
      "id": "212027",
      "timestamp": "2019-07-04T09:30:22+00:00",
      "author": "steve6375",
      "content": "also, you said the ISO file is in \\\\_ISO\\\\MAINMENU\\\\Windows, but you have\n\nloopback loop (hd0,msdos2)/images/Win10_1903_x64.iso\n\n???\n\n"
    },
    {
      "id": "212028",
      "timestamp": "2019-07-04T09:39:51+00:00",
      "author": "nierewa",
      "content": "I have to change the iso location to /images of second partition.  \nWith _ISO/MAINMENU/WINDOWS the legacy Installation doesn\u0027t work anymore.\n\nSo the menu looks like this:\n\n```\nmenuentry \"Install Windows 10 x64\" {\n  loopback loop (hd0,msdos2)/images/Win10_1903_x64.iso\n\n  echo Using /sources/boot.wim...\n\n#NOTE: ORDER IS IMPORTANT! May get 0xC000000f error if order is wrong!\n  wimboot --pause \\\n  @:startup.bat://wimboot/startup.bat \\\n  @:winpeshl.ini:/wimboot/winpeshl.ini \\\n  @:Win10_1903_x64.iso.tag:(loop)/efi/microsoft/boot/bcd \\\n  @:boot.wim:(loop)/sources/boot.wim \\\n  @:bootmgfw.efi:(loop)/efi/boot/bootx64.efi \\\n  @:bcd:(loop)/efi/microsoft/boot/bcd  \\\n  @:boot.sdi:(loop)/boot/boot.sdi\n  boot\n }\n```\n\n\u003cbr /\u003e\n\n"
    },
    {
      "id": "212029",
      "timestamp": "2019-07-04T09:53:26+00:00",
      "author": "steve6375",
      "content": "You must UEFI-boot. It wont work if you MBR boot.\n\ntry adding read lines...\n\npress ENTER to continue with next command.\n\n```\nmenuentry \"Install Windows 10 x64\" {\n  loopback loop (hd0,msdos2)/images/Win10_1903_x64.iso\n\nread\n\n  echo Using /sources/boot.wim...\n\nread\n#NOTE: ORDER IS IMPORTANT! May get 0xC000000f error if order is wrong!\n  wimboot --pause \\\n  @:startup.bat://wimboot/startup.bat \\\n  @:winpeshl.ini:/wimboot/winpeshl.ini \\\n  @:Win10_1903_x64.iso.tag:(loop)/efi/microsoft/boot/bcd \\\n  @:boot.wim:(loop)/sources/boot.wim \\\n  @:bootmgfw.efi:(loop)/efi/boot/bootx64.efi \\\n  @:bcd:(loop)/efi/microsoft/boot/bcd  \\\n  @:boot.sdi:(loop)/boot/boot.sdi\n  boot\n}\n```\n\n\u003cbr /\u003e\n\n"
    },
    {
      "id": "212030",
      "timestamp": "2019-07-04T10:36:58+00:00",
      "author": "nierewa",
      "content": "I use UEFI-Boot. Grub2 only used for UEFI.  \nSame problem:\n\n...\n\nLoad --pause... Please wait\n\n... ENTER\n\nblack dots an nothing else.\n\nI don\u0027t know how to attache files so here\u0027s an overview of the content from the two partitions of USB Stick, so its not easy to read.  \nSorry for that :blush:  \nMaybe you can see a mistake.\n\nPartition 1:\n\n```\nVerzeichnisinhalt von I:\\:\n\n    I:\\\n        .disk\n            info\n            keep_this_directory\n        AIO\n            grub\n                fonts\n                    DejaVuSansMono-large.pf2\n                    unicode-large.pf2\n                    unicode-small.pf2\n                i386-efi\n                    acpi.mod\n                    adler32.mod\n                    affs.mod\n                    afs.mod\n                    ahci.mod\n                    all_video.mod\n                    aout.mod\n                    appleldr.mod\n                    archelp.mod\n                    at_keyboard.mod\n                    ata.mod\n                    backtrace.mod\n                    bfs.mod\n                    bitmap_scale.mod\n                    bitmap.mod\n                    blocklist.mod\n                    boot.mod\n                    bsd.mod\n                    bswap_test.mod\n                    btrfs.mod\n                    bufio.mod\n                    cat.mod\n                    cbfs.mod\n                    cbls.mod\n                    cbmemc.mod\n                    cbtable.mod\n                    cbtime.mod\n                    chain.mod\n                    cmdline_cat_test.mod\n                    cmp_test.mod\n                    cmp.mod\n                    command.lst\n                    configfile.mod\n                    cpio_be.mod\n                    cpio.mod\n                    cpuid.mod\n                    crc64.mod\n                    crypto.lst\n                    crypto.mod\n                    cryptodisk.mod\n                    cs5536.mod\n                    ctz_test.mod\n                    date.mod\n                    datehook.mod\n                    datetime.mod\n                    disk.mod\n                    diskfilter.mod\n                    div_test.mod\n                    div.mod\n                    dm_nv.mod\n                    echo.mod\n                    efi_gop.mod\n                    efi_uga.mod\n                    efifwsetup.mod\n                    efinet.mod\n                    ehci.mod\n                    elf.mod\n                    eval.mod\n                    exfat.mod\n                    exfctest.mod\n                    ext2.mod\n                    extcmd.mod\n                    f2fs.mod\n                    fat.mod\n                    file.mod\n                    fixvideo.mod\n                    font.mod\n                    fs.lst\n                    fshelp.mod\n                    functional_test.mod\n                    gcry_arcfour.mod\n                    gcry_blowfish.mod\n                    gcry_camellia.mod\n                    gcry_cast5.mod\n                    gcry_crc.mod\n                    gcry_des.mod\n                    gcry_dsa.mod\n                    gcry_idea.mod\n                    gcry_md4.mod\n                    gcry_md5.mod\n                    gcry_rfc2268.mod\n                    gcry_rijndael.mod\n                    gcry_rmd160.mod\n                    gcry_rsa.mod\n                    gcry_seed.mod\n                    gcry_serpent.mod\n                    gcry_sha1.mod\n                    gcry_sha256.mod\n                    gcry_sha512.mod\n                    gcry_tiger.mod\n                    gcry_twofish.mod\n                    gcry_whirlpool.mod\n                    gdb.mod\n                    geli.mod\n                    gettext.mod\n                    gfxmenu.mod\n                    gfxterm_background.mod\n                    gfxterm_menu.mod\n                    gfxterm.mod\n                    gptsync.mod\n                    gzio.mod\n                    halt.mod\n                    hashsum.mod\n                    hdparm.mod\n                    hello.mod\n                    help.mod\n                    hexdump.mod\n                    hfs.mod\n                    hfsplus.mod\n                    hfspluscomp.mod\n                    http.mod\n                    iorw.mod\n                    iso9660.mod\n                    jfs.mod\n                    jpeg.mod\n                    keylayouts.mod\n                    keystatus.mod\n                    ldm.mod\n                    legacy_password_test.mod\n                    legacycfg.mod\n                    linux.mod\n                    linux16.mod\n                    loadbios.mod\n                    loadenv.mod\n                    loopback.mod\n                    ls.mod\n                    lsacpi.mod\n                    lsefi.mod\n                    lsefimmap.mod\n                    lsefisystab.mod\n                    lsmmap.mod\n                    lspci.mod\n                    lssal.mod\n                    lua.mod\n                    luks.mod\n                    lvm.mod\n                    lzopio.mod\n                    macbless.mod\n                    macho.mod\n                    mdraid09_be.mod\n                    mdraid09.mod\n                    mdraid1x.mod\n                    memdisk.mod\n                    memrw.mod\n                    minicmd.mod\n                    minix_be.mod\n                    minix.mod\n                    minix2_be.mod\n                    minix2.mod\n                    minix3_be.mod\n                    minix3.mod\n                    mmap.mod\n                    moddep.lst\n                    modinfo.sh\n                    morse.mod\n                    mpi.mod\n                    msdospart.mod\n                    mul_test.mod\n                    multiboot.mod\n                    multiboot2.mod\n                    nativedisk.mod\n                    net.mod\n                    newc.mod\n                    nilfs2.mod\n                    normal.mod\n                    ntfs.mod\n                    ntfscomp.mod\n                    odc.mod\n                    offsetio.mod\n                    ohci.mod\n                    part_acorn.mod\n                    part_amiga.mod\n                    part_apple.mod\n                    part_bsd.mod\n                    part_dfly.mod\n                    part_dvh.mod\n                    part_gpt.mod\n                    part_msdos.mod\n                    part_plan.mod\n                    part_sun.mod\n                    part_sunpc.mod\n                    partmap.lst\n                    parttool.lst\n                    parttool.mod\n                    password_pbkdf2.mod\n                    password.mod\n                    pata.mod\n                    pbkdf2_test.mod\n                    pbkdf2.mod\n                    pcidump.mod\n                    play.mod\n                    png.mod\n                    priority_queue.mod\n                    probe.mod\n                    procfs.mod\n                    progress.mod\n                    raid5rec.mod\n                    raid6rec.mod\n                    random.mod\n                    read.mod\n                    reboot.mod\n                    regexp.mod\n                    reiserfs.mod\n                    relocator.mod\n                    romfs.mod\n                    scsi.mod\n                    search_fs_file.mod\n                    search_fs_uuid.mod\n                    search_label.mod\n                    search.mod\n                    serial.mod\n                    setjmp_test.mod\n                    setjmp.mod\n                    setpci.mod\n                    sfs.mod\n                    shift_test.mod\n                    signature_test.mod\n                    sleep_test.mod\n                    sleep.mod\n                    spkmodem.mod\n                    squash4.mod\n                    strtoull_test.mod\n                    syslinuxcfg.mod\n                    tar.mod\n                    terminal.lst\n                    terminal.mod\n                    terminfo.mod\n                    test_blockarg.mod\n                    test.mod\n                    testload.mod\n                    testspeed.mod\n                    tftp.mod\n                    tga.mod\n                    time.mod\n                    tr.mod\n                    trig.mod\n                    true.mod\n                    udf.mod\n                    ufs1_be.mod\n                    ufs1.mod\n                    ufs2.mod\n                    uhci.mod\n                    usb_keyboard.mod\n                    usb.mod\n                    usbms.mod\n                    usbserial_common.mod\n                    usbserial_ftdi.mod\n                    usbserial_pl2303.mod\n                    usbserial_usbdebug.mod\n                    usbtest.mod\n                    verify.mod\n                    video_bochs.mod\n                    video_cirrus.mod\n                    video_colors.mod\n                    video_fb.mod\n                    video.lst\n                    video.mod\n                    videoinfo.mod\n                    videotest_checksum.mod\n                    videotest.mod\n                    wimboot.mod\n                    xfs.mod\n                    xnu_uuid_test.mod\n                    xnu_uuid.mod\n                    xnu.mod\n                    xzio.mod\n                    zfs.mod\n                    zfscrypt.mod\n                    zfsinfo.mod\n                i386-pc\n                    915resolution.mod\n                    acpi.mod\n                    adler32.mod\n                    affs.mod\n                    afs.mod\n                    ahci.mod\n                    all_video.mod\n                    aout.mod\n                    archelp.mod\n                    at_keyboard.mod\n                    ata.mod\n                    backtrace.mod\n                    bfs.mod\n                    bitmap_scale.mod\n                    bitmap.mod\n                    blocklist.mod\n                    boot.img\n                    boot.mod\n                    bsd.mod\n                    bswap_test.mod\n                    btrfs.mod\n                    bufio.mod\n                    cat.mod\n                    cbfs.mod\n                    cbls.mod\n                    cbmemc.mod\n                    cbtable.mod\n                    cbtime.mod\n                    chain.mod\n                    cmdline_cat_test.mod\n                    cmosdump.mod\n                    cmostest.mod\n                    cmp_test.mod\n                    cmp.mod\n                    command.lst\n                    configfile.mod\n                    core.img\n                    cpio_be.mod\n                    cpio.mod\n                    cpuid.mod\n                    crc64.mod\n                    crypto.lst\n                    crypto.mod\n                    cryptodisk.mod\n                    cs5536.mod\n                    ctz_test.mod\n                    date.mod\n                    datehook.mod\n                    datetime.mod\n                    disk.mod\n                    diskfilter.mod\n                    div_test.mod\n                    div.mod\n                    dm_nv.mod\n                    drivemap.mod\n                    echo.mod\n                    efiemu.mod\n                    efiemu32.o\n                    efiemu64.o\n                    ehci.mod\n                    elf.mod\n                    eltorito.img\n                    eval.mod\n                    exfctest.mod\n                    extcmd.mod\n                    f2fs.mod\n                    file.mod\n                    font.mod\n                    freedos.mod\n                    fs.lst\n                    fshelp.mod\n                    functional_test.mod\n                    gcry_arcfour.mod\n                    gcry_blowfish.mod\n                    gcry_camellia.mod\n                    gcry_cast5.mod\n                    gcry_crc.mod\n                    gcry_des.mod\n                    gcry_dsa.mod\n                    gcry_idea.mod\n                    gcry_md4.mod\n                    gcry_md5.mod\n                    gcry_rfc2268.mod\n                    gcry_rijndael.mod\n                    gcry_rmd160.mod\n                    gcry_rsa.mod\n                    gcry_seed.mod\n                    gcry_serpent.mod\n                    gcry_sha1.mod\n                    gcry_sha256.mod\n                    gcry_sha512.mod\n                    gcry_tiger.mod\n                    gcry_twofish.mod\n                    gcry_whirlpool.mod\n                    gdb.mod\n                    geli.mod\n                    gettext.mod\n                    gfxmenu.mod\n                    gfxterm_background.mod\n                    gfxterm_menu.mod\n                    gfxterm.mod\n                    gptsync.mod\n                    gzio.mod\n                    halt.mod\n                    hashsum.mod\n                    hdparm.mod\n                    hello.mod\n                    help.mod\n                    hexdump.mod\n                    hfs.mod\n                    hfsplus.mod\n                    hfspluscomp.mod\n                    http.mod\n                    iorw.mod\n                    iso9660.mod\n                    jfs.mod\n                    jpeg.mod\n                    keylayouts.mod\n                    keystatus.mod\n                    ldm.mod\n                    legacy_password_test.mod\n                    legacycfg.mod\n                    linux.mod\n                    linux16.mod\n                    loadenv.mod\n                    loopback.mod\n                    ls.mod\n                    lsacpi.mod\n                    lsapm.mod\n                    lsmmap.mod\n                    lspci.mod\n                    lua.mod\n                    luks.mod\n                    lvm.mod\n                    lzopio.mod\n                    macbless.mod\n                    macho.mod\n                    mda_text.mod\n                    mdraid09_be.mod\n                    mdraid09.mod\n                    mdraid1x.mod\n                    memdisk.mod\n                    memrw.mod\n                    minicmd.mod\n                    minix_be.mod\n                    minix.mod\n                    minix2_be.mod\n                    minix2.mod\n                    minix3_be.mod\n                    minix3.mod\n                    mmap.mod\n                    moddep.lst\n                    modinfo.sh\n                    morse.mod\n                    mpi.mod\n                    msdospart.mod\n                    mul_test.mod\n                    multiboot.mod\n                    multiboot2.mod\n                    nativedisk.mod\n                    net.mod\n                    newc.mod\n                    nilfs2.mod\n                    normal.mod\n                    ntldr.mod\n                    odc.mod\n                    offsetio.mod\n                    ohci.mod\n                    part_acorn.mod\n                    part_amiga.mod\n                    part_apple.mod\n                    part_bsd.mod\n                    part_dfly.mod\n                    part_dvh.mod\n                    part_plan.mod\n                    part_sun.mod\n                    part_sunpc.mod\n                    partmap.lst\n                    parttool.lst\n                    parttool.mod\n                    password_pbkdf2.mod\n                    password.mod\n                    pata.mod\n                    pbkdf2_test.mod\n\n\t\t\t\t\t\n\t\t\t\t\t\n\n\t\t\t\t\t\n\t\t\t\t\n```\n\n"
    },
    {
      "id": "212031",
      "timestamp": "2019-07-04T10:54:37+00:00",
      "author": "steve6375",
      "content": "Try going to the grub2 command line (press c)\n\nand then type in the loop and wimboot commands.\n\nyou only need to specify the boot.wim file just to test (if it works you will get a BCD missing error).\n\nreport back exactly what you see...  \n\n#### Attached Thumbnails {#attach_wrap}\n\n* [![wimboot_test.JPG](http://reboot.pro/uploads/monthly_07_2019/post-17818-0-48159800-1562237645_thumb.jpg)](http://reboot.pro/uploads/monthly_07_2019/post-17818-0-48159800-1562237645.jpg \"wimboot_test.JPG - Size: 80.16KB\"){#ipb-attach-url-16755-0-92926300-1676066403}\n\n"
    },
    {
      "id": "212032",
      "timestamp": "2019-07-04T11:08:26+00:00",
      "author": "steve6375",
      "content": "I don\u0027t quite understand how you are booting to grub2?\n\nYou seem to have the AIO install files not the E2B grub2 files.\n\nHave you updated to \\\\EFI\\\\boot\\\\bootx64.efi (27/05/2019) and grubx64.efi (1/7/2019) ???\n\nIf so they should load \\\\boot\\\\grub\\\\grub.cfg - but I dont think you have that file so how can you be getting a menu?\n\nAre you sure you are loading the correct EFI version of grub2??\n\n"
    },
    {
      "id": "212033",
      "timestamp": "2019-07-04T12:06:57+00:00",
      "author": "nierewa",
      "content": "A screenshot what happend when I type in the loop and wimboot commands:\n\n![wimboot.jpg](http://hammer2018.bplaced.net/images/wimboot.jpg)\n\nI found something out.  \nBy default Grub2 uses the menu: AIO/menu/main.cfg  \n\nWhen I replaced the grubx64.efi (version 11/7/2018 with 1/7/2019) file in the EFI/BOOT folder,  \nthe menu boot/grub/grub.cfg is used instead. The following entry boot up\n\nI did this replacement many times before with the same file but this happend first time ![:confused1:](https://reboot.pro/public/style_emoticons/default/confused1.gif)\n\n```\nmenuentry \"${filenamex} EFI\" {\n  loopback loop (hd0,2)/images/Win10_1903_x64.iso\n  set pp\u003d(loop)/sources/boot.wim\n\n#NOTE: ORDER IS IMPORTANT! May get 0xC000000f error if order is wrong!\n  wimboot \\\n  @:startup.bat:(hd0,2)/wimboot/startup.bat \\\n  @:winpeshl.ini:(hd0,2)/wimboot/winpeshl.ini \\\n  @:$filename.tag:(loop)/efi/microsoft/boot/bcd \\\n  @:boot.wim:(loop)/sources/boot.wim \\\n  @:bootmgfw.efi:(loop)/efi/boot/bootx64.efi \\\n  @:bcd:(loop)/efi/microsoft/boot/bcd  \\\n  @:boot.sdi:(loop)/boot/boot.sdi\n  drivemap -s hd0 hd1\n  boot\n }\n```\n\nwith following error\n\n![Invalid_ISO.jpg](http://hammer2018.bplaced.net/images/Invalid_ISO.jpg)\n\n**Edited by nierewa, 04 July 2019 - 12:10 PM.**\n"
    },
    {
      "id": "212034",
      "timestamp": "2019-07-04T12:12:55+00:00",
      "author": "steve6375",
      "content": "As I thought! You weren\u0027t using the correct grub2!\n\nNow it is working.\n\nBut you need to change your menu - See [Tutorial 145](https://www.rmprepusb.com/tutorials/145-grub2winiso \"External link\") because startup.bat no longer uses the .tag file - it now uses the null.cfg file.\n\n```\nset installiso\u003d\"${ip}/${isoname}\"\nsave_env -f /wimboot/null.cfg installiso\n  cat /wimboot/null.cfg\n  read\n#NOTE: ORDER IS IMPORTANT! May get 0xC000000f error if order is wrong or wrong bootmg!\n#use wimboot --pause to see any error ( also --rawbcd --rawwim --index\u003d1 --gui )\n#enclose in \"\" if name\\path contains spaces\n#allow wimboot to find bootmg file (usually works better)\n  wimboot --pause \\\n  @:\"startup.bat\":\"/wimboot/startup.bat\" \\\n  @:\"winpeshl.ini\":\"/wimboot/winpeshl.ini\" \\\n  @:\"null.cfg\":\"/wimboot/null.cfg\" \\\n  @:\"boot.wim\":\"(loop)${pp}/sources/boot.wim\" \\\n#  @:\"bootmgfw.efi\":\"(loop)${pp}/efi/boot/$bootmg\" \\\n  @:\"bcd\":\"(loop)${pp}/efi/microsoft/boot/bcd\"  \\\n  @:\"boot.sdi\":\"(loop)${pp}/boot/boot.sdi\"\n  boot\n}\n```\n\nhere is my menu\n\nyou must set installiso to the path and name of the iso (e.g. /_ISO/WINDOWS/WIN10/xxxxxxxxx.iso) it can contain forward slashes for folders.\n\n"
    },
    {
      "id": "212035",
      "timestamp": "2019-07-04T12:39:07+00:00",
      "author": "nierewa",
      "content": "I dobn\u0027t mind why this not happend any time before..?\n\nI changed the entry according to my structure to following:\n\n```\nset installiso\u003d\"(hd0,2)/images/win10_1903_x64.iso\"\nsave_env -f (hd0,2)/wimboot/null.cfg installiso\n  cat (hd0,2)/wimboot/null.cfg\n  read\n#NOTE: ORDER IS IMPORTANT! May get 0xC000000f error if order is wrong or wrong bootmg!\n#use wimboot --pause to see any error ( also --rawbcd --rawwim --index\u003d1 --gui )\n#enclose in \"\" if name\\path contains spaces\n#allow wimboot to find bootmg file (usually works better)\n  wimboot --pause \\\n  @:\"startup.bat\":\"(hd0,2)/wimboot/startup.bat\" \\\n  @:\"winpeshl.ini\":\"(hd0,2)/wimboot/winpeshl.ini\" \\\n  @:\"null.cfg\":\"(hd0,2)/wimboot/null.cfg\" \\\n  @:\"boot.wim\":\"(loop)/sources/boot.wim\" \\\n#  @:\"bootmgfw.efi\":\"(loop)/efi/boot/$bootmg\" \\\n  @:\"bcd\":\"(loop)/efi/microsoft/boot/bcd\"  \\\n  @:\"boot.sdi\":\"(loop)/boot/boot.sdi\"\n  boot\n}\n```\n\nget this error:\n\n```\nfile 1: startup.bat path: (hd0,2)/wimboot/startup.bat\nfile 2: winpeshl.ini path: (hd0,2)/wimboot/ winpeshl.ini\nfile 3: null.cfg path: (hd0,2)/wimboot/null.cfg\nerror: no server is specified.\nerror: you need to load the kernel first.\n\nPress any key to continue...\n```\n\n\u003cbr /\u003e\n\n"
    },
    {
      "id": "212036",
      "timestamp": "2019-07-04T12:39:54+00:00",
      "author": "steve6375",
      "content": "you need to use loop and load the ISO first, obviously !!! Add this first\n\n```\nloopback loop (hd0,msdos2)/images/Win10_1903_x64.iso\n```\n\nAlso your line is wrong - I gave you an example!!! You have...\n\n```\nset installiso\u003d\"(hd0,2)/images/win10_1903_x64.iso\"\n```\n\nit should be:\n\n```\nset installiso\u003d\"/images/win10_1903_x64.iso\"\n```\n\n\u003cbr /\u003e\n\n"
    },
    {
      "id": "212037",
      "timestamp": "2019-07-04T12:47:56+00:00",
      "author": "nierewa",
      "content": "Upps... sorry ![:wub:](https://reboot.pro/public/style_emoticons/default/wub.png)\n\nNow it it:\n\n```\nloopback loop (hd0,msdos2)/images/Win10_1903_x64.iso\nset installiso\u003d\"(hd0,2)/images/win10_1903_x64.iso\"\nsave_env -f (hd0,2)/wimboot/null.cfg installiso\ncat (hd0,2)/wimboot/null.cfg\nread\n#NOTE: ORDER IS IMPORTANT! May get 0xC000000f error if order is wrong or wrong bootmg!\n#use wimboot --pause to see any error ( also --rawbcd --rawwim --index\u003d1 --gui )\n#enclose in \"\" if name\\path contains spaces\n#allow wimboot to find bootmg file (usually works better)\nwimboot --pause \\\n@:\"startup.bat\":\"(hd0,2)/wimboot/startup.bat\" \\\n@:\"winpeshl.ini\":\"(hd0,2)/wimboot/winpeshl.ini\" \\\n@:\"null.cfg\":\"(hd0,2)/wimboot/null.cfg\" \\\n@:\"boot.wim\":\"(loop)/sources/boot.wim\" \\\n# @:\"bootmgfw.efi\":\"(loop)/efi/boot/$bootmg\" \\\n@:\"bcd\":\"(loop)/efi/microsoft/boot/bcd\" \\\n@:\"boot.sdi\":\"(loop)/boot/boot.sdi\"\nboot\n}\n```\n\nerror is:\n\n```\nFound USB DRIVE AT DRIVE G:\nLooking for X:\\Windows\\System32\\null.cfg contents...\n#GRUB Enviroment Block\ninstalliso\u003d(hd0,2)/images/Win10_1903_x64.iso\n#############################################################################\n#############################################################################\n#############################################################################\n#############################################################################\n#############################################################################\n#############################################################################\n#############################################################################\n#############################################################################\n#############################################################################\n#############################################################################\n####ERROR: Can\u0027t find G:INVALID_ISO_NAME.ISO\n```\n\nHave I have to change null.cfg or startup.bat?\n\n**Edited by nierewa, 04 July 2019 - 12:51 PM.**\n"
    },
    {
      "id": "212038",
      "timestamp": "2019-07-04T12:48:41+00:00",
      "author": "steve6375",
      "content": "See previous post!!\n\n"
    },
    {
      "id": "212039",
      "timestamp": "2019-07-04T13:08:25+00:00",
      "author": "nierewa",
      "content": "It works now ![:hyper:](https://reboot.pro/public/style_emoticons/default/hyper.gif)\n\nI love you man.\n\nThere\u0027s just one thing to do...\n\nThe main.cfg looks like this\n\n```\n### Start WinPE\nif [ -n \"$pc\" ]; then\nif [ -f /AIO/Menu/WinLegacy ]; then\nmenuentry \"[p] WinPE \u0026 Setup\" --hotkey\u003dp {\n\tWinLegacy\n}\nfi\nelif [ [ \"${grub_cpu}\" \u003d\u003d \"x86_64\" ] -a [ -f /EFI/Microsoft/Boot/BCD ] ]\t\\\n-o\t\\\n[ [ \"${grub_cpu}\" \u003d\u003d \"i386\" ] -a [ -f /EFI/Microsoft/Boot/B86 ] ] ; then\nmenuentry \"[p] WinPE \u0026 Setup\" --hotkey\u003dp {\n\tWinUEFI\n}\nfi\n### End WinPE\n### Start \\AIO\\Menu\\Linux.cfg\nmenuentry \"[3] Linux OS\" --hotkey\u003d3 {\n\tconfigfile /AIO/Menu/Linux.cfg\n}\n### End \\AIO\\Menu\\Linux.cfg\n### Start \\AIO\\Menu\\Antivirus.cfg\nmenuentry \"[4] ${av}\" --hotkey\u003d4 {\n\tconfigfile /AIO/Menu/Antivirus.cfg\n}\n### End \\AIO\\Menu\\Antivirus.cfg\n### Start \\AIO\\Menu\\Dos.cfg\nmenuentry \"[5] ${dos}\" --hotkey\u003d5 {\n\tconfigfile /AIO/Menu/Dos.cfg\n}\n### End \\AIO\\Menu\\Dos.cfg\n### Start \\AIO\\Menu\\BackupRecovery.cfg\nmenuentry \"[2] ${br}\" --hotkey\u003d2 {\n\tconfigfile /AIO/Menu/BackupRecovery.cfg\n}\n### End \\AIO\\Menu\\BackupRecovery.cfg\n```\n\nI add this entries to grub.cfg and it work but not the first entry the ### Start WinPE block.  \nNothing happens when I hit ENTER.\n\n"
    },
    {
      "id": "212040",
      "timestamp": "2019-07-04T13:35:25+00:00",
      "author": "steve6375",
      "content": "What is \u0027WinUEFI\u0027 - is it some magic command?\n\n"
    },
    {
      "id": "212041",
      "timestamp": "2019-07-04T13:51:53+00:00",
      "author": "nierewa",
      "content": "This my friend is the question.  \nI found in AIO/Menu a WinLegacy file (don\u0027t know what this is for) and a WinLegacy.cfg\n\nIs there a way to load main.cfg with the new grubx64.efi?\n\nOr maybe a way to choose on USB start which grubx64.efi I wan\u0027t use?\n\n"
    },
    {
      "id": "212042",
      "timestamp": "2019-07-04T13:55:43+00:00",
      "author": "steve6375",
      "content": "You need to post the complete menu you are using.\n\n"
    },
    {
      "id": "212043",
      "timestamp": "2019-07-04T13:59:56+00:00",
      "author": "steve6375",
      "content": "The grubx64.efi will load \\\\boot\\\\grub\\\\grub.cfg\n\nso you need to point it at the AIO boot menu\n\nSo you can add to the **bottom**of the grub.cfg menu in post #58\n\n```\nmenuentry \"AIO Menu\" {\nconfigfile /AIO/grub/grub.cfg\n}\n```\n\nor maybe main.cfg (depends what is in grub.cfg).\n\n"
    },
    {
      "id": "212052",
      "timestamp": "2019-07-05T09:29:13+00:00",
      "author": "nierewa",
      "content": "You are right.\n\nI use the old grubx64.efi so it loads the AIO menu.\n\nI rename main.cfg and it also loads the AIO menu.  \nThen I rename grub.cfg in /AIO/grub and grub shell appears.\n\nSo it use the /AIO/grub/grub.cfg, right?\n\ngrub.cfg in /AIO/grub:\n\n```\n#\n# DO NOT EDIT THIS FILE\n#\n# It is automatically generated by grub2-mkconfig using templates\n# from /etc/grub.d and settings from /etc/default/grub\n#\n\n### BEGIN /etc/grub.d/00_header ###\t\nif [ -s $prefix/grubenv ]; then\n  load_env\nfi\n\nif [ \"${next_entry}\" ] ; then\n   set default\u003d\"${next_entry}\"\n   set next_entry\u003d\n   save_env next_entry\n   set boot_once\u003dtrue\nelse\n   set default\u003d\"0\"\nfi\n\nif [ x\"${feature_menuentry_id}\" \u003d xy ]; then\n  menuentry_id_option\u003d\"--id\"\nelse\n  menuentry_id_option\u003d\"\"\nfi\n\nexport menuentry_id_option\n\nif [ \"${prev_saved_entry}\" ]; then\n  set saved_entry\u003d\"${prev_saved_entry}\"\n  save_env saved_entry\n  set prev_saved_entry\u003d\n  save_env prev_saved_entry\n  set boot_once\u003dtrue\nfi\n\nfunction savedefault {\n  if [ -z \"${boot_once}\" ]; then\n    saved_entry\u003d\"${chosen}\"\n    save_env saved_entry\n  fi\n}\n\nfunction load_video {\n  if [ x$feature_all_video_module \u003d xy ]; then\n    insmod all_video\n  else\n    insmod efi_gop\n    insmod efi_uga\n    insmod ieee1275_fb\n    insmod vbe\n    insmod vga\n    insmod video_bochs\n    insmod video_cirrus\n  fi\n}\n\nif [ -z \"$bgloaded\" ]; then\n\tif [ -z \"${font}\" ]; then\n\t\tif [ -e ${prefix}/fonts/fonts.cfg ]; then source ${prefix}/fonts/fonts.cfg; else font\u003dunicode-small; fi\n\tfi\n\tif loadfont $font ; then\n\t\texport font\n\t\t#set gfxmode\u003d1024x768x32,1024x768x24,1024x768x16,1024x768,auto\n\t\t#set gfxpayload\u003dkeep\n\t\tload_video\n\t\tinsmod gfxterm\n\t\tterminal_output gfxterm\n\t\tif [ -z \"${bg}\" ]; then\n\t\t\tif [ -e ${prefix}/background.cfg ]; then source ${prefix}/background.cfg;\n\t\t\telse\n\t\t\t\tbg\u003d\"splash.png\"\n\t\t\t\texport bg\n\t\t\t\tsave_env bg\n\t\t\tfi\n\t\telse export bg; fi\n\t\tinsmod png\n\t\tinsmod jpeg\n\t\tbackground_image -m stretch \"${prefix}/themes/${bg}\"\n\t\tset bgloaded\u003d\"ok\"\n\t\texport bgloaded\n\tfi\nfi\nif [ x$feature_timeout_style \u003d xy ] ; then\n  set timeout_style\u003dmenu\n  set timeout\u003d15\n# Fallback normal timeout code in case the timeout_style feature is\n# unavailable.\nelse\n  set timeout\u003d15\nfi\n\nif [ \"${grub_platform}\" \u003d\u003d \"efi\" ]; then\n\tset efi\u003d1\n\texport efi\n\tif [ \"${grub_cpu}\" \u003d\u003d \"x86_64\" ]; then\n\t\tset _SPEC_UEFI_ARCH\u003d\"x64\"\n\telse\n\t\tset _SPEC_UEFI_ARCH\u003d\"ia32\"\n\tfi\nfi\nif [ \"${grub_platform}\" \u003d\u003d \"pc\" ]; then\n\tset pc\u003d1\n\tset memdisk\u003d\"(${root})/AIO/Tools/memdisk\"\n\texport pc\n\texport memdisk\nfi\n\nif cpuid -l; then\n\tset _SPEC_ARCH\u003d\"64\"\n\tset _SPEC_ARCH_BIT\u003d\"64-bit\"\nelse\n\tset _SPEC_ARCH\u003d\"32\"\n\tset _SPEC_ARCH_BIT\u003d\"32-bit\"\nfi\nset menudir\u003d\"(${root})/AIO/Menu\"\n\nexport _SPEC_ARCH\nexport _SPEC_UEFI_ARCH\nexport _SPEC_ARCH_BIT\nexport menudir\n\nprobe -l -s rootlabel $root\nprobe -u -s rootuuid $root\nprobe -p -s scheme $root\nprobe -f -s fs $root\nexport rootlabel\nexport rootuuid\nexport scheme\nexport fs\n\nif [ \"${fs}\" \u003d\u003d \"iso9660\" ]; then set cd\u003d1; export cd; fi\n\nif [ -e ${prefix}/Password.cfg ]; then\n\tsource ${prefix}/Password.cfg\nfi\nsource ${prefix}/locale/Lang.cfg\nsource ${prefix}/Functions.cfg\nsource ${prefix}/Main.cfg\n\n### END /etc/grub.d/00_header ###\n\n### BEGIN /etc/grub.d/10_linux ###\n\n### END /etc/grub.d/10_linux ###\n\n### BEGIN /etc/grub.d/20_linux_xen ###\n### END /etc/grub.d/20_linux_xen ###\n\n### BEGIN /etc/grub.d/30_os-prober ###\n### END /etc/grub.d/30_os-prober ###\n\n### BEGIN /etc/grub.d/40_custom ###\n# This file provides an easy way to add custom menu entries.  Simply type the\n# menu entries you want to add after this comment.  Be careful not to change\n# the \u0027exec tail\u0027 line above.\n### END /etc/grub.d/40_custom ###\n\n### BEGIN /etc/grub.d/41_custom ###\n#if [ -f  ${config_directory}/custom.cfg ]; then\n#  source ${config_directory}/custom.cfg\n#elif [ -z \"${config_directory}\" -a -f  $prefix/custom.cfg ]; then\n#  source $prefix/custom.cfg;\n#fi\n### END /etc/grub.d/41_custom ###\n\n```\n\nWhen I used it with\n\nmenuentry \"AIO Menu\" {  \nconfigfile /AIO/grub/grub.cfg  \n}\n\nan error appears. I think it doesn\u0027t find nesessary files.  \nCan I point menu folder to /AIO/grub?\n\nP.S. I guess I could copy the whole /AIO/grub folder to /Boot/grub, but that\u0027d be a waste of disk space.  \n\n"
    },
    {
      "id": "212053",
      "timestamp": "2019-07-05T09:41:56+00:00",
      "author": "steve6375",
      "content": "You must use the new grubx64.efi.\n\nit will load for \\\\boot\\\\grub\\\\grub.cfg\n\nthen set the $prefix to the AIO folder\n\n**\\\\boot\\\\grub\\\\grub.cfg**\n\n```\nset prefix\u003d($root)/AIO/grub\nconfigfile $prefix/grub.cfg\n```\n\nyou can add your wimboot menus into the \\\\AIO\\\\grub\\\\grub.cfg file or the \\\\AIO\\\\grub\\\\Main.cfg file.\n\n\\[Edit\\] changed $root to ($root).\n\n**Edited by steve6375, 05 July 2019 - 03:11 PM.**\n"
    },
    {
      "id": "212055",
      "timestamp": "2019-07-05T10:47:51+00:00",
      "author": "nierewa",
      "content": "Hi Steve.\n\nIf I do so Minimal Bash appears\n\nGrub.cfg in /boot/grub\n\n```\nset prefix\u003d$root/AIO/grub\nconfigfile $prefix/grub.cfg\n```\n\nIs anything wrong or missing?\n\n\u003e You must use the new grubx64.efi.\n\nWithout a doubt ![:D](https://reboot.pro/public/style_emoticons/default/biggrin.png)\n\n**Edited by nierewa, 05 July 2019 - 10:50 AM.**\n"
    },
    {
      "id": "212056",
      "timestamp": "2019-07-05T10:49:17+00:00",
      "author": "steve6375",
      "content": "type\n\n```\nset\n```\n\nan look at the values of prefix and root\n\nchange them if they look wrong using\n\n```\nset xxxx\u003dyyyyy\n```\n\nand then type\n\n```\nnormal\n```\n\nto see if it now works\n\n"
    },
    {
      "id": "212057",
      "timestamp": "2019-07-05T10:51:53+00:00",
      "author": "steve6375",
      "content": "P.S. try\n\n```\nset prefix\u003d($root)/AIO/grub\n```\n\n\u003cbr /\u003e\n\n"
    },
    {
      "id": "212058",
      "timestamp": "2019-07-05T10:58:00+00:00",
      "author": "nierewa",
      "content": "Prefix\u003dhd0,msdos1/AIO/grub  \nroot\u003dhd0,msdos1\n\nHmm, That\u0027s correct.\n\nShould actually work. ??\n\n"
    },
    {
      "id": "212059",
      "timestamp": "2019-07-05T10:59:06+00:00",
      "author": "steve6375",
      "content": "no needs parentheses\n\n($root) not $root\n\n"
    },
    {
      "id": "212060",
      "timestamp": "2019-07-05T10:59:15+00:00",
      "author": "nierewa",
      "content": "Your to fast for me ![:D](https://reboot.pro/public/style_emoticons/default/biggrin.png)\n\nThat works.\n\n"
    },
    {
      "id": "212061",
      "timestamp": "2019-07-05T11:05:04+00:00",
      "author": "nierewa",
      "content": "Many thanks to you Steve.  \nI would never have managed that alone.  \nYou are the best of all ![:worship:](http://reboot.pro/public/style_emoticons/default/worship.gif)\n\n![:yahoo:](http://reboot.pro/public/style_emoticons/default/yahoo.gif) ![:party_time:](http://reboot.pro/public/style_emoticons/default/signsandflags30.gif) ![:cheers:](http://reboot.pro/public/style_emoticons/default/cheers.gif)\n\n"
    }
  ]
}