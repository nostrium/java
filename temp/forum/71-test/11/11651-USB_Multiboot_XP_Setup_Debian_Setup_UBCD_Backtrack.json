{
  "id": "11651",
  "title": "USB Multiboot: XP Setup, Debian Setup, UBCD, Backtrack",
  "isPinned": false,
  "isFirstTopic": false,
  "isLocked": false,
  "tags": [],
  "forumNotes": [
    {
      "id": "101974",
      "timestamp": "2010-06-09T11:42:26+00:00",
      "author": "nodiscc",
      "content": "Hello all,  \ni\u0027ve been trying to build an USB pen drive that would be able to launch the following:  \n\n-Windows XP Setup ISO (custom nLite version, boots on SETUPLDR.bin)  \n-Debian Lenny Setup ISO (boots on g2ldr)  \n-UBCD 5 ISO (boots on isolinux.bin)  \n-Backtrack 4 Final ISO (boots on ??)  \n\nAt first I tried to integrate my XP Setup into UBCD menus, it works but loads the whole (540mb) ISO into ram, and it takes ages.. I\u0027d like to make it as quick as lauching the Setup CD itself.  \n\n```\nLABEL -\n\nMENU LABEL Windows XP Setup\n\nTEXT HELP\n\n Windows XP Setup\n\nENDTEXT\n\nLINUX /boot/syslinux/memdisk\n\nINITRD /ubcd/custom/wxp-sp3.iso\n\nAPPEND iso raw\n```\n\n\u003cbr /\u003e\n\n\u003cbr /\u003e\n\nThen I installed grub4dos on the USB stick and tried the following menu.lst  \n\n```\ntitle WXP SP3 SETUP\n\nfind --set-root /iso/wxp-sp3.iso\n\nmap /iso/wxp-sp3.iso \u0026#40;hd32\u0026#41;\n\nmap --hook\n\nroot \u0026#40;hd32\u0026#41;\n\nchainloader \u0026#40;hd32\u0026#41;\n\n\n\ntitle Debian 5.04 Lenny i386 SETUP\n\nfind --set-root /iso/debian-504-i386.iso\n\nmap /iso/debian-504-i386.iso \u0026#40;hd32\u0026#41;\n\nmap --hook\n\nroot \u0026#40;hd32\u0026#41;\n\nchainloader \u0026#40;hd32\u0026#41;\n\n\n\ntitle Ultimate Boot CD LIVE\n\nfind --set-root /iso/ubcd50.iso\n\nmap /iso/ubcd50.iso \u0026#40;hd32\u0026#41;\n\nmap --hook\n\nroot \u0026#40;hd32\u0026#41;\n\nchainloader \u0026#40;hd32\u0026#41;\n\n\n\ntitle BackTrack 4 Final LIVE\n\nfind --set-root /iso/bt4-final.iso\n\nmap /iso/bt4-final.iso \u0026#40;hd32\u0026#41;\n\nmap --hook\n\nroot \u0026#40;hd32\u0026#41;\n\nchainloader \u0026#40;hd32\u0026#41;\n```\n\n\u003cbr /\u003e\n\nThe XP Setup crashes after the first part (copying files, and then blue screen...), the Backtrack ISO can\u0027t find squashfs, UBC programs do not seem to launch..... did not try with debian but it looks like i\u0027m on the wrong way.  \n\nI\u0027m not quite sure how to do such a multiboot USB.. It\u0027s possible for me to unpack the ISOs on the key, but i\u0027d prefer to keep them in one piece. I\u0027m ready to use other bootloaders though i\u0027d prefer to keep g4d. Do you have any tracks for me to search?..  \n\nThanks in advance   \n"
    },
    {
      "id": "101983",
      "timestamp": "2010-06-09T12:56:58+00:00",
      "author": "Coniferous",
      "content": "Booting from ISOs is incredibly spotty just because they are all made differently. people have varied success with it.  \n\n\"At first I tried to integrate my XP Setup into UBCD menus, it works but loads the whole (540mb) ISO into ram, and it takes ages.. I\u0027d like to make it as quick as launching the Setup CD itself.\"  \n\nSadly the only way you would be able to do something like that would be to extract the contents of the iso and then tell grub to use ntldr to boot. The entry would look something like this...  \n\n\\[codebox\\]title Boot XP find --set-root /ntldr chainloader /ntldr\\[/codebox\\] You could also look into using firadisk to load it into ram, but you said you would like to avoid that. (it takes about 90 seconds for me and my usbboot stick) I also have no found a way to boot backtrack off an ISO either. Extracting it and launching it from grub4dos using a command like the one below should work. \\[codebox\\]title Start BackTrack 4 kernel /boot/vmlinuz BOOT\u003dcasper boot\u003dcasper nopersistent rw quiet vga\u003d0x317  \ninitrd /boot/initrd.gz\\[/codebox\\]  \n\nthat being said, if you find a way to boot BT4 off of an ISO I would be extatic to hear it. I managed to get ubuntu to work using the following command, but it doesn\u0027t translate well to BT  \n\n\\[codebox\\]title Ubuntu LiveCD 10.04  \nfind --set-root /ubuntu.iso  \nmap /ubuntu.iso (0xff)  \nmap --hook  \nroot (0xff)  \nkernel /casper/vmlinuz file\u003d/cdrom/preseed/ubuntu.seed boot\u003dcasper iso-scan/filename\u003d/ubuntu.iso quiet splash --  \ninitrd /casper/initrd.lz  \nboot\\[/codebox\\]   \n"
    },
    {
      "id": "102005",
      "timestamp": "2010-06-09T20:03:49+00:00",
      "author": "nodiscc",
      "content": "Thanks for your reply. I\u0027m ready to forget about botting ISOs directly.. I assume your example will work in my case  \n\n```\ntitle Boot XP\n\nfind --set-root /ntldr\n\nchainloader /ntldr\n```\n\n\u003cbr /\u003e\n\nbut for me it will be  \n\n```\ntitle Boot XP Setup\n\nfind --set-root /winxp/i386/setupldr.bin\n\nchainloader /winxp/i386/setupldr.bin\n```\n\n\u003cbr /\u003e\n\nis there something wrong with that? Should it work with the Debian Cd too? for example  \n\n```\ntitle Boot Debian Setup\n\nfind --set-root /debian/g2ldr\n\nchainloader /debian/g2ldr\n```\n\n\u003cbr /\u003e\n\nis it ok too? can I chainload g2ldr after grub4dos?   \n"
    },
    {
      "id": "102093",
      "timestamp": "2010-06-11T01:07:05+00:00",
      "author": "Coniferous",
      "content": "\"I assume your example will work in my case\"  \n\nIt should. That shouldn\u0027t be a problem if the contents of the CD are extracted to the root of the drive.   \n\n\"is there something wrong with that? Should it work with the Debian Cd too? for example\"  \n\nYes. That won\u0027t work. The linux entry should look something like this...  \n\n\\[codebox\\]title debian  \nkernel /boot/vmlinuz BOOT\u003dcasper boot\u003dcasper persistent rw quiet   \ninitrd /boot/initrd.gz  \n\\[/codebox\\]  \n\nLook inside the ISO and see where the kernel and the inital ramdisk reside and update the menu entry to reflect that.   \n\n\"is it ok too? can I chainload g2ldr after grub4dos?\"  \nI\u0027m not 100% sure to be honest.   \n"
    },
    {
      "id": "102197",
      "timestamp": "2010-06-12T19:02:12+00:00",
      "author": "Wonko the Sane",
      "content": "I really cannot see what is the difficult part in these stickies:  \n[http://www.boot-land...?showtopic\u003d8944](http://www.boot-land.net/forums/index.php?showtopic\u003d8944 \"External link\")  \n[http://www.boot-land...?showtopic\u003d5041](http://www.boot-land.net/forums/index.php?showtopic\u003d5041 \"External link\")  \n\nI\u0027ll try again.  \n\nIf you are a newbie, you should search here first:  \n[http://www.boot-land...?showtopic\u003d5041](http://www.boot-land.net/forums/index.php?showtopic\u003d5041 \"External link\")  \nand then on the board more generally if the particular item you want to boot has been ALREADY found to be bale to be booted AND there is a specific setting/report.  \n\nIf it isn\u0027t there, you WON\u0027T be able to boot it through direct grub4dos .iso mapping ![:D](http://reboot.pro/public/style_emoticons/default/biggrin.png) (until you are not a newbie anymore :smile: and you will find the needed changes or settings).  \n\nIn other words half the world is ASSUMING that \"ANY\" .iso will work with a direct .iso to (hd32) or (0xff) mapping.  \n\nThis is NOT the case.  \n\nMOST .iso\u0027s WON\u0027T work without specific changes or specific menu.lst entries.  \n\nHopefully the given thread lists the settings that have been found as working for some known items/distro\u0027s.  \n\nIf your distro is not there, it is more likely that it won\u0027t work than that it will.  \n\n![:D](http://reboot.pro/public/style_emoticons/default/biggrin.png)  \nWonko   \n"
    },
    {
      "id": "147819",
      "timestamp": "2012-02-06T17:25:52+00:00",
      "author": "sorcerer25",
      "content": "this is soooo beautiful that cannot be tru... oops  \n\noh well, thank you for your small guide  \njust one problem: it is NOT working to install debian  \ni mean, yeah, it will boot that iso, but (a very obvious OFC) it won\u0027t detect CD, and unlike ubuntu  \nwon\u0027t help if you know where kernel is, be cause you still gonna hang at CD detection  \nubuntu don\u0027t have that step in install, but when is about servers ... i don\u0027t REALLY like ubuntu :smile:  \n\nas a hacker i did try to trick it, by mounting manually the iso from inside setup  \nalso not working, debian small setup don\u0027t have module for loopback devices ![:(](http://reboot.pro/public/style_emoticons/default/sad.png)  \ntaking it one step more ... it may work if manually get the module for loopback and mount iso  \nthis is already too much trouble ...  \n\nso, is there any way to install debian from an iso on a USB stick ?  \ni can\u0027t find any useful documentation anywhere on google ![:(](http://reboot.pro/public/style_emoticons/default/sad.png)   \n"
    },
    {
      "id": "147821",
      "timestamp": "2012-02-06T18:06:52+00:00",
      "author": "ilko",
      "content": "\u003e ...so, is there any way to install debian from an iso on a USB stick ?\n[http://www.msfn.org/...post__p__977543](http://www.msfn.org/board/topic/120444-how-to-install-windows-from-usb-winsetupfromusb-with-gui/page__view__findpost__p__977543 \"External link\")  \n\nLook at 2).  \n\n\u003e 2) Get initrd and kernel for installing from hd-media:  \n\u003e [http://ftp.nl.debian...mages/hd-media/](http://ftp.nl.debian.org/debian/dists/squeeze/main/installer-i386/current/images/hd-media/ \"External link\")  \n\u003e [http://ftp.nl.debian...media/initrd.gz](http://ftp.nl.debian.org/debian/dists/squeeze/main/installer-i386/current/images/hd-media/initrd.gz \"External link\")  \n\u003e [http://ftp.nl.debian...d-media/vmlinuz](http://ftp.nl.debian.org/debian/dists/squeeze/main/installer-i386/current/images/hd-media/vmlinuz \"External link\")  \n\u003e\n\u003e Put them somewhere on the USB disk, say \\\\debian\\\\  \n\u003e Use the following lines in menu.lst:  \n\u003e\n\u003e ```\n\u003e title Debian install\n\u003e\n\u003e ls /debian/vmlinuz || find --set-root /debian/vmlinuz\n\u003e\n\u003e kernel /debian/vmlinuz\n\u003e\n\u003e initrd /debian/initrd.gz\n\u003e ```\n\u003e\n\u003e Place the appropriate Debain ISO file, that could be netinstall ISO as well, in root of the USB disk, installer will search for it and mount it. No idea if that way multiple ISO files are supported, e.g. CD1, CD2 etc.\n\u003e\n\u003e \u003cbr /\u003e\n\u003e\n\u003cbr /\u003e\n\n"
    },
    {
      "id": "147822",
      "timestamp": "2012-02-06T18:39:58+00:00",
      "author": "sorcerer25",
      "content": "i managed to make it work by downloading and manually add the proper loop.ko module ... and then skip CD detection  \n\ni will try your solution too, thank you :smile:   \n"
    },
    {
      "id": "147827",
      "timestamp": "2012-02-06T21:31:23+00:00",
      "author": "ilko",
      "content": "The method has been supported at least since Debian Etch (4), see A.2.3. Booting from hard disk:  \n[http://www.debian.or.../install.txt.en](http://www.debian.org/releases/etch/arm/install.txt.en \"External link\")  \n\nAll you have to do is to load somehow (grub, grub4dos, syslinux, whatever) the special kernel and initrd, downloaded from the hd-media directory, e.g from here:  \n\n[http://http.us.debia...mages/hd-media/](http://http.us.debian.org/debian/dists/squeeze/main/installer-i386/current/images/hd-media/ \"External link\")  \n\nand put the ISO in the root of the disk, so when installer searches for ISOs, mounts it, checks if it\u0027s Debian CD and continues.  \nIt seems in newer versions initrd scripts support iso-scan/filename kernel parameter, so you can put the ISO in a subdirectory and explicitly define it, haven\u0027t tested that though.  \n\nThis ISO search functionality in initrd is not available in the regular CD/DVD install media, it\u0027s only in the hd-media images.   \n"
    }
  ]
}