{
  "id": "4186",
  "title": "Fast USB 2.0 boot of ramdisk XP",
  "isPinned": false,
  "isFirstTopic": false,
  "isLocked": false,
  "tags": [],
  "forumNotes": [
    {
      "id": "31541",
      "timestamp": "2008-03-17T17:34:29+00:00",
      "author": "kolk",
      "content": "Hello!  \n\nHow to make booting from USB 2.0 faster if BIOS only supports 1.1?  \n\nFor Linux it\u0027s keeping initrd slim.  \nFor DOS it is loading *big ramdisk* after USB 2.0 drivers.  \nFor EWF XP it\u0027s OK ![:thumbsup:](http://reboot.pro/public/style_emoticons/default/thumbsup.gif)  \n\nBut how to do it for XP RAM (SDI or IMA) booting?  \nYou can make copies of all pre-big-switch files outside of the image and boot same way as to EWF mode.  \nBut how to load image after the big-switch?  \n\nOr may the solution be loading a bootable SDI from DOS?  \n\nI am trying to kexec SDI (I added SDI format support), but for now it just reboots.  \n[SysLinux](http://remile.free.fr/syslinux/ \"External link\") (I applied the patch to 2.13) loads the same SDI OK.  \n\nThank you!   \n"
    },
    {
      "id": "31572",
      "timestamp": "2008-03-17T21:10:18+00:00",
      "author": "Brito",
      "content": "![:tabletalk:](http://reboot.pro/public/style_emoticons/default/tabletalk.gif)   \n\nHow would an SDI boot straight from DOS and keep memory of the image when the kernel is initiated?  \n\n----  \n\nAs far I see things, the best chance for getting this to work is using the FREELDR from the ReactOS code to provide the SDI boot capability and also add support for USB 2.0 drivers.  \n\n[http://en.wikipedia....startup_process](http://en.wikipedia.org/wiki/Windows_NT_startup_process \"External link\")  \n[http://www.reactos.o...er_37.html#sec3](http://www.reactos.org/en/newsletter_37.html#sec3 \"External link\")  \n\n![:thumbsup:](http://reboot.pro/public/style_emoticons/default/thumbsup.gif)   \n"
    },
    {
      "id": "31576",
      "timestamp": "2008-03-17T21:19:16+00:00",
      "author": "Galapo",
      "content": "Yes, hopefully we\u0027ll soon be able to ditch 2k3 \u0027setupldr.bin\u0027 for \u0027FREELDR\u0027! We\u0027ll also need a replacement for \u0027ramdisk.sys\u0027.  \n\nRegards,  \nGalapo.   \n"
    },
    {
      "id": "31579",
      "timestamp": "2008-03-17T21:42:36+00:00",
      "author": "was_jaclaz",
      "content": "\u003e Yes, hopefully we\u0027ll soon be able to ditch 2k3 \u0027setupldr.bin\u0027 for \u0027FREELDR\u0027! We\u0027ll also need a replacement for \u0027ramdisk.sys\u0027.  \n\u003e\n\u003e Regards,  \n\u003e Galapo.\n\nMost probably we don\u0027t ![:thumbsup:](http://reboot.pro/public/style_emoticons/default/thumbsup.gif), there is a report by Bilou Gateux somewhere on the board that he uses successfully a XP version insted of the 2003 one.  \n\nOlof also thinks that IMDISK with small changes could be used as well, check this thread:  \n[http://www.911cd.net...showtopic\u003d19960](http://www.911cd.net/forums//index.php?showtopic\u003d19960 \"External link\")  \n\njaclaz   \n"
    },
    {
      "id": "31625",
      "timestamp": "2008-03-18T10:01:51+00:00",
      "author": "kolk",
      "content": "\u003e ![:tabletalk:](http://reboot.pro/public/style_emoticons/default/tabletalk.gif)   \n\u003e\n\u003e How would an SDI boot straight from DOS and keep memory of the image when the kernel is initiated?\n\nWhich of kernels?  \nDOS kernel was loaded before SDI.  \nThen SDI is loaded with grub4dos (with map command, if it is able to use filesystem or disk drivers provided by DOS instead of BIOS ones) or in LoadLIN way. When control is transferred to SDI (or ntldr inside IMA), we can forget about DOS.  \nFollowing then this is known good process ![:thumbsup:](http://reboot.pro/public/style_emoticons/default/thumbsup.gif)  \n[SDI RAM boot](http://msdn2.microsoft.com/en-us/library/ms838543.aspx \"External link\")   \n"
    },
    {
      "id": "31629",
      "timestamp": "2008-03-18T10:21:29+00:00",
      "author": "was_jaclaz",
      "content": "Please, no, not again. ![:thumbsup:](http://reboot.pro/public/style_emoticons/default/thumbsup.gif)  \n\nPlease do read this:  \n[http://www.boot-land...?...\u003d2692\\\u0026st\u003d26](http://www.boot-land.net/forums/index.php?showtopic\u003d2692\u0026st\u003d26 \"External link\")  \n\n\u003cbr /\u003e\n\nNow, the good news is that we may have a new way for USB booting using native (read USB 2.0) XP drivers, using a \"Kansas City Shuffle\":  \n[http://www.911cd.net...o...c\u003d21242\\\u0026hl\u003d](http://www.911cd.net/forums//index.php?showtopic\u003d21242\u0026hl\u003d \"External link\")  \n\n![:tabletalk:](http://reboot.pro/public/style_emoticons/default/tabletalk.gif)  \n\njaclaz   \n"
    },
    {
      "id": "31641",
      "timestamp": "2008-03-18T12:25:33+00:00",
      "author": "kolk",
      "content": "IMHO, NT Ramdisk can be booted with any OS-independent *filedisk* drivers:  \n1. OS-independent filedisk provides **int 13**   \n2. **ntldr** loads **/rdpath\u003d\\*.ima** inside that filedisk into RAM and serves it  \n3. after the big-switch, \"internal\" .ima is served by *Ramdisk.sys*   \n4. IMHO, OS-independent *memdisk* can be used too, but after step 3 we will have two in-memory copies of the image. Maybe first copy is gone after step 3.   \n"
    },
    {
      "id": "31642",
      "timestamp": "2008-03-18T12:33:56+00:00",
      "author": "kolk",
      "content": "\u003e Now, the good news is that we may have a new way for USB booting using native (read USB 2.0) XP drivers, using a \"Kansas City Shuffle\":  \n\u003e [http://www.911cd.net...o...c\u003d21242\\\u0026hl\u003d](http://www.911cd.net/forums//index.php?showtopic\u003d21242\u0026hl\u003d \"External link\")  \n\u003e\n\u003e ![:tabletalk:](http://reboot.pro/public/style_emoticons/default/tabletalk.gif)  \n\u003e\n\u003e jaclaz\n\nThis hack is placing pre-big-switch files into ramdisk, I\u0027m asking for opposite ![:thumbsup:](http://reboot.pro/public/style_emoticons/default/thumbsup.gif)   \n"
    },
    {
      "id": "31643",
      "timestamp": "2008-03-18T12:38:40+00:00",
      "author": "was_jaclaz",
      "content": "Well, no, you need anyway a NT driver, which is the missing step ![:tabletalk:](http://reboot.pro/public/style_emoticons/default/tabletalk.gif).  \n\nMaybe deeply modifying memdisk to be used as RAMDISK.SYS may work, but cannot say, the modifications will make it become a NT kernel driver, and so we are back to square one, that originated the search for a filedisk/ramdisk driver.....  \n[http://www.boot-land...vers-t1507.html](http://www.boot-land.net/forums/RAMdisk-and-FILEdisk-drivers-t1507.html \"External link\")   \n\nBesides the already linked to thread on IMDISK, there is also this one:  \n[http://www.boot-land...?...ic\u003d1441\\\u0026hl\u003d](http://www.boot-land.net/forums/index.php?showtopic\u003d1441\u0026hl\u003d \"External link\")  \nwhich was the one I was referring to earlier where the finding by **bilou gateux** is referenced and this one:  \n[http://www.boot-land...?showtopic\u003d3142](http://www.boot-land.net/forums/index.php?showtopic\u003d3142 \"External link\")  \n(just fixed the links corrupted by the \"stupid\" board update)  \n\nHowever, the \"fast USB 2.0\" boot is now solved using **s4e** \u0027s/**Dietmar** \u0027s method referenced above, it is still very experimental, but it does work, I know you are asking for something different, but AFAIK the solution you want, the way you want, does not exist (yet ![:thumbsup:](http://reboot.pro/public/style_emoticons/default/thumbsup.gif)) so I am just giving you what is available.  \n\njaclaz   \n"
    },
    {
      "id": "31648",
      "timestamp": "2008-03-18T13:09:32+00:00",
      "author": "kolk",
      "content": "IMHO, the solution is simpler.  \n\nLets assume that we will use *Ramdisk.sys* as NT driver.  \nAnd that ramdisk is just flat memory region containing a file system.  \n\nAll we have to do is to pass it\u0027s start address to ntldr.  \n(I think to real-mode portion).  \n\nThere is one documented way: use 3-BLOB SDI.  \nI think other ways exist (0x41 is not the only flag checked by *Startrom.com* at very beginning,  \nand may be it could point not only to \u0027$SDI0001\u0027).  \n\nBut even 3-BLOB SDI is enough, we can hack, say, *LoadLIN* , to support it\u0027s format or just convert SDI to *bzImage* format:  \n1. Put Microsoft\u0027s sample loader in front of SDI to make it linux *System* -like.  \n2. Remove unneeded code from *Setup* .  \n3. Run through remaining steps of make *bzImage* (System-\\\u003ezSystem-\\\u003ebzImage).  \nOr hack Anvin\u0027s *memdisk* to *not contain* the **int 13** handler but instead pass control to an SDI BOOT BLOB.   \n"
    },
    {
      "id": "31650",
      "timestamp": "2008-03-18T13:51:18+00:00",
      "author": "was_jaclaz",
      "content": "Yep, everything is possible, and the approach you describe is simpler, ![:thumbsup:](http://reboot.pro/public/style_emoticons/default/thumbsup.gif) or to be more exact, it will be simpler when you\u0027ll have found a way to make it work, as a \"general\" solution.  \n\nUsing Ramdisk.sys is actually pointless, as I see it, as it is limited anyway to 512 Mbytes and however there will be memory (RAM) requirements that will make a RAM based solution unusable on older machines, which quite coincidentally are those that have only USB 1.1 support.  \n\nThe \"right\" way as I see it is using a \"filedisk\" driver that has not such limits, but in this particular context, (using USB 2.0 drive speed on motherboards that only have BIOS support for 1.1) BOTH approaches are pointless ![:tabletalk:](http://reboot.pro/public/style_emoticons/default/tabletalk.gif), what you need is to find a way to load USB 2.0 speed enabled drivers to access the USB device, i.e. find a way to speed READING independently from where the data will be written to.  \n\njaclaz   \n"
    },
    {
      "id": "31780",
      "timestamp": "2008-03-20T14:31:59+00:00",
      "author": "ktp",
      "content": "Thanks to this thread I discover the problem of slow USB 1.1 booting with some BIOS.  \nI use BartPE/VistaPE image (.ima) booting method (200 MB). On one machine (6-year old, 512MB RAM) it boots very fast, on the  \nother (newer, 2 GB RAM, 2007) it takes really long !  \n\nBut booting Knoppix is OK (fast) on both machines.  \nBooting XP is a little slow at the beginning on the newer machine (the blank progression bar at about 1/10), then afterwards it progresses quickly. XP booting is real fast on older machine.  \n\nFrom the information in this thread, I understand that probably Knoppix loads USB 2.0 driver at the very beginning, and so probably XP does.  \nBartPE/WinPE probably loads USB 2.0 drivers at the end, so the 200 MB ima file has to be read entirely first.  \n\nIs this correct ?   \n"
    },
    {
      "id": "31782",
      "timestamp": "2008-03-20T14:50:15+00:00",
      "author": "kolk",
      "content": "Yes, you are right!  \n\nFor Knoppix the USB 2.0 (EHCI) driver is in small initrd image.  \nFor XP there is relatively short list of files loaded before switching to 2.0 drivers:  \n[http://www.911cd.net...o...c\u003d21242\\\u0026hl\u003d](http://www.911cd.net/forums//index.php?showtopic\u003d21242\u0026hl\u003d \"External link\")  \n\nBut for loading .iso or .ima or .sdi we depend on BIOS. ![:thumbsup:](http://reboot.pro/public/style_emoticons/default/thumbsup.gif)  \nAt that point the only loaded file is **ntldr** which contains no block device drivers.   \n"
    },
    {
      "id": "31784",
      "timestamp": "2008-03-20T14:55:09+00:00",
      "author": "was_jaclaz",
      "content": "\u003e Is this correct ?\n\nPartly.  \n\nIf you use \" .ima\" file, it means you use RAMDISK.SYS.  \nThus the image is first copied to RAM and then booted.  \nThe copying is done by the SETUPLDR.BIN/NTLDR (i.e. during the \"text-mode\" or \"real mode\" part of booting) thus the BIOS routines are used.  \n\nIf the BIOS routines support USB 2.0 speed the copying will be fast, if they use USB 1.1 speed. it will be slow.  \n\njaclaz   \n"
    },
    {
      "id": "31917",
      "timestamp": "2008-03-24T14:41:20+00:00",
      "author": "kolk",
      "content": "Finally I found this post:  \n[http://www.911cd.net...\u003d40#entry138466](http://www.911cd.net/forums//index.php?showtopic\u003d20450\u0026st\u003d40#entry138466 \"External link\")  \nwhich explains how to build 3-media solution:  \n\nStep 1. You insert USB filesystem and DOS floppy. DOS copies filesystem to ramdisk, served by DOS driver.  \nStep 2. You exchange floppy and type \"*boot* \". Then *ntbootdd.sys* serves preloaded ramdisk.   \n"
    },
    {
      "id": "31934",
      "timestamp": "2008-03-24T19:25:48+00:00",
      "author": "ktp",
      "content": "@kolk  \n\nDo you mean that now there is a solution to the slow USB 1.x boot by BIOS ?   \nIf yes, could you put more details on how to do it ?   \n"
    },
    {
      "id": "31964",
      "timestamp": "2008-03-25T08:13:16+00:00",
      "author": "kolk",
      "content": "\u003e @kolk  \n\u003e\n\u003e Do you mean that now there is a solution to the slow USB 1.x boot by BIOS ?   \n\u003e If yes, could you put more details on how to do it ?\n\nIn referred topic it was also noted that **DOS** -\\\u003e**ntldr** switch is possible  \nwith ***debug*** script (I suppose simple load of whole binary to 0:7c00 and then  \njumping here).  \n\nIMHO, switching from BIOS to loadable DOS driver is already solved DOS problem ![:thumbsup:](http://reboot.pro/public/style_emoticons/default/thumbsup.gif)   \n"
    },
    {
      "id": "31965",
      "timestamp": "2008-03-25T08:36:16+00:00",
      "author": "kolk",
      "content": "\u003e IMHO, switching from BIOS to loadable DOS driver is already solved DOS problem ![:thumbsup:](http://reboot.pro/public/style_emoticons/default/thumbsup.gif)\nReally, we have to load DOS FAT ramdisk before copying of NT filesystem to it.  \nSo we can load it just before loading *the DOS drivers* , copy DOS stuff to it  \n(**command.com, [devload](http://www.ibiblio.org/pub/micro/pc-stuff/freedos/files/util/system/devload/ \"External link\")** (sorry, I don\u0027t remember Microsoft\u0027s one) and the drivers). In the next step we load drivers and copy NT, **ntldr** and **debug** to ramdisk.  \nThen we should be able to boot NT.   \n"
    },
    {
      "id": "31966",
      "timestamp": "2008-03-25T08:55:08+00:00",
      "author": "kolk",
      "content": "\u003e In the next step we load drivers and copy NT, **ntldr** and **debug** to ramdisk.\n\nI\u0027m sorry, there is no need to copy **ntldr** and **debug** ![:thumbsup:](http://reboot.pro/public/style_emoticons/default/thumbsup.gif)  \nAlso we can delete *the drivers* and **command.com** from ramdisk after loading.  \nWe can use them residing on source media.   \n"
    },
    {
      "id": "32021",
      "timestamp": "2008-03-26T03:05:35+00:00",
      "author": "windrv",
      "content": "The best way is to buy a machine with fast USB 2.0 support.  \n\nSave the time to earn more money for that!  \n\nComputer hardware is really cheap these days.  \n\nTime is rather precious on the other hand!   \n"
    },
    {
      "id": "32028",
      "timestamp": "2008-03-26T08:08:14+00:00",
      "author": "kolk",
      "content": "\u003e The best way is to buy a machine with fast USB 2.0 support.\n\nThat\u0027s not such simple.  \nI must boot a machine from USB before buying. ![:thumbsup:](http://reboot.pro/public/style_emoticons/default/thumbsup.gif)  \nAnd if I buy a motherboard alone for assembling myself, I don\u0027t know how to check ![:tabletalk:](http://reboot.pro/public/style_emoticons/default/tabletalk.gif)  \n\nCould you point us to table which shows presence of **EHCI *BIOS*** for different models \\\u0026 manufacturers? ![:D](http://reboot.pro/public/style_emoticons/default/biggrin.png)  \nBecause some manufacturers can stay long with UHCI-only BIOS...  \nOr may be even with UHCI drivers over SMM-emulated UHCI over EHCI-only hardware.   \n"
    },
    {
      "id": "32029",
      "timestamp": "2008-03-26T08:09:38+00:00",
      "author": "was_jaclaz",
      "content": "\u003e Time is rather precious on the other hand!\n\nA very good reason NOT to waste some of yours posting advice on what other people should do with theirs. ![:thumbsup:](http://reboot.pro/public/style_emoticons/default/thumbsup.gif)  \n\nMost of the time spent here on projects is \"fun\" time, even if it\u0027s not commercially or economically a smart idea, it is something most people do as a hobby, to learn and experiment something.  \n\nSometimes it is not important where you arrive, but how you got there. ![:tabletalk:](http://reboot.pro/public/style_emoticons/default/tabletalk.gif)  \n\njaclaz   \n"
    },
    {
      "id": "32032",
      "timestamp": "2008-03-26T09:12:30+00:00",
      "author": "windrv",
      "content": "\u003e That\u0027s not such simple.  \n\u003e I must boot a machine from USB before buying. ![:thumbsup:](http://reboot.pro/public/style_emoticons/default/thumbsup.gif)  \n\u003e And if I buy a motherboard alone for assembling myself, I don\u0027t know how to check ![:tabletalk:](http://reboot.pro/public/style_emoticons/default/tabletalk.gif)  \n\u003e\n\u003e Could you point us to table which shows presence of **EHCI *BIOS*** for different models \\\u0026 manufacturers? ![:D](http://reboot.pro/public/style_emoticons/default/biggrin.png)  \n\u003e Because some manufacturers can stay long with UHCI-only BIOS...  \n\u003e Or may be even with UHCI drivers over SMM-emulated UHCI over EHCI-only hardware.\n\nMay be The Finder could help you in this respect.   \n"
    },
    {
      "id": "32034",
      "timestamp": "2008-03-26T09:25:39+00:00",
      "author": "windrv",
      "content": "\u003e A very good reason NOT to waste some of yours posting advice on what other people should do with theirs. ![:thumbsup:](http://reboot.pro/public/style_emoticons/default/thumbsup.gif)  \n\u003e\n\u003e Most of the time spent here on projects is \"fun\" time, even if it\u0027s not commercially or economically a smart idea, it is something most people do as a hobby, to learn and experiment something.  \n\u003e\n\u003e Sometimes it is not important where you arrive, but how you got there. ![:tabletalk:](http://reboot.pro/public/style_emoticons/default/tabletalk.gif)  \n\u003e\n\u003e jaclaz\n\nYes! That is good for amusement and education purpose and as a hobby.  \n\nSpending a little of my time on advising lots of people not wasting their precious time is an act out of my good motive! may be you could construe it otherwise.   \n"
    },
    {
      "id": "32233",
      "timestamp": "2008-03-30T14:51:30+00:00",
      "author": "ktp",
      "content": "\u003e I\u0027m sorry, there is no need to copy **ntldr** and **debug** ![:thumbsup:](http://reboot.pro/public/style_emoticons/default/thumbsup.gif)  \n\u003e Also we can delete *the drivers* and **command.com** from ramdisk after loading.  \n\u003e We can use them residing on source media.\n\nSo to summarize, finally is there a solution to boot BartPE from USB key with USB 2.0 speed while the BIOS boots only with USB 1.0/1.1 speed ?   \n"
    },
    {
      "id": "31541",
      "timestamp": "2008-03-17T17:34:29+00:00",
      "author": "kolk",
      "content": "Hello!  \n\nHow to make booting from USB 2.0 faster if BIOS only supports 1.1?  \n\nFor Linux it\u0027s keeping initrd slim.  \nFor DOS it is loading *big ramdisk* after USB 2.0 drivers.  \nFor EWF XP it\u0027s OK ![:thumbsup:](http://reboot.pro/public/style_emoticons/default/thumbsup.gif)  \n\nBut how to do it for XP RAM (SDI or IMA) booting?  \nYou can make copies of all pre-big-switch files outside of the image and boot same way as to EWF mode.  \nBut how to load image after the big-switch?  \n\nOr may the solution be loading a bootable SDI from DOS?  \n\nI am trying to kexec SDI (I added SDI format support), but for now it just reboots.  \n[SysLinux](http://remile.free.fr/syslinux/ \"External link\") (I applied the patch to 2.13) loads the same SDI OK.  \n\nThank you!   \n"
    },
    {
      "id": "31572",
      "timestamp": "2008-03-17T21:10:18+00:00",
      "author": "Brito",
      "content": "![:tabletalk:](http://reboot.pro/public/style_emoticons/default/tabletalk.gif)   \n\nHow would an SDI boot straight from DOS and keep memory of the image when the kernel is initiated?  \n\n----  \n\nAs far I see things, the best chance for getting this to work is using the FREELDR from the ReactOS code to provide the SDI boot capability and also add support for USB 2.0 drivers.  \n\n[http://en.wikipedia....startup_process](http://en.wikipedia.org/wiki/Windows_NT_startup_process \"External link\")  \n[http://www.reactos.o...er_37.html#sec3](http://www.reactos.org/en/newsletter_37.html#sec3 \"External link\")  \n\n![:thumbsup:](http://reboot.pro/public/style_emoticons/default/thumbsup.gif)   \n"
    },
    {
      "id": "31576",
      "timestamp": "2008-03-17T21:19:16+00:00",
      "author": "Galapo",
      "content": "Yes, hopefully we\u0027ll soon be able to ditch 2k3 \u0027setupldr.bin\u0027 for \u0027FREELDR\u0027! We\u0027ll also need a replacement for \u0027ramdisk.sys\u0027.  \n\nRegards,  \nGalapo.   \n"
    },
    {
      "id": "31579",
      "timestamp": "2008-03-17T21:42:36+00:00",
      "author": "was_jaclaz",
      "content": "\u003e Yes, hopefully we\u0027ll soon be able to ditch 2k3 \u0027setupldr.bin\u0027 for \u0027FREELDR\u0027! We\u0027ll also need a replacement for \u0027ramdisk.sys\u0027.  \n\u003e\n\u003e Regards,  \n\u003e Galapo.\n\nMost probably we don\u0027t ![:thumbsup:](http://reboot.pro/public/style_emoticons/default/thumbsup.gif), there is a report by Bilou Gateux somewhere on the board that he uses successfully a XP version insted of the 2003 one.  \n\nOlof also thinks that IMDISK with small changes could be used as well, check this thread:  \n[http://www.911cd.net...showtopic\u003d19960](http://www.911cd.net/forums//index.php?showtopic\u003d19960 \"External link\")  \n\njaclaz   \n"
    },
    {
      "id": "31625",
      "timestamp": "2008-03-18T10:01:51+00:00",
      "author": "kolk",
      "content": "\u003e ![:tabletalk:](http://reboot.pro/public/style_emoticons/default/tabletalk.gif)   \n\u003e\n\u003e How would an SDI boot straight from DOS and keep memory of the image when the kernel is initiated?\n\nWhich of kernels?  \nDOS kernel was loaded before SDI.  \nThen SDI is loaded with grub4dos (with map command, if it is able to use filesystem or disk drivers provided by DOS instead of BIOS ones) or in LoadLIN way. When control is transferred to SDI (or ntldr inside IMA), we can forget about DOS.  \nFollowing then this is known good process ![:thumbsup:](http://reboot.pro/public/style_emoticons/default/thumbsup.gif)  \n[SDI RAM boot](http://msdn2.microsoft.com/en-us/library/ms838543.aspx \"External link\")   \n"
    },
    {
      "id": "31629",
      "timestamp": "2008-03-18T10:21:29+00:00",
      "author": "was_jaclaz",
      "content": "Please, no, not again. ![:thumbsup:](http://reboot.pro/public/style_emoticons/default/thumbsup.gif)  \n\nPlease do read this:  \n[http://www.boot-land...?...\u003d2692\\\u0026st\u003d26](http://www.boot-land.net/forums/index.php?showtopic\u003d2692\u0026st\u003d26 \"External link\")  \n\n\u003cbr /\u003e\n\nNow, the good news is that we may have a new way for USB booting using native (read USB 2.0) XP drivers, using a \"Kansas City Shuffle\":  \n[http://www.911cd.net...o...c\u003d21242\\\u0026hl\u003d](http://www.911cd.net/forums//index.php?showtopic\u003d21242\u0026hl\u003d \"External link\")  \n\n![:tabletalk:](http://reboot.pro/public/style_emoticons/default/tabletalk.gif)  \n\njaclaz   \n"
    },
    {
      "id": "31641",
      "timestamp": "2008-03-18T12:25:33+00:00",
      "author": "kolk",
      "content": "IMHO, NT Ramdisk can be booted with any OS-independent *filedisk* drivers:  \n1. OS-independent filedisk provides **int 13**   \n2. **ntldr** loads **/rdpath\u003d\\*.ima** inside that filedisk into RAM and serves it  \n3. after the big-switch, \"internal\" .ima is served by *Ramdisk.sys*   \n4. IMHO, OS-independent *memdisk* can be used too, but after step 3 we will have two in-memory copies of the image. Maybe first copy is gone after step 3.   \n"
    },
    {
      "id": "31642",
      "timestamp": "2008-03-18T12:33:56+00:00",
      "author": "kolk",
      "content": "\u003e Now, the good news is that we may have a new way for USB booting using native (read USB 2.0) XP drivers, using a \"Kansas City Shuffle\":  \n\u003e [http://www.911cd.net...o...c\u003d21242\\\u0026hl\u003d](http://www.911cd.net/forums//index.php?showtopic\u003d21242\u0026hl\u003d \"External link\")  \n\u003e\n\u003e ![:tabletalk:](http://reboot.pro/public/style_emoticons/default/tabletalk.gif)  \n\u003e\n\u003e jaclaz\n\nThis hack is placing pre-big-switch files into ramdisk, I\u0027m asking for opposite ![:thumbsup:](http://reboot.pro/public/style_emoticons/default/thumbsup.gif)   \n"
    },
    {
      "id": "31643",
      "timestamp": "2008-03-18T12:38:40+00:00",
      "author": "was_jaclaz",
      "content": "Well, no, you need anyway a NT driver, which is the missing step ![:tabletalk:](http://reboot.pro/public/style_emoticons/default/tabletalk.gif).  \n\nMaybe deeply modifying memdisk to be used as RAMDISK.SYS may work, but cannot say, the modifications will make it become a NT kernel driver, and so we are back to square one, that originated the search for a filedisk/ramdisk driver.....  \n[http://www.boot-land...vers-t1507.html](http://www.boot-land.net/forums/RAMdisk-and-FILEdisk-drivers-t1507.html \"External link\")   \n\nBesides the already linked to thread on IMDISK, there is also this one:  \n[http://www.boot-land...?...ic\u003d1441\\\u0026hl\u003d](http://www.boot-land.net/forums/index.php?showtopic\u003d1441\u0026hl\u003d \"External link\")  \nwhich was the one I was referring to earlier where the finding by **bilou gateux** is referenced and this one:  \n[http://www.boot-land...?showtopic\u003d3142](http://www.boot-land.net/forums/index.php?showtopic\u003d3142 \"External link\")  \n(just fixed the links corrupted by the \"stupid\" board update)  \n\nHowever, the \"fast USB 2.0\" boot is now solved using **s4e** \u0027s/**Dietmar** \u0027s method referenced above, it is still very experimental, but it does work, I know you are asking for something different, but AFAIK the solution you want, the way you want, does not exist (yet ![:thumbsup:](http://reboot.pro/public/style_emoticons/default/thumbsup.gif)) so I am just giving you what is available.  \n\njaclaz   \n"
    },
    {
      "id": "31648",
      "timestamp": "2008-03-18T13:09:32+00:00",
      "author": "kolk",
      "content": "IMHO, the solution is simpler.  \n\nLets assume that we will use *Ramdisk.sys* as NT driver.  \nAnd that ramdisk is just flat memory region containing a file system.  \n\nAll we have to do is to pass it\u0027s start address to ntldr.  \n(I think to real-mode portion).  \n\nThere is one documented way: use 3-BLOB SDI.  \nI think other ways exist (0x41 is not the only flag checked by *Startrom.com* at very beginning,  \nand may be it could point not only to \u0027$SDI0001\u0027).  \n\nBut even 3-BLOB SDI is enough, we can hack, say, *LoadLIN* , to support it\u0027s format or just convert SDI to *bzImage* format:  \n1. Put Microsoft\u0027s sample loader in front of SDI to make it linux *System* -like.  \n2. Remove unneeded code from *Setup* .  \n3. Run through remaining steps of make *bzImage* (System-\\\u003ezSystem-\\\u003ebzImage).  \nOr hack Anvin\u0027s *memdisk* to *not contain* the **int 13** handler but instead pass control to an SDI BOOT BLOB.   \n"
    },
    {
      "id": "31650",
      "timestamp": "2008-03-18T13:51:18+00:00",
      "author": "was_jaclaz",
      "content": "Yep, everything is possible, and the approach you describe is simpler, ![:thumbsup:](http://reboot.pro/public/style_emoticons/default/thumbsup.gif) or to be more exact, it will be simpler when you\u0027ll have found a way to make it work, as a \"general\" solution.  \n\nUsing Ramdisk.sys is actually pointless, as I see it, as it is limited anyway to 512 Mbytes and however there will be memory (RAM) requirements that will make a RAM based solution unusable on older machines, which quite coincidentally are those that have only USB 1.1 support.  \n\nThe \"right\" way as I see it is using a \"filedisk\" driver that has not such limits, but in this particular context, (using USB 2.0 drive speed on motherboards that only have BIOS support for 1.1) BOTH approaches are pointless ![:tabletalk:](http://reboot.pro/public/style_emoticons/default/tabletalk.gif), what you need is to find a way to load USB 2.0 speed enabled drivers to access the USB device, i.e. find a way to speed READING independently from where the data will be written to.  \n\njaclaz   \n"
    },
    {
      "id": "31780",
      "timestamp": "2008-03-20T14:31:59+00:00",
      "author": "ktp",
      "content": "Thanks to this thread I discover the problem of slow USB 1.1 booting with some BIOS.  \nI use BartPE/VistaPE image (.ima) booting method (200 MB). On one machine (6-year old, 512MB RAM) it boots very fast, on the  \nother (newer, 2 GB RAM, 2007) it takes really long !  \n\nBut booting Knoppix is OK (fast) on both machines.  \nBooting XP is a little slow at the beginning on the newer machine (the blank progression bar at about 1/10), then afterwards it progresses quickly. XP booting is real fast on older machine.  \n\nFrom the information in this thread, I understand that probably Knoppix loads USB 2.0 driver at the very beginning, and so probably XP does.  \nBartPE/WinPE probably loads USB 2.0 drivers at the end, so the 200 MB ima file has to be read entirely first.  \n\nIs this correct ?   \n"
    },
    {
      "id": "31782",
      "timestamp": "2008-03-20T14:50:15+00:00",
      "author": "kolk",
      "content": "Yes, you are right!  \n\nFor Knoppix the USB 2.0 (EHCI) driver is in small initrd image.  \nFor XP there is relatively short list of files loaded before switching to 2.0 drivers:  \n[http://www.911cd.net...o...c\u003d21242\\\u0026hl\u003d](http://www.911cd.net/forums//index.php?showtopic\u003d21242\u0026hl\u003d \"External link\")  \n\nBut for loading .iso or .ima or .sdi we depend on BIOS. ![:thumbsup:](http://reboot.pro/public/style_emoticons/default/thumbsup.gif)  \nAt that point the only loaded file is **ntldr** which contains no block device drivers.   \n"
    },
    {
      "id": "31784",
      "timestamp": "2008-03-20T14:55:09+00:00",
      "author": "was_jaclaz",
      "content": "\u003e Is this correct ?\n\nPartly.  \n\nIf you use \" .ima\" file, it means you use RAMDISK.SYS.  \nThus the image is first copied to RAM and then booted.  \nThe copying is done by the SETUPLDR.BIN/NTLDR (i.e. during the \"text-mode\" or \"real mode\" part of booting) thus the BIOS routines are used.  \n\nIf the BIOS routines support USB 2.0 speed the copying will be fast, if they use USB 1.1 speed. it will be slow.  \n\njaclaz   \n"
    },
    {
      "id": "31917",
      "timestamp": "2008-03-24T14:41:20+00:00",
      "author": "kolk",
      "content": "Finally I found this post:  \n[http://www.911cd.net...\u003d40#entry138466](http://www.911cd.net/forums//index.php?showtopic\u003d20450\u0026st\u003d40#entry138466 \"External link\")  \nwhich explains how to build 3-media solution:  \n\nStep 1. You insert USB filesystem and DOS floppy. DOS copies filesystem to ramdisk, served by DOS driver.  \nStep 2. You exchange floppy and type \"*boot* \". Then *ntbootdd.sys* serves preloaded ramdisk.   \n"
    },
    {
      "id": "31934",
      "timestamp": "2008-03-24T19:25:48+00:00",
      "author": "ktp",
      "content": "@kolk  \n\nDo you mean that now there is a solution to the slow USB 1.x boot by BIOS ?   \nIf yes, could you put more details on how to do it ?   \n"
    },
    {
      "id": "31964",
      "timestamp": "2008-03-25T08:13:16+00:00",
      "author": "kolk",
      "content": "\u003e @kolk  \n\u003e\n\u003e Do you mean that now there is a solution to the slow USB 1.x boot by BIOS ?   \n\u003e If yes, could you put more details on how to do it ?\n\nIn referred topic it was also noted that **DOS** -\\\u003e**ntldr** switch is possible  \nwith ***debug*** script (I suppose simple load of whole binary to 0:7c00 and then  \njumping here).  \n\nIMHO, switching from BIOS to loadable DOS driver is already solved DOS problem ![:thumbsup:](http://reboot.pro/public/style_emoticons/default/thumbsup.gif)   \n"
    },
    {
      "id": "31965",
      "timestamp": "2008-03-25T08:36:16+00:00",
      "author": "kolk",
      "content": "\u003e IMHO, switching from BIOS to loadable DOS driver is already solved DOS problem ![:thumbsup:](http://reboot.pro/public/style_emoticons/default/thumbsup.gif)\nReally, we have to load DOS FAT ramdisk before copying of NT filesystem to it.  \nSo we can load it just before loading *the DOS drivers* , copy DOS stuff to it  \n(**command.com, [devload](http://www.ibiblio.org/pub/micro/pc-stuff/freedos/files/util/system/devload/ \"External link\")** (sorry, I don\u0027t remember Microsoft\u0027s one) and the drivers). In the next step we load drivers and copy NT, **ntldr** and **debug** to ramdisk.  \nThen we should be able to boot NT.   \n"
    },
    {
      "id": "31966",
      "timestamp": "2008-03-25T08:55:08+00:00",
      "author": "kolk",
      "content": "\u003e In the next step we load drivers and copy NT, **ntldr** and **debug** to ramdisk.\n\nI\u0027m sorry, there is no need to copy **ntldr** and **debug** ![:thumbsup:](http://reboot.pro/public/style_emoticons/default/thumbsup.gif)  \nAlso we can delete *the drivers* and **command.com** from ramdisk after loading.  \nWe can use them residing on source media.   \n"
    },
    {
      "id": "32021",
      "timestamp": "2008-03-26T03:05:35+00:00",
      "author": "windrv",
      "content": "The best way is to buy a machine with fast USB 2.0 support.  \n\nSave the time to earn more money for that!  \n\nComputer hardware is really cheap these days.  \n\nTime is rather precious on the other hand!   \n"
    },
    {
      "id": "32028",
      "timestamp": "2008-03-26T08:08:14+00:00",
      "author": "kolk",
      "content": "\u003e The best way is to buy a machine with fast USB 2.0 support.\n\nThat\u0027s not such simple.  \nI must boot a machine from USB before buying. ![:thumbsup:](http://reboot.pro/public/style_emoticons/default/thumbsup.gif)  \nAnd if I buy a motherboard alone for assembling myself, I don\u0027t know how to check ![:tabletalk:](http://reboot.pro/public/style_emoticons/default/tabletalk.gif)  \n\nCould you point us to table which shows presence of **EHCI *BIOS*** for different models \\\u0026 manufacturers? ![:D](http://reboot.pro/public/style_emoticons/default/biggrin.png)  \nBecause some manufacturers can stay long with UHCI-only BIOS...  \nOr may be even with UHCI drivers over SMM-emulated UHCI over EHCI-only hardware.   \n"
    },
    {
      "id": "32029",
      "timestamp": "2008-03-26T08:09:38+00:00",
      "author": "was_jaclaz",
      "content": "\u003e Time is rather precious on the other hand!\n\nA very good reason NOT to waste some of yours posting advice on what other people should do with theirs. ![:thumbsup:](http://reboot.pro/public/style_emoticons/default/thumbsup.gif)  \n\nMost of the time spent here on projects is \"fun\" time, even if it\u0027s not commercially or economically a smart idea, it is something most people do as a hobby, to learn and experiment something.  \n\nSometimes it is not important where you arrive, but how you got there. ![:tabletalk:](http://reboot.pro/public/style_emoticons/default/tabletalk.gif)  \n\njaclaz   \n"
    },
    {
      "id": "32032",
      "timestamp": "2008-03-26T09:12:30+00:00",
      "author": "windrv",
      "content": "\u003e That\u0027s not such simple.  \n\u003e I must boot a machine from USB before buying. ![:thumbsup:](http://reboot.pro/public/style_emoticons/default/thumbsup.gif)  \n\u003e And if I buy a motherboard alone for assembling myself, I don\u0027t know how to check ![:tabletalk:](http://reboot.pro/public/style_emoticons/default/tabletalk.gif)  \n\u003e\n\u003e Could you point us to table which shows presence of **EHCI *BIOS*** for different models \\\u0026 manufacturers? ![:D](http://reboot.pro/public/style_emoticons/default/biggrin.png)  \n\u003e Because some manufacturers can stay long with UHCI-only BIOS...  \n\u003e Or may be even with UHCI drivers over SMM-emulated UHCI over EHCI-only hardware.\n\nMay be The Finder could help you in this respect.   \n"
    },
    {
      "id": "32034",
      "timestamp": "2008-03-26T09:25:39+00:00",
      "author": "windrv",
      "content": "\u003e A very good reason NOT to waste some of yours posting advice on what other people should do with theirs. ![:thumbsup:](http://reboot.pro/public/style_emoticons/default/thumbsup.gif)  \n\u003e\n\u003e Most of the time spent here on projects is \"fun\" time, even if it\u0027s not commercially or economically a smart idea, it is something most people do as a hobby, to learn and experiment something.  \n\u003e\n\u003e Sometimes it is not important where you arrive, but how you got there. ![:tabletalk:](http://reboot.pro/public/style_emoticons/default/tabletalk.gif)  \n\u003e\n\u003e jaclaz\n\nYes! That is good for amusement and education purpose and as a hobby.  \n\nSpending a little of my time on advising lots of people not wasting their precious time is an act out of my good motive! may be you could construe it otherwise.   \n"
    },
    {
      "id": "32233",
      "timestamp": "2008-03-30T14:51:30+00:00",
      "author": "ktp",
      "content": "\u003e I\u0027m sorry, there is no need to copy **ntldr** and **debug** ![:thumbsup:](http://reboot.pro/public/style_emoticons/default/thumbsup.gif)  \n\u003e Also we can delete *the drivers* and **command.com** from ramdisk after loading.  \n\u003e We can use them residing on source media.\n\nSo to summarize, finally is there a solution to boot BartPE from USB key with USB 2.0 speed while the BIOS boots only with USB 1.0/1.1 speed ?   \n"
    },
    {
      "id": "32292",
      "timestamp": "2008-03-31T08:06:14+00:00",
      "author": "was_jaclaz",
      "content": "\u003e So to summarize, finally is there a solution to boot BartPE from USB key with USB 2.0 speed while the BIOS boots only with USB 1.0/1.1 speed ?\n\nYes, there is, still fully and utterly experimental ![:thumbsup:](http://reboot.pro/public/style_emoticons/default/thumbsup.gif) but working ![:tabletalk:](http://reboot.pro/public/style_emoticons/default/tabletalk.gif), here is the link to the \"XP Kansas City Shuffle\":  \n[http://www.boot-land...topic\u003d4186\\\u0026st\u003d5](http://www.boot-land.net/forums/?showtopic\u003d4186\u0026st\u003d5 \"External link\")  \n\n**kolk** is trying to find another (maybe simpler) way.  \n\njaclaz   \n"
    },
    {
      "id": "32295",
      "timestamp": "2008-03-31T08:41:06+00:00",
      "author": "ktp",
      "content": "\u003e Yes, there is, still fully and utterly experimental ![:thumbsup:](http://reboot.pro/public/style_emoticons/default/thumbsup.gif) but working ![:tabletalk:](http://reboot.pro/public/style_emoticons/default/tabletalk.gif), here is the link to the \"XP Kansas City Shuffle\":  \n\u003e [http://www.boot-land...topic\u003d4186\\\u0026st\u003d5](http://www.boot-land.net/forums/?showtopic\u003d4186\u0026st\u003d5 \"External link\")  \n\u003e\n\u003e **kolk** is trying to find another (maybe simpler) way.  \n\u003e\n\u003e jaclaz\n\nOK I will take a look at the mentioned topic.  \nCould you explain the name \"Kansas City Shuffle\" please ? Should be very enjoyful to know.   \n"
    },
    {
      "id": "32297",
      "timestamp": "2008-03-31T08:46:18+00:00",
      "author": "was_jaclaz",
      "content": "\u003e OK I will take a look at the mentioned topic.  \n\u003e Could you explain the name \"Kansas City Shuffle\" please ? Should be very enjoyful to know.\n\n[http://www.911cd.net...o...21242\\\u0026st\u003d60](http://www.911cd.net/forums//index.php?showtopic\u003d21242\u0026st\u003d60 \"External link\")  \n\nIf you haven\u0027t seen \"Lucky Number Slevin\", you should, it\u0027s an overall nice movie, and the scene where Bruce Willis explains the \"Kansas City Shuffle\" is really good.  \n\njaclaz   \n"
    },
    {
      "id": "32298",
      "timestamp": "2008-03-31T09:25:37+00:00",
      "author": "ktp",
      "content": "@jaclaz  \n\nOh thank you for your explanation of the name.   \nNow about the solution, it looks like that Dietmar\u0027s Tutorial 7 is to read, since the different posts in the topic  \n[http://www.boot-land...topic\u003d4186\\\u0026st\u003d5](http://www.boot-land.net/forums/?showtopic\u003d4186\u0026st\u003d5 \"External link\")  \nhas as always many idea exchanges and trials etc..., not really a step by step procedure for an user to follow, isn\u0027t it ?   \n"
    },
    {
      "id": "32302",
      "timestamp": "2008-03-31T10:35:10+00:00",
      "author": "was_jaclaz",
      "content": "\u003e Now about the solution, it looks like that Dietmar\u0027s Tutorial 7 is to read, since the different posts in the topic  \n\u003e [http://www.boot-land...topic\u003d4186\\\u0026st\u003d5](http://www.boot-land.net/forums/?showtopic\u003d4186\u0026st\u003d5 \"External link\")  \n\u003e has as always many idea exchanges and trials etc..., not really a step by step procedure for an user to follow, isn\u0027t it ?\n\n\u003e Yes, there is, still ***fully*** and ***utterly*** **experimental** ![:D](http://reboot.pro/public/style_emoticons/default/biggrin.png) but working ![:thumbsup:](http://reboot.pro/public/style_emoticons/default/thumbsup.gif)\n![:D](http://reboot.pro/public/style_emoticons/default/biggrin.png)  \n\nYou do see the difference between the above sentence and one like:  \n\u003e Fully tested and replicable step by step tutorial....\ndon\u0027t you?  \n![:tabletalk:](http://reboot.pro/public/style_emoticons/default/tabletalk.gif)  \n\njaclaz   \n"
    }
  ]
}