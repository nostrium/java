{
  "id": "22332",
  "title": "Boot windows 10 vhd from usb (also ramboot)",
  "isPinned": false,
  "isFirstTopic": false,
  "isLocked": false,
  "tags": [],
  "forumNotes": [
    {
      "id": "215669",
      "timestamp": "2020-08-01T13:31:11+00:00",
      "author": "favorinus",
      "content": "Hi,\n\nI am trying to make a stripped down windows 10 vhd for booting from USB.\n\nMy goal is to have a small windows 10 running in RAM loaded from USB. I have done this with XP and windows 8, but now I am stuck with windows 10.\n\nsteps I made:\n\nremoved the useless things from windows 10 with Winreducer.\n\ninstall the produced ISO with mode: LZX into VHD with WinNTsetup 4.2.1\n\nrun the vhd in virtuablx to check anything running smooth and install svbus 1.1 while in virtualbox running.\n\nprepare usb stick for BIOS booting: format it one partition NTFS with grub4dos booting.\n\ntitle W10Q1900.vhd RAMDISK - 2 GB  \nfind --set-root --ignore-floppies /W10Q1900.vhd  \nmap --mem /W10Q1900.vhd (hd0)  \nmap --hook  \nroot (hd0,0)  \nchainloader /bootmgr  \ntitle W10Q1900.vhd FILEDISK - 2 GB  \nfind --set-root --ignore-floppies /W10Q1900.vhd  \nmap /W10Q1900.vhd (hd0)  \nmap --hook  \nroot (hd0,0)  \nchainloader /bootmgr\n\nthe RAMdisk is booting fine, the pendrive is also mounted\n\nthe FILEDISK gives me an inaccessible boot device BSOD\n\nwhat can I do to correct this, seems like a mass storage driver problem ? How to check and correct.\n\nthank you!\n\n**Edited by favorinus, 01 August 2020 - 01:32 PM.**\n"
    },
    {
      "id": "215671",
      "timestamp": "2020-08-01T14:21:12+00:00",
      "author": "Wonko the Sane",
      "content": "It\u0027s strange, SVbus has been developed exactly because previous drivers had sometimes those issues with Windows 10:\n\n[http://reboot.pro/to...b4dos/?p\u003d207138](http://reboot.pro/topic/21787-svbus-virtual-scsi-host-adapter-for-grub4dos/?p\u003d207138 \"\")\n\nI cannot see anything that is not \"as it should be\" in the procedure you report for the creating of the image. ![:unsure:](http://reboot.pro/public/style_emoticons/default/unsure.png)\n\nThe \"inacessible boot device\" (0x0000007b) BSOD is definitely connected to the mass storage drivers in use, but if there was some sort of incompatibility with SVBUS, it would have probably created the same issue also as Ramdisk. ![:dubbio:](http://reboot.pro/public/style_emoticons/default/dubbio.gif)\n\nCan you try (only for the sake of the experiment) to copy the W10Q1900.vhd to the internal hard disk (still booting from the pendrive, i.e. leaving the grub4dos on the USB stick, but removing - or renaming - the W10Q1900.vhd in the pendrive)?\n\nMaybe the issue is in the USB drivers, this way they are outside the protected mode part of the booting.\n\n![:duff:](http://reboot.pro/public/style_emoticons/default/duff.gif)\n\nWonko\n\n"
    },
    {
      "id": "215675",
      "timestamp": "2020-08-01T15:20:05+00:00",
      "author": "favorinus",
      "content": "I have copied the vhd to a hdd and now it\u0027s booting fine with filedisk booting.\n\nso the issue is with the usb mass storage drivers, they are install but not loaded early enough?\n\nwhat can I do now?\n\n"
    },
    {
      "id": "215678",
      "timestamp": "2020-08-01T16:05:14+00:00",
      "author": "Wonko the Sane",
      "content": "I don\u0027t know.\n\nWindows 10 should have \"native\" and \"working everywhere\" USB (3.0) drivers ![:unsure:](http://reboot.pro/public/style_emoticons/default/unsure.png)\n\nCould it be - for some reasons - that your \"passing through\" VirtualBox has changed some settings related to the USB bus?\n\nNow that you are filedisk booted from the .vhd on hard disk can you check that everything related to USB is OK?\n\nOr maybe it has been already \"fixed\" by booting on the \"real hardware\".\n\nI.e. if you now switch off the PC, reboot to your normal OS and copy back the booted .vhd from disk to USB stick, is it still the same?\n\nYou can also try (but I don\u0027t think it will make any change) to use the grub4dos USB stack ( add \"usb --init\" as first line in your tiltle(s) in menu.lst).\n\n![:duff:](http://reboot.pro/public/style_emoticons/default/duff.gif)  \nWonko\n\n"
    },
    {
      "id": "215702",
      "timestamp": "2020-08-02T18:01:57+00:00",
      "author": "alacran",
      "content": "@ favorinus\n\nThis are examples for Wimboot VHDs as filedisk or Ramdisk having SvBus driver installed (only required for Ramboot), using grub4dos 0.46a last version:\n\nRamboot from internal disk:  \n\ntitle 10x64-WB.vhd - SVBus RAMDISK - **map as (hd)** for WIMBOOT  \nfind --set-root --ignore-floppies /10x64-WB.vhd  \nmap --top --mem /10x64-WB.vhd **(hd)**   \nmap --hook  \n**root (hd-1,0)**   \nchainloader /bootmgr  \n\nFiledisk booting from internal disk:  \n\ntitle 10x64-WB.vhd - SVBus FILEDISK - **map as (hd)** for WIMBOOT  \nfind --set-root --ignore-floppies /10x64-WB.vhd  \nmap /10x64-WB.vhd **(hd)**   \nmap --hook  \n**root (hd-1,0)**   \nchainloader /bootmgr  \n\n\u003cbr /\u003e\n\nRamboot from external disk:  \n\ntitle 10x64-WB.vhd - SVBus RAMDISK - **map as (hd-1)** for WIMBOOT\n\nfind --set-root --ignore-floppies /10x64-WB.vhd  \nmap --top --mem /10x64-WB.vhd **(hd-1)**   \nmap --hook  \n**root (hd-1,0)**   \nchainloader /bootmgr  \n\n\u003cbr /\u003e\n\nFiledisk booting from external disk:  \n\ntitle 10x64-WB.vhd - SVBus FILEDISK - **map as (hd-1)** for WIMBOOT  \nfind --set-root --ignore-floppies /10x64-WB.vhd  \nmap /10x64-WB.vhd **(hd-1)**   \nmap --hook  \n**root (hd-1,0)**   \nchainloader /bootmgr\n\nBooting Wimboot VHDs has extremely precise requirements to first find the info into the new virtual drive (the VHD during booting) and also let the pointers inside the VHD find the source.wim coupled to it, (located on the USB device).\n\nAbout your issue:\n\u003e\n\u003e FILEDISK gives me an inaccessible boot device BSOD\n\nThis is caused when during boot the internal info contained into the VHD or the associated Wim file is not found, and may happend during RAMboot and/or filedisk booting that\u0027s the reazon to use **root (hd-1,0)** line on previous examples, and then avoid this issue in all cases:\n\nUse yor actual titles.\n\n**Adapt previous commands with your VHD name.**\n\nWhere using:\n\n**root (hd-1,0)**, the USB device is hd0, and the virtual disk is or will be hd1\n\nActually you have **root (hd-0,0)**on all your commands.\n\nIf this don\u0027t solve your issue, it is also possible you have something wrong on the internal BCD of your VHD (I really don\u0027t think it is the case). But it is better to give you also following info:\n\nIn that case you could also use [UEFI_MULTI](http://reboot.pro/files/file/618-usb-format-tool-and-uefi-multi/ \"\") or [VHD_WIMBOOT](http://reboot.pro/files/file/593-vhd-wimboot-apply-and-capture-of-wim-files-for-os-in-vhd/ \"\") from wimb, if using a NT 6.x MBR on your USB, both make entries on BCDs + an entry for grub4dos grld.mbr and add it and grld, and make also requiered entries to menu.lst for filedisk and Ram booting, and additionaly make an enty into the VHD internal BCDs.\n\nEDIT: See attached photo (as a guide) of the generic BCD valid when the VHD is on the root of a drive, wich is good when filebooting or rambooting from internal and external mass storage devices.\n\nalacran  \n\n#### Attached Thumbnails {#attach_wrap}\n\n* [![BCD into the VHD.png](http://reboot.pro/uploads/monthly_08_2020/post-26560-0-44557800-1596469775_thumb.png)](http://reboot.pro/uploads/monthly_08_2020/post-26560-0-44557800-1596469775.png \"BCD into the VHD.png - Size: 95.79KB\"){#ipb-attach-url-17292-0-06385700-1676066385}\n\n"
    },
    {
      "id": "215712",
      "timestamp": "2020-08-03T08:20:22+00:00",
      "author": "Wonko the Sane",
      "content": "@alacran\n\nRamdisk booting already works just fine.\n\nThe filedisk booting from USB (but not from internal disk) is the issue at hand.\n\nNow you explain to me which differences there are between:\n\u003e\n\u003e Filedisk booting from external disk:  \n\u003e\n\u003e title 10x64-WB.vhd - SVBus FILEDISK - map as (hd-1) for WIMBOOT  \n\u003e find --set-root --ignore-floppies /10x64-WB.vhd  \n\u003e map /10x64-WB.vhd (hd-1)  \n\u003e map --hook  \n\u003e root (hd-1,0)  \n\u003e chainloader /bootmgr\n\nand:\n\u003e\n\u003e title W10Q1900.vhd FILEDISK - 2 GB  \n\u003e find --set-root --ignore-floppies /W10Q1900.vhd  \n\u003e map /W10Q1900.vhd (hd0)  \n\u003e map --hook  \n\u003e root (hd0,0)  \n\u003e chainloader /bootmgr\n\nAs I am completely missing them.\n\n![:duff:](http://reboot.pro/public/style_emoticons/default/duff.gif)\n\nWonko\n\n"
    },
    {
      "id": "215718",
      "timestamp": "2020-08-03T11:49:48+00:00",
      "author": "alacran",
      "content": "My suggested commands for Ramboot and for filedisk boot, have proven to be reliable on all scenarios to boot any VHD, including standard VHDs, Wimboot VHDs and Compact installed VHDs, and so far are same used into UEFI_MULTI and WIMBOOT_VHD programs by wimb for any kind of VHDs.\n\n**In fact they are based on karyonix info.**\n\n**Then I could say with no dubt they are the only fullprove option valid for any kind of VHD.**\n\nUnfortunately the info is in several parts on some post located on this topic, where you and I were involved too:\n\n[http://reboot.pro/to...e-8#entry209770](http://reboot.pro/topic/18182-uefi-multi-make-multi-boot-usb-drive/page-8#entry209770 \"\")\n\nAlso this were my finding during my test:\n\n[http://reboot.pro/to...s-svbus-driver/](http://reboot.pro/topic/21968-more-deeper-understanding-of-mapped-drive-number-for-rambooting-wimboot-vhds-from-internal-hd-using-grub4dos-svbus-driver/ \"\")\n\n**EDIT:** also don\u0027t forget the final comment on my previous post:\n\u003e\n\u003e **If this don\u0027t solve your issue, it is also possible you have something wrong on the internal BCD of your VHD (I really don\u0027t think it is the case)**. But it is better to give you also following info....\n\u003e\nalacran\n\n"
    },
    {
      "id": "215721",
      "timestamp": "2020-08-03T13:27:49+00:00",
      "author": "Wonko the Sane",
      "content": "I don\u0027t want to be grumpier than usual, but the OP issue is NOT about Ramdisk booting that works just fine. (so it makes no sense to post a solution about a non-issue).\n\nThe issue is about Filedisk booting (and Filedisk booting from USB ONLY).\n\nYou cannot (actually you can just fine :smile:) post a suggestion that is (seemingly) functionally IDENTICAL to what the OP is already using (and failing with) ++unless++ you explain in what it is different (and hopefully better).\n\nThe point (there and in a different context) was about assigning something to (hd) (next disk drive) and chainloading (hd-1) i.e. last drive before the next one:\n\nIn this post you are suggesting to assign something to (hd-1) and then chainloaing the same (hd-1), so it seems to me very, very like using in both lines (hd0).![:dubbio:](http://reboot.pro/public/style_emoticons/default/dubbio.gif)\n\n![:duff:](http://reboot.pro/public/style_emoticons/default/duff.gif)\n\nWonko\n\n"
    },
    {
      "id": "215724",
      "timestamp": "2020-08-03T15:45:14+00:00",
      "author": "alacran",
      "content": "\u003e In this post you are suggesting to assign something to (hd-1) and then chainloaing the same (hd-1), so it seems to me very, very like using in both lines (hd0).\n\nAgree.\n\nThe idea was to let favorinus know this general use commands, without looking/analyzing very carefuly he should get similar results with hd0, on standard VHDs.\n\nThen the only other possible cause of the issue should be on the BCD of the VHD.\n\nI\u0027m going to edit that post and add a picture of the generic BCD valid when the VHD is on the root of a drive, wich is good when filebooting or rambooting from internal and external mass storage devices.\n\nThanks for your comment into my quote, it was the key that made me look the similar results, on standard VHDs.\n\nIt is good someone let you know when you misslook something.\n\nalacran\n\n"
    },
    {
      "id": "215726",
      "timestamp": "2020-08-03T16:34:42+00:00",
      "author": "Wonko the Sane",
      "content": "\u003e Then the only other possible cause of the issue should be on the BCD of the VHD.  \n\u003e\n\u003e I\u0027m going to edit that post and add a picture of the generic BCD valid when the VHD is on the root of a drive, wich is good when filebooting or rambooting from internal and external mass storage devices.\n\nI don\u0027t know. ![:dubbio:](http://reboot.pro/public/style_emoticons/default/dubbio.gif)  \n\nThe error is a 0x0000007b, which should happen post BCD and definitely is related to mass storage device (or its drivers).  \n\nIf you prefer, the chainloading of BOOTMGR must be working (itherwise he would have a grubdos error), then the BCD must be found (otherwise he would have a \"missing BCD\" error 0xc0000034, \"The Boot Configuration Data file is missing.\"), but it goes a bit further, either WINLOAD.EXE is also found (or he would have a 0xc000000f \"The selected entry could not be loaded because the application is missing or corrupt.\") or - and this is what I believe - the issue happens within BOOTMGR but post BCD the sheer moment the devices are re-enumerated due to the \"switch\" between real and protected mode, i.e. between BCD and WINLOAD.EXE.\n\nOf course it doesn\u0027t happen on Ramdisk (as the whole stuff is already loaded in memory and mapped correctly by grub4dos) and - less obviously but still making sense - it doesn\u0027t happen if the VHD is on the internal disk (surely accessible).\n\nSo what remains is something connected to the BIOS (these days unlikely), to USB drivers (more likely) or to the particular stick used (rare but possible\\[1\\])\n\nThere was something \"loosely\" similar to this related to installing XP from USB:  \n[https://msfn.org/boa...er-d-and-not-u/](https://msfn.org/board/topic/131770-solved-usbstick-take-letter-d-and-not-u/ \"External link\")\n\n![:duff:](http://reboot.pro/public/style_emoticons/default/duff.gif)\n\nWonko\n\n\\[1\\] Anecdata, many years ago I removed the serial number from a USB stick while making an unrelated experiment with it, then several weeks later tried a particular software (sort of portable dektop/environmentm cannot really remember the name) and there was no way I could install/run it on that particular stick (but it worked just \"fine\" - actually it was essentially some crappy stuff - on \\*any\\* other stick I tested it on). Long story short, after I re-used the stick \"Manufacturer Tool\" to re-assign to the stick a serial, the program started working even on that stick.\n\n\u003cbr /\u003e\n\n\u003cbr /\u003e\n\n\u003cbr /\u003e\n\n"
    },
    {
      "id": "215729",
      "timestamp": "2020-08-03T18:22:55+00:00",
      "author": "alacran",
      "content": "\u003e The error is a 0x0000007b, which should happen post BCD and definitely is related to mass storage device (or its drivers)...\n\u003e\n\u003e So what remains is something connected to the BIOS (these days unlikely), to USB drivers (more likely) or to the particular stick used\n\nWhat I would do then (free options first, starting with possible human errors):\n\nIt doesn\u0027t hurt to verify the BCD first, just to descart that something is wrong in it.\n\nCheck current Bios settings related to USB, just to descart that something is wrongly selected.\n\nTry same USB on all MBR USB port available, usually they supply better Volts, Ampers and transfer speed than front ports.\n\nTry booting on another PC with current USB device.\n\nCheck MB/PC manufacturer page to see if there is a new Bios version, and install it if available, even if there is no mention related to USB, (sometimes they don\u0027t mention all changes/improvements).\n\nTry using another USB device (preferable new and a reputable brand), to discart incompatibility.\n\nIf nothing on this list solves the issue buy a new PC (just joking).\n\nalacran\n\n"
    },
    {
      "id": "215732",
      "timestamp": "2020-08-03T21:52:11+00:00",
      "author": "favorinus",
      "content": "thank you all for the replies, but still no joy,\n\nthe internal bcd is the same as posted by alacran,\n\nI will try another usb stick\n\nthe bsod also occurs on an another PC.\n\n**Edited by favorinus, 03 August 2020 - 10:22 PM.**\n"
    },
    {
      "id": "215733",
      "timestamp": "2020-08-03T23:29:07+00:00",
      "author": "favorinus",
      "content": "As a work-around I tried to boot the vhd as FILEDISK using windows 10 native vhd boot.  \n\nfirst boot to grub4dos  \n\nthen  \ntitle Windows 10 native VHD  \nchainloader /bootmgr10  \n\nthis loads /boot/BCD  \n\nwhich will look for W10Q1900.vhd\n\nthis results in a  \n\nVHD BOOT INITIALIZATION FAILED\n\n????\n\n"
    },
    {
      "id": "215734",
      "timestamp": "2020-08-04T02:46:01+00:00",
      "author": "alacran",
      "content": "After reading again your first post looking very carefuly if I missed some info, this are my findings.\n\nFrom your fist post:\n\n\u003e My goal is to have a small windows 10 running in RAM loaded from USB. I have done this with XP and windows 8, but now I am stuck with windows 10.\n\nDoes the 8 VHD boots fine as filedisk and ramdisk on your current USB device?\n\nIf the answer is NO, your USB maybe is not working fine or is not fully compatable with your PC under certain circunstances.\n\nIf the answer is YES, then the problen could be related to the following:\n\n\u003e steps I made:\n\u003e\n\u003e **removed the useless things from windows 10 with Winreducer.**\n\u003e\n\u003e install the produced ISO with mode: LZX into VHD with WinNTsetup 4.2.1\n\u003e\n\u003e run the vhd in **virtuablx** to check anything running smooth and **install svbus 1.1 while in virtualbox running**.\n\n**If you installed the Virtual Box additional package** it has its own drivers and other things to improve the VM funcionality, perhaps this overwrited the original USB drivers, part of them, or the services required to start the driver, the entries on the reg file controling the timings of this service, etc\n\n**About SvBus driver** , on [post No. 115](http://reboot.pro/topic/21787-svbus-virtual-scsi-host-adapter-for-grub4dos/page-5#entry214468 \"\")the author says:\n\n\u003e ++**SVBus V1.2 Virtual SCSI Host Adapter for GRUB4DOS**++   \n\u003e\n\u003e Today we present the new virtual SCSI driver SVBus version 1.2 for use with GRUB4DOS. **SVBus V1.1 was not working correctly in combination with Windows 10 x64 Build 1803 and later.**This could lead to a system crash with BSOD and the error CRITICAL_PROCESS_DIED. We discovered a Microsoft bug in esent.dll, which lead to these critical errors. Details are listed in the ReadMe.txt topic named \"Application and Service Crashes on Windows 10 x64 Build 1909 with SVBus version 1.1\".  \n\u003e\n\u003e In addition we added mode page caching for the MODE SENSE (6) command. The virtual HDD needs MODE PAGE CACHING to display the tab Policies in the Properties of the HDD in device manager.\n\u003e\n\u003e **To download the newest version use the link in my first post.**\n\u003e\n\u003e Much respect go out to all the heroes who work very hard in hospitals all over the world at the moment to fight COVID-19.\n\u003e\n\u003e Keep up your amazing work and spirit!\n\u003e\n\u003e Greets  \n\u003e Kai Schtrom\n\nBetter use SVBus version 1.2 on a new build, and better don\u0027t use any Virtual Machine, you don\u0027t need it, create the VHD on a partition of your PC, WinNTSetup will create the entry on your PC BCD to let you boot from it.\n\nI noticed in your last post you followed more or less the instructions from SVBus author, they are not bad but in my next post (to not miss the target of this post), I will suggest you my manual way, or the automated way using WIMBOOT_VHD by wimb.\n\nFor next comment I will consider the USB device is OK:\n\n**Abut the use of Winreducer:** as the 10 OS on the VHD boots fine when loaded on RAM (by grub4dos) and only fails when starts file booting there is also the possibility the USB funtions are not working to its full capacity because some part of the driver, the services required to start the driver, the entries on the reg file controling the timings of this service, etc were affected during the reduction with Winreducer.\n\nalacran\n\n"
    },
    {
      "id": "215740",
      "timestamp": "2020-08-04T15:48:25+00:00",
      "author": "alacran",
      "content": "I recommend you to start from scratch a new build.\n\nThe procedure made by SVBus author Kai Schtrom is not bad, but I have the opinion the procedures here on reboot.pro are better, as give the user more booting alternatives (MBR \\\u0026 UEFI), using Windows bootmanager + grub4dos and also grub (optional) to let the user include (boot) also Linux distros on same USB device, and do not modify/delete files related to Windows boot files/folders, not only using grub4dos alone as boot loader (good only for MBR).\n\nMy topics related to Wimboot and Compact Installs (manual procedures)\n\n**Read this first:**\n\n**Following topic has info related to Compact Mode Installs:** (basically same applies for Wimboot Installs too):[http://reboot.pro/to...-mode-installs/](http://reboot.pro/topic/22323-compact-mode-installs/ \"\")\n\n**You can skip this, but it has all procedure in detail for Wimboot installs and has good info and test done:**\n\nLong topic about Wimboot Installs: [http://reboot.pro/to...vhd/?hl\u003dwimboot](http://reboot.pro/topic/21957-making-the-smallest-win10-install-wimboot-mode-on-512-mb-vhd/?hl\u003dwimboot \"\")\n\n**Wimb programs to automate Wimboot and Compact Installs:**\n\n**USB Format Tool and UEFI_MULTI:** [http://reboot.pro/fi...and-uefi-multi/](http://reboot.pro/files/file/618-usb-format-tool-and-uefi-multi/ \"\")\n\n**VHD_WIMBOOT - Apply and Capture of WIM Files for OS in VHD:** [http://reboot.pro/fi...-for-os-in-vhd/](http://reboot.pro/files/file/593-vhd-wimboot-apply-and-capture-of-wim-files-for-os-in-vhd/ \"\")\n\nNOTE: Good for Standard, Wimboot and Compact installs. Into this download is included a pdf file with recommended procedure.\n\nLet us know latter if this helped you to solve the issue.\n\ni wich you good luck in your builds\n\nalacran\n\n"
    },
    {
      "id": "215763",
      "timestamp": "2020-08-06T15:32:59+00:00",
      "author": "favorinus",
      "content": "thank you .\n\nI am doing a lot of trial and error looking for a solution. I started all over again with an untouched windows 10 iso: 2016 LTSB version\n\nfirst format the pendrive with rufus 3.11 MBR partition NTFS and let rufus install grub4dos 0.4.6a on it.\n\nwith winntsetup 4.2.1 create an 11GB vhd\n\nrightclick \"add drivers\" to active unsigned drivers and select svbus 1.2\n\ninstall the windows 10 into de vhd and reboot on my pc. As the vhd is added to the BCD I booted into the new created windows 10 and it\u0027s working fine, I see the svbus 1.2 installed.\n\nrebooted back into my every-day-use windows 8.1 and copy the vhd into my pendrive with this menu.lst:\n\ntitle Windows10.vhd - SVBus FILEDISK - map as (hd)\n\nfind --set-root --ignore-floppies /Windows10.vhd\n\nmap /Windows10.vhd (hd)\n\nmap --hook\n\nroot (hd-1,0)\n\nchainloader /bootmgr\n\ntitle Windows10.vhd.vhd - SVBus RAMDISK - map as (hd-1)\n\nfind --set-root --ignore-floppies /Windows10.vhd\n\nmap --top --mem /Windows10.vhd (hd-1)\n\nmap --hook\n\nroot (hd-1,0)\n\nchainloader /bootmgr\n\nand guess what: BSOD inaccessible boot disk on my projected computer, and on my laptop infinity dots rotating.\n\ncan it be that the BIOS mode is some sort of buggy?\n\nI will try the suggested **UEFI_MULTI** posted here above. grub2 can also boot windows 10 as ramdisk ?\n\nps: how can I add pictures to the post?\n\n"
    },
    {
      "id": "215765",
      "timestamp": "2020-08-06T16:13:02+00:00",
      "author": "Wonko the Sane",
      "content": "I still am not convinced of the menu.lst you used.\n\nCan you try on command line? (press \\[Enter\\] after typing each line to issue the command)\n\n```\n\nfind --set-root /Windows10.vhd\nroot \n```\n\nThis root command should output either (hd0,0) or (hd1,0) a result,\n\nIf the output of root is (hd0,0), run these commands:\n\n```\n\nmap (hd0) (hd1)\nmap --hook\nfind --set-root /Windows10.vhd\nroot\n```\n\nIf the above is (hd1,0), then run:\n\n```\n\n\n\nmap /Windows10.vhd (hd0)\nmap --hook\nroot (hd0,0)\nroot\n\n```\n\nIf the above is (hd0,0), then run:\n\n```\n\nchainloader /bootmgr\n```\n\nyou should get a message simillar to \"Will boot ntldr from drive\u003d0x80, partition\u003d0x0 (hiden sectors\u003d0x800)...\"\n\nNow issue:\n\n```\n\nboot\n```\n\n![:duff:](http://reboot.pro/public/style_emoticons/default/duff.gif)\n\nWonko\n\n"
    },
    {
      "id": "215766",
      "timestamp": "2020-08-06T16:39:44+00:00",
      "author": "favorinus",
      "content": "Hi wonko,\n\nI have done all you descripted and the result is the same as your.\n\nIt is showing the dots for some 10 seconds and then BSOD INACCESSIBLE BOOT DEVICE\n\n"
    },
    {
      "id": "215768",
      "timestamp": "2020-08-06T18:06:49+00:00",
      "author": "Wonko the Sane",
      "content": "I forgot to put the \"--set-root\" in the commands. :blush:\n\nI just corrected them.\n\nCan you try again?\n\nNot that it will probably change anything, but the commands (as I posted them earlier, wrong) should have not worked at all, so there must be some ![:wodoo:](http://reboot.pro/public/style_emoticons/default/wodoo.gif) involved.\n\nAnd you cannot have possibly done all I described, as they were a set of conditional commands, please describe EXACTLY what happens (and which commands you use) while in grub4dos.\n\n![:duff:](http://reboot.pro/public/style_emoticons/default/duff.gif)\n\nWonko\n\n"
    },
    {
      "id": "215769",
      "timestamp": "2020-08-06T20:22:09+00:00",
      "author": "favorinus",
      "content": "Ok here we go:\n\nnow I am in the grub4dos 0.4.6a commandline\n\ngrub\\\u003e find --set-root /Windows10.vhd\n\n(hd0,0)\n\ngrub\\\u003e root\n\n(hd0,0) Filesystem type is ntfs, partition type 0x07\n\nVolume Name is \"Radio\"\n\ngrub\\\u003e map (hd0) (hd1)\n\nfloppies_orig\u003d0, harddrives_orig\u003d1, floppies_curr\u003d0, harddrives_curr\u003d2\n\ngrub\\\u003emap --hook\n\ngrub\\\u003efind --set-root /Windows10.vhd\n\n(hd0,0)\n\ngrub\\\u003eroot\n\n(hd0,0) Filesystem type is ntfs, partition type 0x07\n\nVolume Name is \"Radio\"\n\ngrub\\\u003e chainloader /bootmgr\n\nError 15: File not found\n\ngrub\\\u003e\n\n\u003cbr /\u003e\n\n"
    },
    {
      "id": "215770",
      "timestamp": "2020-08-07T09:08:50+00:00",
      "author": "wimb",
      "content": "USB-Stick is too slow for booting Win10 VHD as FILEDISK\n\nYour VHD is booting OK from RAMDISK and as FILEDISK when located on internal Harddisk.\n\nBoth cases are much faster.\n\nTry the very fast [USB Portable SSD](https://www.samsung.com/us/computing/memory-storage/portable-solid-state-drives/portable-ssd-t5-500gb-mu-pa500b-am/ \"External link\") for booting Win10 VHD as FILEDISK.\n\nMore Info:\n\n"
    },
    {
      "id": "215771",
      "timestamp": "2020-08-07T09:25:37+00:00",
      "author": "Wonko the Sane",
      "content": "\u003e I will try again, because it\u0027s so easy to make a mistake ![:blink:](http://reboot.pro/public/style_emoticons/default/blink.png)\n\nYes, you missed a step, and I possibly made some confusion, it is difficult to suggest a sequence of commands remotely, let\u0027s see if I can clear the idea with a more verbose example:\n\nfind --set-root /Windows10.vhd \\\u003c- this finds the vhd and sets root to the disk/volume  \nroot \\\u003c- this confirms that the vhd is on (and you are root on) (hd0,0)  \nmap (hd0) (hd1) \\\u003c- this map the first disk to second disk  \nmap --hook \\\u003c- this hooks the mapping  \nfind --set-root /Windows10.vhd \\\u003c- this is the same of the previous one, you can omit that as - in this moment - you should have the same disk mapped as both (hd0) and (hd1) do the find command will find the .vhd on first volume it scans (hd0,0)  \nroot \\\u003c- this is the same of the previous one, you can omit that, as it will still result as (hd0,0)  \nmap /Windows10.vhd (hd0) \\\u003c- this maps the .vhd to (hd0)  \nmap --hook \\\u003c- this hooks the mapping  \nroot (hd0,0) \\\u003c- this moves the root to the just mapped (hd0), i.e. the .vhd   \nroot \\\u003c- this should have different results from the previous one as this is now the .vhd\n\nfind /Windows10.vhd \\\u003c- this should result in (hd1,0)\n\ngeometry (hd0) \\\u003c- this should confirm that (hd0) is now the .vhd\n\ngeometry (hd1) \\\u003c- and this should confirm that the USB stick is now (hd1)\n\nroot (hd0,0)\\\u003c- this is unneeded as root shoiuld be already (hd0,0) but better be sure\n\nchainloader /bootmgr \\\u003c- this chainloads the bootmanager inside current root (hd0,0), i.e. the one inside the .vhd  \nboot \\\u003c- this passes control to the chainloaded bootmgr and boots\n\nAll the above basically is about mapping the .vhd to first disk AND keep the USB stick available at BIOS level as second disk.\n\nIf it doesn\u0027t work, try doing the opposite, i.e. leaving the USB stick as first disk and map the .vhd to second disk, i.e.:\n\nfind --set-root /Windows10.vhd \\\u003c- this finds the vhd and sets root to the disk/volume  \nroot \\\u003c- this confirms that the vhd is on (and you are root on) (hd0,0)  \nmap /Windows10.vhd (hd1) \\\u003c- this maps the .vhd to (hd1)  \nmap --hook \\\u003c- this hooks the mapping  \nroot (hd1,0) \\\u003c- this moves the root to the just mapped (hd1), i.e. the .vhd   \nroot \\\u003c- this should have different results from the previous one as this is now the .vhd\n\nfind /Windows10.vhd \\\u003c- this should result in (hd0,0)\n\ngeometry (hd0) \\\u003c- this should confirm that (hd0) is the USB stick\n\ngeometry (hd1) \\\u003c- and this should confirm that the .vhd is now (hd1)\n\nroot (hd1,0)\\\u003c- this is unneeded as root shoiuld be already (hd1,0) but better be sure\n\nchainloader /bootmgr \\\u003c- this chainloads the bootmanager inside current root (hd1,0), i.e. the one inside the .vhd  \nboot \\\u003c- this passes control to the chainloaded bootmgr and boots\n\n![:duff:](http://reboot.pro/public/style_emoticons/default/duff.gif)\n\nWonko\n\n"
    },
    {
      "id": "215772",
      "timestamp": "2020-08-07T09:40:17+00:00",
      "author": "Wonko the Sane",
      "content": "\u003e USB-Stick is too slow for booting Win10 VHD as FILEDISK\n\u003e\n\u003e Your VHD is booting OK from RAMDISK and as FILEDISK when located on internal Harddisk.\n\u003e\n\u003e Both cases are much faster.\n\nSure they are much faster but also BOTH do not use the USB driver/stack of Windows 10.\n\nIf you suspect a timing problem, maybe it can be fixed \\*somehow\\*?. ![:unsure:](http://reboot.pro/public/style_emoticons/default/unsure.png)\n\n\u003e **Try** the very fast [USB Portable SSD](https://www.samsung.com/us/computing/memory-storage/portable-solid-state-drives/portable-ssd-t5-500gb-mu-pa500b-am/ \"External link\") for booting Win10 VHD as FILEDISK.\n\nIn exchange for a mere 100 bucks or so ... ![:rolleyes:](http://reboot.pro/public/style_emoticons/default/rolleyes.gif)\n\n![:duff:](http://reboot.pro/public/style_emoticons/default/duff.gif)\n\nWonko\n\n"
    },
    {
      "id": "215773",
      "timestamp": "2020-08-07T10:37:43+00:00",
      "author": "wimb",
      "content": "\u003e In exchange for a mere 100 bucks or so ... ![:rolleyes:](http://reboot.pro/public/style_emoticons/default/rolleyes.gif)\n\u003e\n[USB Portable SSD 500 GB](https://www.coolblue.nl/en/product/785050/samsung-portable-ssd-t5-500gb.html \"External link\") - now in my country for € 89,-\n\n**@favorinus**\n\nWhat kind of USB-Stick Make and Type are you using 2.0 or 3.0 ?\n\nYour Windows 10 VHD has Compact Install with **LZX Compression**.\n\nBooting such LZX Install as FILEDISK on USB requires fast USB medium connected through USB 3.0 and powerful computer\n\n**EDIT:**\n\nWhat is the WOF Status of your VHD Internal files bootmgr and Boot\\\\BCD ?\n\nTry [WOF_Compress](http://reboot.pro/topic/22020-wof-compress/ \"\") and use WOF_Compress_Trusted.cmd to UnCompress these files.\n\n**Download** from wimb GitHub - [WOF_Compress](https://github.com/wimbrts/WOF_Compress/releases \"External link\")\n\nAlso use [**BOOTICE**](http://reboot.pro/files/file/592-bootice-v1332/ \"\") to view if VHD Internal Boot\\\\BCD is present and OK or has \\\u003cunknown\\\u003e entry .....that does not work ....\n\n[VHD_WIMBOOT](http://reboot.pro/topic/21977-vhd-wimboot-apply-and-capture-of-wim-files-for-os-in-vhd/ \"\") and [UEFI_MULTI](http://reboot.pro/files/file/279-uefi-multi-make-multi-boot-usb-drive/ \"\") take care to make Boot\\\\BCD and bootmgr inside VHD,\n\nwhereas WinNTSetup does not do this ....and grub4dos booting will fail ....\n\nAlso VHD_WIMBOOT after wimlib Capture in WimBoot mode followed by wimlib Apply will use WIM file Windows\\\\System32\\\\WimBootCompress.ini\n\nwith \\\\bootmgr and \\\\Boot\\\\BCD in \\[PrepopulateList\\] section so that these files will be Normal instead of may be LZX Compressed in your case ..... giving grub4dos Boot failure.\n\nFor booting as FILEDISK it is preferred to useinstead of SVBus the Microsoft vhdmp.sys driver and have Boot entry in Windows Boot Manager menu as made by UEFI_MULTI or VHD_WIMBOOT\n\n"
    },
    {
      "id": "215774",
      "timestamp": "2020-08-07T11:18:52+00:00",
      "author": "Wonko the Sane",
      "content": "\u003e [USB Portable SSD 500 GB](https://www.coolblue.nl/product/785050/samsung-portable-ssd-t5-500gb.html?cmt\u003dc_a%2Ccid_8863867846%2Caid_92064546711%2Ctid_pla-329108927896%2Cgn_g%2Cd_c\u0026gclid\u003dCjwKCAjw97P5BRBQEiwAGflV6U3bGyPeK161HGElfV24R6ftKmQI4NU-sLHfClTv8vW5hY71XKWuMxoCjhoQAvD_BwE \"External link\") - now in my country for € 89,-\n\nRight now:\n\n[https://www1.oanda.c...ency/converter/](https://www1.oanda.com/currency/converter/ \"External link\")\n\n89 € are 105,62 US$\n\nI stand by my \"mere 100 bucks or so ...\".\n\nNow 90 € or 105 US$ are not - in my personal book - \"peanuts\".\n\nIsn\u0027t it funny that an Italian tells a Dutch how unneeded expenditures should be carefuly evaluated? ![:unsure:](http://reboot.pro/public/style_emoticons/default/unsure.png)\n\nPlease also consider that the OP comes from Argentina, where AFAIK the minimum salary is around 300-350 USD and the average is around 500-600 USD.\n\nAnd where that T5 thingy seemingly sells for 15.000-20,000 pesos:\n\n[https://tiendamia.co...?amz\u003dB073GZBT36](https://tiendamia.com/ar/producto?amz\u003dB073GZBT36 \"External link\")  \n[https://www.mercadol...l/p/MLA9282793?](https://www.mercadolibre.com.ar/disco-solido-externo-samsung-t5-mu-pa500b-500gb-azul/p/MLA9282793? \"External link\")\n\ni.e. more than double the EU price, like 205-275 US$\n\n![:duff:](http://reboot.pro/public/style_emoticons/default/duff.gif)\n\nWonko\n\n"
    },
    {
      "id": "215669",
      "timestamp": "2020-08-01T13:31:11+00:00",
      "author": "favorinus",
      "content": "Hi,\n\nI am trying to make a stripped down windows 10 vhd for booting from USB.\n\nMy goal is to have a small windows 10 running in RAM loaded from USB. I have done this with XP and windows 8, but now I am stuck with windows 10.\n\nsteps I made:\n\nremoved the useless things from windows 10 with Winreducer.\n\ninstall the produced ISO with mode: LZX into VHD with WinNTsetup 4.2.1\n\nrun the vhd in virtuablx to check anything running smooth and install svbus 1.1 while in virtualbox running.\n\nprepare usb stick for BIOS booting: format it one partition NTFS with grub4dos booting.\n\ntitle W10Q1900.vhd RAMDISK - 2 GB  \nfind --set-root --ignore-floppies /W10Q1900.vhd  \nmap --mem /W10Q1900.vhd (hd0)  \nmap --hook  \nroot (hd0,0)  \nchainloader /bootmgr  \ntitle W10Q1900.vhd FILEDISK - 2 GB  \nfind --set-root --ignore-floppies /W10Q1900.vhd  \nmap /W10Q1900.vhd (hd0)  \nmap --hook  \nroot (hd0,0)  \nchainloader /bootmgr\n\nthe RAMdisk is booting fine, the pendrive is also mounted\n\nthe FILEDISK gives me an inaccessible boot device BSOD\n\nwhat can I do to correct this, seems like a mass storage driver problem ? How to check and correct.\n\nthank you!\n\n**Edited by favorinus, 01 August 2020 - 01:32 PM.**\n"
    },
    {
      "id": "215671",
      "timestamp": "2020-08-01T14:21:12+00:00",
      "author": "Wonko the Sane",
      "content": "It\u0027s strange, SVbus has been developed exactly because previous drivers had sometimes those issues with Windows 10:\n\n[http://reboot.pro/to...b4dos/?p\u003d207138](http://reboot.pro/topic/21787-svbus-virtual-scsi-host-adapter-for-grub4dos/?p\u003d207138 \"\")\n\nI cannot see anything that is not \"as it should be\" in the procedure you report for the creating of the image. ![:unsure:](http://reboot.pro/public/style_emoticons/default/unsure.png)\n\nThe \"inacessible boot device\" (0x0000007b) BSOD is definitely connected to the mass storage drivers in use, but if there was some sort of incompatibility with SVBUS, it would have probably created the same issue also as Ramdisk. ![:dubbio:](http://reboot.pro/public/style_emoticons/default/dubbio.gif)\n\nCan you try (only for the sake of the experiment) to copy the W10Q1900.vhd to the internal hard disk (still booting from the pendrive, i.e. leaving the grub4dos on the USB stick, but removing - or renaming - the W10Q1900.vhd in the pendrive)?\n\nMaybe the issue is in the USB drivers, this way they are outside the protected mode part of the booting.\n\n![:duff:](http://reboot.pro/public/style_emoticons/default/duff.gif)\n\nWonko\n\n"
    },
    {
      "id": "215675",
      "timestamp": "2020-08-01T15:20:05+00:00",
      "author": "favorinus",
      "content": "I have copied the vhd to a hdd and now it\u0027s booting fine with filedisk booting.\n\nso the issue is with the usb mass storage drivers, they are install but not loaded early enough?\n\nwhat can I do now?\n\n"
    },
    {
      "id": "215678",
      "timestamp": "2020-08-01T16:05:14+00:00",
      "author": "Wonko the Sane",
      "content": "I don\u0027t know.\n\nWindows 10 should have \"native\" and \"working everywhere\" USB (3.0) drivers ![:unsure:](http://reboot.pro/public/style_emoticons/default/unsure.png)\n\nCould it be - for some reasons - that your \"passing through\" VirtualBox has changed some settings related to the USB bus?\n\nNow that you are filedisk booted from the .vhd on hard disk can you check that everything related to USB is OK?\n\nOr maybe it has been already \"fixed\" by booting on the \"real hardware\".\n\nI.e. if you now switch off the PC, reboot to your normal OS and copy back the booted .vhd from disk to USB stick, is it still the same?\n\nYou can also try (but I don\u0027t think it will make any change) to use the grub4dos USB stack ( add \"usb --init\" as first line in your tiltle(s) in menu.lst).\n\n![:duff:](http://reboot.pro/public/style_emoticons/default/duff.gif)  \nWonko\n\n"
    },
    {
      "id": "215702",
      "timestamp": "2020-08-02T18:01:57+00:00",
      "author": "alacran",
      "content": "@ favorinus\n\nThis are examples for Wimboot VHDs as filedisk or Ramdisk having SvBus driver installed (only required for Ramboot), using grub4dos 0.46a last version:\n\nRamboot from internal disk:  \n\ntitle 10x64-WB.vhd - SVBus RAMDISK - **map as (hd)** for WIMBOOT  \nfind --set-root --ignore-floppies /10x64-WB.vhd  \nmap --top --mem /10x64-WB.vhd **(hd)**   \nmap --hook  \n**root (hd-1,0)**   \nchainloader /bootmgr  \n\nFiledisk booting from internal disk:  \n\ntitle 10x64-WB.vhd - SVBus FILEDISK - **map as (hd)** for WIMBOOT  \nfind --set-root --ignore-floppies /10x64-WB.vhd  \nmap /10x64-WB.vhd **(hd)**   \nmap --hook  \n**root (hd-1,0)**   \nchainloader /bootmgr  \n\n\u003cbr /\u003e\n\nRamboot from external disk:  \n\ntitle 10x64-WB.vhd - SVBus RAMDISK - **map as (hd-1)** for WIMBOOT\n\nfind --set-root --ignore-floppies /10x64-WB.vhd  \nmap --top --mem /10x64-WB.vhd **(hd-1)**   \nmap --hook  \n**root (hd-1,0)**   \nchainloader /bootmgr  \n\n\u003cbr /\u003e\n\nFiledisk booting from external disk:  \n\ntitle 10x64-WB.vhd - SVBus FILEDISK - **map as (hd-1)** for WIMBOOT  \nfind --set-root --ignore-floppies /10x64-WB.vhd  \nmap /10x64-WB.vhd **(hd-1)**   \nmap --hook  \n**root (hd-1,0)**   \nchainloader /bootmgr\n\nBooting Wimboot VHDs has extremely precise requirements to first find the info into the new virtual drive (the VHD during booting) and also let the pointers inside the VHD find the source.wim coupled to it, (located on the USB device).\n\nAbout your issue:\n\u003e\n\u003e FILEDISK gives me an inaccessible boot device BSOD\n\nThis is caused when during boot the internal info contained into the VHD or the associated Wim file is not found, and may happend during RAMboot and/or filedisk booting that\u0027s the reazon to use **root (hd-1,0)** line on previous examples, and then avoid this issue in all cases:\n\nUse yor actual titles.\n\n**Adapt previous commands with your VHD name.**\n\nWhere using:\n\n**root (hd-1,0)**, the USB device is hd0, and the virtual disk is or will be hd1\n\nActually you have **root (hd-0,0)**on all your commands.\n\nIf this don\u0027t solve your issue, it is also possible you have something wrong on the internal BCD of your VHD (I really don\u0027t think it is the case). But it is better to give you also following info:\n\nIn that case you could also use [UEFI_MULTI](http://reboot.pro/files/file/618-usb-format-tool-and-uefi-multi/ \"\") or [VHD_WIMBOOT](http://reboot.pro/files/file/593-vhd-wimboot-apply-and-capture-of-wim-files-for-os-in-vhd/ \"\") from wimb, if using a NT 6.x MBR on your USB, both make entries on BCDs + an entry for grub4dos grld.mbr and add it and grld, and make also requiered entries to menu.lst for filedisk and Ram booting, and additionaly make an enty into the VHD internal BCDs.\n\nEDIT: See attached photo (as a guide) of the generic BCD valid when the VHD is on the root of a drive, wich is good when filebooting or rambooting from internal and external mass storage devices.\n\nalacran  \n\n#### Attached Thumbnails {#attach_wrap}\n\n* [![BCD into the VHD.png](http://reboot.pro/uploads/monthly_08_2020/post-26560-0-44557800-1596469775_thumb.png)](http://reboot.pro/uploads/monthly_08_2020/post-26560-0-44557800-1596469775.png \"BCD into the VHD.png - Size: 95.79KB\"){#ipb-attach-url-17292-0-30366600-1676066385}\n\n"
    },
    {
      "id": "215712",
      "timestamp": "2020-08-03T08:20:22+00:00",
      "author": "Wonko the Sane",
      "content": "@alacran\n\nRamdisk booting already works just fine.\n\nThe filedisk booting from USB (but not from internal disk) is the issue at hand.\n\nNow you explain to me which differences there are between:\n\u003e\n\u003e Filedisk booting from external disk:  \n\u003e\n\u003e title 10x64-WB.vhd - SVBus FILEDISK - map as (hd-1) for WIMBOOT  \n\u003e find --set-root --ignore-floppies /10x64-WB.vhd  \n\u003e map /10x64-WB.vhd (hd-1)  \n\u003e map --hook  \n\u003e root (hd-1,0)  \n\u003e chainloader /bootmgr\n\nand:\n\u003e\n\u003e title W10Q1900.vhd FILEDISK - 2 GB  \n\u003e find --set-root --ignore-floppies /W10Q1900.vhd  \n\u003e map /W10Q1900.vhd (hd0)  \n\u003e map --hook  \n\u003e root (hd0,0)  \n\u003e chainloader /bootmgr\n\nAs I am completely missing them.\n\n![:duff:](http://reboot.pro/public/style_emoticons/default/duff.gif)\n\nWonko\n\n"
    },
    {
      "id": "215718",
      "timestamp": "2020-08-03T11:49:48+00:00",
      "author": "alacran",
      "content": "My suggested commands for Ramboot and for filedisk boot, have proven to be reliable on all scenarios to boot any VHD, including standard VHDs, Wimboot VHDs and Compact installed VHDs, and so far are same used into UEFI_MULTI and WIMBOOT_VHD programs by wimb for any kind of VHDs.\n\n**In fact they are based on karyonix info.**\n\n**Then I could say with no dubt they are the only fullprove option valid for any kind of VHD.**\n\nUnfortunately the info is in several parts on some post located on this topic, where you and I were involved too:\n\n[http://reboot.pro/to...e-8#entry209770](http://reboot.pro/topic/18182-uefi-multi-make-multi-boot-usb-drive/page-8#entry209770 \"\")\n\nAlso this were my finding during my test:\n\n[http://reboot.pro/to...s-svbus-driver/](http://reboot.pro/topic/21968-more-deeper-understanding-of-mapped-drive-number-for-rambooting-wimboot-vhds-from-internal-hd-using-grub4dos-svbus-driver/ \"\")\n\n**EDIT:** also don\u0027t forget the final comment on my previous post:\n\u003e\n\u003e **If this don\u0027t solve your issue, it is also possible you have something wrong on the internal BCD of your VHD (I really don\u0027t think it is the case)**. But it is better to give you also following info....\n\u003e\nalacran\n\n"
    },
    {
      "id": "215721",
      "timestamp": "2020-08-03T13:27:49+00:00",
      "author": "Wonko the Sane",
      "content": "I don\u0027t want to be grumpier than usual, but the OP issue is NOT about Ramdisk booting that works just fine. (so it makes no sense to post a solution about a non-issue).\n\nThe issue is about Filedisk booting (and Filedisk booting from USB ONLY).\n\nYou cannot (actually you can just fine :smile:) post a suggestion that is (seemingly) functionally IDENTICAL to what the OP is already using (and failing with) ++unless++ you explain in what it is different (and hopefully better).\n\nThe point (there and in a different context) was about assigning something to (hd) (next disk drive) and chainloading (hd-1) i.e. last drive before the next one:\n\nIn this post you are suggesting to assign something to (hd-1) and then chainloaing the same (hd-1), so it seems to me very, very like using in both lines (hd0).![:dubbio:](http://reboot.pro/public/style_emoticons/default/dubbio.gif)\n\n![:duff:](http://reboot.pro/public/style_emoticons/default/duff.gif)\n\nWonko\n\n"
    },
    {
      "id": "215724",
      "timestamp": "2020-08-03T15:45:14+00:00",
      "author": "alacran",
      "content": "\u003e In this post you are suggesting to assign something to (hd-1) and then chainloaing the same (hd-1), so it seems to me very, very like using in both lines (hd0).\n\nAgree.\n\nThe idea was to let favorinus know this general use commands, without looking/analyzing very carefuly he should get similar results with hd0, on standard VHDs.\n\nThen the only other possible cause of the issue should be on the BCD of the VHD.\n\nI\u0027m going to edit that post and add a picture of the generic BCD valid when the VHD is on the root of a drive, wich is good when filebooting or rambooting from internal and external mass storage devices.\n\nThanks for your comment into my quote, it was the key that made me look the similar results, on standard VHDs.\n\nIt is good someone let you know when you misslook something.\n\nalacran\n\n"
    },
    {
      "id": "215726",
      "timestamp": "2020-08-03T16:34:42+00:00",
      "author": "Wonko the Sane",
      "content": "\u003e Then the only other possible cause of the issue should be on the BCD of the VHD.  \n\u003e\n\u003e I\u0027m going to edit that post and add a picture of the generic BCD valid when the VHD is on the root of a drive, wich is good when filebooting or rambooting from internal and external mass storage devices.\n\nI don\u0027t know. ![:dubbio:](http://reboot.pro/public/style_emoticons/default/dubbio.gif)  \n\nThe error is a 0x0000007b, which should happen post BCD and definitely is related to mass storage device (or its drivers).  \n\nIf you prefer, the chainloading of BOOTMGR must be working (itherwise he would have a grubdos error), then the BCD must be found (otherwise he would have a \"missing BCD\" error 0xc0000034, \"The Boot Configuration Data file is missing.\"), but it goes a bit further, either WINLOAD.EXE is also found (or he would have a 0xc000000f \"The selected entry could not be loaded because the application is missing or corrupt.\") or - and this is what I believe - the issue happens within BOOTMGR but post BCD the sheer moment the devices are re-enumerated due to the \"switch\" between real and protected mode, i.e. between BCD and WINLOAD.EXE.\n\nOf course it doesn\u0027t happen on Ramdisk (as the whole stuff is already loaded in memory and mapped correctly by grub4dos) and - less obviously but still making sense - it doesn\u0027t happen if the VHD is on the internal disk (surely accessible).\n\nSo what remains is something connected to the BIOS (these days unlikely), to USB drivers (more likely) or to the particular stick used (rare but possible\\[1\\])\n\nThere was something \"loosely\" similar to this related to installing XP from USB:  \n[https://msfn.org/boa...er-d-and-not-u/](https://msfn.org/board/topic/131770-solved-usbstick-take-letter-d-and-not-u/ \"External link\")\n\n![:duff:](http://reboot.pro/public/style_emoticons/default/duff.gif)\n\nWonko\n\n\\[1\\] Anecdata, many years ago I removed the serial number from a USB stick while making an unrelated experiment with it, then several weeks later tried a particular software (sort of portable dektop/environmentm cannot really remember the name) and there was no way I could install/run it on that particular stick (but it worked just \"fine\" - actually it was essentially some crappy stuff - on \\*any\\* other stick I tested it on). Long story short, after I re-used the stick \"Manufacturer Tool\" to re-assign to the stick a serial, the program started working even on that stick.\n\n\u003cbr /\u003e\n\n\u003cbr /\u003e\n\n\u003cbr /\u003e\n\n"
    },
    {
      "id": "215729",
      "timestamp": "2020-08-03T18:22:55+00:00",
      "author": "alacran",
      "content": "\u003e The error is a 0x0000007b, which should happen post BCD and definitely is related to mass storage device (or its drivers)...\n\u003e\n\u003e So what remains is something connected to the BIOS (these days unlikely), to USB drivers (more likely) or to the particular stick used\n\nWhat I would do then (free options first, starting with possible human errors):\n\nIt doesn\u0027t hurt to verify the BCD first, just to descart that something is wrong in it.\n\nCheck current Bios settings related to USB, just to descart that something is wrongly selected.\n\nTry same USB on all MBR USB port available, usually they supply better Volts, Ampers and transfer speed than front ports.\n\nTry booting on another PC with current USB device.\n\nCheck MB/PC manufacturer page to see if there is a new Bios version, and install it if available, even if there is no mention related to USB, (sometimes they don\u0027t mention all changes/improvements).\n\nTry using another USB device (preferable new and a reputable brand), to discart incompatibility.\n\nIf nothing on this list solves the issue buy a new PC (just joking).\n\nalacran\n\n"
    },
    {
      "id": "215732",
      "timestamp": "2020-08-03T21:52:11+00:00",
      "author": "favorinus",
      "content": "thank you all for the replies, but still no joy,\n\nthe internal bcd is the same as posted by alacran,\n\nI will try another usb stick\n\nthe bsod also occurs on an another PC.\n\n**Edited by favorinus, 03 August 2020 - 10:22 PM.**\n"
    },
    {
      "id": "215733",
      "timestamp": "2020-08-03T23:29:07+00:00",
      "author": "favorinus",
      "content": "As a work-around I tried to boot the vhd as FILEDISK using windows 10 native vhd boot.  \n\nfirst boot to grub4dos  \n\nthen  \ntitle Windows 10 native VHD  \nchainloader /bootmgr10  \n\nthis loads /boot/BCD  \n\nwhich will look for W10Q1900.vhd\n\nthis results in a  \n\nVHD BOOT INITIALIZATION FAILED\n\n????\n\n"
    },
    {
      "id": "215734",
      "timestamp": "2020-08-04T02:46:01+00:00",
      "author": "alacran",
      "content": "After reading again your first post looking very carefuly if I missed some info, this are my findings.\n\nFrom your fist post:\n\n\u003e My goal is to have a small windows 10 running in RAM loaded from USB. I have done this with XP and windows 8, but now I am stuck with windows 10.\n\nDoes the 8 VHD boots fine as filedisk and ramdisk on your current USB device?\n\nIf the answer is NO, your USB maybe is not working fine or is not fully compatable with your PC under certain circunstances.\n\nIf the answer is YES, then the problen could be related to the following:\n\n\u003e steps I made:\n\u003e\n\u003e **removed the useless things from windows 10 with Winreducer.**\n\u003e\n\u003e install the produced ISO with mode: LZX into VHD with WinNTsetup 4.2.1\n\u003e\n\u003e run the vhd in **virtuablx** to check anything running smooth and **install svbus 1.1 while in virtualbox running**.\n\n**If you installed the Virtual Box additional package** it has its own drivers and other things to improve the VM funcionality, perhaps this overwrited the original USB drivers, part of them, or the services required to start the driver, the entries on the reg file controling the timings of this service, etc\n\n**About SvBus driver** , on [post No. 115](http://reboot.pro/topic/21787-svbus-virtual-scsi-host-adapter-for-grub4dos/page-5#entry214468 \"\")the author says:\n\n\u003e ++**SVBus V1.2 Virtual SCSI Host Adapter for GRUB4DOS**++   \n\u003e\n\u003e Today we present the new virtual SCSI driver SVBus version 1.2 for use with GRUB4DOS. **SVBus V1.1 was not working correctly in combination with Windows 10 x64 Build 1803 and later.**This could lead to a system crash with BSOD and the error CRITICAL_PROCESS_DIED. We discovered a Microsoft bug in esent.dll, which lead to these critical errors. Details are listed in the ReadMe.txt topic named \"Application and Service Crashes on Windows 10 x64 Build 1909 with SVBus version 1.1\".  \n\u003e\n\u003e In addition we added mode page caching for the MODE SENSE (6) command. The virtual HDD needs MODE PAGE CACHING to display the tab Policies in the Properties of the HDD in device manager.\n\u003e\n\u003e **To download the newest version use the link in my first post.**\n\u003e\n\u003e Much respect go out to all the heroes who work very hard in hospitals all over the world at the moment to fight COVID-19.\n\u003e\n\u003e Keep up your amazing work and spirit!\n\u003e\n\u003e Greets  \n\u003e Kai Schtrom\n\nBetter use SVBus version 1.2 on a new build, and better don\u0027t use any Virtual Machine, you don\u0027t need it, create the VHD on a partition of your PC, WinNTSetup will create the entry on your PC BCD to let you boot from it.\n\nI noticed in your last post you followed more or less the instructions from SVBus author, they are not bad but in my next post (to not miss the target of this post), I will suggest you my manual way, or the automated way using WIMBOOT_VHD by wimb.\n\nFor next comment I will consider the USB device is OK:\n\n**Abut the use of Winreducer:** as the 10 OS on the VHD boots fine when loaded on RAM (by grub4dos) and only fails when starts file booting there is also the possibility the USB funtions are not working to its full capacity because some part of the driver, the services required to start the driver, the entries on the reg file controling the timings of this service, etc were affected during the reduction with Winreducer.\n\nalacran\n\n"
    },
    {
      "id": "215740",
      "timestamp": "2020-08-04T15:48:25+00:00",
      "author": "alacran",
      "content": "I recommend you to start from scratch a new build.\n\nThe procedure made by SVBus author Kai Schtrom is not bad, but I have the opinion the procedures here on reboot.pro are better, as give the user more booting alternatives (MBR \\\u0026 UEFI), using Windows bootmanager + grub4dos and also grub (optional) to let the user include (boot) also Linux distros on same USB device, and do not modify/delete files related to Windows boot files/folders, not only using grub4dos alone as boot loader (good only for MBR).\n\nMy topics related to Wimboot and Compact Installs (manual procedures)\n\n**Read this first:**\n\n**Following topic has info related to Compact Mode Installs:** (basically same applies for Wimboot Installs too):[http://reboot.pro/to...-mode-installs/](http://reboot.pro/topic/22323-compact-mode-installs/ \"\")\n\n**You can skip this, but it has all procedure in detail for Wimboot installs and has good info and test done:**\n\nLong topic about Wimboot Installs: [http://reboot.pro/to...vhd/?hl\u003dwimboot](http://reboot.pro/topic/21957-making-the-smallest-win10-install-wimboot-mode-on-512-mb-vhd/?hl\u003dwimboot \"\")\n\n**Wimb programs to automate Wimboot and Compact Installs:**\n\n**USB Format Tool and UEFI_MULTI:** [http://reboot.pro/fi...and-uefi-multi/](http://reboot.pro/files/file/618-usb-format-tool-and-uefi-multi/ \"\")\n\n**VHD_WIMBOOT - Apply and Capture of WIM Files for OS in VHD:** [http://reboot.pro/fi...-for-os-in-vhd/](http://reboot.pro/files/file/593-vhd-wimboot-apply-and-capture-of-wim-files-for-os-in-vhd/ \"\")\n\nNOTE: Good for Standard, Wimboot and Compact installs. Into this download is included a pdf file with recommended procedure.\n\nLet us know latter if this helped you to solve the issue.\n\ni wich you good luck in your builds\n\nalacran\n\n"
    },
    {
      "id": "215763",
      "timestamp": "2020-08-06T15:32:59+00:00",
      "author": "favorinus",
      "content": "thank you .\n\nI am doing a lot of trial and error looking for a solution. I started all over again with an untouched windows 10 iso: 2016 LTSB version\n\nfirst format the pendrive with rufus 3.11 MBR partition NTFS and let rufus install grub4dos 0.4.6a on it.\n\nwith winntsetup 4.2.1 create an 11GB vhd\n\nrightclick \"add drivers\" to active unsigned drivers and select svbus 1.2\n\ninstall the windows 10 into de vhd and reboot on my pc. As the vhd is added to the BCD I booted into the new created windows 10 and it\u0027s working fine, I see the svbus 1.2 installed.\n\nrebooted back into my every-day-use windows 8.1 and copy the vhd into my pendrive with this menu.lst:\n\ntitle Windows10.vhd - SVBus FILEDISK - map as (hd)\n\nfind --set-root --ignore-floppies /Windows10.vhd\n\nmap /Windows10.vhd (hd)\n\nmap --hook\n\nroot (hd-1,0)\n\nchainloader /bootmgr\n\ntitle Windows10.vhd.vhd - SVBus RAMDISK - map as (hd-1)\n\nfind --set-root --ignore-floppies /Windows10.vhd\n\nmap --top --mem /Windows10.vhd (hd-1)\n\nmap --hook\n\nroot (hd-1,0)\n\nchainloader /bootmgr\n\nand guess what: BSOD inaccessible boot disk on my projected computer, and on my laptop infinity dots rotating.\n\ncan it be that the BIOS mode is some sort of buggy?\n\nI will try the suggested **UEFI_MULTI** posted here above. grub2 can also boot windows 10 as ramdisk ?\n\nps: how can I add pictures to the post?\n\n"
    },
    {
      "id": "215765",
      "timestamp": "2020-08-06T16:13:02+00:00",
      "author": "Wonko the Sane",
      "content": "I still am not convinced of the menu.lst you used.\n\nCan you try on command line? (press \\[Enter\\] after typing each line to issue the command)\n\n```\n\nfind --set-root /Windows10.vhd\nroot \n```\n\nThis root command should output either (hd0,0) or (hd1,0) a result,\n\nIf the output of root is (hd0,0), run these commands:\n\n```\n\nmap (hd0) (hd1)\nmap --hook\nfind --set-root /Windows10.vhd\nroot\n```\n\nIf the above is (hd1,0), then run:\n\n```\n\n\n\nmap /Windows10.vhd (hd0)\nmap --hook\nroot (hd0,0)\nroot\n\n```\n\nIf the above is (hd0,0), then run:\n\n```\n\nchainloader /bootmgr\n```\n\nyou should get a message simillar to \"Will boot ntldr from drive\u003d0x80, partition\u003d0x0 (hiden sectors\u003d0x800)...\"\n\nNow issue:\n\n```\n\nboot\n```\n\n![:duff:](http://reboot.pro/public/style_emoticons/default/duff.gif)\n\nWonko\n\n"
    },
    {
      "id": "215766",
      "timestamp": "2020-08-06T16:39:44+00:00",
      "author": "favorinus",
      "content": "Hi wonko,\n\nI have done all you descripted and the result is the same as your.\n\nIt is showing the dots for some 10 seconds and then BSOD INACCESSIBLE BOOT DEVICE\n\n"
    },
    {
      "id": "215768",
      "timestamp": "2020-08-06T18:06:49+00:00",
      "author": "Wonko the Sane",
      "content": "I forgot to put the \"--set-root\" in the commands. :blush:\n\nI just corrected them.\n\nCan you try again?\n\nNot that it will probably change anything, but the commands (as I posted them earlier, wrong) should have not worked at all, so there must be some ![:wodoo:](http://reboot.pro/public/style_emoticons/default/wodoo.gif) involved.\n\nAnd you cannot have possibly done all I described, as they were a set of conditional commands, please describe EXACTLY what happens (and which commands you use) while in grub4dos.\n\n![:duff:](http://reboot.pro/public/style_emoticons/default/duff.gif)\n\nWonko\n\n"
    },
    {
      "id": "215769",
      "timestamp": "2020-08-06T20:22:09+00:00",
      "author": "favorinus",
      "content": "Ok here we go:\n\nnow I am in the grub4dos 0.4.6a commandline\n\ngrub\\\u003e find --set-root /Windows10.vhd\n\n(hd0,0)\n\ngrub\\\u003e root\n\n(hd0,0) Filesystem type is ntfs, partition type 0x07\n\nVolume Name is \"Radio\"\n\ngrub\\\u003e map (hd0) (hd1)\n\nfloppies_orig\u003d0, harddrives_orig\u003d1, floppies_curr\u003d0, harddrives_curr\u003d2\n\ngrub\\\u003emap --hook\n\ngrub\\\u003efind --set-root /Windows10.vhd\n\n(hd0,0)\n\ngrub\\\u003eroot\n\n(hd0,0) Filesystem type is ntfs, partition type 0x07\n\nVolume Name is \"Radio\"\n\ngrub\\\u003e chainloader /bootmgr\n\nError 15: File not found\n\ngrub\\\u003e\n\n\u003cbr /\u003e\n\n"
    },
    {
      "id": "215770",
      "timestamp": "2020-08-07T09:08:50+00:00",
      "author": "wimb",
      "content": "USB-Stick is too slow for booting Win10 VHD as FILEDISK\n\nYour VHD is booting OK from RAMDISK and as FILEDISK when located on internal Harddisk.\n\nBoth cases are much faster.\n\nTry the very fast [USB Portable SSD](https://www.samsung.com/us/computing/memory-storage/portable-solid-state-drives/portable-ssd-t5-500gb-mu-pa500b-am/ \"External link\") for booting Win10 VHD as FILEDISK.\n\nMore Info:\n\n"
    },
    {
      "id": "215771",
      "timestamp": "2020-08-07T09:25:37+00:00",
      "author": "Wonko the Sane",
      "content": "\u003e I will try again, because it\u0027s so easy to make a mistake ![:blink:](http://reboot.pro/public/style_emoticons/default/blink.png)\n\nYes, you missed a step, and I possibly made some confusion, it is difficult to suggest a sequence of commands remotely, let\u0027s see if I can clear the idea with a more verbose example:\n\nfind --set-root /Windows10.vhd \\\u003c- this finds the vhd and sets root to the disk/volume  \nroot \\\u003c- this confirms that the vhd is on (and you are root on) (hd0,0)  \nmap (hd0) (hd1) \\\u003c- this map the first disk to second disk  \nmap --hook \\\u003c- this hooks the mapping  \nfind --set-root /Windows10.vhd \\\u003c- this is the same of the previous one, you can omit that as - in this moment - you should have the same disk mapped as both (hd0) and (hd1) do the find command will find the .vhd on first volume it scans (hd0,0)  \nroot \\\u003c- this is the same of the previous one, you can omit that, as it will still result as (hd0,0)  \nmap /Windows10.vhd (hd0) \\\u003c- this maps the .vhd to (hd0)  \nmap --hook \\\u003c- this hooks the mapping  \nroot (hd0,0) \\\u003c- this moves the root to the just mapped (hd0), i.e. the .vhd   \nroot \\\u003c- this should have different results from the previous one as this is now the .vhd\n\nfind /Windows10.vhd \\\u003c- this should result in (hd1,0)\n\ngeometry (hd0) \\\u003c- this should confirm that (hd0) is now the .vhd\n\ngeometry (hd1) \\\u003c- and this should confirm that the USB stick is now (hd1)\n\nroot (hd0,0)\\\u003c- this is unneeded as root shoiuld be already (hd0,0) but better be sure\n\nchainloader /bootmgr \\\u003c- this chainloads the bootmanager inside current root (hd0,0), i.e. the one inside the .vhd  \nboot \\\u003c- this passes control to the chainloaded bootmgr and boots\n\nAll the above basically is about mapping the .vhd to first disk AND keep the USB stick available at BIOS level as second disk.\n\nIf it doesn\u0027t work, try doing the opposite, i.e. leaving the USB stick as first disk and map the .vhd to second disk, i.e.:\n\nfind --set-root /Windows10.vhd \\\u003c- this finds the vhd and sets root to the disk/volume  \nroot \\\u003c- this confirms that the vhd is on (and you are root on) (hd0,0)  \nmap /Windows10.vhd (hd1) \\\u003c- this maps the .vhd to (hd1)  \nmap --hook \\\u003c- this hooks the mapping  \nroot (hd1,0) \\\u003c- this moves the root to the just mapped (hd1), i.e. the .vhd   \nroot \\\u003c- this should have different results from the previous one as this is now the .vhd\n\nfind /Windows10.vhd \\\u003c- this should result in (hd0,0)\n\ngeometry (hd0) \\\u003c- this should confirm that (hd0) is the USB stick\n\ngeometry (hd1) \\\u003c- and this should confirm that the .vhd is now (hd1)\n\nroot (hd1,0)\\\u003c- this is unneeded as root shoiuld be already (hd1,0) but better be sure\n\nchainloader /bootmgr \\\u003c- this chainloads the bootmanager inside current root (hd1,0), i.e. the one inside the .vhd  \nboot \\\u003c- this passes control to the chainloaded bootmgr and boots\n\n![:duff:](http://reboot.pro/public/style_emoticons/default/duff.gif)\n\nWonko\n\n"
    },
    {
      "id": "215772",
      "timestamp": "2020-08-07T09:40:17+00:00",
      "author": "Wonko the Sane",
      "content": "\u003e USB-Stick is too slow for booting Win10 VHD as FILEDISK\n\u003e\n\u003e Your VHD is booting OK from RAMDISK and as FILEDISK when located on internal Harddisk.\n\u003e\n\u003e Both cases are much faster.\n\nSure they are much faster but also BOTH do not use the USB driver/stack of Windows 10.\n\nIf you suspect a timing problem, maybe it can be fixed \\*somehow\\*?. ![:unsure:](http://reboot.pro/public/style_emoticons/default/unsure.png)\n\n\u003e **Try** the very fast [USB Portable SSD](https://www.samsung.com/us/computing/memory-storage/portable-solid-state-drives/portable-ssd-t5-500gb-mu-pa500b-am/ \"External link\") for booting Win10 VHD as FILEDISK.\n\nIn exchange for a mere 100 bucks or so ... ![:rolleyes:](http://reboot.pro/public/style_emoticons/default/rolleyes.gif)\n\n![:duff:](http://reboot.pro/public/style_emoticons/default/duff.gif)\n\nWonko\n\n"
    },
    {
      "id": "215773",
      "timestamp": "2020-08-07T10:37:43+00:00",
      "author": "wimb",
      "content": "\u003e In exchange for a mere 100 bucks or so ... ![:rolleyes:](http://reboot.pro/public/style_emoticons/default/rolleyes.gif)\n\u003e\n[USB Portable SSD 500 GB](https://www.coolblue.nl/en/product/785050/samsung-portable-ssd-t5-500gb.html \"External link\") - now in my country for € 89,-\n\n**@favorinus**\n\nWhat kind of USB-Stick Make and Type are you using 2.0 or 3.0 ?\n\nYour Windows 10 VHD has Compact Install with **LZX Compression**.\n\nBooting such LZX Install as FILEDISK on USB requires fast USB medium connected through USB 3.0 and powerful computer\n\n**EDIT:**\n\nWhat is the WOF Status of your VHD Internal files bootmgr and Boot\\\\BCD ?\n\nTry [WOF_Compress](http://reboot.pro/topic/22020-wof-compress/ \"\") and use WOF_Compress_Trusted.cmd to UnCompress these files.\n\n**Download** from wimb GitHub - [WOF_Compress](https://github.com/wimbrts/WOF_Compress/releases \"External link\")\n\nAlso use [**BOOTICE**](http://reboot.pro/files/file/592-bootice-v1332/ \"\") to view if VHD Internal Boot\\\\BCD is present and OK or has \\\u003cunknown\\\u003e entry .....that does not work ....\n\n[VHD_WIMBOOT](http://reboot.pro/topic/21977-vhd-wimboot-apply-and-capture-of-wim-files-for-os-in-vhd/ \"\") and [UEFI_MULTI](http://reboot.pro/files/file/279-uefi-multi-make-multi-boot-usb-drive/ \"\") take care to make Boot\\\\BCD and bootmgr inside VHD,\n\nwhereas WinNTSetup does not do this ....and grub4dos booting will fail ....\n\nAlso VHD_WIMBOOT after wimlib Capture in WimBoot mode followed by wimlib Apply will use WIM file Windows\\\\System32\\\\WimBootCompress.ini\n\nwith \\\\bootmgr and \\\\Boot\\\\BCD in \\[PrepopulateList\\] section so that these files will be Normal instead of may be LZX Compressed in your case ..... giving grub4dos Boot failure.\n\nFor booting as FILEDISK it is preferred to useinstead of SVBus the Microsoft vhdmp.sys driver and have Boot entry in Windows Boot Manager menu as made by UEFI_MULTI or VHD_WIMBOOT\n\n"
    },
    {
      "id": "215774",
      "timestamp": "2020-08-07T11:18:52+00:00",
      "author": "Wonko the Sane",
      "content": "\u003e [USB Portable SSD 500 GB](https://www.coolblue.nl/product/785050/samsung-portable-ssd-t5-500gb.html?cmt\u003dc_a%2Ccid_8863867846%2Caid_92064546711%2Ctid_pla-329108927896%2Cgn_g%2Cd_c\u0026gclid\u003dCjwKCAjw97P5BRBQEiwAGflV6U3bGyPeK161HGElfV24R6ftKmQI4NU-sLHfClTv8vW5hY71XKWuMxoCjhoQAvD_BwE \"External link\") - now in my country for € 89,-\n\nRight now:\n\n[https://www1.oanda.c...ency/converter/](https://www1.oanda.com/currency/converter/ \"External link\")\n\n89 € are 105,62 US$\n\nI stand by my \"mere 100 bucks or so ...\".\n\nNow 90 € or 105 US$ are not - in my personal book - \"peanuts\".\n\nIsn\u0027t it funny that an Italian tells a Dutch how unneeded expenditures should be carefuly evaluated? ![:unsure:](http://reboot.pro/public/style_emoticons/default/unsure.png)\n\nPlease also consider that the OP comes from Argentina, where AFAIK the minimum salary is around 300-350 USD and the average is around 500-600 USD.\n\nAnd where that T5 thingy seemingly sells for 15.000-20,000 pesos:\n\n[https://tiendamia.co...?amz\u003dB073GZBT36](https://tiendamia.com/ar/producto?amz\u003dB073GZBT36 \"External link\")  \n[https://www.mercadol...l/p/MLA9282793?](https://www.mercadolibre.com.ar/disco-solido-externo-samsung-t5-mu-pa500b-500gb-azul/p/MLA9282793? \"External link\")\n\ni.e. more than double the EU price, like 205-275 US$\n\n![:duff:](http://reboot.pro/public/style_emoticons/default/duff.gif)\n\nWonko\n\n"
    },
    {
      "id": "215789",
      "timestamp": "2020-08-09T17:04:00+00:00",
      "author": "favorinus",
      "content": "Hi WONKO,\n\nI have tried your both grub4dos entries but both fail.\n\nfact is: when the vhd is located on a hard disk drive FILEDISK will work but when it\u0027s placed on the USB Stick FILEDISK will fail.\n\nI tried a lot to find a solution: untouched windows10. untouched windows 8.1. use bootice to edit the bcd inside the vhd,\n\nused different usb sticks (usb 2 and 3). used different PC\u0027s all the same: a nice BSOD ACCESSIBLE BOOT DEVICE\n\nwhat else can I try?\n\n"
    },
    {
      "id": "215790",
      "timestamp": "2020-08-09T18:06:30+00:00",
      "author": "Wonko the Sane",
      "content": "I don\u0027t know.\n\n\"both fail\" isn\u0027t a useful report.\n\nThey should, I believe, at least fail *differently*.\n\nI know we are a bunch of inquisitive people and - at least personally, an annoying old grumpy bastard (and cheap :wink: ) - but here everyone asked questions and you didn\u0027t reply properly to all of them.\n\nLet\u0027s start again, here is a set of numbered questions, some of them already asked (and not replied to):\n\n1) What computer is that?  \n2) What USB stick is that?  \n3) Does the 8 VHD boots fine as filedisk and ramdisk on your current USB device? (or - if you prefer - is it only Windows 10, and while we are at it the peculiar 2016 LTSB version you are using that created the issue?)\n\n4) In you report here: [http://reboot.pro/to...mboot/?p\u003d215769](http://reboot.pro/topic/22332-boot-windows-10-vhd-from-usb-also-ramboot/?p\u003d215769 \"\")\n\nyou say grub4dos tells you:\n\n```\ngrub\u003e map (hd0) (hd1) \n\nfloppies_orig\u003d0, harddrives_orig\u003d1, floppies_curr\u003d0, harddrives_curr\u003d2\n```\n\nbut his would mean that you have only one hard disk (the USB stick) connected? ![:dubbio:](https://reboot.pro/public/style_emoticons/default/dubbio.gif)\n\n5) Have you tried a non-compact build? Compare with:  \n[http://reboot.pro/to...mboot/?p\u003d215773](http://reboot.pro/topic/22332-boot-windows-10-vhd-from-usb-also-ramboot/?p\u003d215773 \"\")\n\n![:duff:](https://reboot.pro/public/style_emoticons/default/duff.gif)\n\nWonko\n\n"
    },
    {
      "id": "215791",
      "timestamp": "2020-08-09T18:09:42+00:00",
      "author": "alacran",
      "content": "\u003e I recommend you to start from scratch a new build.\n\u003e\n\u003e **Wimb programs to automate Wimboot and Compact Installs:**\n\u003e\n\u003e **USB Format Tool and UEFI_MULTI:** [http://reboot.pro/fi...and-uefi-multi/](http://reboot.pro/files/file/618-usb-format-tool-and-uefi-multi/ \"\")\n\u003e\n\u003e **VHD_WIMBOOT - Apply and Capture of WIM Files for OS in VHD:** [http://reboot.pro/fi...-for-os-in-vhd/](http://reboot.pro/files/file/593-vhd-wimboot-apply-and-capture-of-wim-files-for-os-in-vhd/ \"\")\n\u003e\n\u003e NOTE: Good for Standard, Wimboot and Compact installs. Into this download is included a pdf file with recommended procedure.\n\u003e\n\u003e Let us know latter if this helped you to solve the issue.\n\u003e\n\u003e i wich you good luck in your builds\n\u003e\n\u003e alacran\n\n\u003cbr /\u003e\n\n"
    },
    {
      "id": "215792",
      "timestamp": "2020-08-09T19:13:04+00:00",
      "author": "favorinus",
      "content": "Hi Wonko,\n\nI am sorry that I am not that clear, I will try to explain the best possible.\n\n\"both fail\" I mean map the vhd on hd0 and the usb stick on hd1 and vica versa, doesn\u0027t matter both result in the bsod.\n\n1) What computer is that?\n\nmy target system is Asrock Q1900-itx , nothing fancy I think. has 2 sodimm modules of 4GB. and the intel celeron J1900 cpu (4 cores)\n\nother test system is a acer e5-573, 12 GB of ram.\n\nHi Alacran, I will try the **VHD_WIMBOOT** also.\n\n2) What USB stick is that?\n\nKingston datatraveler 100 G3 64GB\n\nSamsung 256GB usb 3.1\n\nsandisk cruzer blade 16GB usb 2.0\n\n3) Does the 8 VHD boots fine as filedisk and ramdisk on your current USB device? (or - if you prefer - is it only Windows 10, and while we are at it the peculiar 2016 LTSB version you are using that created the issue?)\n\nNo windows 8.1 is not booting as filedisk from usb either, it\u0027s from a hard disk drive. although I remember I have had it worked also from usb stick ones, can it be with firadisk?\n\n4) but his would mean that you have only one hard disk (the USB stick) connected?\n\nYes I disconnect the sata cable before testing the usb stick.\n\n5) Have you tried a non-compact build?\n\nyes I always make non-compact build now for testing, so there is one possible cause less.\n\n"
    },
    {
      "id": "215794",
      "timestamp": "2020-08-10T00:19:53+00:00",
      "author": "alacran",
      "content": "About:\n\nAcer e5-573 [Intel Celeron 2957U](https://ark.intel.com/content/www/us/en/ark/products/78942/intel-celeron-processor-2957u-2m-cache-1-40-ghz.html \"External link\") 1.40 GHz 2 Cores 2 Threads, 12 GB Ram.\n\nThe 2957U Processor seems to me very weak for LZX Compression, For Ram boot it should work as all is on Ram, but even from Ram it will feel slow, I would use Compact 4K Compression (or Express 4K on wimlib terminology) for file booting on this CPU.\n\nAbout:\n\nAsrock Q1900-itx [Intel Celeron® J1900](https://ark.intel.com/content/www/us/en/ark/products/78867/intel-celeron-processor-j1900-2m-cache-up-to-2-42-ghz.html \"External link\") 2 - 2.42 GHz 4 Cores 4 Threads, 8 GB Ram.\n\nThe J1900 Processor is not so weak as the other, but it isn\u0027t a powerful Processor too.\n\nAbout the USB devices:\n\nSandisk cruzer blade 16GB usb 2.0 \\\u003e\\\u003e\\\u003e You may boot some WinPEs from it as they load to Ram, but USB 2.0 is too slow for file boot a VHD fine. Don\u0027t use it for this task. I booted once a uncompressed XP x86 VHD from a USB 2.0 stick and it was so slow it was unusable, but from a USD 2.0 HDD it booted fine.\n\nThe other 2 are USB 3.1 devices, they look fine, and they should work fine too.\n\nSo the Asrock Q1900-itx (Intel Celeron® J1900, 2 - 2.4 GHz 2 Cores 4 Threads, 8 GB Ram), should be capable to file boot a 10x64 LZX VHD from a USB 3.0 device, maybe a few slow (depending on actual USB speed) but it should be definitively capable to do it.\n\nBetter check following settings in UEFI Bios/Firmware:\n\n**Is Fast Boot disabled on UEFI firmware?**\n\nPlease verify and if it isn\u0027t disabled, disable it.\n\nFrom your MB Asrock Q1900-itx Manual, pag. 49:\n\u003e\n\u003e **Fast Boot**   \n\u003e Fast Boot minimizes your computer\u0027s boot time. In fast mode you may not boot  \n\u003e from an USB storage device. Ultra Fast mode is only supported by Windows 8 and  \n\u003e the VBIOS must support UEFI GOP if you are using an external graphics card.  \n\u003e Please notice that Ultra Fast mode will boot so fast that the only way to enter this  \n\u003e UEFI Setup Utility is to Clear CMOS or run the Restart to UEFI utility in Windows.\n\n**About USB**, on the manual on pag. 43, it says this\n\u003e **USB Controller**   \n\u003e Enable or disable all the USB ports.  \n\u003e\n\u003e **USB 3.0 Controller**   \n\u003e Enable or disable all the USB 3.0 ports.  \n\u003e\n\u003e **Legacy USB Support**   \n\u003e Enable or disable Legacy OS Support for USB 2.0 devices. If you encounter USB compatibility issues it is recommended to disable legacy USB support.  \n\u003e Select UEFI Setup Only to support USB devices under the UEFI setup and Windows/Linux operating systems only.\n\nI would try first all 3 enabled, and try file booting from your USB 3.1 device.\n\nIf previous setting don\u0027t work, then I would try selecting **UEFI Setup Only** on **Legacy USB Support** option, and try againg file booting from your USB 3.1 device.\n\n**EDIT:**\n\nWhen selecting **UEFI Setup Only,** if you have a USB keyboard, maybe you can\u0027t use it, if booting from grub4dos, better keep the filedisk booting as default option on menu.lst, or don\u0027t use grub4dos in this case, and boot from Windows boot manager directly.\n\nalacran\n\n"
    },
    {
      "id": "215796",
      "timestamp": "2020-08-10T02:35:32+00:00",
      "author": "favorinus",
      "content": "Hi Alacran,\n\nyes fastboot is disabled, I will try the **UEFI Setup Only setting.**\n\ntweaking the speed is a luxury for now, as I am still not able to boot :-(\n\n"
    },
    {
      "id": "215812",
      "timestamp": "2020-08-10T12:53:18+00:00",
      "author": "favorinus",
      "content": "another idea/question.\n\nis Windows Boot Manager capable of booting vhd from usb? I can use that as a workaround.\n\n"
    },
    {
      "id": "215815",
      "timestamp": "2020-08-10T13:05:59+00:00",
      "author": "wimb",
      "content": "\u003e For booting as FILEDISK it is preferred to useinstead of SVBus the Microsoft vhdmp.sys driver and have Boot entry in Windows Boot Manager menu as made by UEFI_MULTI or VHD_WIMBOOT\n\nSure Windows Boot Manager can be used to boot Win10 VHD as FILEDISK.\n\nIn that case Win10 vhdmp.sys driver is used and SVBus driver is not used.\n\nSVBus driver is only really needed in case of using grub4dos for booting from RAMDISK.\n\n"
    },
    {
      "id": "215830",
      "timestamp": "2020-08-11T14:37:13+00:00",
      "author": "moriarty",
      "content": "\u003e Sure Windows Boot Manager can be used to boot Win10 VHD as FILEDISK.\n\u003e\n\u003e In that case Win10 vhdmp.sys driver is used and SVBus driver is not used.\n\u003e\n\u003e SVBus driver is only really needed in case of using grub4dos for booting from RAMDISK.\n\nDo you happen to know how to ascertain the driver loadout at early boot? I don\u0027t understand the early boot process since MS moved away from the boot critical registry.\n\n"
    },
    {
      "id": "215831",
      "timestamp": "2020-08-11T16:49:20+00:00",
      "author": "wimb",
      "content": "\u003e Do you happen to know how to ascertain the driver loadout at early boot? I don\u0027t understand the early boot process since MS moved away from the boot critical registry.\n\nWhat I can say about it is that in MBR BIOS mode the file **Boot\\\\bootvhd.dll**\n\nis since version 1903 certainly needed for [booting Win10 VHD](http://reboot.pro/topic/22274-i-cant-start-winpe-on-the-2gb-usb-drive/?p\u003d214306 \"\") from Windows Boot Manager menu.\n\n"
    }
  ]
}