{
  "id": "4408",
  "title": "Dual Booting XP and WinPE2",
  "isPinned": false,
  "isFirstTopic": false,
  "isLocked": false,
  "tags": [],
  "forumNotes": [
    {
      "id": "33145",
      "timestamp": "2008-04-11T16:55:34+00:00",
      "author": "allanf",
      "content": "... ![:thumbsup:](http://reboot.pro/public/style_emoticons/default/thumbsup.gif) ...  \n\nThe Dual Boot should only be tested on XP Systems!  \n\nI was trying to learn about boot management in Vista and WinPE 2.0, and came across an article in the Feb 08 technet magazine, \u0027Dual Booting with Windows XP and Windows PE 2.0\u0027:  \n[http://technet.micro...e/cc194422.aspx](http://technet.microsoft.com/en-us/magazine/cc194422.aspx \"External link\")  \n\nThe Dual Boot is from a single partition.  \n\nIt reminded me of a recent post by **paxamime** who is booting WinPE 2.0 from HDD, not into RAM, and without a .wim file: [http://www.boot-land...?...ost\\\u0026p\u003d33006](http://www.boot-land.net/forums/index.php?s\u003d\u0026showtopic\u003d4392\u0026view\u003dfindpost\u0026p\u003d33006 \"External link\")  \n\nTrying to catch up to **paxamime** , I thought I\u0027d try - as a first step - the method in the technet mag, which sets up WinPE 2.0 to boot from a HDD into RAM using a boot.wim file.  \n\nThe article provides a .vbs script, and provides sample batch-file code (without Paths) for the procedure. As far as I can see, the .vbs does the following:  \n\n```\nbootsect.exe /NT60 ALL\n\nxcopy BOOTMGR C\u0026#58;\\BOOTMGR /I\n\nxcopy BOOT.SDI C\u0026#58;\\BOOT\\ \n\nxcopy BOOT.WIM C\u0026#58;\\BOOT\\BOOT.WIM \n\nbcdedit /createstore\n\nbcdedit /create {ramdiskoptions} /d \u0026#34;Boot Windows PE\u0026#34;\n\nbcdedit /set {ramdiskoptions} ramdisksdidevice partition\u003dc\u0026#58;\n\nbcdedit /set {ramdiskoptions} ramdisksdipath \\boot\\boot.sdi\n\nbcdedit /create /d \u0026#34;Windows PE\u0026#34; /application OSLOADER\n\n\u0026#58;\u0026#58;\u0026#58;The last line will return a GUID. Replace {YOURGUID} with the actual GUID that was returned.\n\nbcdedit /set {YOURGUID} device ramdisk\u003d\u0026#91;c\u0026#58;\u0026#93;\\boot\\boot.wim,{ramdiskoptions}\n\nbcdedit /set{YOURGUID} path \\windows\\system32\\winload.exe\n\nbcdedit /{YOURGUID} osdeviceramdisk\u003d\u0026#91;c\u0026#58;\u0026#93;\\boot\\boot.wim,{ramdiskoptions}\n\nbcdedit /set{YOURGUID} systemroot \\windows\n\nbcdedit /set{YOURGUID} winpe yes\n\nbcdedit /set {YOURGUID} detecthal yes\n\nbcdedit /create {bootmgr} /d \u0026#34;Boot Manager\u0026#34;\n\nbcdedit /set {bootmgr} device boot\n\nbcdedit /create {ntldr} /d \u0026#34;Windows XP\u0026#34;\n\nbcdedit /set {ntldr} device partition\u003dC\u0026#58;\n\nbcdedit /set {ntldr} path \\ntldr\n\nbcdedit /displayorder {ntldr} /addfirst\n```\n\n\u003cbr /\u003e\n\n\u003cbr /\u003e\n\nThe \u0027UnDo\u0027 is simply:  \n\n```\nbootsect.exe /NT52 ALL\n```\n\n\u003cbr /\u003e\n\nThe bootsect.exe bits need to be run from WinPE. As I understand it, the rest may be run from the XP System, provided that all the stuff from Vista/WinPE 2.0 is available - in the same folder as the .vbs file. The targeted XP partition is hard-coded in the procedure as \u0027c:\u0027.  \n\nHere is a special edition of the pe2 Project, which performs the whole Dual-Boot creation from the booted pe2 using the .vbs file. WAIK 1.0 is required to build pe2, and Winbuilder must have access to the internet. In Winbuilder, the DualBoot script can be selected from pe2\u0027s scrollable checklist, and Shortcuts to \u0027DualBootXP\u0027 and \u0027Undo DualBootXP\u0027 are created in pe2\u0027s emergeDesktop start menu.  \n\nThe .vbs file is extracted from a downloaded archive which also contains a EULA. The EULA prohibits me from mentioning the Company\u0027s name when promoting my Project, but the Company is fairly-well known.   \n\nSo... for anyone who has a spare test Virtual Machine with XP on a Virtual HardDrive... It\u0027s real Beta.  \n\nExtract the two files in the .zip to a folder (\u0027pe2.009\u0027) inside Winbuilder\u0027s Projects Folder.  \n\\[attachment\u003d4954:pe2.009.zip\\]  \n\nIf the .vbs download doesn\u0027t work, extract the self-extracting .exe from the following .zip and place it in the \u0027...\\\\winbuilder\\\\Projects\\\\pe2ArchiveDir\u0027 folder.  \n\\[attachment\u003d4955:Desktop2008_02.zip\\]  \n\nGood Luck ![:tabletalk:](http://reboot.pro/public/style_emoticons/default/tabletalk.gif)   \n"
    }
  ]
}