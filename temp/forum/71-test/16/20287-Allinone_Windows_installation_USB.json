{
  "id": "20287",
  "title": "All-in-one Windows installation USB?",
  "isPinned": false,
  "isFirstTopic": false,
  "isLocked": false,
  "tags": [],
  "forumNotes": [
    {
      "id": "190074",
      "timestamp": "2015-01-22T18:06:52+00:00",
      "author": "Flux",
      "content": "Hey guys, I\u0027m wondering if there\u0027s some known way to set up an all-in-one vista, 7, 8 and 8.1 usb flash drive.\n\nThe catch is, I need it to be FAT32, support UEFI, and somehow be able to use the extracted files from ISO\u0027s rather than copying over the ISO\u0027s themselves.\n\nWhy? well, because unfortunately, the MSDN Windows 8.1 with Update 64-bit iso is over 4 gigs, and can\u0027t be put onto a FAT32 drive. But as far as I know, UEFI can only boot x64 windows 8 from FAT32.\n\nAny insights to this would be greatly appreciated. The closest I\u0027ve come so far is WinSetupFromUSB(which uses ISOs) and Easy2Boot(which also uses ISOs or PTN files)\n\n"
    },
    {
      "id": "190076",
      "timestamp": "2015-01-22T18:27:31+00:00",
      "author": "steve6375",
      "content": "Did you actually try E2B .imgPTN files (which does extract the files from the ISO)?\n\nIs your Flash drive of the Remvable type or Fixed Disk type?\n\n"
    },
    {
      "id": "190077",
      "timestamp": "2015-01-22T18:29:02+00:00",
      "author": "Flux",
      "content": "removable type, and yes, I did try that. It actually makes a imgPTN which is bigger than the original ISO, which is the opposite direction from where I want to go :tongue:\n\n"
    },
    {
      "id": "190078",
      "timestamp": "2015-01-22T18:32:45+00:00",
      "author": "steve6375",
      "content": "You mean you want a solution that takes up less room than the ISO??? Is that your only objection to E2B+.imgPTN files?\n\nIf you used the MPI_FAT32 shortcut to make the .imgPTN file, it is on the generous side - you can used the MakePartImage shortcut to make a smaller .imgPTN file by specifying the smallest size that the files will just fit into.\n\n"
    },
    {
      "id": "190079",
      "timestamp": "2015-01-22T18:36:43+00:00",
      "author": "Flux",
      "content": "not sure I follow. I used the mpi_fat32, which output a file larger than the iso.\n\nThe point I was trying to make is that if you extract the ISO, the largest file is the install.wim, which on it\u0027s own is not over 4GB, but as the ISO, it takes up over 4. So if I had some solution that would use the extracted files, rather than the ISO or any single file, it would work fine.\n\nAre you saying that makepartimage can compress it or something? sorry, just not sure I follow. xD\n\n"
    },
    {
      "id": "190080",
      "timestamp": "2015-01-22T18:42:58+00:00",
      "author": "steve6375",
      "content": "You make a **NTFS** E2B USB drive. You convert your Windows ISOs to .imgPTN files using **MPI_FAT32** Desktop shortcut.\n\nYou copy the .imgPTN files to the NTFS E2B USB drive.\n\nYou boot to E2B Menu and choose one of the .imgPTN files - it converts the whole USB drive to FAT32 and loads the CSM menu.\n\nYou can now MBR-boot **or UEFI-boot** from the USB drive which is now FAT32 (you can even UEFI-boot using Clover directly in MBR mode to load Windows Setup in EUFI mode).\n\nAfter installing Windows, you boot back to the CSM menu and select option 0 to convert the USB drive back to the NTFS E2B partition.\n\n"
    },
    {
      "id": "190081",
      "timestamp": "2015-01-22T18:48:56+00:00",
      "author": "Flux",
      "content": "so my next question would be - what is the behavior of E2B with UEFI? for example, if I want to boot Win8.1 64-bit(which is the 4+ gb file), I insert the USB drive(which has imgPTN files for every version of windows I want), and it boots to Clover? Or do I actually need a third party machine with CSM enabled? Because this is intended for convenience.\n\nSo I don\u0027t want to have to enable CSM on every machine I wish to install Windows onto. I\u0027d rather have the ability to load up on any machine, and select any version of Windows.\n\n"
    },
    {
      "id": "190082",
      "timestamp": "2015-01-22T18:54:55+00:00",
      "author": "steve6375",
      "content": "If you don\u0027t want to boot in MBR mode first, you can run QEMU or MobaLiveCD.exe (which can be kept on the E2B USB drive).\n\nJust run the E2B menu under the VM and get to the CSM menu. Then unplug and connect to your UEFI system.\n\nI agree it is not most convenient of solutions because of the need to boot in MBR\\\\CSM mode to run the E2B menu first, but it is real easy to add Windows Install ISOs to the E2B USB drive.\n\nP.S. On systems with Secure Boot enabled, you will have to disable that anyway to UEFI-boot from the USB drive.\n\n"
    },
    {
      "id": "190083",
      "timestamp": "2015-01-22T19:00:45+00:00",
      "author": "steve6375",
      "content": "The other alternative is to use a FAT32 USB drive that boots to Win8.1 WinPE. You can prepare a dual-boot drive which will boot any of the 4 Windows PE flavours (32-bit MBR or UEFI, 64-bit MBR or UEFI). See [here](http://www.rmprepusb.com/tutorials/127-make-dual-32-64bit-pe \"External link\") for details.\n\nThen add WinNTSetup.exe to your USB drive and all the Install.wim files from all your ISOs.\n\nWhen you boot to WinPE, run WinNTSetup and select one of the Install.wim files.\n\n"
    },
    {
      "id": "190084",
      "timestamp": "2015-01-22T19:19:47+00:00",
      "author": "cdob",
      "content": "\u003e Why? well, because unfortunately, the MSDN Windows 8.1 with Update 64-bit iso is over 4 gigs, and can\u0027t be put onto a FAT32 drive.\n\nAnother alternative: cheat a small file.  \nAdjust the iso file:  \ncreate a install.esd  \n\n\u003cbr /\u003e\n\nor remove files, a reduced ISO image is less 4 gigs:  \n\u003e \\\\setup.exe  \n\u003e \\\\sources\\\\ without boot.wim\nBoot boot.wim from the USB drive and mount the ISO file. Continue \\[ISO file\\]\\\\setup.exe.   \n"
    },
    {
      "id": "190086",
      "timestamp": "2015-01-22T21:34:48+00:00",
      "author": "Rootman",
      "content": "\u003e so my next question would be - what is the behavior of E2B with UEFI? for example, if I want to boot Win8.1 64-bit(which is the 4+ gb file), I insert the USB drive(which has imgPTN files for every version of windows I want), and it boots to Clover? Or do I actually need a third party machine with CSM enabled? Because this is intended for convenience.\n\u003e\n\u003e So I don\u0027t want to have to enable CSM on every machine I wish to install Windows onto. I\u0027d rather have the ability to load up on any machine, and select any version of Windows.\n\nI had a little trouble getting me head around how it works too.\n\nLike Steve said make a NTFS Easy2Boot USB stick. Then convert the ISOs to .imgPTN files as FAT32 images. Since the stick is NTFS it can hold files greater than 4GB.\n\nWhat happens is that Easy2Boot loads up, you select which imgPTN file you want to boot to and E2B does some slight of hand and makes the .imgPTN bootable from the stick . Since the partition IMAGE is formatted FAT32 that means it can be used to boot UEFI. There is no issue with it being greater than 4GB as it\u0027s the partition IMAGE file that exceeds 4GB and it\u0027s formatted FAT 32.\n\nAfter I select which imgPTN file I want to boot to by selecting it in E2B (and letting E2B do it\u0027s magic) I typically reboot the PC with the stick, the \"drive\" (which is actually the imgPTN file) is booted. As long as the UEFI files are there in the correct folder it will boot via UEFI (UEFI boot must be ON in the BIOS and secure boot OFF). Be sure to trip the PCs BIOS boot menu, usually by hitting a key as the PC starts, for a lot of PCs it\u0027s the F12 key. If you select to boot to the E2B stick via UEFI it boots straight through. You can also boot via UEFI using Clover but I\u0027ve found this problematic at times.\n\nAfter you are done with the Windows install then boot to the stick, only this time select to boot to it via MBR mode. When you boot the stick via MBR and the imgPTN was set t boot a special E2B menu appears and one of the selections is to restore the E2B menu back to the normal E2B menu structure.\n\nI have 6 different imgPTN files that I can install from. Both 32 and 64 bit installs of Win 7, Win 8.1 and Win 10. Of course the 32 bit versions will not boot via UEFI on a 64 bit CPU. I also have a few ISOs with Windows PE and various Linux distros and utilities on the same stick. It works like a charm and all fits in my pocket.\n\n"
    },
    {
      "id": "193255",
      "timestamp": "2015-06-22T01:57:15+00:00",
      "author": "pun84",
      "content": "I am having trouble understanding, so can we use \\\u003e 4GB images or not? I go to create a imgPTN with a iso file greater than 4GB and I get the below error\n\n[![3KeCejKb.png](http://i.imgur.com/3KeCejKb.png)](http://imgur.com/3KeCejK \"External link\")\n\n"
    },
    {
      "id": "193261",
      "timestamp": "2015-06-22T08:16:12+00:00",
      "author": "steve6375",
      "content": "When you use MPI to create a FAT32 volume, the largest file that you can copy to the FAT32 volume is 4GB.\n\nHow big is the \\\\sources\\\\install.wim file in your ISO? If larger than 4GB then you know why it won\u0027t work.\n\nIf it is less than 4GB, then you may need to create a larger FAT32 volume. When you are prompted for the size of the volume, manually enter in a larger size - e.g. 5600 and see if that works. Some ISOs are \u0027compressed\u0027.\n\n"
    }
  ]
}