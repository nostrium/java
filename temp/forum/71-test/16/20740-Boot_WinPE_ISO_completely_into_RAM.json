{
  "id": "20740",
  "title": "Boot WinPE ISO completely into RAM?",
  "isPinned": false,
  "isFirstTopic": false,
  "isLocked": false,
  "tags": [],
  "forumNotes": [
    {
      "id": "195451",
      "timestamp": "2015-09-21T01:21:05+00:00",
      "author": "Siginet",
      "content": "Is it possible to boot from an ISO file and it completely is running from within RAM?\n\nThe reason I ask is I am wanting to figure out how to reinstall customers computers remotely. I thought it would be great if I could create a program that automatically downloads my custom WinPE ISO to the customers system drive and sets it up as a boot option. I could then boot to my winpe, format the c drive... which also has the ISO on it... and reinstall a new operating system. Which I would create fully unattended to launch my remote access again at first boot.\n\nHas anyone ever tried something like this before? Any tips on what you feel is the best way to do this? Some in depth tutorials would come in handy. Thanks!\n\n"
    },
    {
      "id": "195452",
      "timestamp": "2015-09-21T01:47:06+00:00",
      "author": "Siginet",
      "content": "I also noticed people have a method to install WinPESE into a hidden partition and can make it bootable. But I haven\u0027t found information on how to do this.If someone can point me in the right direction that has done this before that would be great.\n\n"
    },
    {
      "id": "195454",
      "timestamp": "2015-09-21T03:51:04+00:00",
      "author": "Siginet",
      "content": "OK... I think I got it figured out. Found some info. I\u0027ll see if I can put together something to simplify doing something like this if anyone is interested.\n\n"
    },
    {
      "id": "195460",
      "timestamp": "2015-09-21T08:20:52+00:00",
      "author": "Siginet",
      "content": "Well... I got as far as loading grldr on the system drive. But whenever I try launching my ISO I always get corruption errors. I\u0027ve checked and made sure its contigous. I have also verified I can boot it from a USB just fine. But no matter what I try it will not boot from the system drive. ![:(](http://reboot.pro/public/style_emoticons/default/sad.png)\n\n"
    },
    {
      "id": "195461",
      "timestamp": "2015-09-21T10:08:15+00:00",
      "author": "Wonko the Sane",
      "content": "Well, if you DETAIL what you attempted and what the results (error messages/whatever) were, maybe someone could provide you with some suggestions. ![:duff:](http://reboot.pro/public/style_emoticons/default/duff.gif) Wonko   \n"
    },
    {
      "id": "195463",
      "timestamp": "2015-09-21T11:34:34+00:00",
      "author": "Siginet",
      "content": "I tried the steps from here:  \n[http://diddy.boot-la...all_windows.htm](http://diddy.boot-land.net/grub4dos/files/install_windows.htm \"External link\")  \n\nWhich works at loading the grldr and menu.lst But I had a hard time with which version of grldr.mbr and grldr to use. Some of them would say grldr not found and some would say found and work. I\u0027m wondering if maybe some of the grldr files I used messed up the mbr or something.\n\nI did finally get easy2boot menu to start up... but it would not boot my Win10PESE. Kept saying it was corrupt. But it wasn\u0027t corrupt.\n\nI also tried this:  \n[http://windowsitpro....indows-7-system](http://windowsitpro.com/systems-management/adding-windows-pe-your-windows-7-system \"External link\")\n\nBut the current OS I was on was x64 and my WinPE is x86... so I think it crashed my system. lol! No big deal cause it was a test environment too. I ended up reinstalling windows 7 with x86 so I can test again with my x86 winpe.\n\nI gotta get some sleep right now though. It\u0027s about 7:30 am here... going on no sleep.\n\nWhat is a simple menu.lst I could use that can load a WinPESE iso pretty easily? What version of grldr and grldr.mbr is recommended? When I tried the latest version was when I got grldr not found errors. But... maybe thats due to the previous versions I had tried.\n\n"
    },
    {
      "id": "195464",
      "timestamp": "2015-09-21T15:24:23+00:00",
      "author": "wimb",
      "content": "In Win10PESE Builder you can Set in Build \\\u003e CdDrive - X: - Y: to Run ALL programs from RAM\n\nAfter building your Win10PESE you can use UEFI_MULTI.exe and select Boot and System Drive and select as Boot Image boot.wim made in folder Win10PE_SE_2015-09-11\\\\ISO\\\\TargetImage\\\\WIM\\\\sources and select boot.sdi in folder Win10PE_SE_2015-09-11\\\\ISO\\\\TargetImage\\\\WIM\\\\Boot\n\nUsing UEFI_MULTI.exe to make bootable with boot.wim Boot Image file is working the same as described for Win8.1SE\n\n[http://reboot.pro/to...ve/#entry168079](http://reboot.pro/topic/18182-uefi-multi-make-multi-boot-usb-drive/#entry168079 \"\")\n\nI expect that PXE Wimboot for booting from Network your boot.wim of Win10PESE is working the same as described for Win8.1SE\n\n"
    },
    {
      "id": "195465",
      "timestamp": "2015-09-21T16:02:58+00:00",
      "author": "Wonko the Sane",
      "content": "Yep, you\u0027d better get some sleep :smile:.\n\nThe given page lists 8 (eight) different ways to boot to grub4dos, since you are talking of grldr.mbr, you must be using this one ![:unsure:](http://reboot.pro/public/style_emoticons/default/unsure.png)\n\n[http://diddy.boot-la...ws.htm#windows4](http://diddy.boot-land.net/grub4dos/files/install_windows.htm#windows4 \"External link\")\n\nThe grub4dos to use unless explicitly told to use a specific version is LATEST of the 0.4.5 series here:\n\n[http://grub4dos.chen...oads/#year_2015](http://grub4dos.chenall.net/categories/downloads/#year_2015 \"External link\")\n\nright now:\n\n[http://grub4dos.chen....5c-2015-05-18/](http://grub4dos.chenall.net/downloads/grub4dos-0.4.5c-2015-05-18/ \"External link\")\n\nOR (and only if that one does not work) the LATEST of the 0.4.6 series, right now:\n\n[http://grub4dos.chen....6a-2015-09-15/](http://grub4dos.chenall.net/downloads/grub4dos-0.4.6a-2015-09-15/ \"External link\")\n\nYou should be careful to not mix together different grldr and grldr.mbr\u0027s, though normally most grldr.mbr can load \\*any\\* grldr this may be not always true.\n\nBut apart form that, which EXACT menu.lst entry (or command sequence) are you using?\n\nAlso, if you want to go the Easy2boot way, then use EXACTLY the methods Steve6375 provides AND the specific grub4dos version which is part of Easy2boot (and not any other one).\n\n![:duff:](http://reboot.pro/public/style_emoticons/default/duff.gif)  \nWonko\n\n"
    },
    {
      "id": "195467",
      "timestamp": "2015-09-21T19:18:05+00:00",
      "author": "sixcentgeorge",
      "content": "what you want is not easy ..if you have long term customers , may be try to make them use some mainboard like the tyan s7025\n\nit has a chipset :\n\nAST2050 IPMI Feature IPMI 2.0 compliant baseboard management controller (BMC) / Supports storage over IP and remote platform-flash / USB 2.0 virtual hub\n\nthat creates a virtual keyb and mouse from the moment computer is started , so remotely that even should be possible to enter bios...\n\ni did not tested much that option...\n\nhere is the old board page : [http://www.tyan.com/...25_S7025WAGM2NR](http://www.tyan.com/Motherboards_S7025_S7025WAGM2NR \"External link\")\n\nIntelligent Platform Management Interface : [https://en.wikipedia...ement_Interface](https://en.wikipedia.org/wiki/Intelligent_Platform_Management_Interface \"External link\")\n\n"
    },
    {
      "id": "195468",
      "timestamp": "2015-09-21T19:57:25+00:00",
      "author": "steve6375",
      "content": "Setting up WinPE as a boot option on an existing computer automatically is fraught with problems unless you know how that computer is set up to boot in the first place. For example, is the computer 32-bit or 64-bit, does it contain Windows or linux or a mix? What boot loader does it have? Is it UEFI or MBR? What partitions? Is it set up for UEFI secure boot? What if that particular computer is not bootable?\n\nMaybe your clients download a zip file which will make a bootable USB drive (the client will need a USB flash or hdd - but most people have at least one of these). The client must then boot the PC from the flash drive (could be MBR boot or 32-bit or 64-bit UEFI boot if a UEFI-only system).\n\nOnce the system has booted to WinPE + Teamviewer (say), you can wipe the internal HDD or repair it remotely. You could download any ISO to the USB drive (or the internal hard drive once it has been partitioned) and then start the install e.g. using WinNTSetup.\n\n"
    },
    {
      "id": "195469",
      "timestamp": "2015-09-21T20:14:06+00:00",
      "author": "Siginet",
      "content": "OK.. Thanks for all the tips. I\u0027ll post here in this thread any progress I make. I know it\u0027s not a widespread thing I am trying to do so I basically am just in the phase of trial and error. I understand I would need to know how the boot is setup on the customers computers. But I doubt it would be difficult to code in ways to detect it. Of course we wouldn\u0027t wipe a computer until all of the proper checks were in place. I recently am opening a PC repair shop in Florida to expand from our shop in California. So I\u0027m researching ways that Techs from both shops can help customers on both sides of the country. I like Easy2Boot... since I know it is pretty universal. I have already created a Remote Access system that works perfectly wether it is in WinPE or booted into the clients regular system. So the only are I am stuck right now is the booting into WinPE. :wink: Which I know is possible. I am leaning toward the idea of creating a wimboot in a partition created specifically for it. Pretty much how Windows 10 upgrades seem to work. Except it would be a WinPESE boot which has remote access. I don\u0027t think the theory I have to make this work is very difficult. It\u0027s just figuring out which way is the best to implement it.\n\n"
    },
    {
      "id": "195470",
      "timestamp": "2015-09-21T20:47:01+00:00",
      "author": "cdob",
      "content": "\u003e So I\u0027m researching ways that Techs from both shops can help customers on both sides of the country.\nWhich machines do you expect? Old CPU, win 8.1 compatible? below 1 GB RAM, above 1 GB RAM?  \nWindows only machines? Multi OS machines?  \nWhat about UEFI secure boot at unkown machines, without testing?  \n\n\u003e I am leaning toward the idea of creating a wimboot in a partition created specifically for it. Pretty much how Windows 10 upgrades seem to work. Except it would be a WinPESE boot which has remote access.\nYes, a additonal partition, a boot.sdi and a \\*.wim does match. Can work at BIOS and UEFI mode.  \nDo you intent to replace windows recovery boot?  \n\nI would discard ISO file boot today and go for a addional partiton with flat files.   \n"
    },
    {
      "id": "195471",
      "timestamp": "2015-09-21T20:59:57+00:00",
      "author": "Siginet",
      "content": "\u003e Which machines do you expect? Old CPU, win 8.1 compatible? below 1 GB RAM, above 1 GB RAM?  \n\u003e Windows only machines? Multi OS machines?  \n\u003e What about UEFI secure boot at unkown machines, without testing?  \n\u003e\n\u003e Yes, a additonal partition, a boot.sdi and a \\*.wim does match. Can work at BIOS and UEFI mode.  \n\u003e Do you intent to replace windows recovery boot?  \n\u003e\n\u003e I would discard ISO file boot today and go for a addional partiton with flat files.\n\u003e\n\u003e I would be supporting Windows PCs. Nowadays most users are running a newer Windows. Windows 7 + systems. Also most computers I see have a decent amount of RAM. Of course my tool would check if a PC fits the requirements of remote re-installation first. If I needed I could have 2 versions of WinPE one x86 and one x64 and have the tool download the one needed. My tool would have to check mbr / uefi.\n\u003e\n\u003e I really like the idea of additional partition. I would prefer a hidden partition and not replacing the customers recovery option. These are all great ideas. I\u0027m sure I\u0027ll come up with a solid way to do it all. ;-)\n\u003e\n\u003e Thanks\n\n"
    },
    {
      "id": "195473",
      "timestamp": "2015-09-21T23:02:51+00:00",
      "author": "Siginet",
      "content": "\u003e In Win10PESE Builder you can Set in Build \\\u003e CdDrive - X: - Y: to Run ALL programs from RAM\n\u003e\n\u003e After building your Win10PESE you can use UEFI_MULTI.exe and select Boot and System Drive and select as Boot Image boot.wim made in folder Win10PE_SE_2015-09-11\\\\ISO\\\\TargetImage\\\\WIM\\\\sources and select boot.sdi in folder Win10PE_SE_2015-09-11\\\\ISO\\\\TargetImage\\\\WIM\\\\Boot\n\u003e\n\u003e Using UEFI_MULTI.exe to make bootable with boot.wim Boot Image file is working the same as described for Win8.1SE\n\u003e\n\u003e [http://reboot.pro/to...ve/#entry168079](http://reboot.pro/topic/18182-uefi-multi-make-multi-boot-usb-drive/#entry168079 \"\")\n\u003e\n\u003e I expect that PXE Wimboot for booting from Network your boot.wim of Win10PESE is working the same as described for Win8.1SE\n\nThis method is the best method I have found so far. :wink: Thanks wim. It does seem to work. It looks like all I need to do to swap between regular os boot and WinPE boot is change the active partition. This might be the perfect way to do it. Is there any ideas you may have for limitations of this method? It sonds like it would work with uefi or mbr? If I used a x86 WinPE could this work no matter what OSArch or UEFI/MBR?\n\nThanks!\n\n"
    },
    {
      "id": "195474",
      "timestamp": "2015-09-22T04:19:22+00:00",
      "author": "wimb",
      "content": "\u003e This method is the best method I have found so far. :wink: Thanks wim. It does seem to work. It looks like all I need to do to swap between regular os boot and WinPE boot is change the active partition. This might be the perfect way to do it. Is there any ideas you may have for limitations of this method? It sonds like it would work with uefi or mbr? If I used a x86 WinPE could this work no matter what OSArch or UEFI/MBR?\n\u003e\n\u003e Thanks!\n\nWin8.1SE**x64** is needed for booting UEFI and UEFI secure and it can also be used for booting BIOS computers with MBR.\n\nThe advantage of Win8.1SE x64 is that it also supports 32-bit apps since it has the SysWOW64 support, which is not available in Win10PE SE.\n\nWin8.1SE x64 contains all the drivers for booting any computer and I consider Win8.1 SE x64 as the Universal solution that allows booting from USB and HDD or from Network by using PXE wimboot. My Win8.1SE x64 contains also WinNTSetup x64 and AOMEI Backupper and AOMEI Partition assistant.\n\nThe dropbox cloud server can be used in any place to download the w81x64A.wim Boot Image file and a 7-zip selfextracting file containing the Boot and EFI boot files as made by UEFI_MULTI.exe for booting w81x64A.wim. The 7-zip SFX file can be used then for easily making bootable FAT32 USB-sticks for booting any UEFI or BIOS computer. Booting from USB-Stick is easily selected from F8 Menu and many computers boot already auto first from USB-Stick so that F8 is not even needed. The advantage is that you don\u0027t need to make changes in BIOS/UEFI settings and don\u0027t need to change the active partition as you proposed.\n\n[http://www.msfn.org/...170546-win81se/](http://www.msfn.org/board/topic/170546-win81se/ \"External link\")\n\n[http://reboot.pro/to...ve/#entry168079](http://reboot.pro/topic/18182-uefi-multi-make-multi-boot-usb-drive/#entry168079 \"\")\n\nAnother approach is booting from Network by using PXE wimboot which must be activated in BIOS on the client computer and can then be selected in BIOS Boot menu.\n\nOn a LAN this is working excellent for me, but I don\u0027t know if this can be used via Internet.\n\nBooting from Network by PXE wimboot of Win8.1SE x64 would be a very handy solution.\n\n"
    },
    {
      "id": "195477",
      "timestamp": "2015-09-22T07:45:31+00:00",
      "author": "steve6375",
      "content": "Can it boot on a 32-bit PC or a PC that is 32-bit UEFI only?\n\n"
    },
    {
      "id": "195486",
      "timestamp": "2015-09-22T13:51:00+00:00",
      "author": "memoarfaa",
      "content": "you can use remote desktop connection from winpe\n\n[http://deploymentres...CCM-deployments](http://deploymentresearch.com/Research/Post/250/Software-Assurance-Pays-Off-Remote-Connection-to-WinPE-during-MDT-SCCM-deployments \"External link\")\n\n"
    },
    {
      "id": "195488",
      "timestamp": "2015-09-22T19:06:07+00:00",
      "author": "cdob",
      "content": "\u003e It looks like all I need to do to swap between regular os boot and WinPE boot is change the active partition.  \n\u003e If I used a x86 WinPE could this work no matter what OSArch or UEFI/MBR?\nThe UEFI architecture has to match the PE architecture.  \nThe UEFI architecture matches the CPU architecture almost always: 32 bit UEFI at x86 CPU. And 64bit UEFI at amd64 CPU.  \nContrary seldom 32 bit UEFI at amd64 CPU, some tablet.  \n\nGPT dosn\u0027t use active partition. Boot files are at GPT system partition.  \n\nBe aware, there is BIOS/GPT possible.  \nHowever you may assume this is very seldom used in real life.  \n[http://reboot.pro/to...in-bios-to-gpt/](http://reboot.pro/topic/19516-hack-bootmgr-to-boot-windows-in-bios-to-gpt/ \"\")  \n\nA idea, not tested: custom keyboard action during boot  \n[https://social.techn...vistadeployment](https://social.technet.microsoft.com/Forums/forefront/en-US/90e176d9-afaf-4e99-99c9-2d8958eb035d/windows-pe-setting-up-custom-keyboard-action-during-boot?forum\u003ditprovistadeployment \"External link\")  \n[https://social.techn...\u003dw7itproinstall](https://social.technet.microsoft.com/Forums/windows/en-US/95a029fc-edf6-46db-a7f3-608a1c5cfe30/is-there-anyways-to-enable-win-recovery-boot-key-before-entering-oobe?forum\u003dw7itproinstall \"External link\")  \n[http://download.micr...MBoot_Vista.doc](http://download.microsoft.com/download/9/c/5/9c5b2167-8017-4bae-9fde-d599bac8184a/OEMBoot_Vista.doc \"External link\")  \nThis feature goes back to Vista. No idea how it works at Win 10 BIOS/UEFI fast boot.   \n"
    },
    {
      "id": "195496",
      "timestamp": "2015-09-23T04:05:46+00:00",
      "author": "Siginet",
      "content": "Awesome info in here. This should be great to get me started on doing this. I won\u0027t be able to work on anything this week though. Flying back to California from Florida for the week. But when I get back I\u0027m gonna play around with some ideas for sure.\n\nThanks again everybody!!\n\n"
    },
    {
      "id": "195497",
      "timestamp": "2015-09-23T04:47:31+00:00",
      "author": "wimb",
      "content": "\u003e Can it boot on a 32-bit PC or a PC that is 32-bit UEFI only?\n\nYou are right, the x64 wim cannot be used in that case.\n\nIn that case you need to make Win8.1 SE **x86** and then use w81x86.wim as boot image file as also mentioned by **cdob** .\n\n![:cheers:](http://reboot.pro/public/style_emoticons/default/cheers.gif)\n\n"
    },
    {
      "id": "195535",
      "timestamp": "2015-09-23T20:12:48+00:00",
      "author": "wimb",
      "content": "TeamViewer Portable is working via Internet in Win8.1 SE **x86**file w81x86.wim\n\n[![81SEx86TV.png](http://reboot.pro/uploads/monthly_09_2015/post-9517-0-11483000-1443039043_thumb.png)](http://reboot.pro/uploads/monthly_09_2015/post-9517-0-11483000-1443039043.png \"81SEx86TV.png - Size: 307.24KB\"){#ipb-attach-url-15728-0-84503900-1676066474} \u003d\u003d\u003d\u003d\\\u003e [![w81x86TVC.png](http://reboot.pro/uploads/monthly_09_2015/post-9517-0-24347200-1443039082_thumb.png)](http://reboot.pro/uploads/monthly_09_2015/post-9517-0-24347200-1443039082.png \"w81x86TVC.png - Size: 148.21KB\"){#ipb-attach-url-15729-0-84515500-1676066474}\n\n![:cheers:](http://reboot.pro/public/style_emoticons/default/cheers.gif)\n\nbut not yet in x64 version file w81x64.wim .....\n\n"
    },
    {
      "id": "195541",
      "timestamp": "2015-09-24T05:53:05+00:00",
      "author": "sixcentgeorge",
      "content": "i wonder if 32bit cpu are still made for pcs..? beside that why wanting some remote solution if he travels and have shops ..?\n\nplus working remotely means no money right after working...\n\npost links of your businesses , website ...that should help to help...\n\n"
    },
    {
      "id": "195547",
      "timestamp": "2015-09-24T08:21:49+00:00",
      "author": "wimb",
      "content": "Teamviewer V9 script is the good working solution for Win8.1SE x64 ![:cheerleader:](http://reboot.pro/public/style_emoticons/default/cheerleader.gif)\n\n[![w81x64TV.png](http://reboot.pro/uploads/monthly_09_2015/post-9517-0-11822500-1443082850_thumb.png)](http://reboot.pro/uploads/monthly_09_2015/post-9517-0-11822500-1443082850.png \"w81x64TV.png - Size: 540.15KB\"){#ipb-attach-url-15731-0-84523600-1676066474} \u003d\u003d\u003d\\\u003e [![w81x64TVC.png](http://reboot.pro/uploads/monthly_09_2015/post-9517-0-73880300-1443082879_thumb.png)](http://reboot.pro/uploads/monthly_09_2015/post-9517-0-73880300-1443082879.png \"w81x64TVC.png - Size: 558.9KB\"){#ipb-attach-url-15732-0-84530800-1676066474}\n\n![:cheers:](http://reboot.pro/public/style_emoticons/default/cheers.gif)\n\nTeamviewer V6 script can be used in Win10PE SE x64 but V6 is not compatible with higher versions ![:dubbio:](http://reboot.pro/public/style_emoticons/default/dubbio.gif)\n\nWin10PE SE x64 has now 32-bits support so that PStart and other 32-bit apps can be used.\n\nWLAN is working thanks to Utils/Extract Wim Folders.\n\n[![w10x64AT.png](http://reboot.pro/uploads/monthly_10_2015/post-9517-0-02928300-1444055004_thumb.png)](http://reboot.pro/uploads/monthly_10_2015/post-9517-0-02928300-1444055004.png \"w10x64AT.png - Size: 587.24KB\"){#ipb-attach-url-15734-0-84537400-1676066474}\n\n"
    },
    {
      "id": "195566",
      "timestamp": "2015-09-26T06:40:14+00:00",
      "author": "Erik_FL",
      "content": "\u003e i wonder if 32bit cpu are still made for pcs..? beside that why wanting some remote solution if he travels and have shops ..?\n\u003e\n\u003e plus working remotely means no money right after working...\n\u003e\n\u003e post links of your businesses , website ...that should help to help...\n\nYes, unfortunately. There are two reasons why 32-bit CPUs are still around. One is the cost. The other is the power requirements (and heat). You are less likely to see 32-bit CPUs in desktops than laptops and embedded devices (media servers, tiny PCs, etc.)\n\nReally, there wasn\u0027t a big need for 64-bit software. Mostly that was a marketing driven change because Microsoft chose not to fully support Physical Address Extension in 32-bit versions of Windows. Linux supports that to allow 32-bit software to access 64 GB of RAM instead of 4 GB. Intel also was not making 32-bit chipsets that supported over 4 GB of RAM because of marketing reasons. So, AMD caught them both asleep at the switch and released a 64-bit X86 compatible CPU (another marketing decision). Intel and Microsoft both really wanted to keep 64-bit on server versions of hardware and software (to charge more of course).\n\nBack to the topic. Keep the hardware as standard as possible. It may pay to replace or upgrade some machines. UEFI has it\u0027s problems but it has a lot more support for doing things when there is no OS. UEFI is sort of a minimal OS by itself. I haven\u0027t looked, but it is possible that companies have developed UEFI applications to do some of the things that you want.\n\n"
    },
    {
      "id": "195567",
      "timestamp": "2015-09-26T06:56:27+00:00",
      "author": "sixcentgeorge",
      "content": "UEFI is made only for the security thingie M$ invented lately...it starts with w8...even linux has it...steamos needs it.....\n\nthat could have been good , if that made computer being able to be an msdos8+compiler : so making program in assembler would be easy...that will come in our \"spying us all era\"\n\n"
    }
  ]
}