{
  "id": "20448",
  "title": "Does UEFI booting read the MBR or PBR?",
  "isPinned": false,
  "isFirstTopic": false,
  "isLocked": false,
  "tags": [],
  "forumNotes": [
    {
      "id": "192011",
      "timestamp": "2015-04-16T20:25:05+00:00",
      "author": "generalmx",
      "content": "Is there a way with USB Flash drives to automatically use BOOTMGR.EFI if UEFI-booting, otherwise use say grub4dos? I\u0027m trying to make an absurdly compatible Easy2Boot setup where it boots into BOOTMGR by default only if UEFI-booting. Would I need to hack grldr to rename it to \"bootmgr\" for MBR loading, or can I just leave the Easy2Boot MBR \\\u0026 PBR records and place the necessary EFI files on the root? Not sure if EFI/UEFI even generally looks at the MBR or PBR.\n\nI also want to do this for bootable DVDs too, but I suspect it\u0027s some fancy oscdimg command.\n\n**Edited by generalmx, 16 April 2015 - 08:26 PM.**\n"
    },
    {
      "id": "192018",
      "timestamp": "2015-04-17T11:45:01+00:00",
      "author": "Wonko the Sane",
      "content": "Well, presuming that you are going to make a MBR style USB stick, UEFI completely ignores both the MBR and the PBR boot code, and loads the \\*whatever\\* UEFI bootloader that is found (on a FAT volume on the device).\n\nYou may want to read:\n\n[http://homepage.ntlw...ot-process.html](http://homepage.ntlworld.com./jonathan.deboynepollard/FGA/windows-nt-6-boot-process.html \"External link\")\n\n[http://homepage.ntlw...ot-process.html](http://homepage.ntlworld.com./jonathan.deboynepollard/FGA/efi-boot-process.html \"External link\")\n\nAnd more generally everything here:\n\n[http://homepage.ntlw...ynepollard/FGA/](http://homepage.ntlworld.com./jonathan.deboynepollard/FGA/ \"External link\")\n\nunder \"Operating system bootstraps\".\n\nAbout CD/DVD\u0027s, yes, you can use EITHER some obscure OSCDIMG command or some somehow slightly less obscure MKISOFS command (making SURE to have a compatible mkisofs version), see:\n\n[http://reboot.pro/to...maker/?p\u003d189257](http://reboot.pro/topic/9610-multiboot-iso-maker/?p\u003d189257 \"\")\n\n[http://reboot.pro/to...-under-windows/](http://reboot.pro/topic/20247-biosefi-hybrid-iso-creation-under-windows/ \"\")\n\n![:duff:](http://reboot.pro/public/style_emoticons/default/duff.gif)\n\nWonko\n\n"
    },
    {
      "id": "192030",
      "timestamp": "2015-04-18T02:17:18+00:00",
      "author": "generalmx",
      "content": "Awesome links Wonko, thanks! I actually ended up throwing the EFI portion of the Windows 8.1 Recovery USB files on an Easy2Boot (grub4dos) flash drive and seeing what pops up on a:\n\n- Windows 8.1 Laptop using Secure Boot\n\n- Windows 8.1 Netbook\n\n- Macbook Pro (Intel) running Mac OS X 10.10\n\nAnd in each case, including the Macbook, it\u0027s just as Wonko said --- the EFI files were detected and could be used, despite the MBR \\\u0026 PBR pointing to grub4dos.\n\nSo to make my Super-Easy2Boot-UEFI-Compatible Tech flash drives, I just need to start with Easy2Boot and throw my current setup on top of it.\n\n"
    },
    {
      "id": "192125",
      "timestamp": "2015-04-23T16:56:59+00:00",
      "author": "steve6375",
      "content": "That only works if the E2B drive is FAT32 and you can only install one version of Windows.\n\nAlso, many systems will not give you a CSM\\\\MBR boot choice if they are UEFI systems and detect the UEFI .efi boot file - so you wont be able to boot to Easy2Boot on those systems.\n\nE2B uses .imgPTN files for UEFI booting. If you use these (converted from .iso files using MakePartImage) then you won\u0027t have these issues.\n\n"
    },
    {
      "id": "194311",
      "timestamp": "2015-08-05T14:51:41+00:00",
      "author": "S466531257BOSS",
      "content": "Because it is the only place where i have found\n\na : the two guys i thought of that can answer the question\n\nand\n\nb : a slight similar base to what i am requesting \\| asking\n\nWonko \\| Steve \\| anyone else that can help out ;\n\n( it helps to look at the given posts the other way around ... to understand the following )\n\nHow could easy2boot as it is be made to work off a gpt-type internal SSD whereas the ESP ( fat28/32 ) is itself declared as active partition in hybrid mbr starting at sector 2048/64 (whatever works better) followed by either a single primary ntfs usable as storage hold for vhds or mostly appreciated an extended partition for native installed systems running from logical partitions containing lvm2 ; accessible as extended booted either via g4d of easy2boot from the esp-mbr-hybrid-active-partition or via grub2 from boot partition following the extended/ being the third and last primary at all partition ( rest is blocked in hybrid mbr and used for gpt-partitions ) ; I am steadily stumbling in some part of the process, feeling a bit like Schroedingers cat.\n\nIf you get the essence of what i am asking, please give advice/hints/links to similar tutorials/experiments.\n\nAnd for sure, i don\u0027t want to dicuss the sense of this; to me it makes sense and i do not want to aim anything else by doing this, this is what i am aiming for, just to make it clear in forefront.\n\nAny help appreciated.\n\nTHANKS FOR YOUR INTEREST .\n\nS466531257 BOSS\n\nPAETH CLAUDIUSRAPHAEL\n\nP.S.: the background information you might have riddles on is : creating a gpt-based bios-bootable (without DUET or similar emulated EFI ) with the possibility to use the for-boot-accessible storage-part of the SSD\\|HDD up to 2.2TB Limit for native (hybrid-)mbr-partitioned (1P+1E) followed by the grub-boot that itself marks the border for anything-that-follows-is-purely-gpt-and-storage-or-chainloaded .\n\n**Edited by S466531257BOSS, 05 August 2015 - 02:57 PM.**\n"
    },
    {
      "id": "194328",
      "timestamp": "2015-08-05T16:28:41+00:00",
      "author": "Wonko the Sane",
      "content": "Right now it is clear (to me) only the solemn declaration that the intended/designed environment is not up for debate (which BTW not necessarily will grant you immunity from debate/observations on it).\n\nThe actual description of the environment is a single extremely loooong sentence:\n\u003e How could easy2boot as it is be made to work off a gpt-type internal SSD whereas the ESP ( fat28/32 ) is itself declared as active partition in hybrid mbr starting at sector 2048/64 (whatever works better) followed by either a single primary ntfs usable as storage hold for vhds or mostly appreciated an extended partition for native installed systems running from logical partitions containing lvm2 ; accessible as extended booted either via g4d of easy2boot from the esp-mbr-hybrid-active-partition or via grub2 from boot partition following the extended/ being the third and last primary at all partition ( rest is blocked in hybrid mbr and used for gpt-partitions ) ; I am steadily stumbling in some part of the process, feeling a bit like Schroedingers cat.\n\u003e\nthat I really cannot understand. ![:(](http://reboot.pro/public/style_emoticons/default/sad.png)\n\nMaybe you can re-describe it in a simplified manner, possibly using a list of the points or something similar, and possibly posting a copy of the Hybrid MBR as it is now?\n\nWhat is missing at first sight is if this is a BIOS or UEFI (or UEFI+CMS\u003dBIOS) system.\n\ngrub4dos requires BIOS, and should the actual \"base\" question be \"how to boot on BIOS on GPT\", there are IMHO better methods than a Hybrid MBR:\n\n[http://reboot.pro/to...in-bios-to-gpt/](http://reboot.pro/topic/19516-hack-bootmgr-to-boot-windows-in-bios-to-gpt/ \"\")\n\nShameless plug (and WARNING still to be fully tested/experimental):\n\n[http://reboot.pro/to...e-7#entry192974](http://reboot.pro/topic/19516-hack-bootmgr-to-boot-windows-in-bios-to-gpt/page-7#entry192974 \"\")\n\n[http://reboot.pro/to...o-gpt/?p\u003d193659](http://reboot.pro/topic/19516-hack-bootmgr-to-boot-windows-in-bios-to-gpt/?p\u003d193659 \"\")\n\n(you will need to read most of the thread to get the hang of the two possible solutions above)\n\nAnd conversely (yes I am ignoring your request for no debate) it makes little sense to use GPT on a SSD on a BIOS system, unless the SSD exceeds 2.2 Tb.\n\nIf you are going for a Hybrid MBR instead make sure to be familiar with the info here:\n\n[http://www.rodsbooks...isk/hybrid.html](http://www.rodsbooks.com/gdisk/hybrid.html \"External link\")\n\n![:duff:](http://reboot.pro/public/style_emoticons/default/duff.gif)\n\nWonko\n\n"
    },
    {
      "id": "194334",
      "timestamp": "2015-08-05T18:52:58+00:00",
      "author": "S466531257BOSS",
      "content": "Thanks Wonko, i\u0027ll take a look into the links .\n\nTo roll it up from top to bottom :\n\nYes, i am familiar with hybrid mbrs efi uefi duet tianocore also and especially rodsbooks practical notes on that .\n\nFor testing purposes a just big enough 80GB SSD ( Intel X-18M G1 80 GB SSD - original one from the 2730p ) ;\n\nIf it survives the task - next stage is on the 2740p which runs a samsung evo 840 1TB ; next stage on the 2760p with samsung evo 850 1TB ; If it is possible to create the setup stable i am willed to spend a ( so-to-say refurbished then ) 3TB Fixstars ( possible in Q2 next year ) ;\n\nTesting work also for testing on 1.5TB and 3TB Drives ( mechanical WD i think 32M Cache ) in forefront for HDD\u0027s 4TB and 8 TB external SATA-600 USB-3 and as sas raid 4 x 8TB but not as hardware raid, that would be total nonsense and even myself accpets that as a no-go.\n\nOh sorry, the NoteBooks are Convertibles with digitizer HP CompaQ EliteBook 2730p \\| 2740P \\| 2760P - as an alternative a ruggedized Panasonic ToughBook CF-30 and a CF-31 later when worn-out will be the basement for the next years for the 2.5 inch drives ( the problem with the elitebooks is they need 1.8\u0027\u0027 (7mm) drives ; its a bit cozy in there . CPU Classes vary from Core-Duo to i5 . RAM is varying from 2 to 8 GB .\n\nThe EliteBooks have HP-Customized (U)EFI from version 1.7 ( 2730p alternatively modded variant available with 2.0 but needs time and concentration due to TPM-Binding ) others are 2.0 2.1 2.10 2.11 ; EliteBooks are CSM-enabled and support Intel TXT \\| CIRA \\| SecureBoot model-dependent ; the ToughBooks are a bit more complicated ( GPS-Lock and some other fancy remote-stuff ) and the CF-30 runs EFI (1.3/1.7 ? AMI-EFI-CSM-Bios ) --- in short --- 5 mixed CSM/EFI/UEFI - Setups\n\n--- and the wish to run and prepare the same drives also on bios-based systems ( Dell Poweredge 2900 (broken right now ) and 2950 ESXI5 \\| Windows Server 2008 \\| Windows Hyper-V 2012 \\| Ubuntu Server Lucid \\| Precise \\| Trusty \\| Fedora 21 WorkStation \\| Server and CentOS 6 and Debian Jessie untouched for month ) --- so in short --- i need interchangeability , mostly because i try to avoid to sit anymore than necessary right besides these monsters - i would estimate around 100 to 115dB noise of Wind on a beaufort scale around 6 -- NEVER SMOKE ASIDE ! )\n\nThe ToughBook runs fine/excellent with a hybrid-mbr in any variant. It runs Leopard / Fedora 21 WorkStation and Ubuntu Precise Desktop Which is the main reason for using a hybrid mbr as long as i haven\u0027t found more simple ways to run a hackintosh ( especially interested in Snow Leopard / Mavericks on the EliteBooks if Posssible ).\n\nThe eliteBooks by the way are the most hairy ones in terms of bitching around when something changes ( It is more complicated to avoid that the books save em\u0027self beware of potential problems which there might could happen then to break them at will / at least when using the hardware-assisted tpm/credential/fingerprint-combo in combination with amt-assist and remote-storage ) --- however in short --- hybrid mbr because of hackintosh .\n\nThe optimum in terms of disk layout i can think of\n\n1. ESP ( EFI system Partition )\n\n: of 8GiB up to 32GiB\n\n: ( Offset and Sector-Alignment 63 ( 32KB / 512 Byte/Sector ))\n\n--- which is already problematic with external HDD 1.5TB USB-3 cases because i haven\u0027t found a firmware that allows me to handle that directly and the 3 TB are Adavanced Format ; So a better solution would be circumventing the start at Sector 63 for hybrid MBR problemless booting in bios mode ; any ideas/informations welcome\n\nThe ESP also\n\n--- as the first hybrid mbr partition\n\n--- active\n\n--- containing any boot loaders\n\n--- easy2Boot (G4D)\n\n--- besides\n\n: Clover / Chameleon / grub4dos earlier versions / refit / refind / grub2 / burg / ntldr / bootmgr ( except grub2 stage 1.5 - that one is appended as separate gpt partition and mirrored as bios-boot partition )\n\n2. So to say in the inbetween of the first active primary hybrid mbr which is identical to the ESP\n\n--- an hybrid mbr extended partition\n\n--- with fixed positions\n\n--- and reserved space between the EP and the first logical\n\n--- to secure that ( due to the fact an MBR-EP handles PBR listwise ) the corruption is as minimal as possible just in case ;\n\n--- followed by a copy of the EP ( 0x88 ) which is unknown to the hybrid mbr and set with enough offset to the ExtendedPartition-Definition\n\n--- followed by all logical partitions pre-reserved in stackings of\n\n: 8 GB + reserved-space-up-to 8 GiB\n\n: 16 GB + reserved-space-up-to 16 GiB\n\n: 32 GB + reserved-space-up-to 32 GiB\n\n: 64 GB + reserved-space-up-to 64 GiB\n\netc. ( just to be able to calculate the offsets in case of repairing tables / recovery )\n\n--- if you ask why --- BECAUSE ( in the logical ones interchangeable SetUps / Installed Versions of mostly Linux-LVM2-Container-Stuff awaits editing / direct-booting / cloning / deploying / virtualizing / etc. via Network/SDHC/CompactFlash/VHD(1/RAW)/DVD/BluRay )\n\nSo just in case one can follow - this is all about having a fixed grid that can be calculated in disaster case by hand and also can be setup dependent on a fixed set of hardware for storage/backup/deployment-purposes\n\nHowever\n\nThe last logical-partition is the grub-stage 1.5 / the full grub2 --- aka the bios-boot which can already and should be runable in any mode (bios/csm/efi) problem is sometimes it does / sometimes not\n\n--- so right now i am staggering with gaining the feel of when something will definately go to break ;\n\n3. After the extended partition (well-defined as you might have understood right now and so far according to Steves notes on Easy2Boot )\n\n--- the hybrid mbr\n\n--- JUST contains the ESP as first primary\n\n--- and the extended partition\n\n--- containing a plaintext-copy of the EP-PBR-LIST\n\n--- followed by the Logicals\n\n--- followed and therefore ended/closed by the grub2 bios-boot partition\n\n... and here it comes : the icing on the top of the fire-pickle-carrying water-rock-climbing-deep-sky-diver drowning under it :\n\n--- all that is followed by the MSR ( MicroSoft Reserved Partition which can be 32MiB if just followed by one 16GiB GPT-Partition or 128 MiB for any bigger amounts following )\n\n... so the MSR states the border between the (hybrid-)MBR-Portion and the GPT-Piss-In-Rest-Portions of the drive .\n\n... I know, i know you might think i am crazy and one could do that easier ; Well if so please show me the way . If not feel free to tinker with it .\n\nThe main problem right now is the layout of the grid to specify where the partitions have to start and end so that\n\n--- enough space is inbetween\n\n--- the offsets accord to the rules given by MBR \\| GPT \\| BIOS \\| EFI and the necessities of the bootloaders\n\n--- and the offsets have to fit into the possible formats ( 512Byte/2kb/AF or conditions like having the ESP fat28/32 with 4k-clusters etc. )\n\nAll in all its simple , but to create it practically has to be done step-by-step and though almost all parts behave like they should if used on their own it is problematic because i haven\u0027t found the least common denominator for the partition-splitting.\n\nAnd also i am not sure about things like in fact Mac OS X as stated on rodsbook has a definitive problem with hybrid-mbr protected ee-partition-type additionally ; it is true but i haven\u0027t found an alternative yet that is untouched by other operating systems ( besides x88 which is recognized by some os but doesn\u0027t bother them ) .\n\nWell, that\u0027s it in a round-up for now.\n\nWhen time comes - i\u0027ll try to essay out the conclusions and spend some drawings and attaching some partition tables and configurations; Until then : Maybe one has a deeper knowledge and an interest in it and is willed to help out with some thoughts to give the cuddle-muddle in my head based on some hundred tested variants until now a better shape .\n\nYOU DID IT ! I AM PROUD OF YOU !! YOU BEHAVED BRAVE !!!\n\nNow forget about all that crap, go get a girl or a drink or show your kid why you have that funny unexplainable look on your face ...\n\nTHANKS FOR YOUR INTEREST .\n\nS466531257 BOSS\n\nPAETH CLAUDIUSRAPHAEL\n\nP.S.: You are save now ... That was the last post from my side, mostly because\n\n: Reboot.Pro tells me \u0027 You can make 1 more posts until A minute ago. \u0027 ![:dubbio:](http://reboot.pro/public/style_emoticons/default/dubbio.gif)\n\nBURN AFTER READING .\n\n"
    },
    {
      "id": "194336",
      "timestamp": "2015-08-05T19:16:41+00:00",
      "author": "S466531257BOSS",
      "content": "And maybe i should end right here, copy that post into a new thread and in the meanwhile think of a fancy title for it ... before i get kicked because of hijacking threads ; Hmmm ...\n\nMaybe :\n\nREQUEST : [Thoughts on Partitioning ( Hybrid-MBR / GPT ) - Stacked Partition Grid](http://reboot.pro/topic/20646-request-thoughts-on-partitioning-hybrid-mbr-gpt-stacked-partition-grid/#entry194335 \"\")\n\nTHANKS AND SORRY FOR THE FISH .\n\nS466531257 BOSS\n\nPAETH CLAUDIUSRAPHAEL\n\n"
    }
  ]
}