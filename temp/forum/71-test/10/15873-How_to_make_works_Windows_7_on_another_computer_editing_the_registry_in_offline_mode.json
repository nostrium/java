{
  "id": "15873",
  "title": "How to make works Windows 7 on another computer editing the registry in offline mode",
  "isPinned": false,
  "isFirstTopic": false,
  "isLocked": false,
  "tags": [],
  "forumNotes": [
    {
      "id": "142512",
      "timestamp": "2011-11-23T12:44:05+00:00",
      "author": "Marietto",
      "content": "Hello to everyone.  \n\nThe computer that I use mostly is broken. On it there was installed Windows 7. Now I\u0027m trying to make work that installation of Windows 7 on another computer. If someone remembers well the procedure to follow,that has been invented on 2009 by karyonix and other members of this forum,it is about to :  \n\na) copy two files on the disk where windows 7 is installed,exactly on windowssystem32 The first is called usbbootwatcher.conf and this is the content :  \n\n```\n \n\n[usbstor]\n\nStart@REG_DWORD\u003d0\n\nGroup@REG_SZ\u003d\"SCSI miniport\"\n\n[usbehci]\n\nStart@REG_DWORD\u003d0\n\nGroup@REG_SZ\u003d\"Boot Bus Extender\"\n\n[usbohci]\n\nStart@REG_DWORD\u003d0\n\nGroup@REG_SZ\u003d\"Boot Bus Extender\"\n\n[usbuhci]\n\nStart@REG_DWORD\u003d0\n\nGroup@REG_SZ\u003d\"Boot Bus Extender\"\n\n[usbhub]\n\nStart@REG_DWORD\u003d0\n\nGroup@REG_SZ\u003d\"System Bus Extender\"\n\n \n\n```\n\n\u003cbr /\u003e\n\nthe second is called usbbootwatcher.exe  \n\nb) write this code inside the registry :  \n\n```\n\n\nREGEDIT4\n\n\n\n[HKEY_LOCAL_MACHINESystemCurrentControlSetservicesUsbBootWatcherService]\n\n\"Type\"\u003ddword:00000010\n\n\"Start\"\u003ddword:00000002\n\n\"ErrorControl\"\u003ddword:00000000\n\n\"ImagePath\"\u003dhex(2):25,53,79,73,74,65,6d,52,6f,6f,74,25,5c,73,79,73,74,65,6d,33,\n\n32,5c,55,73,62,42,6f,6f,74,57,61,74,63,68,65,72,2e,65,78,65,00\n\n\"DisplayName\"\u003d\"Usb Boot Watcher Service\"\n\n\"ObjectName\"\u003d\"LocalSystem\"\n\n\n\n[HKEY_LOCAL_MACHINESystemCurrentControlSetControlSafeBootMinimalUsbBootWatcherService]\n\n\n\n[HKEY_LOCAL_MACHINESystemCurrentControlSetControlSafeBootNetworkUsbBootWatcherService]\n\n\n\n[HKEY_LOCAL_MACHINESystemCurrentControlSetservicespciide]\n\n\"Start\"\u003ddword:00000000\n\n\n\n[HKEY_LOCAL_MACHINESystemCurrentControlSetservicesintelide]\n\n\"Start\"\u003ddword:00000000\n\n \n\n```\n\n\u003cbr /\u003e\n\nI followed this procedure a lot of times,but always while Windows 7 was running. And it worked fine. Now I would like to do it editing the registry in offline mode,because,as I said my primarily computer does not turn on. For who doesn\u0027t know how to edit the registry in offline mode,this is a good article to read : [http://4sysops.com/a...gistry-editor/.](http://4sysops.com/archives/regedit-as-offline-registry-editor/. \"External link\") The problem is that when I try to edit the registry offline, normally there is no CurrentControlset key active,so I can\u0027t add that code. If I write it from scratch it does not work anyway. In fact when I try to boot Windows 7,it says : REG_INITIALIZATION_FAILED..   \n"
    },
    {
      "id": "142515",
      "timestamp": "2011-11-23T13:17:25+00:00",
      "author": "Wonko the Sane",
      "content": "Marietto,  \nCurrentControlSet DOES NOT exist offline.  \nWhen online it is a link to either ControlSet001 or ControlSet002 or more generally to ControlSet***xyz***   \n\nYou can use **erwan.l** \u0027s little app that will do automatically the remapping (or check manually contents of the Select key and change the paths accordingly):  \n\u003chttp://reboot.pro/11312/\u003e  \n\n\u003cbr /\u003e\n\n![:cheers:](http://reboot.pro/public/style_emoticons/default/cheers.gif)  \nWonko   \n"
    },
    {
      "id": "142530",
      "timestamp": "2011-11-23T14:44:55+00:00",
      "author": "Marietto",
      "content": "ok. following your advice,I\u0027ve found that the ControlSet used in my case is the 002. I\u0027ve followed two ways to find it :  \n\n1) i\u0027ve executed the cdob script :  \n\n```\n\n\nrem detect CurrentControlSet\n\nfor /f \"tokens\u003d3\"; %%a in (\u0027reg.exe query \"HKLMsysSelect\" /v \"Current\"\u0027); do set /a ControlSet\u003d%%a\n\nset ControlSet\u003d00000%ControlSet%\n\nset ControlSet\u003dControlSet%ControlSet:~-3%\n\necho. \u0026echo ControlSet \"%ControlSet%\" used.\n\n\n\n```\n\n\u003cbr /\u003e\n\nand I\u0027ve checked manually the HKLMsysselect key of the imported system registry. It says : current \u003d 2 ; default \u003d 2 ; failed \u003d 1 ; lastknowngood \u003d 3 ;  \n\nafter this,I\u0027ve merged the reg script inside the ControlSet002 reg key and I\u0027ve rebooted the computer,but Windows 7 was unabled to make the boot again.   \n"
    },
    {
      "id": "142532",
      "timestamp": "2011-11-23T15:03:24+00:00",
      "author": "Wonko the Sane",
      "content": "Well, you probably have made something \"wrong\" ![:ph34r:](http://reboot.pro/public/style_emoticons/default/scared9.gif) or more probably that Windows 7 suffers from \\*another\\* problem.  \n\nYou can try the \"other\" approach for 7, though cannot say whether it will work:  \n[http://reboot.pro/98...403#entry140403](http://reboot.pro/9830/page__st__425__p__140403#entry140403 \"\")  \n\nOr even see if PWboot can work in your situation. ![:unsure:](http://reboot.pro/public/style_emoticons/default/unsure.png)  \n\u003chttp://reboot.pro/6851/\u003e  \n\n![:cheers:](http://reboot.pro/public/style_emoticons/default/cheers.gif)  \nWonko   \n"
    }
  ]
}