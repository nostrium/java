{
  "id": "7138",
  "title": "Multiple boot partitiions on the same drive",
  "isPinned": false,
  "isFirstTopic": false,
  "isLocked": false,
  "tags": [],
  "forumNotes": [
    {
      "id": "59617",
      "timestamp": "2009-02-17T17:21:29+00:00",
      "author": "Luca\u0027s",
      "content": "Hello everybody.  \nI have a quite puzzling problem.  \n\n**I\u0027m under xp, and have a usb stick which i need to be formatted with 3 primary ntfs partitions: one for data, another for data too (but to be used with true-crypt), while the third needed to multi-boot an xp and a vista setup.**   \nTo achieve my goal, i acted like so: using this really remarkable tool (i mean the one reachable **[here](http://www.msfn.org/board/install-USB-WinSetupF-t120444.html \"External link\")** ), i made a multi-boot xp and vista setup out of the removable drive.  \nThen, in order to resize the bootable ntfs partition created by the tool (so to be able to create the other two partitions), i used the hitachi filter driver to make xp see the usb stick as if it were a fixed unit.  \n\n**What\u0027s the problem, hence? Easy to say: the problem is i have the usb stick to be portable.\nI mean: i need the default driver (the microsoft one that sees the usb disk as a removable device) to see as a removable device the data partition, not the bootable nor the true-crypt partitions. It shows the bootable partition instead.**   \n\nThis is due to the fact that, when you turn back to the default driver, the OS sees as a removable device just one partition among the created (no more than one). The point is, at most, which partition is choosen to be shown and why.   \n\nI have noticed that to be shown as a removable device, there\u0027s no need at all it is the partition where xp and vista setup files are: when you have on the stick three primary partitions none of which is bootable, it is the first partition on disk that is seen as a removable unit. In particular, when the partition where xp and vista setup files are (let\u0027s call it \\\u003c\\\u003cD:\\\u003e\\\u003e ) is bootable, the default driver keeps showing D: as the removable device until you convert it to a logical partition (no matter if you have set it as inactive or as hidden when using the filter driver).  \n\nTo be honest, i don\u0027t know if the tool makes the partition bootable in the sense that it writes grub4dos in the MBR of the entire usb stick disk or else in the sense that it writes grub4dos in D: bootsector (i just know it requires the partition to be active for the boot process to work), but in any case what i need is the default driver to show the data partition, not D:.  \n\n**So here comes my question.\nLet\u0027s suppose that having more than one bootable partition on the same device can change the priority with which the default driver chooses among partitions the one to be shown (for example: if i make the data partition a bootable partition, now i have two bootable partitions and the priority criterion becomes to show the partition that comes first on disk). If so, could you please indicate or teach me a way to have multiple bootable partitions on the same device? (i have heard of multiple boot records, am i on the right path or am i just confused?)\nOr at least: could you please show me a guide or teach me how to create a multi-boot usb stick in such a way that the bootable partition actually is the data partition, but having a bootchain in it to launch grub4dos from the other partition?**   \nI hope i have been clear enough.  \n\nThe puzzle is driving me crazy so... any help will be truly appreciated.  \nThanks a lot! ![:poke:](http://reboot.pro/public/style_emoticons/default/poke.gif)   \n"
    },
    {
      "id": "59620",
      "timestamp": "2009-02-17T17:44:29+00:00",
      "author": "was_jaclaz",
      "content": "\u003e I hope i have been clear enough.\nMaybe you also overdid it. ![:poke:](http://reboot.pro/public/style_emoticons/default/poke.gif)  \n\nWhat is the reason for three primaries? ![:poke:](http://reboot.pro/public/style_emoticons/default/poke.gif)  \n\nIf i get it right, in \"normal\" operation you just need to \"see\" one partition out of the three, correct?  \n\nIf yes, you have two choices:  \n\n* keep grub4dos installed on the MBR (+hidden sectors) and add the commands needed to hide/unhide active/inactive the partition each time you boot from the stick.\n* remove grub4dos from the MBR and use instead ~~OS-BS~~ mbldr:\n\n[http://www.boot-land...p?showtopic\u003d334](http://www.boot-land.net/forums/index.php?showtopic\u003d334 \"External link\")  \n(this is advised as it fits ENTIRELY in the MBR thus avoiding possible problems with any software that may use the hidden sectors)  \n\nthen:  \nAdd to EACH partition a set of tools for ALL operating systems running on the PCs you are going to use the stick on capable of setting the Active partition.  \n\nLet\u0027s start to call partitons with their \"names\", a partition is better indicated by it\u0027s position, like in (hd***x*** ,***y*** ) where ***x*** is the drive number, ***0*** if you boot from it, ***n*** if added to an already booted system, ***y*** is the partition number, ***0*** being the first one (in grub4dos notation, ***1*** in common NT based windows notation).  \n\nTo better clear the above, first partition of first disk will be:  \n(hd0,0) in grub4dos or  \nrdisk(0)partition(1) in Windows ARCPATH, shortened to 0,1  \n\nWhen you boot from the stick, the three partitions will be:  \n(hd0,0)  \n(hd0,1)  \n(hd0,2)  \n\nwhen you insert the stick in an already booted system, with already one disk in it, you will get:  \n(hd1,0)  \n(hd1,1)  \n(hd1,2)  \n\nIt would be nice if you could run ddlistw.cmd:  \n[http://www.boot-land...?...c\u003d6492\\\u0026st\u003d7](http://www.boot-land.net/forums/index.php?showtopic\u003d6492\u0026st\u003d7 \"External link\")  \n\nand post it\u0027s output, like in this post:  \n[http://www.boot-land...?...5306\\\u0026st\u003d156](http://www.boot-land.net/forums/index.php?showtopic\u003d5306\u0026st\u003d156 \"External link\")  \n\nAnd a screenshot of the USB thingy as seen by beeblebrox:  \n[http://students.cs.byu.edu/\\~codyb/](http://students.cs.byu.edu/~codyb/ \"External link\")  \nor however the info how it sees the stick.  \n\nThis way I can see how it is formatted and how it is seen by windows (with and without the filter driver). ![:poke:](http://reboot.pro/public/style_emoticons/default/poke.gif)   \n\njaclaz   \n"
    },
    {
      "id": "59666",
      "timestamp": "2009-02-18T00:34:40+00:00",
      "author": "Luca\u0027s",
      "content": "I will begin by posting the infos you asked me. Then i will develop my reasonment.  \n\nThis is how the stick is seen as fixed with the 3 partitions in it:  \n\n```\nDrives by drive letter:c: 0,1 FIX \\Volume{302303c8-08ca-11dd-bfed-806d6172696f} \\HarddiskVolume1d: 0,3 FIX \\Volume{2a969c7a-b7af-11dd-8329-806d6172696f} \\HarddiskVolume3e: 0,2 FIX \\Volume{2a969c7b-b7af-11dd-8329-806d6172696f} \\HarddiskVolume2f: x,x CDR \\Volume{82185941-08cb-11dd-aab9-806d6172696f} \\CdRom0g: x,x CDR \\Volume{8711f062-204b-11dd-aac0-0013ce9184f6} \\CdRom3h: x,x CDR \\Volume{8711f060-204b-11dd-aac0-0013ce9184f6} \\CdRom1i: x,x CDR \\Volume{8711f061-204b-11dd-aac0-0013ce9184f6} \\CdRom2j: x,x CDR \\Volume{c3b0e5db-b319-11dd-ab81-005056c00008} \\CdRom4k: x,x CDR \\Volume{b9e9cdc3-f691-11dd-abce-005056c00008} \\CdRom5l: 1,2 FIX \\Volume{a95f399e-fcd1-11dd-abe7-005056c00008} \\HarddiskVolume5m: 1,3 FIX \\Volume{a95f399c-fcd1-11dd-abe7-005056c00008} \\HarddiskVolume6n: 1,1 FIX \\Volume{a95f399d-fcd1-11dd-abe7-005056c00008} \\HarddiskVolume4Drives by connection:c: 0,1 FIX \\Volume{302303c8-08ca-11dd-bfed-806d6172696f} \\HarddiskVolume1e: 0,2 FIX \\Volume{2a969c7b-b7af-11dd-8329-806d6172696f} \\HarddiskVolume2d: 0,3 FIX \\Volume{2a969c7a-b7af-11dd-8329-806d6172696f} \\HarddiskVolume3n: 1,1 FIX \\Volume{a95f399d-fcd1-11dd-abe7-005056c00008} \\HarddiskVolume4l: 1,2 FIX \\Volume{a95f399e-fcd1-11dd-abe7-005056c00008} \\HarddiskVolume5m: 1,3 FIX \\Volume{a95f399c-fcd1-11dd-abe7-005056c00008} \\HarddiskVolume6f: x,x CDR \\Volume{82185941-08cb-11dd-aab9-806d6172696f} \\CdRom0h: x,x CDR \\Volume{8711f060-204b-11dd-aac0-0013ce9184f6} \\CdRom1i: x,x CDR \\Volume{8711f061-204b-11dd-aac0-0013ce9184f6} \\CdRom2g: x,x CDR \\Volume{8711f062-204b-11dd-aac0-0013ce9184f6} \\CdRom3k: x,x CDR \\Volume{b9e9cdc3-f691-11dd-abce-005056c00008} \\CdRom5j: x,x CDR \\Volume{c3b0e5db-b319-11dd-ab81-005056c00008} \\CdRom4\n```\n\nThis is how the stick is seen as a removable device:\n\n```\nDrives by drive letter:c: 0,1 FIX \\Volume{302303c8-08ca-11dd-bfed-806d6172696f} \\HarddiskVolume1d: 0,3 FIX \\Volume{2a969c7a-b7af-11dd-8329-806d6172696f} \\HarddiskVolume3e: 0,2 FIX \\Volume{2a969c7b-b7af-11dd-8329-806d6172696f} \\HarddiskVolume2f: x,x CDR \\Volume{82185941-08cb-11dd-aab9-806d6172696f} \\CdRom0g: x,x CDR \\Volume{8711f062-204b-11dd-aac0-0013ce9184f6} \\CdRom3h: x,x CDR \\Volume{8711f060-204b-11dd-aac0-0013ce9184f6} \\CdRom1i: x,x CDR \\Volume{8711f061-204b-11dd-aac0-0013ce9184f6} \\CdRom2j: x,x CDR \\Volume{c3b0e5db-b319-11dd-ab81-005056c00008} \\CdRom4k: x,x CDR \\Volume{b9e9cdc3-f691-11dd-abce-005056c00008} \\CdRom6l: 1,1 REM \\Volume{b9e9cdc4-f691-11dd-abce-005056c00008} \\Harddisk1\\DP(1)0-0+dDrives by connection:c: 0,1 FIX \\Volume{302303c8-08ca-11dd-bfed-806d6172696f} \\HarddiskVolume1e: 0,2 FIX \\Volume{2a969c7b-b7af-11dd-8329-806d6172696f} \\HarddiskVolume2d: 0,3 FIX \\Volume{2a969c7a-b7af-11dd-8329-806d6172696f} \\HarddiskVolume3l: 1,1 REM \\Volume{b9e9cdc4-f691-11dd-abce-005056c00008} \\Harddisk1\\DP(1)0-0+df: x,x CDR \\Volume{82185941-08cb-11dd-aab9-806d6172696f} \\CdRom0h: x,x CDR \\Volume{8711f060-204b-11dd-aac0-0013ce9184f6} \\CdRom1i: x,x CDR \\Volume{8711f061-204b-11dd-aac0-0013ce9184f6} \\CdRom2g: x,x CDR \\Volume{8711f062-204b-11dd-aac0-0013ce9184f6} \\CdRom3k: x,x CDR \\Volume{b9e9cdc3-f691-11dd-abce-005056c00008} \\CdRom6j: x,x CDR \\Volume{c3b0e5db-b319-11dd-ab81-005056c00008} \\CdRom4\n```\n\nThis is the beeblebrox screenshot. It is the same both with and without the fixed driver.[![beeblebrox.jpg](http://reboot.pro/uploads/monthly_02_2009/post-15106-1234917443_thumb.jpg)](http://reboot.pro/uploads/monthly_02_2009/post-15106-1234917443.jpg \"beeblebrox.jpg - Size: 41.78KB\"){#ipb-attach-url-7579-0-64193900-1676066544} What is the reason for three primaries?\nWell, to tell the truth, no reason. Only the bootable partition needs to be primary... If i get it right, in \"normal\" operation you just need to \"see\" one partition out of the three, correct?\nIf by \"normal operation\" is meant when i have windows normally running from the notebook hard disk, yes, i need so. To be more precise, i need not just to be shown only one partition, but the data partition and not the others.Let\u0027s suppose i decide to keep grub4dos (because i think it\u0027s too hard-coded in the multi-boot installation process of the partition created by the tool). I can\u0027t understand why you suggest me to Add to EACH partition a set of tools for ALL operating systems running on the PCs you are going to use the stick on capable of setting the Active partition.\nFirst of all: what tools do you refer to?Then, do you think setting as the active partition the data partition L: instead of the bootable partition N: will solve the problem? My question is not pretentious, i just don\u0027t understand if it\u0027s that what you think. Because if you think so, i have to say i\u0027ve already worked on setting (with Acronis disk director) both the other 2 partitions to be the active one, but with just the result that the usb stick gives an error when i try to boot from it, while it still sees N: as the removable device when i am within windows.In any case, what\u0027s strange to me as an ignorant is that N: partition is seen as Volume4 even if i have moved it to be, in order, the third partition on disk.  \n\nBTW, thank you very much for your kindness.  \n\n#### Attached Thumbnails {#attach_wrap}\n\n* [![beeblebrox.jpg](http://reboot.pro/uploads/monthly_02_2009/post-15106-1234917626_thumb.jpg)](http://reboot.pro/uploads/monthly_02_2009/post-15106-1234917626.jpg \"beeblebrox.jpg - Size: 41.78KB\"){#ipb-attach-url-7580-0-64206000-1676066544}\n\n"
    },
    {
      "id": "59747",
      "timestamp": "2009-02-18T19:45:31+00:00",
      "author": "was_jaclaz",
      "content": "OK. ![:poke:](http://reboot.pro/public/style_emoticons/default/poke.gif)  \n\nLet\u0027s start with some order.  \n\nThis:  \n\u003e l: 1,2 FIX \\\\Volume{a95f399e-fcd1-11dd-abe7-005056c00008} \\\\HarddiskVolume5  \n\u003e m: 1,3 FIX \\\\Volume{a95f399c-fcd1-11dd-abe7-005056c00008} \\\\HarddiskVolume6  \n\u003e n: 1,1 FIX \\\\Volume{a95f399d-fcd1-11dd-abe7-005056c00008} \\\\HarddiskVolume4\n(stick seen as fixed)  \nprobably means that you already connected this particular stick to the particular PC you are using and during any of the tests the first partition (1,1) got assigned letter \"n\".  \nThis kind of assignment is generally \"sticky\", until you do not re-assign the letter through mountvol or Disk Management.  \n\nThe beeblebrox screenshot shows how your partitioning... well... ...is a mess. ![:poke:](http://reboot.pro/public/style_emoticons/default/poke.gif)  \n\nbeeblebrox (through the filter driver you are using) sees the stick as having a geometry of 61,209x16x32, and more generally a geometry of ***n*** x16x32, which is not \"standard\".  \n\nThe stick appears to have been partitioned (or re-partitioned) in a \"queer\" way.  \nFirst Entry (entry 0) is starting past cylinder 1023, and has fractional heads/sectors. It should really be entry 2, size is 3.444.439.040 bytes  \nThough this may not be a problem since the partition is NTFS and thus accessed through LBA addressing, it might not be \"compatible\" with some BIOSes.  \nSecond Entry (entry 1) should actually be entry 0 (as it starts - correctly - at CHS 0/1/1 or LBA 63) size is 10.561.227.264 bytes  \nThird Entry (entry 2) should actually be entry 1, size is 2.039.869.440  \n\n\u003cbr /\u003e\n\n\u003cbr /\u003e\n\n\u003cbr /\u003e\n\nI would suggest you to re-start from scratch, thus you will lose any data you have currently on the stick, please backup any data you care about.  \n\nPlease ***FORGET*** Acronis, I may well be wrong, but I suspect that it is part of the problem ![:poke:](http://reboot.pro/public/style_emoticons/default/poke.gif).  \n\nWhat you have currently is roughly:  \n\n* a 10 Gb partition\n* a 2 Gb partition\n* a 3 Gb partition\n\n\u003cbr /\u003e\n\nWhich one is \"data\", which one is \"truecrypt\" and which one is \"setups\"?  \n\nWhat you should do now is clear the first, say, 100 sectors of the stick.  \n\nYou can use a hex/disk editor, if you are familiar with it, or the method using fsz/dsfo here:  \n[http://www.boot-land...topic\u003d3453\\\u0026st\u003d8](http://www.boot-land.net/forums/?showtopic\u003d3453\u0026st\u003d8 \"External link\")  \n\nBe VERY careful in using the right Physicaldrive number!  \n\nDisconnect the stick and reconnect it.  \n\nAccess it through Disk Management (I am assuming you are having the Filter Driver installed) and partition the disk, creating first thing the \"setups\" partition, then the \"truecrypt\" one, then the data one.  \nMake three primary ones.  \nFormat each of them as NTFS.  \n\nDisconnect the stick and reconnect it.  \n\nRun again beeblebrox and post screenshot.  \n\nAbout your question, when there is NO filter driver in the NT based OS, only one partition is accessible, the Active one.   \nHidden partitions are NOT assigned drive letters anyway.  \n\nThe idea should be that when you boot from the stick, you have:  \n\n* \"setups\" Active and unhidden\n* \"data\" hidden\n* \"truecrypt\" hidden\n\n\u003cbr /\u003e\n\nAnd you are able from the boot menu to change the Active and hidden status of each partition for present and NEXT boot/connection. (through grub4dos or other \"special\" MBR)  \n\nWhen you access the stick by connecting it to a live system, you must have (on ALL partitions in the stick, so that whatever is the unhidden active one you can access it) a tool to be able to switch the status of the partitions, so that you can change it to the one you like to access and by disconnecting and reconnecting the stick access the one you are interested in.  \n\nIn other words the stick can be in either of THREE states, depending on how you left it last time you used/accessed it:  \n\n* **\"setups\" Active and unhidden**/\"data\" hidden/\"truecrypt\" hidden\n* \"setups\" hidden/**\"data\" Active and unhidden**/\"truecrypt\" hidden\n* \"setups\" hidden/\"data\" hidden/**\"truecrypt\" Active and unhidden**\n\n\u003cbr /\u003e\n\nAnd you need a way to \"switch\" among the above both when you are booting from the stick (through grub4dos or \"special\" MBR) and when you simply connect it to a working system (the \"other tool\", which can be the same beeblebrox, a diskpart script, MBRFIX, MBRWIZ, and a number of other programs).  \n\nI hope that the above is clear enough to show what the \"plan\" is. :smile:  \n\njaclaz   \n"
    },
    {
      "id": "59906",
      "timestamp": "2009-02-19T23:51:12+00:00",
      "author": "Luca\u0027s",
      "content": "Sorry for being late but i have some problems to stay connected.  \nAs usual, i begin with providing you the infos you asked me, then reply.  \n\n\u003e What you have currently is roughly:  \n\u003e 1. a 10 Gb partition   \n\u003e 2. a 2 Gb partition   \n\u003e 3. a 3 Gb partition  \n\u003e Which one is \"data\", which one is \"truecrypt\" and which one is \"setups\"?\n\nThe 10 gb partition should be data  \nThe 2 gb should be truecrypt  \nThe 3 gb partition should be setups  \n\nBut you told me to create  \n\n\u003e first thing the \"setups\" partition, then the \"truecrypt\" one, then the data one\n\nso i have partitioned in the order you said.  \nHere\u0027s the beeblebrox screenshot (after having zeroed the first 100 sectors and having partitioned):  \n[![beeblebrox.jpg](http://reboot.pro/uploads/monthly_02_2009/post-15106-1235087226_thumb.jpg)](http://reboot.pro/uploads/monthly_02_2009/post-15106-1235087226.jpg \"beeblebrox.jpg - Size: 41.2KB\"){#ipb-attach-url-7609-0-64212000-1676066544}   \n\nWith disk management, setups is L:, truecrypt is M:, data is N:. I have to specify there is no active partition at the moment.  \n\nIn addition, let me say i now better understand your plan: but before to reply, i have to clarify a little more what my needs are.  \nFirst of all, when within Windows, i\u0027d like the setups partition to be ALWAYS hidden, both when the OS uses the filter driver and when it does not (which is to prevent the user from accidentally deleting setups files). The same holds true for the truecrypt partition. In other words: within Windows, i need ONLY the data partition to be shown, be it with the filter driver or not. On the other side, i still need to boot in some way from the setups partition. These are the pre-requisites: i have to meet them all, and simultaneously.  \n\nSo, back to your solution. Given the pre-requisites, it follows i only want the state 2 to be true. this one--\\\u003e (\"setups\" hidden/**\"data\" Active and unhidden** /\"truecrypt\" hidden). I want to explicitly exclude state 1 and 3.  \n\nAbout the filter driver, in order to see the data partition only, it is sufficient to mark the setups and truecrypt partitions as hidden. Here, setting the data partition as active is uninfluential. (We have now setups and truecrypt hidden)  \n\nAbout the default driver, in order to see the data partition only, you told me i need to set it active. (We have now setups and truecrypt hidden, while data active)  \n\nSo, being the data partition the active one, it follows i can only create a bootchain from the data partition, to be also able to boot from the setups partition. I see no other solution (even if i hope there could be one). If i mark the setups partition as active, then the default driver within windows shows setups instead of data.  \n\nI don\u0027t intend to despise your useful proposal, but it\u0027s still that:  \n1 i prefer to avoid setting each time the active and hidden partitions manually  \n2 above all, i don\u0027t want to have any tool on any partition to allow those partitions i don\u0027t want to be shown to be shown. It has to be a pre-arranged configuration that only expert hands should deal with.  \n\nWell, the first to like it easier would be me, please trust me when i say.  \nI\u0027m sorry, but that\u0027s what i want to do: just hope if i solve my problem, it could help other people too. ![:poke:](http://reboot.pro/public/style_emoticons/default/poke.gif)   \n"
    },
    {
      "id": "59925",
      "timestamp": "2009-02-20T09:38:06+00:00",
      "author": "was_jaclaz",
      "content": "You\u0027ll have to agree that the newly partitioned stick looks a lot more \"tidy\" ![:poke:](http://reboot.pro/public/style_emoticons/default/poke.gif).  \n\nWell,  \nyou cannot have BOTH   \n\\[italian\\]  \nbotte piena e moglie ubriaca  \n\\[/italian\\]  \n(the above is an italian proverb, you cannot have at the same time wife drunk and cask of wine full)  \n\nSome compromises are needed.  \n\nLet\u0027s see which are the most simple ones.  \n\nI take for granted that you want the \"truecrypt\" always hidden and you have some misterious ![:poke:](http://reboot.pro/public/style_emoticons/default/poke.gif) way to deal with it.  \n\nIn beeblebrox, change the type 07 in entry #2 to 17 and let\u0027s forget about it.  \n\nSo we have just two partitions left.  \n\nInstall grub4dos to MBR +hidden sectors method #8:  \n[http://diddy.boot-la...ll.htm#method08](http://diddy.boot-land.net/grub4dos/files/install.htm#method08 \"External link\")  \n\nCopy grldr to \"setup\" partition, copy to it also NTLDR, NTDETECT.COM and a BOOT.INI with at least two entries, the one here will be OK for this test:  \n[http://diddy.boot-la...ll.htm#method05](http://diddy.boot-land.net/grub4dos/files/install.htm#method05 \"External link\")  \n\ncopy to it also a tag file, create a new empty .txt file and rename it my_grldr.tag  \ncopy to it also a menu.lst as follows:  \n\n```\ncolor black/cyan yellow/cyan\n\ntimeout 30\n\ndefault /default\n\n\n\ntitle find and load NTLDR of Windows NT/2K/XP\n\nfind --set-root /my_grldr.tag\n\nmakeactive\n\nunhide\n\nchainloader /ntldr\n\n\n\ntitle rehide setup partition\n\nfind --set-root /my_grldr.tag\n\nhide\n\nfind --set-root /my_data.tag\n\nmakeactive\n\nunhide\n```\n\n\u003cbr /\u003e\n\ncopy to the \"data\" partition a tag file , create a new empty .txt file and rename it my_data.tag  \n\nIn beeblebrox, hide the \"setup\" partition by changing the type 07 in entry #0 to 17 .  \nSet the \"data\" partition active by writing 80 in \"boot\" field.  \n\nTry booting from the stick.  \n\nChoose the \"find and load NTLDR of Windows NT/2K/XP\".  \n\nYou should be able to get to the choices in boot.ini, of which the \"windows\" entry won\u0027t work, and the grldr one should bring you back to menu.lst choices.  \n\nRestart the PC and check the stick with beeblebrox, once after having chosen \"find and load NTLDR of Windows NT/2K/XP\" last and once after having chosen \"rehide setup partition\".  \n\nProposed method:  \n\n* normal status of the stick is 2. \"setups\" hidden/**\"data\" Active and unhidden**/\"truecrypt\" hidden\n* when you boot from the stick you can choose to make the setup partition active/unhidden (and thus use it to install)\n* once the setup has finished you need to reboot from the stick once again and choose the \"rehide setup partition\" entry\n* stick is back to \"normal\" status\n\n\u003cbr /\u003e\n\nIf this is acceptable, try it, report, and we\u0027ll see some \"enhancements\", like password protecting etries in menu.list, using UUID instead of \"tag\" files, etc.  \n\njaclaz   \n"
    },
    {
      "id": "59987",
      "timestamp": "2009-02-20T17:47:38+00:00",
      "author": "Luca\u0027s",
      "content": "\u003e You\u0027ll have to agree that the newly partitioned stick looks a lot more \"tidy\"\nYep i think so. I take your word for it. ![:poke:](http://reboot.pro/public/style_emoticons/default/poke.gif)  \nBTW i have not understood why you told me not to use Acronis.. Well, no matter if you don\u0027t want to dwell on long explanations, but could you please indicate me a substitutive tool to resize, move, mark partitions as active, convert them from logical to primary etc.? Partition magic didn\u0027t seem that advanced to me.  \n\nAnyway yes, to momentarily forget the truecrypt partition was my intention too.  \nSo, let\u0027s come to the point.  \nI think it\u0027s not really that the proposed method is not acceptable: it\u0027s rather that i still don\u0027t get why grub4dos needs the setups partition to be active and unhidden to load the installation process. Could not the installation process be launched in memory like any normal program? Is it because to launch it you can\u0027t skip the loading of ntldr? Or is it because the second part of the windows installation needs the partition active and unhidden, to be completed? As far as i\u0027ve seen, when i had hidden the setups partition with Acronis, the first part of the xp setup launched correctly even when the partition was the last one on disk (but well, yes, there still was the partition mess).  \n\nYou know i just don\u0027t want to have critical files on the data partition. They could be deleted.  \nSo, if \\\u003c\\\u003cusing UUID instead of \"tag\" files\\\u003e\\\u003e is a method to avoid files on the data partition, it is welcome. Even better with passwords in the boot menu. This way, having to set the active partition each time i complete a setup, is a compromise i can stand. But first tell me it is impossible to reach my goal otherwise (i mean tell me it is not possible to leave the data partition always active). Because if you know other methods, i don\u0027t mind if they take time or they\u0027re difficult. I just do prefer to avoid stepping in with setting what partitions are active and what are not.  \n\nThere is also one more question.  \nLet\u0027s say i decide to adopt the last strategy you advised me. What about creating the setups partition files with winsetupfromusb? Will you help me find the way how to make the multi-boot setup process with xp and vista work, given that i\u0027ll have a grub4dos menu modified if compared with the one originally created with the tool? I mean either help with a guide to create the multi-boot partition out of nothing too...  \n\n\u003cbr /\u003e\n\nThanks a lot for all of your precious suggestions.   \n"
    },
    {
      "id": "59995",
      "timestamp": "2009-02-20T18:28:20+00:00",
      "author": "was_jaclaz",
      "content": "\u003e I think it\u0027s not really that the proposed method is not acceptable: it\u0027s rather that i still don\u0027t get why grub4dos needs the setups partition to be active and unhidden to load the installation process. Could not the installation process be launched in memory like any normal program? Is it because to launch it you can\u0027t skip the loading of ntldr? Or is it because the second part of the windows installation needs the partition active and unhidden, to be completed?\nWRONG question. ![:poke:](http://reboot.pro/public/style_emoticons/default/poke.gif)  \n\ngrub4dos couldn\u0027t care less about hidden and active partitions, but the Windows setup does.  \n\nYou seem not to appreciate enough that installing XP from USB was IMPOSSIBLE ***by design*** according to the good MS guys.  \n\nFor years this was accepted as an undeniable truth.  \n\nNow, after several months of hard work, the people involved:  \n[http://www.msfn.org/...howtopic\u003d111401](http://www.msfn.org/board/index.php?showtopic\u003d111401 \"External link\")  \nmanaged to find a working solution.  \n\nNot only, they continued bettering it, day after day, and came out with three different ways/methods to do that.  \n\nYou may want to compare the number of people who viewed the referenced thread with the actual thank you\u0027s in it, then check how many people in the Forum:  \n[http://www.msfn.org/...p?showforum\u003d157](http://www.msfn.org/board/index.php?showforum\u003d157 \"External link\")  \nposted to say \"nice, but I need it a different setup....\"  \n\n*Currently* , Install for XP must run from first, Active, Unhidden, Primary partition on the stick.  \n\nThis is **NOT** negotiable.  \n\n\u003e BTW i have not understood why you told me not to use Acronis.. Well, no matter if you don\u0027t want to dwell on long explanations, but could you please indicate me a substitutive tool to resize, move, mark partitions as active, convert them from logical to primary etc.? Partition magic didn\u0027t seem that advanced to me.\nThe whole point with Acronis (as well as Partition Magic, which I personally rate worse than Acronis) is you have NO control over what you do.  \nBut basically they are too \"easy\" people thinks that since the program automagically does it they can move, shift, activate, convert types and filesystems at will.  \nResult is often a partitioning that does not make sense, like your original one, or other \"collateral damages\" you find about only when you need a paritcular setup/OS.  \nIn my personal view partitions should be planned and done once and for all.  \nBesides the (very few) problems the mentioned app actually have, the real problem is that they give \"power\" to the unexperienced user, thus \"unleashing\" his/her lack of planning/thinking ahead, through the (false) omnipotence feeling, like in: HA, no prob, I\u0027ll just fire up \\\u003capp name\\\u003e and will fix it in no time....   \nAnyway, using always some \"manual\" tools to check what has been done by these \"magic\" utilities is advised.  \n\n\u003cbr /\u003e\n\n\u003e There is also one more question.  \n\u003e Let\u0027s say i decide to adopt the last strategy you advised me. What about creating the setups partition files with winsetupfromusb? Will you help me find the way how to make the multi-boot setup process with xp and vista work, given that i\u0027ll have a grub4dos menu modified if compared with the one originally created with the tool? I mean either help with a guide to create the multi-boot partition out of nothing too...\nI have a better question for you ![:poke:](http://reboot.pro/public/style_emoticons/default/poke.gif), why do you think that I made you have the \"setup\" partitition be first, Active, Unhidden, Primary? ![:poke:](http://reboot.pro/public/style_emoticons/default/poke.gif)  \n\n:smile:  \n\njaclaz   \n"
    },
    {
      "id": "60058",
      "timestamp": "2009-02-21T11:21:46+00:00",
      "author": "Luca\u0027s",
      "content": "\u003e I have a better question for you , why do you think that I made you have the \"setup\" partitition be first, Active, Unhidden, Primary?\nActually i suspected it was the same reason for winsetupfromusb required me those conditions ![:poke:](http://reboot.pro/public/style_emoticons/default/poke.gif)   \n\n\u003e You seem not to appreciate enough that installing XP from USB was IMPOSSIBLE by design according to the good MS guys.\n\nOops.. ![:poke:](http://reboot.pro/public/style_emoticons/default/poke.gif)  \n\nSo. I have tested the proposed method and it fully works.  \nThere is a problem though. Before to proceed to the next step, which i suppose to be when you teach me how to password-protect the boot menu and use UUIDs instead of tag files, i have to ask you:  \n**Why the hell using the filter driver everything is okay, while using the default driver it shows as the removable device the setups partition and not the data one??? Data partition is active and unhidden; the setups one is inactive and hidden: well, i can\u0027t understand!**   \nIs it due to the fact i have a u3 device with the cd-rom firmware feature activated (maybe it has some influence on how the driver sees partitions on the stick)? I don\u0027t think so: it rather seems to me that, when i have an unmodified mbr and partitions are without files, the partition shown is not the one gldr is into...  \n\nI don\u0027t post any screenshot how beeblebrox sees the unit when the OS uses the default driver: i\u0027ve checked and (apart from 80s and 17s) numbers have not changed from when i had partitioned.  \nI post the disk management screenshot instead (default driver currently being used).  \n[![Disk_management.jpg](http://reboot.pro/uploads/monthly_02_2009/post-15106-1235215255_thumb.jpg)](http://reboot.pro/uploads/monthly_02_2009/post-15106-1235215255.jpg \"Disk_management.jpg - Size: 83.8KB\"){#ipb-attach-url-7634-0-64219000-1676066544}   \n\n\u003cbr /\u003e\n\n:smile: ![:poke:](http://reboot.pro/public/style_emoticons/default/poke.gif)  \n\n\u003cbr /\u003e\n\n---   \n"
    },
    {
      "id": "60059",
      "timestamp": "2009-02-21T11:59:53+00:00",
      "author": "was_jaclaz",
      "content": "\u003e **Why the hell using the filter driver everything is okay, while using the default driver it shows as the removable device the setups partition and not the data one??? Data partition is active and unhidden; the setups one is inactive and hidden: well, i can\u0027t understand!**\nI guess that it is due to the method not working ![:poke:](http://reboot.pro/public/style_emoticons/default/poke.gif) (yet ![:poke:](http://reboot.pro/public/style_emoticons/default/poke.gif)).  \n\nTry the following:  \n\n* run beeblebrox\n* take a screenshot of it (for reference)\n* copy all values in entry #1 to entry #0 and all values from entry #0 to entry #1\n* disconnect and re-connect USB stick\n\n\u003cbr /\u003e\n\nWhat happens?  \n\njaclaz   \n"
    },
    {
      "id": "60062",
      "timestamp": "2009-02-21T13:03:04+00:00",
      "author": "Luca\u0027s",
      "content": "sorry but...what do you mean by \"all values\"?   \nalso  \nECyl, EHd, ESec, StartSector, NumSectors?   \n"
    },
    {
      "id": "60064",
      "timestamp": "2009-02-21T13:18:58+00:00",
      "author": "was_jaclaz",
      "content": "Yep.  \n\nIs there another meaning for \"all\" (meaning \"most\" or \"some\" or \"a few\")? ![:poke:](http://reboot.pro/public/style_emoticons/default/poke.gif)  \n\nRight now you should have:  \n#0: 17-00-0-1-1-420-254-63-63-6763302  \n#1: 07-80-421-0-1-675-254-63-6763365-4096575  \n#2: 17-00-676-0-1-1023-254-63-10859940-20466810  \n\nTry to change it to:  \n#0: 07-80-421-0-1-675-254-63-6763365-4096575  \n#1: 17-00-0-1-1-420-254-63-63-6763302  \n#2: 17-00-676-0-1-1023-254-63-10859940-20466810  \n\nWhat happens?  \n\njaclaz   \n"
    },
    {
      "id": "60071",
      "timestamp": "2009-02-21T14:07:39+00:00",
      "author": "Luca\u0027s",
      "content": "\u003e Is there another meaning for \"all\" (meaning \"most\" or \"some\" or \"a few\")?\n![:poke:](http://reboot.pro/public/style_emoticons/default/poke.gif) i\u0027m just trustful no more: i didn\u0027t want to destroy anything...  \n\nokay, i do think your suggestion has contributed to give a major pull down to my problem.  \nGuessing the aim of the operation, i have substituted entry 0 with entry 2 (instead of 1).  \nNow the shown partition is data (the correct one) ![:poke:](http://reboot.pro/public/style_emoticons/default/poke.gif)   \n\nProceeding on this line, i have decided to set the setups partition as active by default. Again the OS, be it with the filter driver or not, only shows the data partition (as i wanted).   \n\nIt follows that in Menu.lst i can remove the part where it marks the setups/data partition as active. the script just needs to hide/unhide the setups partition: wonderful.  \n\nanyway i am still interested both in   \n--password-protecting menus and avoiding the presence of any file  \nand in   \n--the second part where i populate the setups partition (even if i could use winsetupfromusb and re-correct the partition table after, couldn\u0027t i?)   \n"
    },
    {
      "id": "60072",
      "timestamp": "2009-02-21T14:25:33+00:00",
      "author": "was_jaclaz",
      "content": "Yep, since you stopped posting the info, I thought that #1 was \"data\".  \n\nIt seems however like we are once again stuck ![:poke:](http://reboot.pro/public/style_emoticons/default/poke.gif), as with the \"data\" partition as first one, most probably the SETUP won\u0027t run.  \n\nWe need to try another thing.  \n\nTry shifting ALL partition entries by one, i.e. write contents of #2 in #3, contents of #1 in #2, contents of #0 in #1 and fill ALL fields in #0 with 0\u0027s.  \n\nWhat happens?  \n\nFORGET (together with Acronis ![:poke:](http://reboot.pro/public/style_emoticons/default/poke.gif)) the UUID and password thingies for the moment, we\u0027ll talk about them once the base thingie works (hopefully ![:poke:](http://reboot.pro/public/style_emoticons/default/poke.gif)).  \n\njaclaz  \n\nP.S.: since I cannot simply resist to the idea of \"confusing\" you with some \"data overload\", can you run Chipgenius:  \n[http://www.boot-land...?showtopic\u003d4661](http://www.boot-land.net/forums/index.php?showtopic\u003d4661 \"External link\")  \nand post VID/PID of your stick, together with it\u0027s make/model and (if given) controller used?   \n"
    },
    {
      "id": "60083",
      "timestamp": "2009-02-21T16:29:29+00:00",
      "author": "Luca\u0027s",
      "content": "I\u0027d like to specify i have shifted the original configuration, the one with:  \n\n-as the first entry, the setups partition (3gb)  \n-as the second entry, the truecrypt one (2gb)  \n-as the third entry, the data one (10gb)  \nOnly change i\u0027ve made is to mark setups (instead of data) as active.  \n\nAnyway, even with data active, shifting does not work: it\u0027s the partition table order that makes the difference in what partition is shown with the default driver...  \n\nTomorrow i\u0027ll make you know about Chipgenius and maybe i\u0027ll post a beeblebrox screen of the current situation.  \nSee you   \n"
    },
    {
      "id": "60084",
      "timestamp": "2009-02-21T16:45:43+00:00",
      "author": "was_jaclaz",
      "content": "I\u0027ll wait for those info. ![:poke:](http://reboot.pro/public/style_emoticons/default/poke.gif)  \n\nIf you are adventurous enough, you could also start testing with:  \nthe PARTNEW ![:poke:](http://reboot.pro/public/style_emoticons/default/poke.gif) command  \n(AFTER having shifted current entries by one, so that entry #0 can be \"cleared\")  \n\n```\ntitle create 1st partition from 2nd\n\npartnew \u0026#40;hd0,0\u0026#41; 0 0 0\n\npartnew \u0026#40;hd0,0\u0026#41; 0x07 \u0026#40;hd0,1\u0026#41;+1\n\n\n\ntitle create 1st partition from 3rd\n\npartnew \u0026#40;hd0,0\u0026#41; 0 0 0\n\npartnew \u0026#40;hd0,0\u0026#41; 0x07 \u0026#40;hd0,2\u0026#41;+1\n\n\n\ntitle create 1st partition from 4th\n\npartnew \u0026#40;hd0,0\u0026#41; 0 0 0\n\npartnew \u0026#40;hd0,0\u0026#41; 0x07 \u0026#40;hd0,3\u0026#41;+1\n```\n\n\u003cbr /\u003e\n\nREAD \"README_GRUB4DOS.txt\".  \n\nWould this work for Primary partitions also?  \n\nOr can we use \"hardcoded values:  \n\n```\ntitle create 1st partition for \u0026#34;setups\u0026#34;\n\npartnew \u0026#40;hd0,0\u0026#41; 0 0 0\n\npartnew \u0026#40;hd0,0\u0026#41; 0x07 63 6763302\n\n\n\ntitle create 1st partition for \u0026#34;data\u0026#34;\n\npartnew \u0026#40;hd0,0\u0026#41; 0 0 0\n\npartnew \u0026#40;hd0,0\u0026#41; 0x07 10859940 20466810\n```\n\n\u003cbr /\u003e\n\nOr should we shift to ALL Logical Volumes inside Extended?  \n\njaclaz   \n"
    },
    {
      "id": "60186",
      "timestamp": "2009-02-22T12:48:20+00:00",
      "author": "was_jaclaz",
      "content": "A couple of reports from **Ponch** ![:poke:](http://reboot.pro/public/style_emoticons/default/poke.gif) , here:  \n[http://www.msfn.org/...opic\u003d129454\\\u0026hl\u003d](http://www.msfn.org/board/index.php?showtopic\u003d129454\u0026hl\u003d \"External link\")  \n[http://www.msfn.org/...opic\u003d130168\\\u0026hl\u003d](http://www.msfn.org/board/index.php?showtopic\u003d130168\u0026hl\u003d \"External link\")  \nconfirm that when the device is seen a \"Removable\" (i.e. the \"Removable bit\" has not been \"flipped\" or no Filter Driver is installed) XP sees only ***First*** partition entry.  \n\njaclaz   \n"
    },
    {
      "id": "60208",
      "timestamp": "2009-02-22T15:45:54+00:00",
      "author": "Luca\u0027s",
      "content": "\u003e when the device is seen a \"Removable\" (i.e. the \"Removable bit\" has not been \"flipped\" or no Filter Driver is installed) XP sees only First partition entry.\nyes i already knew about the removable bit, but my device is firmware controlled and i can\u0027t flip it (have tried yet). ![:poke:](http://reboot.pro/public/style_emoticons/default/poke.gif)  \nI was interested in finding a production tool though. I had searched on a russian site where they list all models by PID \\\u0026 VID: no tool was signalled for my device. Now that you indicated me this chipgenius, it says i can use a toshiba program. But even if i could get the program elsewhere (everything on bbs.mydigit.cn is in chinese and i can\u0027t register!!!), i suspect the cdrom unit wouldn\u0027t be seen at bootup.  \nMine is a 16 Gb SanDisk Cruzer Micro usb stick. Here are chipgenius results:  \n\n```\nSanDisk Cruzer USB DevicePnP Device ID: VID \u003d 0781 PID \u003d 5406Serial Number: 4324301B5880521BRevision: 8.01/8.01Device Type: Standard USB device - USB2.0 High-SpeedChip Vendor: SanDiskChip Part-Number: Product Vendor: SanDiskProduct Model: CruzerTools on Web:  [url\u003d\"http://bbs.mydigit.cn/read.php?tid\u003d25669\"]http://bbs.mydigit.cn/read.php?tid\u003d25669[/url]\n```\n\n\u003cbr /\u003e\n\nanyway, this is the current situation of the unit:  \n[![beeblebrox.jpg](http://reboot.pro/uploads/monthly_02_2009/post-15106-1235317059_thumb.jpg)](http://reboot.pro/uploads/monthly_02_2009/post-15106-1235317059.jpg \"beeblebrox.jpg - Size: 40.95KB\"){#ipb-attach-url-7646-0-64225600-1676066544}   \n\ni have not modified Menu.lst for i don\u0027t understand the commands given:  \nsorry but if use, for example,  \n\n```\ntitle create 1st partition for \"data\"partnew (hd0,0) 0 0 0partnew (hd0,0) 0x07 10859940 20466810\n```\n\nthen there will be 2 entries which are the same (data entry is both at the first position and the third)?  \n\n.   \n"
    },
    {
      "id": "60210",
      "timestamp": "2009-02-22T16:16:22+00:00",
      "author": "was_jaclaz",
      "content": "\u003e then there will be 2 entries which are the same (data entry is both at the first position and the third)?\n\nYes, but since Windows (if device is seen as \"Removable\") should only see one, it should work.  \n\nIf it doesn\u0027t, you will need to use the \"normal\" way and \"clear\" the 2nd or 3rd entry after having generated \"right\" 1st one  \n\nThere are TWO ways to use the **partnew** command:  \n\n* \"standard\" GRUB-like one\n* \"special\" grub4dos one\n\n\u003cbr /\u003e\n\n\"standard\" one works as follow:  \n[http://www.gnu.org/s...de/partnew.html](http://www.gnu.org/software/grub/manual/html_node/partnew.html \"External link\")  \n\n```\npartnew part type from len\n```\n\n\u003cbr /\u003e\n\nWhich in your case becomes either:  \n\n```\npartnew \u0026#40;hd0,0\u0026#41; 0x07 63 6763302\n```\n\nor  \n\n```\npartnew \u0026#40;hd0,0\u0026#41; 0x07 10859940 20466810\n```\n\n\u003cbr /\u003e\n\nThe line:  \n\n```\npartnew \u0026#40;hd0,0\u0026#41; 0 0 0\n```\n\nis not really needed, as it simply blanks first entry.  \n\n\"special\" one adds the ability to add a \"primary\" entry for a Logical Volume inside Extended Partition.  \nI don\u0027t know if it may also work for a Primary partition, as said this use is documented in \"README_GRUB4DOS.txt\".  \n\n**If** it works it is more \"general\" as it copies data from one entry to the other , instead of \"normal\" that needs hardcoded \"from\" and \"len\".  \n\nI\u0027ll check what I can find with that PID/VID.  \n\njaclaz   \n"
    },
    {
      "id": "60212",
      "timestamp": "2009-02-22T16:22:02+00:00",
      "author": "was_jaclaz",
      "content": "\u003e I\u0027ll check what I can find with that PID/VID.\n\nIs your google broken? ![:poke:](http://reboot.pro/public/style_emoticons/default/poke.gif)  \n\nHere:  \n[http://www.toshiba.c.../1_4/1_4-02.htm](http://www.toshiba.co.jp/p-media/english/u3/update/1_4/1_4-02.htm \"External link\")  \n[http://www.toshiba.c...2H_Ver1.055.exe](http://www.toshiba.co.jp/p-media/english/u3/update/1_4/U3updater_toshiba_U2H_Ver1.055.exe \"External link\")  \n[http://www.toshiba.c..._install_f2.gif](http://www.toshiba.co.jp/p-media/english/img/bt_dl_install_f2.gif \"External link\")  \n\nthough I don\u0027t think it will be useful. ![:poke:](http://reboot.pro/public/style_emoticons/default/poke.gif)  \n\njaclaz   \n"
    },
    {
      "id": "60219",
      "timestamp": "2009-02-22T17:29:35+00:00",
      "author": "Luca\u0027s",
      "content": "\u003e Is your google broken? ![:poke:](http://reboot.pro/public/style_emoticons/default/poke.gif)\nwho said i used google? ![:poke:](http://reboot.pro/public/style_emoticons/default/poke.gif)   \nwell, no, just kidding, i was already downloading when i wrote. but the fact still is the tool is of no use, for it doesn\u0027t change the cd-rom unit dimensions.. you have to keep your 6mb drive.  \n\nabout the commands: i suppose they\u0027re just a test, but actually we don\u0027t have just to replace the first entry with the currently needed one: we need to exchange entry 1 with entry 3 and viceversa, or else the trick could work when we use windows with the default driver, but i guess it won\u0027t when we use the filter driver instead (wrong partition table with two entries the same). did i get the point?  \nanyway i\u0027ll give it a try with the default driver and make you know ASAP.   \n"
    },
    {
      "id": "60220",
      "timestamp": "2009-02-22T17:40:01+00:00",
      "author": "was_jaclaz",
      "content": "\u003e we need to exchange entry 1 with entry 3 and viceversa, or else the trick could work when we use windows with the default driver, but i guess it won\u0027t when we use the filter driver (wrong partition table with two entries the same). did i get the point?\n\nYep, but I continue to suggest a step by step approach.  \n\nIf these basic commands work, noone prohibits us to make them more complex later. ![:poke:](http://reboot.pro/public/style_emoticons/default/poke.gif)   \n\nWe could simpy hide the \"duplicate\" with 0x07-\\\u003e0x17. if needed, or find another way, let\u0027s wait until we face the problem, and ***then*** we\u0027ll see how to work around it...![:poke:](http://reboot.pro/public/style_emoticons/default/poke.gif)  \n\nThe only way to know is to do some tests.....  \n\nAbout enlarging the 6 MB partiton, this should be of help ![:poke:](http://reboot.pro/public/style_emoticons/default/poke.gif):  \n[http://www.msfn.org/...howtopic\u003d121502](http://www.msfn.org/board/index.php?showtopic\u003d121502 \"External link\")  \n(site down right now) googlecache:  \n[http://209.85.129.13.....wtopic\u003d121502](http://209.85.129.132/search?q\u003dcache:3xiCL1Um97IJ:www.msfn.org/board/index.php%3Fshowtopic%3D121502 \"External link\")  \n[http://209.85.129.13...hp/t121502.html](http://209.85.129.132/search?q\u003dcache:d498apTRHgEJ:www.msfn.org/board/lofiversion/index.php/t121502.html \"External link\")  \n\njaclaz   \n"
    },
    {
      "id": "60244",
      "timestamp": "2009-02-22T21:13:04+00:00",
      "author": "Luca\u0027s",
      "content": "You\u0027re up to more tricks than Old Nick... ![:poke:](http://reboot.pro/public/style_emoticons/default/poke.gif)   \n\n\u003cbr /\u003e\n\n\u003e About enlarging the 6 MB partiton, this should be of help :  \n\u003e [http://www.msfn.org/...howtopic\u003d121502](http://www.msfn.org/board/index.php?showtopic\u003d121502 \"External link\")\nmmm, last time i used it, it gave me an error (it could not access the device). i will try sooner or later with the toshiba tool instead.  \n\nbut as you teach me, it\u0027s better to focus on one problem at a time.  \nwith the partnew commands no way.  \ni have grub4dos 0.4.3 and it gives me aproximately this error:  \nThis command is inhibited from running in a script  \nError 35: Invalid argument  \n\ndoh!  \nit seems it has too many arguments...  \nHere is the main part of the documentation from README_GRUB4DOS.txt  \n\n```\n***********************************************************************\n\n*******\n\n***\t\t\t\t\t  The PARTNEW Command Syntax\t\t\t\t\t\t***\n\n******************************************************************************\n\n\n\nBesides the mappings in the above section, you may instead choose to create a\n\nnew primary partition with the PARTNEW command. PARTNEW can generate a primary\n\npartition entry \u0026#40;in the partition table\u0026#41; for a logical partition.\n\n\n\nFor example,\n\n\n\n\tpartnew \u0026#40;hd0,3\u0026#41; 0x07 \u0026#40;hd0,4\u0026#41;+1\n\n\n\nwhere the file \u0026#40;hd0,4\u0026#41;+1 stands for the whole partition \u0026#40;hd0,4\u0026#41;. This command\n\nwill create a new primary partition \u0026#40;hd0,3\u0026#41; whose type is 0x07 and whose\n\ncontents/data is the same as that of the logical partition \u0026#40;hd0,4\u0026#41;.\n\n\n\nJust like a whole logical partition, a contiguous partition image file can\n\nalso be used with PARTNEW\u0026#58;\n\n\n\n\tpartnew \u0026#40;hd0,3\u0026#41; 0x00 \u0026#40;hd0,0\u0026#41;/my_partition.img\n\n\n\nThe type 0x00 indicates a type-auto-detection of the image MY_PARTITION.IMG.\n\nThe above command will create a new primary partition \u0026#40;hd0,3\u0026#41; with a proper\n\ntype and with contents/data being exactly that of the contiguous file\n\n\u0026#40;hd0,0\u0026#41;/my_partition.img.\n\n\n\nPARTNEW will automatically correct the \u0026#34;hidden sectors\u0026#34; in the BPB and the\n\nmodification will be permanent. And PARTNEW modifies the partition table\n\npermanently.\n```\n\n\u003cbr /\u003e\n\n"
    },
    {
      "id": "60268",
      "timestamp": "2009-02-23T08:41:25+00:00",
      "author": "was_jaclaz",
      "content": "\u003e i have grub4dos 0.4.3\n\nWHY?  \n\nUse ALWAYS **latest** one:  \n[http://www.boot-land...?...pic\u003d14\\\u0026st\u003d1](http://www.boot-land.net/forums/index.php?showtopic\u003d14\u0026st\u003d1 \"External link\")  \n\n\u003cbr /\u003e\n\nMaybe:  \n\u003e This command is inhibited from running in a script\nmeans that it is inhibited to run from a script. ![:poke:](http://reboot.pro/public/style_emoticons/default/poke.gif)  \n\nTry using command line ![:poke:](http://reboot.pro/public/style_emoticons/default/poke.gif):  \n[http://diddy.boot-la...s/files/cli.htm](http://diddy.boot-land.net/grub4dos/files/cli.htm \"External link\")  \n\njaclaz   \n"
    },
    {
      "id": "60286",
      "timestamp": "2009-02-23T13:39:47+00:00",
      "author": "Luca\u0027s",
      "content": "\u003e WHY?  \n\u003e Use ALWAYS latest one  \n\u003e [http://www.boot-land...?...pic\u003d14\\\u0026st\u003d1](http://www.boot-land.net/forums/index.php?...pic\u003d14\u0026st\u003d1 \"External link\")\nThe link leads you here:  \n\u003e WHERETO  \n\u003e FINAL VERSIONS are here:  \n\u003e [http://sourceforge.n...ojects/grub4dos](http://sourceforge.net/projects/grub4dos \"External link\")\n\nAnd in fact at that sourceforge address version 0.4.3 is shown...  \n\nHowever i\u0027ve tried, the stick situation being the one in the last screenshot, the commandline way. I\u0027ve used one of the hardcoded commands (to make data the first entry):  \n\n```\npartnew \u0026#40;hd0,0\u0026#41; 0x07 10859940 20466810\n```\n\n\u003cbr /\u003e\n\nThis time it was accepted, but when i rebooted windows, connecting the stick resulted in a blue screen. I\u0027ve tried on a clear xp-copy too: but both with and without filter driver, you have a blue screen.  \nUsing **\u0027** partnew (hd0,0) 0x07 63 6763302**\u0027** also had no repair effect.  \nI had to resort to diskpart from the recovery console, to erase all the partitions. It was strange in that it saw on the usb stick disk a 3,2gb ntfs partition (the setups one), and then three odd entries of raw non-partitioned space matching each one the size of the partitions present on disk before (setups, truecrypt, data).  \nSo, back to us.. I have deleted all the partitions, booted windows, zeroed first 100 sectors, created new partitions on the stick.  \nNow order is:  \n1.Setups  \n2.Data  \n3.Truecrypt  \n\nHere is a screenshot of the current situation.  \n[![beeblebrox.jpg](http://reboot.pro/uploads/monthly_02_2009/post-15106-1235396475_thumb.jpg)](http://reboot.pro/uploads/monthly_02_2009/post-15106-1235396475.jpg \"beeblebrox.jpg - Size: 40.62KB\"){#ipb-attach-url-7658-0-64231900-1676066544}   \nI will copy grub4dos on the stick soon.  \n\nAny idea?   \n"
    },
    {
      "id": "59617",
      "timestamp": "2009-02-17T17:21:29+00:00",
      "author": "Luca\u0027s",
      "content": "Hello everybody.  \nI have a quite puzzling problem.  \n\n**I\u0027m under xp, and have a usb stick which i need to be formatted with 3 primary ntfs partitions: one for data, another for data too (but to be used with true-crypt), while the third needed to multi-boot an xp and a vista setup.**   \nTo achieve my goal, i acted like so: using this really remarkable tool (i mean the one reachable **[here](http://www.msfn.org/board/install-USB-WinSetupF-t120444.html \"External link\")** ), i made a multi-boot xp and vista setup out of the removable drive.  \nThen, in order to resize the bootable ntfs partition created by the tool (so to be able to create the other two partitions), i used the hitachi filter driver to make xp see the usb stick as if it were a fixed unit.  \n\n**What\u0027s the problem, hence? Easy to say: the problem is i have the usb stick to be portable.\nI mean: i need the default driver (the microsoft one that sees the usb disk as a removable device) to see as a removable device the data partition, not the bootable nor the true-crypt partitions. It shows the bootable partition instead.**   \n\nThis is due to the fact that, when you turn back to the default driver, the OS sees as a removable device just one partition among the created (no more than one). The point is, at most, which partition is choosen to be shown and why.   \n\nI have noticed that to be shown as a removable device, there\u0027s no need at all it is the partition where xp and vista setup files are: when you have on the stick three primary partitions none of which is bootable, it is the first partition on disk that is seen as a removable unit. In particular, when the partition where xp and vista setup files are (let\u0027s call it \\\u003c\\\u003cD:\\\u003e\\\u003e ) is bootable, the default driver keeps showing D: as the removable device until you convert it to a logical partition (no matter if you have set it as inactive or as hidden when using the filter driver).  \n\nTo be honest, i don\u0027t know if the tool makes the partition bootable in the sense that it writes grub4dos in the MBR of the entire usb stick disk or else in the sense that it writes grub4dos in D: bootsector (i just know it requires the partition to be active for the boot process to work), but in any case what i need is the default driver to show the data partition, not D:.  \n\n**So here comes my question.\nLet\u0027s suppose that having more than one bootable partition on the same device can change the priority with which the default driver chooses among partitions the one to be shown (for example: if i make the data partition a bootable partition, now i have two bootable partitions and the priority criterion becomes to show the partition that comes first on disk). If so, could you please indicate or teach me a way to have multiple bootable partitions on the same device? (i have heard of multiple boot records, am i on the right path or am i just confused?)\nOr at least: could you please show me a guide or teach me how to create a multi-boot usb stick in such a way that the bootable partition actually is the data partition, but having a bootchain in it to launch grub4dos from the other partition?**   \nI hope i have been clear enough.  \n\nThe puzzle is driving me crazy so... any help will be truly appreciated.  \nThanks a lot! ![:poke:](http://reboot.pro/public/style_emoticons/default/poke.gif)   \n"
    },
    {
      "id": "59620",
      "timestamp": "2009-02-17T17:44:29+00:00",
      "author": "was_jaclaz",
      "content": "\u003e I hope i have been clear enough.\nMaybe you also overdid it. ![:poke:](http://reboot.pro/public/style_emoticons/default/poke.gif)  \n\nWhat is the reason for three primaries? ![:poke:](http://reboot.pro/public/style_emoticons/default/poke.gif)  \n\nIf i get it right, in \"normal\" operation you just need to \"see\" one partition out of the three, correct?  \n\nIf yes, you have two choices:  \n\n* keep grub4dos installed on the MBR (+hidden sectors) and add the commands needed to hide/unhide active/inactive the partition each time you boot from the stick.\n* remove grub4dos from the MBR and use instead ~~OS-BS~~ mbldr:\n\n[http://www.boot-land...p?showtopic\u003d334](http://www.boot-land.net/forums/index.php?showtopic\u003d334 \"External link\")  \n(this is advised as it fits ENTIRELY in the MBR thus avoiding possible problems with any software that may use the hidden sectors)  \n\nthen:  \nAdd to EACH partition a set of tools for ALL operating systems running on the PCs you are going to use the stick on capable of setting the Active partition.  \n\nLet\u0027s start to call partitons with their \"names\", a partition is better indicated by it\u0027s position, like in (hd***x*** ,***y*** ) where ***x*** is the drive number, ***0*** if you boot from it, ***n*** if added to an already booted system, ***y*** is the partition number, ***0*** being the first one (in grub4dos notation, ***1*** in common NT based windows notation).  \n\nTo better clear the above, first partition of first disk will be:  \n(hd0,0) in grub4dos or  \nrdisk(0)partition(1) in Windows ARCPATH, shortened to 0,1  \n\nWhen you boot from the stick, the three partitions will be:  \n(hd0,0)  \n(hd0,1)  \n(hd0,2)  \n\nwhen you insert the stick in an already booted system, with already one disk in it, you will get:  \n(hd1,0)  \n(hd1,1)  \n(hd1,2)  \n\nIt would be nice if you could run ddlistw.cmd:  \n[http://www.boot-land...?...c\u003d6492\\\u0026st\u003d7](http://www.boot-land.net/forums/index.php?showtopic\u003d6492\u0026st\u003d7 \"External link\")  \n\nand post it\u0027s output, like in this post:  \n[http://www.boot-land...?...5306\\\u0026st\u003d156](http://www.boot-land.net/forums/index.php?showtopic\u003d5306\u0026st\u003d156 \"External link\")  \n\nAnd a screenshot of the USB thingy as seen by beeblebrox:  \n[http://students.cs.byu.edu/\\~codyb/](http://students.cs.byu.edu/~codyb/ \"External link\")  \nor however the info how it sees the stick.  \n\nThis way I can see how it is formatted and how it is seen by windows (with and without the filter driver). ![:poke:](http://reboot.pro/public/style_emoticons/default/poke.gif)   \n\njaclaz   \n"
    },
    {
      "id": "59666",
      "timestamp": "2009-02-18T00:34:40+00:00",
      "author": "Luca\u0027s",
      "content": "I will begin by posting the infos you asked me. Then i will develop my reasonment.  \n\nThis is how the stick is seen as fixed with the 3 partitions in it:  \n\n```\nDrives by drive letter:c: 0,1 FIX \\Volume{302303c8-08ca-11dd-bfed-806d6172696f} \\HarddiskVolume1d: 0,3 FIX \\Volume{2a969c7a-b7af-11dd-8329-806d6172696f} \\HarddiskVolume3e: 0,2 FIX \\Volume{2a969c7b-b7af-11dd-8329-806d6172696f} \\HarddiskVolume2f: x,x CDR \\Volume{82185941-08cb-11dd-aab9-806d6172696f} \\CdRom0g: x,x CDR \\Volume{8711f062-204b-11dd-aac0-0013ce9184f6} \\CdRom3h: x,x CDR \\Volume{8711f060-204b-11dd-aac0-0013ce9184f6} \\CdRom1i: x,x CDR \\Volume{8711f061-204b-11dd-aac0-0013ce9184f6} \\CdRom2j: x,x CDR \\Volume{c3b0e5db-b319-11dd-ab81-005056c00008} \\CdRom4k: x,x CDR \\Volume{b9e9cdc3-f691-11dd-abce-005056c00008} \\CdRom5l: 1,2 FIX \\Volume{a95f399e-fcd1-11dd-abe7-005056c00008} \\HarddiskVolume5m: 1,3 FIX \\Volume{a95f399c-fcd1-11dd-abe7-005056c00008} \\HarddiskVolume6n: 1,1 FIX \\Volume{a95f399d-fcd1-11dd-abe7-005056c00008} \\HarddiskVolume4Drives by connection:c: 0,1 FIX \\Volume{302303c8-08ca-11dd-bfed-806d6172696f} \\HarddiskVolume1e: 0,2 FIX \\Volume{2a969c7b-b7af-11dd-8329-806d6172696f} \\HarddiskVolume2d: 0,3 FIX \\Volume{2a969c7a-b7af-11dd-8329-806d6172696f} \\HarddiskVolume3n: 1,1 FIX \\Volume{a95f399d-fcd1-11dd-abe7-005056c00008} \\HarddiskVolume4l: 1,2 FIX \\Volume{a95f399e-fcd1-11dd-abe7-005056c00008} \\HarddiskVolume5m: 1,3 FIX \\Volume{a95f399c-fcd1-11dd-abe7-005056c00008} \\HarddiskVolume6f: x,x CDR \\Volume{82185941-08cb-11dd-aab9-806d6172696f} \\CdRom0h: x,x CDR \\Volume{8711f060-204b-11dd-aac0-0013ce9184f6} \\CdRom1i: x,x CDR \\Volume{8711f061-204b-11dd-aac0-0013ce9184f6} \\CdRom2g: x,x CDR \\Volume{8711f062-204b-11dd-aac0-0013ce9184f6} \\CdRom3k: x,x CDR \\Volume{b9e9cdc3-f691-11dd-abce-005056c00008} \\CdRom5j: x,x CDR \\Volume{c3b0e5db-b319-11dd-ab81-005056c00008} \\CdRom4\n```\n\nThis is how the stick is seen as a removable device:\n\n```\nDrives by drive letter:c: 0,1 FIX \\Volume{302303c8-08ca-11dd-bfed-806d6172696f} \\HarddiskVolume1d: 0,3 FIX \\Volume{2a969c7a-b7af-11dd-8329-806d6172696f} \\HarddiskVolume3e: 0,2 FIX \\Volume{2a969c7b-b7af-11dd-8329-806d6172696f} \\HarddiskVolume2f: x,x CDR \\Volume{82185941-08cb-11dd-aab9-806d6172696f} \\CdRom0g: x,x CDR \\Volume{8711f062-204b-11dd-aac0-0013ce9184f6} \\CdRom3h: x,x CDR \\Volume{8711f060-204b-11dd-aac0-0013ce9184f6} \\CdRom1i: x,x CDR \\Volume{8711f061-204b-11dd-aac0-0013ce9184f6} \\CdRom2j: x,x CDR \\Volume{c3b0e5db-b319-11dd-ab81-005056c00008} \\CdRom4k: x,x CDR \\Volume{b9e9cdc3-f691-11dd-abce-005056c00008} \\CdRom6l: 1,1 REM \\Volume{b9e9cdc4-f691-11dd-abce-005056c00008} \\Harddisk1\\DP(1)0-0+dDrives by connection:c: 0,1 FIX \\Volume{302303c8-08ca-11dd-bfed-806d6172696f} \\HarddiskVolume1e: 0,2 FIX \\Volume{2a969c7b-b7af-11dd-8329-806d6172696f} \\HarddiskVolume2d: 0,3 FIX \\Volume{2a969c7a-b7af-11dd-8329-806d6172696f} \\HarddiskVolume3l: 1,1 REM \\Volume{b9e9cdc4-f691-11dd-abce-005056c00008} \\Harddisk1\\DP(1)0-0+df: x,x CDR \\Volume{82185941-08cb-11dd-aab9-806d6172696f} \\CdRom0h: x,x CDR \\Volume{8711f060-204b-11dd-aac0-0013ce9184f6} \\CdRom1i: x,x CDR \\Volume{8711f061-204b-11dd-aac0-0013ce9184f6} \\CdRom2g: x,x CDR \\Volume{8711f062-204b-11dd-aac0-0013ce9184f6} \\CdRom3k: x,x CDR \\Volume{b9e9cdc3-f691-11dd-abce-005056c00008} \\CdRom6j: x,x CDR \\Volume{c3b0e5db-b319-11dd-ab81-005056c00008} \\CdRom4\n```\n\nThis is the beeblebrox screenshot. It is the same both with and without the fixed driver.[![beeblebrox.jpg](http://reboot.pro/uploads/monthly_02_2009/post-15106-1234917443_thumb.jpg)](http://reboot.pro/uploads/monthly_02_2009/post-15106-1234917443.jpg \"beeblebrox.jpg - Size: 41.78KB\"){#ipb-attach-url-7579-0-04253800-1676066545} What is the reason for three primaries?\nWell, to tell the truth, no reason. Only the bootable partition needs to be primary... If i get it right, in \"normal\" operation you just need to \"see\" one partition out of the three, correct?\nIf by \"normal operation\" is meant when i have windows normally running from the notebook hard disk, yes, i need so. To be more precise, i need not just to be shown only one partition, but the data partition and not the others.Let\u0027s suppose i decide to keep grub4dos (because i think it\u0027s too hard-coded in the multi-boot installation process of the partition created by the tool). I can\u0027t understand why you suggest me to Add to EACH partition a set of tools for ALL operating systems running on the PCs you are going to use the stick on capable of setting the Active partition.\nFirst of all: what tools do you refer to?Then, do you think setting as the active partition the data partition L: instead of the bootable partition N: will solve the problem? My question is not pretentious, i just don\u0027t understand if it\u0027s that what you think. Because if you think so, i have to say i\u0027ve already worked on setting (with Acronis disk director) both the other 2 partitions to be the active one, but with just the result that the usb stick gives an error when i try to boot from it, while it still sees N: as the removable device when i am within windows.In any case, what\u0027s strange to me as an ignorant is that N: partition is seen as Volume4 even if i have moved it to be, in order, the third partition on disk.  \n\nBTW, thank you very much for your kindness.  \n\n#### Attached Thumbnails {#attach_wrap}\n\n* [![beeblebrox.jpg](http://reboot.pro/uploads/monthly_02_2009/post-15106-1234917626_thumb.jpg)](http://reboot.pro/uploads/monthly_02_2009/post-15106-1234917626.jpg \"beeblebrox.jpg - Size: 41.78KB\"){#ipb-attach-url-7580-0-04266600-1676066545}\n\n"
    },
    {
      "id": "59747",
      "timestamp": "2009-02-18T19:45:31+00:00",
      "author": "was_jaclaz",
      "content": "OK. ![:poke:](http://reboot.pro/public/style_emoticons/default/poke.gif)  \n\nLet\u0027s start with some order.  \n\nThis:  \n\u003e l: 1,2 FIX \\\\Volume{a95f399e-fcd1-11dd-abe7-005056c00008} \\\\HarddiskVolume5  \n\u003e m: 1,3 FIX \\\\Volume{a95f399c-fcd1-11dd-abe7-005056c00008} \\\\HarddiskVolume6  \n\u003e n: 1,1 FIX \\\\Volume{a95f399d-fcd1-11dd-abe7-005056c00008} \\\\HarddiskVolume4\n(stick seen as fixed)  \nprobably means that you already connected this particular stick to the particular PC you are using and during any of the tests the first partition (1,1) got assigned letter \"n\".  \nThis kind of assignment is generally \"sticky\", until you do not re-assign the letter through mountvol or Disk Management.  \n\nThe beeblebrox screenshot shows how your partitioning... well... ...is a mess. ![:poke:](http://reboot.pro/public/style_emoticons/default/poke.gif)  \n\nbeeblebrox (through the filter driver you are using) sees the stick as having a geometry of 61,209x16x32, and more generally a geometry of ***n*** x16x32, which is not \"standard\".  \n\nThe stick appears to have been partitioned (or re-partitioned) in a \"queer\" way.  \nFirst Entry (entry 0) is starting past cylinder 1023, and has fractional heads/sectors. It should really be entry 2, size is 3.444.439.040 bytes  \nThough this may not be a problem since the partition is NTFS and thus accessed through LBA addressing, it might not be \"compatible\" with some BIOSes.  \nSecond Entry (entry 1) should actually be entry 0 (as it starts - correctly - at CHS 0/1/1 or LBA 63) size is 10.561.227.264 bytes  \nThird Entry (entry 2) should actually be entry 1, size is 2.039.869.440  \n\n\u003cbr /\u003e\n\n\u003cbr /\u003e\n\n\u003cbr /\u003e\n\nI would suggest you to re-start from scratch, thus you will lose any data you have currently on the stick, please backup any data you care about.  \n\nPlease ***FORGET*** Acronis, I may well be wrong, but I suspect that it is part of the problem ![:poke:](http://reboot.pro/public/style_emoticons/default/poke.gif).  \n\nWhat you have currently is roughly:  \n\n* a 10 Gb partition\n* a 2 Gb partition\n* a 3 Gb partition\n\n\u003cbr /\u003e\n\nWhich one is \"data\", which one is \"truecrypt\" and which one is \"setups\"?  \n\nWhat you should do now is clear the first, say, 100 sectors of the stick.  \n\nYou can use a hex/disk editor, if you are familiar with it, or the method using fsz/dsfo here:  \n[http://www.boot-land...topic\u003d3453\\\u0026st\u003d8](http://www.boot-land.net/forums/?showtopic\u003d3453\u0026st\u003d8 \"External link\")  \n\nBe VERY careful in using the right Physicaldrive number!  \n\nDisconnect the stick and reconnect it.  \n\nAccess it through Disk Management (I am assuming you are having the Filter Driver installed) and partition the disk, creating first thing the \"setups\" partition, then the \"truecrypt\" one, then the data one.  \nMake three primary ones.  \nFormat each of them as NTFS.  \n\nDisconnect the stick and reconnect it.  \n\nRun again beeblebrox and post screenshot.  \n\nAbout your question, when there is NO filter driver in the NT based OS, only one partition is accessible, the Active one.   \nHidden partitions are NOT assigned drive letters anyway.  \n\nThe idea should be that when you boot from the stick, you have:  \n\n* \"setups\" Active and unhidden\n* \"data\" hidden\n* \"truecrypt\" hidden\n\n\u003cbr /\u003e\n\nAnd you are able from the boot menu to change the Active and hidden status of each partition for present and NEXT boot/connection. (through grub4dos or other \"special\" MBR)  \n\nWhen you access the stick by connecting it to a live system, you must have (on ALL partitions in the stick, so that whatever is the unhidden active one you can access it) a tool to be able to switch the status of the partitions, so that you can change it to the one you like to access and by disconnecting and reconnecting the stick access the one you are interested in.  \n\nIn other words the stick can be in either of THREE states, depending on how you left it last time you used/accessed it:  \n\n* **\"setups\" Active and unhidden**/\"data\" hidden/\"truecrypt\" hidden\n* \"setups\" hidden/**\"data\" Active and unhidden**/\"truecrypt\" hidden\n* \"setups\" hidden/\"data\" hidden/**\"truecrypt\" Active and unhidden**\n\n\u003cbr /\u003e\n\nAnd you need a way to \"switch\" among the above both when you are booting from the stick (through grub4dos or \"special\" MBR) and when you simply connect it to a working system (the \"other tool\", which can be the same beeblebrox, a diskpart script, MBRFIX, MBRWIZ, and a number of other programs).  \n\nI hope that the above is clear enough to show what the \"plan\" is. :smile:  \n\njaclaz   \n"
    },
    {
      "id": "59906",
      "timestamp": "2009-02-19T23:51:12+00:00",
      "author": "Luca\u0027s",
      "content": "Sorry for being late but i have some problems to stay connected.  \nAs usual, i begin with providing you the infos you asked me, then reply.  \n\n\u003e What you have currently is roughly:  \n\u003e 1. a 10 Gb partition   \n\u003e 2. a 2 Gb partition   \n\u003e 3. a 3 Gb partition  \n\u003e Which one is \"data\", which one is \"truecrypt\" and which one is \"setups\"?\n\nThe 10 gb partition should be data  \nThe 2 gb should be truecrypt  \nThe 3 gb partition should be setups  \n\nBut you told me to create  \n\n\u003e first thing the \"setups\" partition, then the \"truecrypt\" one, then the data one\n\nso i have partitioned in the order you said.  \nHere\u0027s the beeblebrox screenshot (after having zeroed the first 100 sectors and having partitioned):  \n[![beeblebrox.jpg](http://reboot.pro/uploads/monthly_02_2009/post-15106-1235087226_thumb.jpg)](http://reboot.pro/uploads/monthly_02_2009/post-15106-1235087226.jpg \"beeblebrox.jpg - Size: 41.2KB\"){#ipb-attach-url-7609-0-04274000-1676066545}   \n\nWith disk management, setups is L:, truecrypt is M:, data is N:. I have to specify there is no active partition at the moment.  \n\nIn addition, let me say i now better understand your plan: but before to reply, i have to clarify a little more what my needs are.  \nFirst of all, when within Windows, i\u0027d like the setups partition to be ALWAYS hidden, both when the OS uses the filter driver and when it does not (which is to prevent the user from accidentally deleting setups files). The same holds true for the truecrypt partition. In other words: within Windows, i need ONLY the data partition to be shown, be it with the filter driver or not. On the other side, i still need to boot in some way from the setups partition. These are the pre-requisites: i have to meet them all, and simultaneously.  \n\nSo, back to your solution. Given the pre-requisites, it follows i only want the state 2 to be true. this one--\\\u003e (\"setups\" hidden/**\"data\" Active and unhidden** /\"truecrypt\" hidden). I want to explicitly exclude state 1 and 3.  \n\nAbout the filter driver, in order to see the data partition only, it is sufficient to mark the setups and truecrypt partitions as hidden. Here, setting the data partition as active is uninfluential. (We have now setups and truecrypt hidden)  \n\nAbout the default driver, in order to see the data partition only, you told me i need to set it active. (We have now setups and truecrypt hidden, while data active)  \n\nSo, being the data partition the active one, it follows i can only create a bootchain from the data partition, to be also able to boot from the setups partition. I see no other solution (even if i hope there could be one). If i mark the setups partition as active, then the default driver within windows shows setups instead of data.  \n\nI don\u0027t intend to despise your useful proposal, but it\u0027s still that:  \n1 i prefer to avoid setting each time the active and hidden partitions manually  \n2 above all, i don\u0027t want to have any tool on any partition to allow those partitions i don\u0027t want to be shown to be shown. It has to be a pre-arranged configuration that only expert hands should deal with.  \n\nWell, the first to like it easier would be me, please trust me when i say.  \nI\u0027m sorry, but that\u0027s what i want to do: just hope if i solve my problem, it could help other people too. ![:poke:](http://reboot.pro/public/style_emoticons/default/poke.gif)   \n"
    },
    {
      "id": "59925",
      "timestamp": "2009-02-20T09:38:06+00:00",
      "author": "was_jaclaz",
      "content": "You\u0027ll have to agree that the newly partitioned stick looks a lot more \"tidy\" ![:poke:](http://reboot.pro/public/style_emoticons/default/poke.gif).  \n\nWell,  \nyou cannot have BOTH   \n\\[italian\\]  \nbotte piena e moglie ubriaca  \n\\[/italian\\]  \n(the above is an italian proverb, you cannot have at the same time wife drunk and cask of wine full)  \n\nSome compromises are needed.  \n\nLet\u0027s see which are the most simple ones.  \n\nI take for granted that you want the \"truecrypt\" always hidden and you have some misterious ![:poke:](http://reboot.pro/public/style_emoticons/default/poke.gif) way to deal with it.  \n\nIn beeblebrox, change the type 07 in entry #2 to 17 and let\u0027s forget about it.  \n\nSo we have just two partitions left.  \n\nInstall grub4dos to MBR +hidden sectors method #8:  \n[http://diddy.boot-la...ll.htm#method08](http://diddy.boot-land.net/grub4dos/files/install.htm#method08 \"External link\")  \n\nCopy grldr to \"setup\" partition, copy to it also NTLDR, NTDETECT.COM and a BOOT.INI with at least two entries, the one here will be OK for this test:  \n[http://diddy.boot-la...ll.htm#method05](http://diddy.boot-land.net/grub4dos/files/install.htm#method05 \"External link\")  \n\ncopy to it also a tag file, create a new empty .txt file and rename it my_grldr.tag  \ncopy to it also a menu.lst as follows:  \n\n```\ncolor black/cyan yellow/cyan\n\ntimeout 30\n\ndefault /default\n\n\n\ntitle find and load NTLDR of Windows NT/2K/XP\n\nfind --set-root /my_grldr.tag\n\nmakeactive\n\nunhide\n\nchainloader /ntldr\n\n\n\ntitle rehide setup partition\n\nfind --set-root /my_grldr.tag\n\nhide\n\nfind --set-root /my_data.tag\n\nmakeactive\n\nunhide\n```\n\n\u003cbr /\u003e\n\ncopy to the \"data\" partition a tag file , create a new empty .txt file and rename it my_data.tag  \n\nIn beeblebrox, hide the \"setup\" partition by changing the type 07 in entry #0 to 17 .  \nSet the \"data\" partition active by writing 80 in \"boot\" field.  \n\nTry booting from the stick.  \n\nChoose the \"find and load NTLDR of Windows NT/2K/XP\".  \n\nYou should be able to get to the choices in boot.ini, of which the \"windows\" entry won\u0027t work, and the grldr one should bring you back to menu.lst choices.  \n\nRestart the PC and check the stick with beeblebrox, once after having chosen \"find and load NTLDR of Windows NT/2K/XP\" last and once after having chosen \"rehide setup partition\".  \n\nProposed method:  \n\n* normal status of the stick is 2. \"setups\" hidden/**\"data\" Active and unhidden**/\"truecrypt\" hidden\n* when you boot from the stick you can choose to make the setup partition active/unhidden (and thus use it to install)\n* once the setup has finished you need to reboot from the stick once again and choose the \"rehide setup partition\" entry\n* stick is back to \"normal\" status\n\n\u003cbr /\u003e\n\nIf this is acceptable, try it, report, and we\u0027ll see some \"enhancements\", like password protecting etries in menu.list, using UUID instead of \"tag\" files, etc.  \n\njaclaz   \n"
    },
    {
      "id": "59987",
      "timestamp": "2009-02-20T17:47:38+00:00",
      "author": "Luca\u0027s",
      "content": "\u003e You\u0027ll have to agree that the newly partitioned stick looks a lot more \"tidy\"\nYep i think so. I take your word for it. ![:poke:](http://reboot.pro/public/style_emoticons/default/poke.gif)  \nBTW i have not understood why you told me not to use Acronis.. Well, no matter if you don\u0027t want to dwell on long explanations, but could you please indicate me a substitutive tool to resize, move, mark partitions as active, convert them from logical to primary etc.? Partition magic didn\u0027t seem that advanced to me.  \n\nAnyway yes, to momentarily forget the truecrypt partition was my intention too.  \nSo, let\u0027s come to the point.  \nI think it\u0027s not really that the proposed method is not acceptable: it\u0027s rather that i still don\u0027t get why grub4dos needs the setups partition to be active and unhidden to load the installation process. Could not the installation process be launched in memory like any normal program? Is it because to launch it you can\u0027t skip the loading of ntldr? Or is it because the second part of the windows installation needs the partition active and unhidden, to be completed? As far as i\u0027ve seen, when i had hidden the setups partition with Acronis, the first part of the xp setup launched correctly even when the partition was the last one on disk (but well, yes, there still was the partition mess).  \n\nYou know i just don\u0027t want to have critical files on the data partition. They could be deleted.  \nSo, if \\\u003c\\\u003cusing UUID instead of \"tag\" files\\\u003e\\\u003e is a method to avoid files on the data partition, it is welcome. Even better with passwords in the boot menu. This way, having to set the active partition each time i complete a setup, is a compromise i can stand. But first tell me it is impossible to reach my goal otherwise (i mean tell me it is not possible to leave the data partition always active). Because if you know other methods, i don\u0027t mind if they take time or they\u0027re difficult. I just do prefer to avoid stepping in with setting what partitions are active and what are not.  \n\nThere is also one more question.  \nLet\u0027s say i decide to adopt the last strategy you advised me. What about creating the setups partition files with winsetupfromusb? Will you help me find the way how to make the multi-boot setup process with xp and vista work, given that i\u0027ll have a grub4dos menu modified if compared with the one originally created with the tool? I mean either help with a guide to create the multi-boot partition out of nothing too...  \n\n\u003cbr /\u003e\n\nThanks a lot for all of your precious suggestions.   \n"
    },
    {
      "id": "59995",
      "timestamp": "2009-02-20T18:28:20+00:00",
      "author": "was_jaclaz",
      "content": "\u003e I think it\u0027s not really that the proposed method is not acceptable: it\u0027s rather that i still don\u0027t get why grub4dos needs the setups partition to be active and unhidden to load the installation process. Could not the installation process be launched in memory like any normal program? Is it because to launch it you can\u0027t skip the loading of ntldr? Or is it because the second part of the windows installation needs the partition active and unhidden, to be completed?\nWRONG question. ![:poke:](http://reboot.pro/public/style_emoticons/default/poke.gif)  \n\ngrub4dos couldn\u0027t care less about hidden and active partitions, but the Windows setup does.  \n\nYou seem not to appreciate enough that installing XP from USB was IMPOSSIBLE ***by design*** according to the good MS guys.  \n\nFor years this was accepted as an undeniable truth.  \n\nNow, after several months of hard work, the people involved:  \n[http://www.msfn.org/...howtopic\u003d111401](http://www.msfn.org/board/index.php?showtopic\u003d111401 \"External link\")  \nmanaged to find a working solution.  \n\nNot only, they continued bettering it, day after day, and came out with three different ways/methods to do that.  \n\nYou may want to compare the number of people who viewed the referenced thread with the actual thank you\u0027s in it, then check how many people in the Forum:  \n[http://www.msfn.org/...p?showforum\u003d157](http://www.msfn.org/board/index.php?showforum\u003d157 \"External link\")  \nposted to say \"nice, but I need it a different setup....\"  \n\n*Currently* , Install for XP must run from first, Active, Unhidden, Primary partition on the stick.  \n\nThis is **NOT** negotiable.  \n\n\u003e BTW i have not understood why you told me not to use Acronis.. Well, no matter if you don\u0027t want to dwell on long explanations, but could you please indicate me a substitutive tool to resize, move, mark partitions as active, convert them from logical to primary etc.? Partition magic didn\u0027t seem that advanced to me.\nThe whole point with Acronis (as well as Partition Magic, which I personally rate worse than Acronis) is you have NO control over what you do.  \nBut basically they are too \"easy\" people thinks that since the program automagically does it they can move, shift, activate, convert types and filesystems at will.  \nResult is often a partitioning that does not make sense, like your original one, or other \"collateral damages\" you find about only when you need a paritcular setup/OS.  \nIn my personal view partitions should be planned and done once and for all.  \nBesides the (very few) problems the mentioned app actually have, the real problem is that they give \"power\" to the unexperienced user, thus \"unleashing\" his/her lack of planning/thinking ahead, through the (false) omnipotence feeling, like in: HA, no prob, I\u0027ll just fire up \\\u003capp name\\\u003e and will fix it in no time....   \nAnyway, using always some \"manual\" tools to check what has been done by these \"magic\" utilities is advised.  \n\n\u003cbr /\u003e\n\n\u003e There is also one more question.  \n\u003e Let\u0027s say i decide to adopt the last strategy you advised me. What about creating the setups partition files with winsetupfromusb? Will you help me find the way how to make the multi-boot setup process with xp and vista work, given that i\u0027ll have a grub4dos menu modified if compared with the one originally created with the tool? I mean either help with a guide to create the multi-boot partition out of nothing too...\nI have a better question for you ![:poke:](http://reboot.pro/public/style_emoticons/default/poke.gif), why do you think that I made you have the \"setup\" partitition be first, Active, Unhidden, Primary? ![:poke:](http://reboot.pro/public/style_emoticons/default/poke.gif)  \n\n:smile:  \n\njaclaz   \n"
    },
    {
      "id": "60058",
      "timestamp": "2009-02-21T11:21:46+00:00",
      "author": "Luca\u0027s",
      "content": "\u003e I have a better question for you , why do you think that I made you have the \"setup\" partitition be first, Active, Unhidden, Primary?\nActually i suspected it was the same reason for winsetupfromusb required me those conditions ![:poke:](http://reboot.pro/public/style_emoticons/default/poke.gif)   \n\n\u003e You seem not to appreciate enough that installing XP from USB was IMPOSSIBLE by design according to the good MS guys.\n\nOops.. ![:poke:](http://reboot.pro/public/style_emoticons/default/poke.gif)  \n\nSo. I have tested the proposed method and it fully works.  \nThere is a problem though. Before to proceed to the next step, which i suppose to be when you teach me how to password-protect the boot menu and use UUIDs instead of tag files, i have to ask you:  \n**Why the hell using the filter driver everything is okay, while using the default driver it shows as the removable device the setups partition and not the data one??? Data partition is active and unhidden; the setups one is inactive and hidden: well, i can\u0027t understand!**   \nIs it due to the fact i have a u3 device with the cd-rom firmware feature activated (maybe it has some influence on how the driver sees partitions on the stick)? I don\u0027t think so: it rather seems to me that, when i have an unmodified mbr and partitions are without files, the partition shown is not the one gldr is into...  \n\nI don\u0027t post any screenshot how beeblebrox sees the unit when the OS uses the default driver: i\u0027ve checked and (apart from 80s and 17s) numbers have not changed from when i had partitioned.  \nI post the disk management screenshot instead (default driver currently being used).  \n[![Disk_management.jpg](http://reboot.pro/uploads/monthly_02_2009/post-15106-1235215255_thumb.jpg)](http://reboot.pro/uploads/monthly_02_2009/post-15106-1235215255.jpg \"Disk_management.jpg - Size: 83.8KB\"){#ipb-attach-url-7634-0-04285500-1676066545}   \n\n\u003cbr /\u003e\n\n:smile: ![:poke:](http://reboot.pro/public/style_emoticons/default/poke.gif)  \n\n\u003cbr /\u003e\n\n---   \n"
    },
    {
      "id": "60059",
      "timestamp": "2009-02-21T11:59:53+00:00",
      "author": "was_jaclaz",
      "content": "\u003e **Why the hell using the filter driver everything is okay, while using the default driver it shows as the removable device the setups partition and not the data one??? Data partition is active and unhidden; the setups one is inactive and hidden: well, i can\u0027t understand!**\nI guess that it is due to the method not working ![:poke:](http://reboot.pro/public/style_emoticons/default/poke.gif) (yet ![:poke:](http://reboot.pro/public/style_emoticons/default/poke.gif)).  \n\nTry the following:  \n\n* run beeblebrox\n* take a screenshot of it (for reference)\n* copy all values in entry #1 to entry #0 and all values from entry #0 to entry #1\n* disconnect and re-connect USB stick\n\n\u003cbr /\u003e\n\nWhat happens?  \n\njaclaz   \n"
    },
    {
      "id": "60062",
      "timestamp": "2009-02-21T13:03:04+00:00",
      "author": "Luca\u0027s",
      "content": "sorry but...what do you mean by \"all values\"?   \nalso  \nECyl, EHd, ESec, StartSector, NumSectors?   \n"
    },
    {
      "id": "60064",
      "timestamp": "2009-02-21T13:18:58+00:00",
      "author": "was_jaclaz",
      "content": "Yep.  \n\nIs there another meaning for \"all\" (meaning \"most\" or \"some\" or \"a few\")? ![:poke:](http://reboot.pro/public/style_emoticons/default/poke.gif)  \n\nRight now you should have:  \n#0: 17-00-0-1-1-420-254-63-63-6763302  \n#1: 07-80-421-0-1-675-254-63-6763365-4096575  \n#2: 17-00-676-0-1-1023-254-63-10859940-20466810  \n\nTry to change it to:  \n#0: 07-80-421-0-1-675-254-63-6763365-4096575  \n#1: 17-00-0-1-1-420-254-63-63-6763302  \n#2: 17-00-676-0-1-1023-254-63-10859940-20466810  \n\nWhat happens?  \n\njaclaz   \n"
    },
    {
      "id": "60071",
      "timestamp": "2009-02-21T14:07:39+00:00",
      "author": "Luca\u0027s",
      "content": "\u003e Is there another meaning for \"all\" (meaning \"most\" or \"some\" or \"a few\")?\n![:poke:](http://reboot.pro/public/style_emoticons/default/poke.gif) i\u0027m just trustful no more: i didn\u0027t want to destroy anything...  \n\nokay, i do think your suggestion has contributed to give a major pull down to my problem.  \nGuessing the aim of the operation, i have substituted entry 0 with entry 2 (instead of 1).  \nNow the shown partition is data (the correct one) ![:poke:](http://reboot.pro/public/style_emoticons/default/poke.gif)   \n\nProceeding on this line, i have decided to set the setups partition as active by default. Again the OS, be it with the filter driver or not, only shows the data partition (as i wanted).   \n\nIt follows that in Menu.lst i can remove the part where it marks the setups/data partition as active. the script just needs to hide/unhide the setups partition: wonderful.  \n\nanyway i am still interested both in   \n--password-protecting menus and avoiding the presence of any file  \nand in   \n--the second part where i populate the setups partition (even if i could use winsetupfromusb and re-correct the partition table after, couldn\u0027t i?)   \n"
    },
    {
      "id": "60072",
      "timestamp": "2009-02-21T14:25:33+00:00",
      "author": "was_jaclaz",
      "content": "Yep, since you stopped posting the info, I thought that #1 was \"data\".  \n\nIt seems however like we are once again stuck ![:poke:](http://reboot.pro/public/style_emoticons/default/poke.gif), as with the \"data\" partition as first one, most probably the SETUP won\u0027t run.  \n\nWe need to try another thing.  \n\nTry shifting ALL partition entries by one, i.e. write contents of #2 in #3, contents of #1 in #2, contents of #0 in #1 and fill ALL fields in #0 with 0\u0027s.  \n\nWhat happens?  \n\nFORGET (together with Acronis ![:poke:](http://reboot.pro/public/style_emoticons/default/poke.gif)) the UUID and password thingies for the moment, we\u0027ll talk about them once the base thingie works (hopefully ![:poke:](http://reboot.pro/public/style_emoticons/default/poke.gif)).  \n\njaclaz  \n\nP.S.: since I cannot simply resist to the idea of \"confusing\" you with some \"data overload\", can you run Chipgenius:  \n[http://www.boot-land...?showtopic\u003d4661](http://www.boot-land.net/forums/index.php?showtopic\u003d4661 \"External link\")  \nand post VID/PID of your stick, together with it\u0027s make/model and (if given) controller used?   \n"
    },
    {
      "id": "60083",
      "timestamp": "2009-02-21T16:29:29+00:00",
      "author": "Luca\u0027s",
      "content": "I\u0027d like to specify i have shifted the original configuration, the one with:  \n\n-as the first entry, the setups partition (3gb)  \n-as the second entry, the truecrypt one (2gb)  \n-as the third entry, the data one (10gb)  \nOnly change i\u0027ve made is to mark setups (instead of data) as active.  \n\nAnyway, even with data active, shifting does not work: it\u0027s the partition table order that makes the difference in what partition is shown with the default driver...  \n\nTomorrow i\u0027ll make you know about Chipgenius and maybe i\u0027ll post a beeblebrox screen of the current situation.  \nSee you   \n"
    },
    {
      "id": "60084",
      "timestamp": "2009-02-21T16:45:43+00:00",
      "author": "was_jaclaz",
      "content": "I\u0027ll wait for those info. ![:poke:](http://reboot.pro/public/style_emoticons/default/poke.gif)  \n\nIf you are adventurous enough, you could also start testing with:  \nthe PARTNEW ![:poke:](http://reboot.pro/public/style_emoticons/default/poke.gif) command  \n(AFTER having shifted current entries by one, so that entry #0 can be \"cleared\")  \n\n```\ntitle create 1st partition from 2nd\n\npartnew \u0026#40;hd0,0\u0026#41; 0 0 0\n\npartnew \u0026#40;hd0,0\u0026#41; 0x07 \u0026#40;hd0,1\u0026#41;+1\n\n\n\ntitle create 1st partition from 3rd\n\npartnew \u0026#40;hd0,0\u0026#41; 0 0 0\n\npartnew \u0026#40;hd0,0\u0026#41; 0x07 \u0026#40;hd0,2\u0026#41;+1\n\n\n\ntitle create 1st partition from 4th\n\npartnew \u0026#40;hd0,0\u0026#41; 0 0 0\n\npartnew \u0026#40;hd0,0\u0026#41; 0x07 \u0026#40;hd0,3\u0026#41;+1\n```\n\n\u003cbr /\u003e\n\nREAD \"README_GRUB4DOS.txt\".  \n\nWould this work for Primary partitions also?  \n\nOr can we use \"hardcoded values:  \n\n```\ntitle create 1st partition for \u0026#34;setups\u0026#34;\n\npartnew \u0026#40;hd0,0\u0026#41; 0 0 0\n\npartnew \u0026#40;hd0,0\u0026#41; 0x07 63 6763302\n\n\n\ntitle create 1st partition for \u0026#34;data\u0026#34;\n\npartnew \u0026#40;hd0,0\u0026#41; 0 0 0\n\npartnew \u0026#40;hd0,0\u0026#41; 0x07 10859940 20466810\n```\n\n\u003cbr /\u003e\n\nOr should we shift to ALL Logical Volumes inside Extended?  \n\njaclaz   \n"
    },
    {
      "id": "60186",
      "timestamp": "2009-02-22T12:48:20+00:00",
      "author": "was_jaclaz",
      "content": "A couple of reports from **Ponch** ![:poke:](http://reboot.pro/public/style_emoticons/default/poke.gif) , here:  \n[http://www.msfn.org/...opic\u003d129454\\\u0026hl\u003d](http://www.msfn.org/board/index.php?showtopic\u003d129454\u0026hl\u003d \"External link\")  \n[http://www.msfn.org/...opic\u003d130168\\\u0026hl\u003d](http://www.msfn.org/board/index.php?showtopic\u003d130168\u0026hl\u003d \"External link\")  \nconfirm that when the device is seen a \"Removable\" (i.e. the \"Removable bit\" has not been \"flipped\" or no Filter Driver is installed) XP sees only ***First*** partition entry.  \n\njaclaz   \n"
    },
    {
      "id": "60208",
      "timestamp": "2009-02-22T15:45:54+00:00",
      "author": "Luca\u0027s",
      "content": "\u003e when the device is seen a \"Removable\" (i.e. the \"Removable bit\" has not been \"flipped\" or no Filter Driver is installed) XP sees only First partition entry.\nyes i already knew about the removable bit, but my device is firmware controlled and i can\u0027t flip it (have tried yet). ![:poke:](http://reboot.pro/public/style_emoticons/default/poke.gif)  \nI was interested in finding a production tool though. I had searched on a russian site where they list all models by PID \\\u0026 VID: no tool was signalled for my device. Now that you indicated me this chipgenius, it says i can use a toshiba program. But even if i could get the program elsewhere (everything on bbs.mydigit.cn is in chinese and i can\u0027t register!!!), i suspect the cdrom unit wouldn\u0027t be seen at bootup.  \nMine is a 16 Gb SanDisk Cruzer Micro usb stick. Here are chipgenius results:  \n\n```\nSanDisk Cruzer USB DevicePnP Device ID: VID \u003d 0781 PID \u003d 5406Serial Number: 4324301B5880521BRevision: 8.01/8.01Device Type: Standard USB device - USB2.0 High-SpeedChip Vendor: SanDiskChip Part-Number: Product Vendor: SanDiskProduct Model: CruzerTools on Web:  [url\u003d\"http://bbs.mydigit.cn/read.php?tid\u003d25669\"]http://bbs.mydigit.cn/read.php?tid\u003d25669[/url]\n```\n\n\u003cbr /\u003e\n\nanyway, this is the current situation of the unit:  \n[![beeblebrox.jpg](http://reboot.pro/uploads/monthly_02_2009/post-15106-1235317059_thumb.jpg)](http://reboot.pro/uploads/monthly_02_2009/post-15106-1235317059.jpg \"beeblebrox.jpg - Size: 40.95KB\"){#ipb-attach-url-7646-0-04292900-1676066545}   \n\ni have not modified Menu.lst for i don\u0027t understand the commands given:  \nsorry but if use, for example,  \n\n```\ntitle create 1st partition for \"data\"partnew (hd0,0) 0 0 0partnew (hd0,0) 0x07 10859940 20466810\n```\n\nthen there will be 2 entries which are the same (data entry is both at the first position and the third)?  \n\n.   \n"
    },
    {
      "id": "60210",
      "timestamp": "2009-02-22T16:16:22+00:00",
      "author": "was_jaclaz",
      "content": "\u003e then there will be 2 entries which are the same (data entry is both at the first position and the third)?\n\nYes, but since Windows (if device is seen as \"Removable\") should only see one, it should work.  \n\nIf it doesn\u0027t, you will need to use the \"normal\" way and \"clear\" the 2nd or 3rd entry after having generated \"right\" 1st one  \n\nThere are TWO ways to use the **partnew** command:  \n\n* \"standard\" GRUB-like one\n* \"special\" grub4dos one\n\n\u003cbr /\u003e\n\n\"standard\" one works as follow:  \n[http://www.gnu.org/s...de/partnew.html](http://www.gnu.org/software/grub/manual/html_node/partnew.html \"External link\")  \n\n```\npartnew part type from len\n```\n\n\u003cbr /\u003e\n\nWhich in your case becomes either:  \n\n```\npartnew \u0026#40;hd0,0\u0026#41; 0x07 63 6763302\n```\n\nor  \n\n```\npartnew \u0026#40;hd0,0\u0026#41; 0x07 10859940 20466810\n```\n\n\u003cbr /\u003e\n\nThe line:  \n\n```\npartnew \u0026#40;hd0,0\u0026#41; 0 0 0\n```\n\nis not really needed, as it simply blanks first entry.  \n\n\"special\" one adds the ability to add a \"primary\" entry for a Logical Volume inside Extended Partition.  \nI don\u0027t know if it may also work for a Primary partition, as said this use is documented in \"README_GRUB4DOS.txt\".  \n\n**If** it works it is more \"general\" as it copies data from one entry to the other , instead of \"normal\" that needs hardcoded \"from\" and \"len\".  \n\nI\u0027ll check what I can find with that PID/VID.  \n\njaclaz   \n"
    },
    {
      "id": "60212",
      "timestamp": "2009-02-22T16:22:02+00:00",
      "author": "was_jaclaz",
      "content": "\u003e I\u0027ll check what I can find with that PID/VID.\n\nIs your google broken? ![:poke:](http://reboot.pro/public/style_emoticons/default/poke.gif)  \n\nHere:  \n[http://www.toshiba.c.../1_4/1_4-02.htm](http://www.toshiba.co.jp/p-media/english/u3/update/1_4/1_4-02.htm \"External link\")  \n[http://www.toshiba.c...2H_Ver1.055.exe](http://www.toshiba.co.jp/p-media/english/u3/update/1_4/U3updater_toshiba_U2H_Ver1.055.exe \"External link\")  \n[http://www.toshiba.c..._install_f2.gif](http://www.toshiba.co.jp/p-media/english/img/bt_dl_install_f2.gif \"External link\")  \n\nthough I don\u0027t think it will be useful. ![:poke:](http://reboot.pro/public/style_emoticons/default/poke.gif)  \n\njaclaz   \n"
    },
    {
      "id": "60219",
      "timestamp": "2009-02-22T17:29:35+00:00",
      "author": "Luca\u0027s",
      "content": "\u003e Is your google broken? ![:poke:](http://reboot.pro/public/style_emoticons/default/poke.gif)\nwho said i used google? ![:poke:](http://reboot.pro/public/style_emoticons/default/poke.gif)   \nwell, no, just kidding, i was already downloading when i wrote. but the fact still is the tool is of no use, for it doesn\u0027t change the cd-rom unit dimensions.. you have to keep your 6mb drive.  \n\nabout the commands: i suppose they\u0027re just a test, but actually we don\u0027t have just to replace the first entry with the currently needed one: we need to exchange entry 1 with entry 3 and viceversa, or else the trick could work when we use windows with the default driver, but i guess it won\u0027t when we use the filter driver instead (wrong partition table with two entries the same). did i get the point?  \nanyway i\u0027ll give it a try with the default driver and make you know ASAP.   \n"
    },
    {
      "id": "60220",
      "timestamp": "2009-02-22T17:40:01+00:00",
      "author": "was_jaclaz",
      "content": "\u003e we need to exchange entry 1 with entry 3 and viceversa, or else the trick could work when we use windows with the default driver, but i guess it won\u0027t when we use the filter driver (wrong partition table with two entries the same). did i get the point?\n\nYep, but I continue to suggest a step by step approach.  \n\nIf these basic commands work, noone prohibits us to make them more complex later. ![:poke:](http://reboot.pro/public/style_emoticons/default/poke.gif)   \n\nWe could simpy hide the \"duplicate\" with 0x07-\\\u003e0x17. if needed, or find another way, let\u0027s wait until we face the problem, and ***then*** we\u0027ll see how to work around it...![:poke:](http://reboot.pro/public/style_emoticons/default/poke.gif)  \n\nThe only way to know is to do some tests.....  \n\nAbout enlarging the 6 MB partiton, this should be of help ![:poke:](http://reboot.pro/public/style_emoticons/default/poke.gif):  \n[http://www.msfn.org/...howtopic\u003d121502](http://www.msfn.org/board/index.php?showtopic\u003d121502 \"External link\")  \n(site down right now) googlecache:  \n[http://209.85.129.13.....wtopic\u003d121502](http://209.85.129.132/search?q\u003dcache:3xiCL1Um97IJ:www.msfn.org/board/index.php%3Fshowtopic%3D121502 \"External link\")  \n[http://209.85.129.13...hp/t121502.html](http://209.85.129.132/search?q\u003dcache:d498apTRHgEJ:www.msfn.org/board/lofiversion/index.php/t121502.html \"External link\")  \n\njaclaz   \n"
    },
    {
      "id": "60244",
      "timestamp": "2009-02-22T21:13:04+00:00",
      "author": "Luca\u0027s",
      "content": "You\u0027re up to more tricks than Old Nick... ![:poke:](http://reboot.pro/public/style_emoticons/default/poke.gif)   \n\n\u003cbr /\u003e\n\n\u003e About enlarging the 6 MB partiton, this should be of help :  \n\u003e [http://www.msfn.org/...howtopic\u003d121502](http://www.msfn.org/board/index.php?showtopic\u003d121502 \"External link\")\nmmm, last time i used it, it gave me an error (it could not access the device). i will try sooner or later with the toshiba tool instead.  \n\nbut as you teach me, it\u0027s better to focus on one problem at a time.  \nwith the partnew commands no way.  \ni have grub4dos 0.4.3 and it gives me aproximately this error:  \nThis command is inhibited from running in a script  \nError 35: Invalid argument  \n\ndoh!  \nit seems it has too many arguments...  \nHere is the main part of the documentation from README_GRUB4DOS.txt  \n\n```\n***********************************************************************\n\n*******\n\n***\t\t\t\t\t  The PARTNEW Command Syntax\t\t\t\t\t\t***\n\n******************************************************************************\n\n\n\nBesides the mappings in the above section, you may instead choose to create a\n\nnew primary partition with the PARTNEW command. PARTNEW can generate a primary\n\npartition entry \u0026#40;in the partition table\u0026#41; for a logical partition.\n\n\n\nFor example,\n\n\n\n\tpartnew \u0026#40;hd0,3\u0026#41; 0x07 \u0026#40;hd0,4\u0026#41;+1\n\n\n\nwhere the file \u0026#40;hd0,4\u0026#41;+1 stands for the whole partition \u0026#40;hd0,4\u0026#41;. This command\n\nwill create a new primary partition \u0026#40;hd0,3\u0026#41; whose type is 0x07 and whose\n\ncontents/data is the same as that of the logical partition \u0026#40;hd0,4\u0026#41;.\n\n\n\nJust like a whole logical partition, a contiguous partition image file can\n\nalso be used with PARTNEW\u0026#58;\n\n\n\n\tpartnew \u0026#40;hd0,3\u0026#41; 0x00 \u0026#40;hd0,0\u0026#41;/my_partition.img\n\n\n\nThe type 0x00 indicates a type-auto-detection of the image MY_PARTITION.IMG.\n\nThe above command will create a new primary partition \u0026#40;hd0,3\u0026#41; with a proper\n\ntype and with contents/data being exactly that of the contiguous file\n\n\u0026#40;hd0,0\u0026#41;/my_partition.img.\n\n\n\nPARTNEW will automatically correct the \u0026#34;hidden sectors\u0026#34; in the BPB and the\n\nmodification will be permanent. And PARTNEW modifies the partition table\n\npermanently.\n```\n\n\u003cbr /\u003e\n\n"
    },
    {
      "id": "60268",
      "timestamp": "2009-02-23T08:41:25+00:00",
      "author": "was_jaclaz",
      "content": "\u003e i have grub4dos 0.4.3\n\nWHY?  \n\nUse ALWAYS **latest** one:  \n[http://www.boot-land...?...pic\u003d14\\\u0026st\u003d1](http://www.boot-land.net/forums/index.php?showtopic\u003d14\u0026st\u003d1 \"External link\")  \n\n\u003cbr /\u003e\n\nMaybe:  \n\u003e This command is inhibited from running in a script\nmeans that it is inhibited to run from a script. ![:poke:](http://reboot.pro/public/style_emoticons/default/poke.gif)  \n\nTry using command line ![:poke:](http://reboot.pro/public/style_emoticons/default/poke.gif):  \n[http://diddy.boot-la...s/files/cli.htm](http://diddy.boot-land.net/grub4dos/files/cli.htm \"External link\")  \n\njaclaz   \n"
    },
    {
      "id": "60286",
      "timestamp": "2009-02-23T13:39:47+00:00",
      "author": "Luca\u0027s",
      "content": "\u003e WHY?  \n\u003e Use ALWAYS latest one  \n\u003e [http://www.boot-land...?...pic\u003d14\\\u0026st\u003d1](http://www.boot-land.net/forums/index.php?...pic\u003d14\u0026st\u003d1 \"External link\")\nThe link leads you here:  \n\u003e WHERETO  \n\u003e FINAL VERSIONS are here:  \n\u003e [http://sourceforge.n...ojects/grub4dos](http://sourceforge.net/projects/grub4dos \"External link\")\n\nAnd in fact at that sourceforge address version 0.4.3 is shown...  \n\nHowever i\u0027ve tried, the stick situation being the one in the last screenshot, the commandline way. I\u0027ve used one of the hardcoded commands (to make data the first entry):  \n\n```\npartnew \u0026#40;hd0,0\u0026#41; 0x07 10859940 20466810\n```\n\n\u003cbr /\u003e\n\nThis time it was accepted, but when i rebooted windows, connecting the stick resulted in a blue screen. I\u0027ve tried on a clear xp-copy too: but both with and without filter driver, you have a blue screen.  \nUsing **\u0027** partnew (hd0,0) 0x07 63 6763302**\u0027** also had no repair effect.  \nI had to resort to diskpart from the recovery console, to erase all the partitions. It was strange in that it saw on the usb stick disk a 3,2gb ntfs partition (the setups one), and then three odd entries of raw non-partitioned space matching each one the size of the partitions present on disk before (setups, truecrypt, data).  \nSo, back to us.. I have deleted all the partitions, booted windows, zeroed first 100 sectors, created new partitions on the stick.  \nNow order is:  \n1.Setups  \n2.Data  \n3.Truecrypt  \n\nHere is a screenshot of the current situation.  \n[![beeblebrox.jpg](http://reboot.pro/uploads/monthly_02_2009/post-15106-1235396475_thumb.jpg)](http://reboot.pro/uploads/monthly_02_2009/post-15106-1235396475.jpg \"beeblebrox.jpg - Size: 40.62KB\"){#ipb-attach-url-7658-0-04299600-1676066545}   \nI will copy grub4dos on the stick soon.  \n\nAny idea?   \n"
    },
    {
      "id": "60429",
      "timestamp": "2009-02-24T16:02:08+00:00",
      "author": "Luca\u0027s",
      "content": "so, my question seems to become: is there a way to launch from grub4dos a cmd file that tells a dos program (like ptedit) to edit the master partition table entries?  \nthank you!  \njaclaz are you still there? ![:cheers:](http://reboot.pro/public/style_emoticons/default/cheers.gif)   \n"
    },
    {
      "id": "60442",
      "timestamp": "2009-02-24T19:48:56+00:00",
      "author": "was_jaclaz",
      "content": "\u003e jaclaz are you still there? ![:cheers:](http://reboot.pro/public/style_emoticons/default/cheers.gif)\nYes, I am, though I am starting to think that you are not (or at least that you are not following). ![:cheers:](http://reboot.pro/public/style_emoticons/default/cheers.gif)  \n\nRe-read, slowly this post:  \n[http://www.boot-land...?...pic\u003d14\\\u0026st\u003d1](http://www.boot-land.net/forums/index.php?showtopic\u003d14\u0026st\u003d1 \"External link\")  \n\n\u003cbr /\u003e\n\n\u003e And in fact at that sourceforge address version 0.4.3 is shown...\n\n\u003cbr /\u003e\n\n\u003cbr /\u003e\n\ncan you see the bolded part?  \n\u003e **Unless otherwise stated all comments, hints, howto etc., will always be related to the NEWISH experimental version.**\n\n\u003e I had to resort to diskpart from the recovery console, to erase all the partitions.\nYep, and you have now a different partition setting.  \n\nThat was the problem we were talking about. ![:cheers:](http://reboot.pro/public/style_emoticons/default/cheers.gif)  \n\nLet\u0027s try again. with these new settings:  \n\n```\npartnew \u0026#40;hd0,0\u0026#41; 0x07 27342630 3984120\n\npartnew \u0026#40;hd0,1\u0026#41; 0 0 0\n\npartnew \u0026#40;hd0,2\u0026#41; 0 0 0\n```\n\n\u003cbr /\u003e\n\nPlease note that EITHER  \nyou install to the MBR grldr.mbr AND copy grldr on EACH partition  \nOR  \ncopy to EACH partition NTLDR, grldr and BOOT.INI with entry pointing to C:\\\\grldr  \n\n**BEFORE** issuing the above commands ![:cheers:](http://reboot.pro/public/style_emoticons/default/cheers.gif) .  \n\nThis way we:  \n\n* overwrite first partition entry\n* delete second one\n* delete third one\n\n\u003cbr /\u003e\n\nIt should work normally. (only third partition visible/booting)  \n\n\u003cbr /\u003e\n\n\u003cbr /\u003e\n\nNow try:  \n\n```\npartnew \u0026#40;hd0,0\u0026#41; 0x07 6715170 20627460\n```\n\n\u003cbr /\u003e\n\n\u003cbr /\u003e\n\nIt should work normally. (only second partition visible/booting)  \n\nNow try:  \n\n```\npartnew \u0026#40;hd0,0\u0026#41; 0x07 63 6175107\n```\n\n\u003cbr /\u003e\n\n\u003cbr /\u003e\n\nIt should work normally. (only first partition visible/booting)  \n\nNow try:  \n\n```\npartnew \u0026#40;hd0,1\u0026#41; 0x17 6715170 20627460\n\npartnew \u0026#40;hd0,2\u0026#41; 0x17 27342630 3984120\n```\n\n\u003cbr /\u003e\n\nIt should work normally. (only first partition visible/booting) ![:cheers:](http://reboot.pro/public/style_emoticons/default/cheers.gif)  \n\n```\npartnew \u0026#40;hd0,0\u0026#41; 0x07 6715170 20627460\n```\n\n\u003cbr /\u003e\n\nIt ***may*** work normally. (only third partition visible/booting) or it ***may*** bluescreen. ![:cheers:](http://reboot.pro/public/style_emoticons/default/cheers.gif)   \n\nWhat happens? ![:cheers:](http://reboot.pro/public/style_emoticons/default/cheers.gif)   \n\n\u003e so, my question seems to become: is there a way to launch from grub4dos a cmd file that tells a dos program (like ptedit) to edit the master partition table entries?\nYES.  \n[http://homepages.tes...no-answers.html](http://homepages.tesco.net/J.deBoynePollard/FGA/questions-with-yes-or-no-answers.html \"External link\")  \n\nBut the question is about the ***tool*** to make the changes, what we are still missing is WHAT changes can be made and HOW to make them without having windows bluescreen.  \n\nThere are however several DOS programs able to do that, but you will need to boot to DOS (possibly in an image, since the partitions are NTFS, and then have an autoexec.bat or anyway a .bat -NOT .cmd - to execute the changes).  \n[http://www.mdgx.com/secrets.htm#FDPT](http://www.mdgx.com/secrets.htm#FDPT \"External link\")  \n\nThese ones should be the \"right\" one, Editpart:  \n[http://www.partition...m/utilities.htm](http://www.partitionsupport.com/utilities.htm \"External link\")  \n\njaclaz   \n"
    },
    {
      "id": "60652",
      "timestamp": "2009-02-26T18:12:38+00:00",
      "author": "Luca\u0027s",
      "content": "\u003e can you see the bolded part?\nYep, i must say it was not so visible to the naked eye.. But anyway, SORRY.  \n\nI have done all the things you told me.  \nAs foreseen, all the commands work but the last (it bluescreens)  \n\nBased on your suggestions, here is the code i propose to exchange the partiton table entries\u0027 order (it both makes data and setups first entry)  \n\n```\nPartnew \u0026#40;hd0,3\u0026#41; 0x17 \u0026#40;hd0,0\u0026#41;+1\n\nPartnew \u0026#40;hd0,0\u0026#41; 0x07 \u0026#40;hd0,1\u0026#41;+1\n\nPartnew \u0026#40;hd0,1\u0026#41; 0x17 \u0026#40;hd0,3\u0026#41;+1\n\nPartnew \u0026#40;hd0,3\u0026#41; 0 0 0\n```\n\n\u003cbr /\u003e\n\nBTW, yes, the commands work also for primary partitions. I have tested this code and it reaches the goal (it also sets partitions active and un/hides them as desired).  \n\nIt seems the next step is to make these commands be allowed to run in a menu script from grub4dos. How? ![:cheers:](http://reboot.pro/public/style_emoticons/default/cheers.gif)   \n"
    },
    {
      "id": "60676",
      "timestamp": "2009-02-26T20:10:48+00:00",
      "author": "was_jaclaz",
      "content": "Let\u0027s see if I have understood the set of \"proposed\" commands.  \n\n```\nPartnew \u0026#40;hd0,3\u0026#41; 0x17 \u0026#40;hd0,0\u0026#41;+1\n```\n\n\u003cbr /\u003e\n\nThis one copies current 1st partition to 4th entry and hides it.  \n\n```\nPartnew \u0026#40;hd0,0\u0026#41; 0x07 \u0026#40;hd0,1\u0026#41;+1\n```\n\n\u003cbr /\u003e\n\nThis one copies current 2nd partition to 1st entry and unhides it.  \n\n```\nPartnew \u0026#40;hd0,1\u0026#41; 0x17 \u0026#40;hd0,3\u0026#41;+1\n```\n\n\u003cbr /\u003e\n\nThis one copies current 1st partition to 2nd entry and hides it.  \n\n```\nPartnew \u0026#40;hd0,3\u0026#41; 0 0 0\n```\n\n\u003cbr /\u003e\n\nThis one clears contents of 4th entry.  \n\nIn other words you are using 4th entry as temporary store to exchange entries in 1st and 2nd entry for first and second partiton. ![:cheers:](http://reboot.pro/public/style_emoticons/default/cheers.gif):cheers:   \n\nThus, you verified that:  \n\n* as long as there are NO \"duplicate entries\" in the MBR, no matter if hidden or unhidden (i.e. if there is a duplicate entry, even if hidden, it will bluescreen)\n* as long as first entry in partition table is valind and unhidden, that partition is bootable (and visible WITHOUT Filter driver)\n\n\u003cbr /\u003e\n\nVery good. ![:cheers:](http://reboot.pro/public/style_emoticons/default/cheers.gif)  \n\nNow we\u0027ll have to ask **tinybit** if he could provide a switch to allow the using of partnew ![:cheers:](http://reboot.pro/public/style_emoticons/default/cheers.gif) from within a menu.lst.  \n\nProposed:  \n\u003e partnew \\\u003cpart\\\u003e \\\u003ctype\\\u003e \\\u003cstart\\\u003e \\\u003clength\\\u003e **--nike**\n\nwhere --nike could stand for:  \n**n** oprobs **I** **k** now **e** verything (***just do it*** )  \n![:cheers:](http://reboot.pro/public/style_emoticons/default/cheers.gif)   \n\nI\u0027ll PM **tinybit** to raise his attention to this, just in case he does not have a chance to see it.  \n\nHave you checked that partnew NEVER runs from menu.lst (or it does run with \"hardcoded\" syntax, but not with the \"enhanced\" one)? ![:cheers:](http://reboot.pro/public/style_emoticons/default/cheers.gif)  \n\nNow that we have a working - though not yet actually easily implementable method - let\u0027s find how to replicate it - temporarily, waiting for **tinybit** \u0027s take on the matter - with grub4dos booting DOS.  \n\nSince partitions are NTFS, booting DOS from them is out of question, so an image is needed.  \n\nThis image needs to be able to \"see\" the stick, at least as physicaldevice in order to access the MBR and change entries.  \n\nCan you try following these threads:  \n[http://www.boot-land...?showtopic\u003d3963](http://www.boot-land.net/forums/index.php?showtopic\u003d3963 \"External link\")  \n[http://www.boot-land...?showtopic\u003d4260](http://www.boot-land.net/forums/index.php?showtopic\u003d4260 \"External link\")  \n(possibly just a \"simple\" image as per first one will be enough) ![:cheers:](http://reboot.pro/public/style_emoticons/default/cheers.gif)  \n\nSince you have devised this clever \"exchange routine\", editpart is not actually needed (while it may be useful if using \"harcoded\" partition entries).  \n\nA simpler hex editor, command line driven, would be more suitable.   \n\nTo follow your original \"exchange routine\" a suitable app seems to me the FreeFdisk:  \n[http://www.ibiblio.o...sk/fdisk131.zip](http://www.ibiblio.org/pub/micro/pc-stuff/freedos/files/dos/fdisk/fdisk131.zip \"External link\")  \nIt\u0027s /MOVE command seems like it will do the trick.  \n\nAll in all the easiest way from DOS would be to save two (or ***n*** ) copies (each one properly set) of the MBR and simply overwrite \"real\" MBR with either of the two (or three, or ***n*** ).  \nFor this latter approach MBRWIZARD:  \n[http://mbrwizard.com/](http://mbrwizard.com/ \"External link\")  \n[http://mbrwizard.com/reference.shtml](http://mbrwizard.com/reference.shtml \"External link\")  \nand it\u0027s /save and /restore commands seem to me a good choice.  \n\nThere may be other ways, such as simply copying the ***n*** MBR\u0027s to some hidden sectors, that could possibly be \"ported back\" to grub4dos, but again we will need a \"safety removal switch\" for dd command.... ![:cheers:](http://reboot.pro/public/style_emoticons/default/cheers.gif)  \n\n![:cheers:](http://reboot.pro/public/style_emoticons/default/cheers.gif)  \n\njaclaz   \n"
    },
    {
      "id": "60697",
      "timestamp": "2009-02-26T21:57:12+00:00",
      "author": "cdob",
      "content": "```\nPartnew \u0026#40;hd0,3\u0026#41; 0x17 \u0026#40;hd0,0\u0026#41;+1\n```\n\n\u003e This one copies current 1st partition to 4th entry and hides it.\nActually this dosn\u0027t copy full partition definition.  \nPartnew does read starting address and length from 1st partition.  \nA new 4th entry is created.   \nThe main difference: CHS definition is not copied, a new CHS definition is created.  \nThere maybe (and are at first testings) different CHS definition at 1st partition and 4th partition.  \nThat\u0027s not a copy.  \nDOS and partition boot sector use CHS definition.  \n\nCan grub4dos copy whole partition entry?  \n\n\u003e There may be other ways, such as simply copying the n MBR\u0027s to some hidden sectors, that could possibly be \"ported back\" to grub4dos\nRandom ideas: given two MBR files mbr0123.08a and mbr0123.08a  \nRecognice the sort order 0123 and 1023: partition definition is edited already  \n\n```\nls \u0026#40;hd0,0\u0026#41;/mbr1023.08a \u0026\u0026 dd if\u003d\u0026#40;hd0,0\u0026#41;/mbr1023.08a of\u003d\u0026#40;hd0\u0026#41; count\u003d1\n\nls \u0026#40;hd0,1\u0026#41;/mbr0123.08a \u0026\u0026 dd if\u003d\u0026#40;hd0,1\u0026#41;/mbr0123.08a of\u003d\u0026#40;hd0\u0026#41; count\u003d1\n```\n\n\u003cbr /\u003e\n\n\u003e but again we will need a \"safety removal switch\" for dd command\nA -force would be nice  \n\n```\nls \u0026#40;hd0,0\u0026#41;/mbr1023.08a \u0026\u0026 dd if\u003d\u0026#40;hd0,0\u0026#41;/mbr1023.08a of\u003d\u0026#40;hd0\u0026#41; count\u003d1 -force\n```\n\n\u003cbr /\u003e\n\nOr copy partition entries with dd.  \n\n\u003cbr /\u003e\n\nAnother approach: use a continuous image file  \n\n```\ntitle partnew \u0026#40;hd0,0\u0026#41; disk image\n\npartnew \u0026#40;hd0,0\u0026#41; 0x00 \u0026#40;hd0,0\u0026#41;/XP_disk.img\n```\n\npreviously partition entry (hd0,0) copied to (hd0,1) with a disk editor.  \nDoes work in real life. Just installed XP that way.  \n\nAgain the above question: how to restore (hd0,0) to previous state within menu.lst?   \n"
    },
    {
      "id": "60747",
      "timestamp": "2009-02-27T08:50:46+00:00",
      "author": "was_jaclaz",
      "content": "\u003e \u003cbr /\u003e\n\u003e\n\u003e ```\n\u003e Partnew \u0026#40;hd0,3\u0026#41; 0x17 \u0026#40;hd0,0\u0026#41;+1\n\u003e ```\n\u003e\n\u003e Actually this dosn\u0027t copy full partition definition.  \n\u003e Partnew does read starting address and length from 1st partition.  \n\u003e A new 4th entry is created.   \n\u003e The main difference: CHS definition is not copied, a new CHS definition is created.  \n\u003e There maybe (and are at first testings) different CHS definition at 1st partition and 4th partition.  \n\u003e That\u0027s not a copy.\n\u003e\n\u003e \u003cbr /\u003e\n\u003e\nRight. ![:cheers:](http://reboot.pro/public/style_emoticons/default/cheers.gif)  \nIt is the creation of a new entry taking the LBA data from the actual partition.  \n\nI would be curious to know what it was the CHS before and what it is after.  \n\nIf the stick/device was \"properly\" sensed/partitioned with a geometry of ***n*** x255x63, the recreated CHS should be identical.  \n\n\u003e DOS and partition boot sector use CHS definition.\nOn this I have some reserves, for NTFS.  \n\n\u003e Another approach: use a continuous image file  \n\u003e\n\u003e ```\n\u003e title partnew \u0026#40;hd0,0\u0026#41; disk image\n\u003e\n\u003e partnew \u0026#40;hd0,0\u0026#41; 0x00 \u0026#40;hd0,0\u0026#41;/XP_disk.img\n\u003e ```\n\u003e\n\u003e previously partition entry (hd0,0) copied to (hd0,1) with a disk editor.  \n\u003e Does work in real life. Just installed XP that way.  \n\u003e\n\u003e Again the above question: how to restore (hd0,0) to previous state within menu.lst?\n\u003e\n\u003e \u003cbr /\u003e\n\u003e\n\u003cbr /\u003e\n\nI don\u0027t understand the above. ![:cheers:](http://reboot.pro/public/style_emoticons/default/cheers.gif)  \n\nCould you explain it giving some details? ![:cheers:](http://reboot.pro/public/style_emoticons/default/cheers.gif)   \n\nSometimes it is difficult to follow you, as you give as assumed or implied lots of things....![:cheers:](http://reboot.pro/public/style_emoticons/default/cheers.gif)  \n\njaclaz   \n"
    },
    {
      "id": "60785",
      "timestamp": "2009-02-27T13:53:52+00:00",
      "author": "Luca\u0027s",
      "content": "\u003e In other words, you are using 4th entry as temporary store to exchange entries in 1st and 2nd entry for first and second partition.\nYesss that was my intention.  \n\nLet me specify one thing, though.   \n\\[Forget for the moment the fact that, with partnew, the CHS definition seems not to be copied\\]  \nAn important point is that, if enhanced syntax is used, the exchange routine i proposed is portable only when you have no more than 3 primary partitions on disk (4th entry must be blank).  \nI preferred enhanced syntax because of what you told me:  \nthat, except for \u0027Type\u0027, the partnew command would have \"copied\" all values from the existent entries, not only \u0027StartSector\u0027 and \u0027NumSectors\u0027.  \nBut what about if one needs 4 primaries? I propose to use harcoded syntax, and simply overwrite the 1st and the 2nd entries with the desired \"StartSector\" and \"NumSectors\" values.  \nAnyway yes, duplicate entries are not allowed by windows in the MBR (no matter if they\u0027re hidden or not); and the partnew command never works in scripts, neither with the hardcoded syntax nor the enhanced one.  \n\nNow, back to the CHS definition problem. How can i verify partnew does not copy it?  \nPlease take a look at this screenshot (it\u0027s the situation after having made data first)  \n[![beeblebroxshifted.jpg](http://reboot.pro/uploads/monthly_02_2009/post-15106-1235742790_thumb.jpg)](http://reboot.pro/uploads/monthly_02_2009/post-15106-1235742790.jpg \"beeblebroxshifted.jpg - Size: 26.9KB\"){#ipb-attach-url-7704-0-28773100-1676066545}   \nIs it here that you see the CHS definition has not been copied?  \nEven if actually i still don\u0027t know what concept the abbreviation CHS stands for, i further ask:  \nwhen you say  \n\u003e DOS and partition boot sector use CHS definition\ndo you mean if i don\u0027t copy it too, the windows setups on the usb stick won\u0027t work (even if setups-partition entry is ordered first in the partition table, it is active and unhidden)?  \n\nApart from that,  \nthis code  \n\n```\nls \u0026#40;hd0,0\u0026#41;/mbr1023.08a \u0026\u0026 dd if\u003d\u0026#40;hd0,0\u0026#41;/mbr1023.08a of\u003d\u0026#40;hd0\u0026#41; count\u003d1\n\nls \u0026#40;hd0,1\u0026#41;/mbr0123.08a \u0026\u0026 dd if\u003d\u0026#40;hd0,1\u0026#41;/mbr0123.08a of\u003d\u0026#40;hd0\u0026#41; count\u003d1\n```\n\ncauses me some trouble.  \nWhat\u0027s \u0027Ls\u0027 for? I didn\u0027t see it in grub4dos readme. I know i could search on google, but i\u0027m not so confident with linux bashes. I also don\u0027t understand what the first and second commands exactly perform... Need they be in a commandline, or are they paired in a script? On which partition should i place dd? And above all: why mbr1023.08a and mbr0123.08a are on two different partitions?   \nAnyway i wish i can avoid having configuration files on data partition \\[ (hd0,1) \\]  \nI also hope - just hope - to get over the difficulties and be able to follow the partnew menu script path.  \n\n\u003e where --nike could stand for:  \n\u003e **n** oprobs **I** **k** now **e** verything (***just do it***)\nWell i already said you know one more than the devil.. ![:cheers:](http://reboot.pro/public/style_emoticons/default/cheers.gif)   \nActually i cannot help appreciating the quotation from the ancient Greek. ![:cheers:](http://reboot.pro/public/style_emoticons/default/cheers.gif) I\u0027ll pretend i didn\u0027t see the final \u0027Just do it\u0027, for at most i\u0027d prefer, as a switch,   \n--adidas  \n**A** ha, **d** iscussing **i** **d** evised **a** **s** olution!  \nA matter of tastes... ![:cheers:](http://reboot.pro/public/style_emoticons/default/cheers.gif) ![:cheers:](http://reboot.pro/public/style_emoticons/default/cheers.gif)   \n\nJoking aside, i\u0027ll do really be grateful to you if you could ask tinybit to add a switch to allow partnew menu scripts. I trust in your power.  \nIn fact, even if i have to (and want to) thank you for all the links and know-how you have provided onto the DOS way, and even if i had plunged for first into that way, i now think grub4dos is the best solution (well, yes, if the problem put forward on CHS can be overcome). Not only i think so because it would take some time to me, to learn now how to create a DOS ramdrive, but also for, got to this point, if you have, say, a menu in grub4dos to launch a DOS image, and then have to launch another script from there (i mean if you adopt an approach involving more than one step), you\u0027d do quicker by manually exchanging the partition table entries with beeblebrox, or at most by using the grub4dos commandline.  \n\nI hope partnew scripts are not inhibited due to some security policy, or else our wait could be longer than expected: but i prefer to wait a grub4dos enhancement rather than to plunge myself into the DOS image way: i\u0027d leave it as the last resort.  \nHope it\u0027s okay for you.  \nLet me know.   \n"
    },
    {
      "id": "60787",
      "timestamp": "2009-02-27T14:01:46+00:00",
      "author": "Luca\u0027s",
      "content": "```\ntitle partnew \u0026#40;hd0,0\u0026#41; disk image\n\npartnew \u0026#40;hd0,0\u0026#41; 0x00 \u0026#40;hd0,0\u0026#41;/XP_disk.img\n```\n\n\u003cbr /\u003e\n\n\u003e I don\u0027t understand the above.\n\ni add myself to the list.  \n\n.   \n"
    },
    {
      "id": "60795",
      "timestamp": "2009-02-27T15:45:09+00:00",
      "author": "was_jaclaz",
      "content": "CHS and LBA are two different \"conventions\" about how to address a sector.  \n\nInitially, only CHS was used, and this soon led to the first hard disk barrier (528 Mb) :  \n[http://www.pcguide.c...d/bios/size.htm](http://www.pcguide.com/ref/hdd/bios/size.htm \"External link\")  \n[http://www.pcguide.c...izeMB504-c.html](http://www.pcguide.com/ref/hdd/bios/sizeMB504-c.html \"External link\")  \n\nLater a BIOS translation or ECHS scheme was used, leading to another \"main\" hard disk barrier (8 Gb):  \n[http://www.pcguide.c.../sizeGB8-c.html](http://www.pcguide.com/ref/hdd/bios/sizeGB8-c.html \"External link\")  \n\nThe usual Int13h needed to be extended:  \n[http://www.pcguide.c...bios_Int13h.htm](http://www.pcguide.com/ref/hdd/bios/bios_Int13h.htm \"External link\")  \n[http://www.pcguide.c...tensions-c.html](http://www.pcguide.com/ref/hdd/bios/biosExtensions-c.html \"External link\")  \n\nOn a ***PROPERLY*** set partition entry, as long as the partition starts and ends within the 1024th cylinder ( 8 Gb limit) CHS and LBA should be interchangeable).  \n\nFor anything above cylinder 1024 the CHS results in \"a suffusion of yellow\":  \n[http://www.thateden.co.uk/dirk/](http://www.thateden.co.uk/dirk/ \"External link\")  \n\nSome \"formatting\" utilities, including the \"famous\" HP USB one, may (and often does) produce an \"unbalanced\" partition entry.  \n\nThis is **WRONG** . ![:cheers:](http://reboot.pro/public/style_emoticons/default/cheers.gif)   \n\nCHS and LBA data should always be balanced, **ALWAYS** .  \n\nAnd moreover, head and sector data **SHOULD** be aligned to non-fractional Cylinder.   \n\nTheoretically, whenever a BIOS detects a LBA type of partition:  \n[http://www.win.tue.n...on_types-1.html](http://www.win.tue.nl/~aeb/partitions/partition_types-1.html \"External link\")  \n\n* 0c FAT32 LBA mapped\n* 0e FAT16 LBA mapped\n* 07 NTFS (***always*** LBA mapped) Or not? ![:cheers:](http://reboot.pro/public/style_emoticons/default/cheers.gif)\n\nthe CHS part should be alltogether ignored.  \n\n\u003cbr /\u003e\n\nLBA is geometry ***in*** dependent, while CHS is geometry dependent.  \n\nVarious BIOS and various OS may use the CHS and LBA info differently, and moreover detected device geometry may change.  \n\nYou may want to play a bit with this:  \n[http://www.boot-land...?showtopic\u003d2959](http://www.boot-land.net/forums/?showtopic\u003d2959 \"External link\")  \n\nBy re-calculating the CHS from LBA data based on the geometry seen by BIOS, as grub4dos commands do, should actually be an advantage, as long as the initial partition data is \"correct\", i.e. respects non-fractional Cylinder/Head.  \n\nYour (**Luca\u0027s** \u0027s) initial partitioning was WRONG, as one of the entries started on 1023/8/5 and ended on 1023/15/32 - this also led beeblebrox to wrongly detect a geometry of 61209x16x32 instead of the \"correct\" one 1950x255x63, that was later detected once properly partitioned.  \n\nI wrote my small batches exactly to prevent this possibility:  \n[http://www.boot-land...?showtopic\u003d5000](http://www.boot-land.net/forums/index.php?showtopic\u003d5000 \"External link\")  \n\nStandard Windows Disk Management usually behaves well.  \n\nVista diskpart DOES NOT (unless Registry is tweaked):  \n[http://www.911cd.net...showtopic\u003d21186](http://www.911cd.net/forums//index.php?showtopic\u003d21186 \"External link\")  \n\nOther utilities may or may not work properly, usually not because of the apps themselves but because of what the users tell them to do, compare with my previous statement about Acronis and and Partition Magic and with the note to the /SORT command in MBRWIZ:  \n[http://mbrwizard.com/reference.shtml](http://mbrwizard.com/reference.shtml \"External link\")  \n\nYour post brings us back to the initial question ![:cheers:](http://reboot.pro/public/style_emoticons/default/cheers.gif) :  \n\u003e What is the reason for three primaries? ![:cheers:](http://reboot.pro/public/style_emoticons/default/cheers.gif)\n\nNothing prevents you from using one primary and ANY number of Logical Volumes inside Extended, which would leave or even ONLY Logical Volumes inside Extended.  \nThis way you can have in the MBR:  \n\n* entry 0 (empty) to be filled each time with the result of the grub4dos partnew command\n* entry 1 pointing to Extended Partition\n* entry 2 empty\n* entry 3 empty\n\nin the EPBR:  \n\n* entry 0 actual partition\n* entry 1 link to next EPBR\n\nand so on....  \n[http://www.goodells....boot/ptedit.htm](http://www.goodells.net/multiboot/ptedit.htm \"External link\")  \n\n\u003cbr /\u003e\n\nTo sum up:  \n\n* as long as you have proper partition entries there will be NO problems, as CHS will be calculated from LBA data using correct BIOS geometry, besides, using NTFS partitions this won\u0027t be a problem. (a \"bad\" BIOS that needs CHS won\u0027t probably work at all with a NTFS partition and definitely not if you go beyond 1024th cylinder anyway)\n* the current limitation to the use of partnew is a (VERY understandable) security feature\n\n\u003cbr /\u003e\n\nNonetheless, using a pre-made partition entry is somewhat \"safer\", though the resulting menu.lst will be device specific.  \n\n@**tinybit**   \nA possibility for adding the run partnew from a menu.lst entry while keeping a relatively safe setup could be to allow it running ONLY in a menu.lst entry protected by hashed password.  \n\nAnd this brings us back to the two features we talked about:  \nmenu.lst password protection:  \nread here:  \n[http://www.boot-land...?showtopic\u003d5862](http://www.boot-land.net/forums/index.php?showtopic\u003d5862 \"External link\")  \n[http://www.boot-land...?...ic\u003d2984\\\u0026hl\u003d](http://www.boot-land.net/forums/index.php?showtopic\u003d2984\u0026hl\u003d \"External link\")  \n\nUUID instead of \"tag\" files, from README_GRUB4DOS.txt:  \n\u003e \\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*  \n\u003e \\*\\*\\* New command \u0027uuid\u0027 to identify partitions \\*\\*\\*  \n\u003e \\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*  \n\u003e\n\u003e Usage:  \n\u003e\n\u003e uuid \\[DEVICE\\] \\[UUID\\]  \n\u003e\n\u003e If DEVICE is not specified, search for filesystem with UUID in all partitions  \n\u003e and set the partition containing the filesystem as new root (if UUID is  \n\u003e specified), or just list uuid\u0027s of all filesystems on all devices (if UUID is  \n\u003e not specified). If DEVICE is specified, return true or false according to  \n\u003e whether or not the DEVICE matches the specified UUID (if UUID is specified),  \n\u003e or just list the uuid of DEVICE (if UUID is not specified).  \n\u003e\n\u003e Example 1:  \n\u003e\n\u003e find --set-root uuid () 7f95820f-5e33-4e6c-8f50-0760bf06d79c  \n\u003e\n\u003e which will find a partition with uuid\u003d7f95820f-5e33-4e6c-8f50-0760bf06d79c  \n\u003e and set the partition as root if found.  \n\u003e\n\u003e Example 2:  \n\u003e\n\u003e uuid ()  \n\u003e\n\u003e which will print the uuid of the current root device.\n\n\u003cbr /\u003e\n\n![:cheers:](http://reboot.pro/public/style_emoticons/default/cheers.gif)   \n\njaclaz   \n"
    },
    {
      "id": "60826",
      "timestamp": "2009-02-27T18:36:02+00:00",
      "author": "Luca\u0027s",
      "content": "Jaclaz... ![:cheers:](http://reboot.pro/public/style_emoticons/default/cheers.gif) ![:cheers:](http://reboot.pro/public/style_emoticons/default/cheers.gif) I LOVE YOU...   \n![:cheers:](http://reboot.pro/public/style_emoticons/default/cheers.gif)   \n![:cheers:](http://reboot.pro/public/style_emoticons/default/cheers.gif) ![:cheers:](http://reboot.pro/public/style_emoticons/default/cheers.gif)   \nBoth for how much you know and your clarity you deserve a ![:cheers:](http://reboot.pro/public/style_emoticons/default/cheers.gif) on behalf of everybody. it is a pleasure to speak with people like you.  \n\nOnly word i must add is, if i will implement my commands in a script, i won\u0027t need neither UUID nor \"tag\" files. Anyway thank you, good to know how UUID works. I will then read about password protection....  \nAs for the rest, all that is left for me to do now, is just wait for tinybit to answer my prayers.. ![:cheers:](http://reboot.pro/public/style_emoticons/default/cheers.gif)   \nI don\u0027t know, granted that s/he is disposed to change the grub4dos partnew routine, how much could it take to change it in order to allow only password-protected partnews: anyway i will wait for someone to give me a whistle..   \n"
    },
    {
      "id": "60829",
      "timestamp": "2009-02-27T18:46:07+00:00",
      "author": "was_jaclaz",
      "content": "\u003e Jaclaz... ![:cheers:](http://reboot.pro/public/style_emoticons/default/cheers.gif) ![:cheers:](http://reboot.pro/public/style_emoticons/default/cheers.gif) I LOVE YOU...\n\n@Others  \nUnfortunately NOT translatable to English easily:  \n\n@Luca\u0027s  \n[http://www.mymovies....attute/?id\u003d5318](http://www.mymovies.it/battute/?id\u003d5318 \"External link\")  \n\n\"Signore alla farmacia\"  \n\n![:cheers:](http://reboot.pro/public/style_emoticons/default/cheers.gif)   \n\nHopefully **tinybit** will post something in a few days time... ![:cheers:](http://reboot.pro/public/style_emoticons/default/cheers.gif)   \n\n![:cheers:](http://reboot.pro/public/style_emoticons/default/cheers.gif)  \n\njaclaz   \n"
    },
    {
      "id": "60833",
      "timestamp": "2009-02-27T19:35:04+00:00",
      "author": "Luca\u0027s",
      "content": "\u003e \"Signore alla farmacia\"\n\n![:cheers:](http://reboot.pro/public/style_emoticons/default/cheers.gif)   \n\n\u003e Hopefully tinybit will post something in a few days time...\n\nlet\u0027s hope. anyway, if so, might you please make me know here? thanks a lot.  \n\nsee you...   \n"
    },
    {
      "id": "60847",
      "timestamp": "2009-02-27T22:16:00+00:00",
      "author": "cdob",
      "content": "\u003e If the stick/device was \"properly\" sensed/partitioned with a geometry of nx255x63, the recreated CHS should be identical.\nYes, that\u0027s true.   \nPreviously I made some worst case tests with bad CHS examples to get results.   \nSorry details are lost, did render USB stick.  \n\nNew examples, partitions created with XP diskmanager\\[codebox\\]copy 0 -\\\u003e 3copy 1 -\\\u003e 2Type Boot BCyl BHd BSec ECyl EHd ESec SlartSector NumSectors0B 00 0 - 0 1 1 - 707 254 63 - 63 1137395707 00 0 - 708 1 1 - 982 254 63 - 11374020 4417875emptyemptypartnew (hd0,3) 0x00 (hd0,0)+1partnew (hd0,2) 0x00 (hd0,1)+10B 00 0 - 0 1 1 - 707 254 63 - 63 1137395707 00 0 - 708 1 1 - 982 254 63 - 11374020 441787507 00 0 - 708 1 1 - 982 254 63 - 11374020 44178750C 00 0 - 0 1 1 - 707 254 63 - 63 11373957partnew (hd0,2) 0 0 0partnew (hd0,3) 0 0 00B 00 0 - 0 1 1 - 707 254 63 - 63 1137395707 00 0 - 708 1 1 - 982 254 63 - 11374020 4417875emptyemptypartnew (hd0,2) 0x0B 63 11373957partnew (hd0,3) 0x07 11374020 44178750B 00 0 - 0 1 1 - 707 254 63 - 63 1137395707 00 0 - 708 1 1 - 982 254 63 - 11374020 44178750B 00 0 - 0 1 1 - 707 254 63 - 63 1137395707 00 0 - 708 1 1 - 981 254 63 - 11374020 4417875There are 240 Heads BIOS: Fake entry 2 added manually0B 00 0 - 0 1 1 - 707 254 63 - 63 1137395707 00 0 - 708 1 1 - 982 254 63 - 11374020 441787507 80 0 - 0 1 1 -1023 239 63 - 63 51196257emptypartnew (hd0,3) 0x07 (hd0,2)+10B 00 0 - 0 1 1 - 707 254 63 - 63 1137395707 00 0 - 708 1 1 - 982 254 63 - 11374020 441787507 80 0 - 0 1 1 -1023 239 63 - 63 5119625707 80 0 - 0 1 1 - 981 209 63 - 63 51196257\\[/codebox\\]@Luca\u0027sIn general: different CHS may cause errors. That\u0027s a weak point. This may work today, but cause errors in future at different machines.Creating a new solution: find weak points. Solve the weak points. Or ignore them. But keep them in mind. If there are errors in future, remember them.As for windows installation: I don\u0027t know. This has to be tested.README_GRUB4DOS.txt\\[quote\\]Just like a whole logical partition, a contiguous partition image file canalso be used with PARTNEW: partnew (hd0,3) 0x00 (hd0,0)/my_partition.imgThe type 0x00 indicates a type-auto-detection of the image MY_PARTITION.IMG.The above command will create a new primary partition (hd0,3) with a propertype and with contents/data being exactly that of the contiguous file(hd0,0)/my_partition.img.PARTNEW will automatically correct the \"hidden sectors\" in the BPB and themodification will be permanent. And PARTNEW modifies the partition tablepermanently.\\[/quote\\]This gave another idea: don\u0027t use different partition at USB. Use different image files instead. E.g. add more than four images.I created a floppy like image XP_disk.img. Contents\\[quote\\]$WIN_NT$.\\~BT$WIN_NT$.\\~LSNTDETECT.COMtxtsetup.sif\\[/quote\\]partnew map this image as a partition. XP can be installed from this partition.entry 0 holds partition definition to image fileentry 1 points to whole USB drive: grldr, menu.st and image files\\[code\\]partnew \\\u0026#40;hd0,0\\\u0026#41; 0x00 \\\u0026#40;hd0,1\\\u0026#41;/XP_disk.img\\[/code\\]  \nAs jaclaz pointed already, entry 1 can be fixed. There is no need to change this.  \nChange entry 0 only.  \nThis is a more secure approach: USB drive definition is not changed.   \n"
    },
    {
      "id": "60872",
      "timestamp": "2009-02-28T08:35:40+00:00",
      "author": "was_jaclaz",
      "content": "So, we need **tinybit** to add another parameter / possibility to partnew, allowing to specify \"correct\" geometry on \"stupid\" BIOSes? ![:cheers:](http://reboot.pro/public/style_emoticons/default/cheers.gif)  \n\nOr could this (as long as partition entries are re-calculated/reset at each boot) be considered an advantage:  \n\u003e By re-calculating the CHS from LBA data based on the geometry seen by BIOS, as grub4dos commands do, should actually be an advantage, as long as the initial partition data is \"correct\", i.e. respects non-fractional Cylinder/Head.\n\nI.e. did the stick with the \"weird\" 240 cylinders work/boot on that particular PC? unsure:  \n\nI do like the idea of the XP_disk.img ![:cheers:](http://reboot.pro/public/style_emoticons/default/cheers.gif)   \n\nI guess we can use the usual (hd1) mapping and migrate.inf at it.  \n\nSo, if I get it right we could have:  \n\n* entry 1 \"fixed\" to the Extended Partition (pointing to EPBR of it) switching between visible/invisible\n* entry 0 \"variable\" with partnew \"switching\" from XP_disk.img and actual bootsector of (one of the) Logical Volume(s) inside Extended\n\n\u003cbr /\u003e\n\nA non \"Filter Driver featured\" OS will see just entry 0 (either XP_disk.img or one Logical Volume among the one or more present in the Logical partition)  \nWhen using a \"Filter Driver featured\" OS, one could unhide entry 1, thus being able to acces ALL volumes inside Extended, (optionally blanking entry 0 or leaving it pointing to XP_disk.img)  \n\nVERY, VERY good! ![:cheers:](http://reboot.pro/public/style_emoticons/default/cheers.gif)   \n\n![:cheers:](http://reboot.pro/public/style_emoticons/default/cheers.gif)  \n\njaclaz   \n"
    },
    {
      "id": "60900",
      "timestamp": "2009-02-28T16:48:02+00:00",
      "author": "Luca\u0027s",
      "content": "I don\u0027t understand.  \nAgain, how can i verify that the CHS definition has somehow been altered?  \nI still also don\u0027t understand if, roughly speaking, this CHS **is** a trouble or **not** . What sort of errors may happen in the future? Data not correctly copied to disk? Usb stick burning out? I don\u0027t understand. Sorry to be so ignorant....but you jaclaz and cdob seem not to totally agree on this point.  \n\nAnyway i have some more questions:  \nIf  \n\u003e we could have:  \n\u003e · entry 1 \"fixed\" to the Extended Partition (pointing to EPBR of it) switching between visible/invisible   \n\u003e · entry 0 \"variable\" with partnew \"switching\" from XP_disk.img and actual bootsector of (one of the) Logical Volume(s) inside Extended\nthen could i have also a Vista_disk.img to switch to?  \nWhere would these images stay? On what partition?  \nIf entry 0 is variable, so that i can switch among the images and the  \n\u003e actual bootsector of (one of the) Logical Volume(s) inside Extended\nwhy, here, CHS is not a problem? It seems to me that i would have to overwrite partition table values the same, wouldn\u0027t i?  \n\nI believe that the XP_disk.img way is clever and we could eventually adopt it.  \nBut please can we keep on testing if CHS is actually changed/copied or not? If the work is done correctly, at the moment i don\u0027t see why the \u0027ask tinybit for a partnew enhancement\u0027 way should be abandoned.   \n"
    },
    {
      "id": "60908",
      "timestamp": "2009-02-28T17:56:08+00:00",
      "author": "tinybit",
      "content": "I am sorry to have kept you waiting. No problem for writing to disk by a command in a menu. But how and in what manner we should implement it?  \n\nJaclaz, do you mean only a password-protected entry would be allowed to have special write access to disks?  \n\nShould we allow the write without taking any protection measures?  \n\nFor the time being I cannot deal with the CHS translation issue. I will think it out later.   \n"
    },
    {
      "id": "60926",
      "timestamp": "2009-02-28T19:11:50+00:00",
      "author": "was_jaclaz",
      "content": "@tinybit  \n\nI was thinking about a way to prevent possible malicious use of the partnew (or of the dd) command for deleting partitions or however manage the HD.  \n\nI am guessing ***that*** was the original concern of the coder that limited it\u0027s use to \"direct\" command line entries.  \n\nIf there is a way to allow the use of such \"destructive\" commands also from menu.lst ONLY if the corresponding entry is protected by a password AND the password is NOT \"plain text\", I presume we still have a reasonable safety while allowing \"advanced\" tricks/tweeaks.  \n\nIf someone downloads blindly a disk image containing a bootable grub4dos, in the instructions it is said to use a given password to access the menu.lst and \"have a surprise\", and the \"someone\" is gullible enough to do that before checking in any text editor the contents of menu.lst, I presume that he actually \"deserves\" the \"surprise\" ![:cheers:](http://reboot.pro/public/style_emoticons/default/cheers.gif) .  \n\nNotheless, providing an additional explicit confirmation seems to me only too logic and inobtrusive enough for final user:  \n\u003e grub4dos is about to change permanently contents of MBR of (hdx,y).  \n\u003e Input Y (CAPITAL) to confirm, or press any other key to skip.\n\n@Luca\u0027s  \nThe consequence of an unbalanced CHS/LBA is debatable. ![:cheers:](http://reboot.pro/public/style_emoticons/default/cheers.gif)  \nBIOS of newish machines, when a LBA mapped partition type is detected should ignore completely the CHS values.  \nOn the other hand some older BIOS will use CHS nonetheless, at least for the initial part of booting.  \nSome BIOS have an actual limit to 512 (read 528) Mb in size.  \nSome BIOS may have an 8Gb one.  \nDos 6.22 and earlier, as well as NT 3.51 and probably NT 4.00 ![:cheers:](http://reboot.pro/public/style_emoticons/default/cheers.gif) need CHS data.  \n\nOn the other hand, modern machines will normally \"adopt\" a nx255x63.  \n\nBoth **cdob** \u0027s and my concerns, in these we have a similar approach, are relative to always adopting the most standard possible setup in order to prevent possible problems, though of course and expecially in these debatable issue, we may, at least temporarily, wait for the problem to actually be confirmed by \"field experiments\".  \n\nIn other words, it is a problem, but not right now, a \"vital\" one.  \n\nBTW anything above the 8 Gb will result in \"a suffusion of yellow\" if accessed through CHS, so, and we may soon get there ![:cheers:](http://reboot.pro/public/style_emoticons/default/cheers.gif), it could be convenient to buy a 16 or 32 Gb stick and simply leave first 8 Gb empty! ![:cheers:](http://reboot.pro/public/style_emoticons/default/cheers.gif)  \n\njaclaz   \n"
    },
    {
      "id": "60954",
      "timestamp": "2009-02-28T23:15:31+00:00",
      "author": "cdob",
      "content": "\u003e I.e. did the stick with the \"weird\" 240 cylinders work/boot on that particular PC?\nSorry for the confusion. Actually I report some CHS warnings, not a detailed report.   \nA 240 heads hint [http://www.pcguide.c...izeGB738-c.html](http://www.pcguide.com/ref/hdd/bios/sizeGB738-c.html \"External link\")  \nReal Thinkpad T60 BIOS handle internal hard drives at 240 heads, but USB drives as 255 heads drive.   \nWell does BIOS map CHS or USB firmware?  \n\n@Luca\u0027s  \nE.g. BeeblebroxNT list CHS part.  \nCHS is not copied. A copy may use the same CHS pattern or different one.  \nAs for XP instllation: I still also don\u0027t understand if, roughly speaking, this CHS is a trouble or not.  \nTake this as a warning. Installation may work at some machines and fail at others.  \nOr installation may work at all machines.  \n\nAt current knowledge I don\u0027t trust partnew for DOS and windows based systems.  \nThe possible limitation is DOS or boot sector.  \nLinux booting dosn\u0027t use CHS.  \n\nThe secure work arround:  \nentry 0 holds current XP installation partition definition  \nentry 1 points to whole USB drive  \n\npartnew changes entry 0.   \nentry 1 is fixed. Not to be changed by partnew.  \n\nI maybe wrong / overly precautious now, don\u0027t like to risk data.  \nThis may change in future.  \n\n\u003e then could i have also a Vista_disk.img to switch to?  \n\u003e Where would these images stay? On what partition?\nShure, a Vista_disk.img is possible too.  \nIdea was: there is a entry 1 points to whole USB drive. That\u0027s a primary partition.  \nAll images are at entry 1 partition.  \n\n\u003e why, here, CHS is not a problem?\nThe image used a nx255x63 pattern, partnew created a equal CHS copy.  \nAgain CHS maybe importand or not.  \n\n@tinybit  \nKeep current precautions: Disable partnew and dd from scripts.  \nThis are high risk commands. Disable makes sence.  \n\nBut add antother option   \ndd --force  \npartnew --force  \n--force allows dd and partnew at scripts.  \n\nIf I request --force I my destroy my data.   \nThat\u0027s my fault then.  \n\nIn addition:  \nA partcopy command would be nice  \npartcopy (hd0,0) (hd0,1)  \nCopy hd0,1 entry to (hd0,0)  \nCopy full partition entries, do not validate settings.  \nAgain: disable from script by default. But possible at --force.   \n"
    },
    {
      "id": "60986",
      "timestamp": "2009-03-01T09:58:45+00:00",
      "author": "Luca\u0027s",
      "content": "Okay thanks for all the explanations...  \nWhile waiting for further developments, just two questions in the meantime:  \n\n**@cdob**   \n\u003e E.g. BeeblebroxNT list CHS part.\nmmm, where? what values?  \n\n\u003e CHS is not copied\ndo you evict it from my last screenshot?  \n\n**@jaclaz**   \n\u003e we may, at least temporarily, wait for the problem to actually be confirmed by \"field experiments\"\nyep, i hope so.   \n"
    },
    {
      "id": "60988",
      "timestamp": "2009-03-01T10:17:47+00:00",
      "author": "was_jaclaz",
      "content": "\u003e mmm, where? what values?\n\nTime for you to read my good ol\u0027 page:  \n[http://home.graffiti...B/USBstick.html](http://home.graffiti.net/jaclaz:graffiti.net/Projects/USB/USBstick.html \"External link\")  \n\nCHS is not copied because only LBA is used and CHS is calculated from LBA values with a given geometry.  \n\nYou may also want to re-read my previous post:  \n[http://www.boot-land...?...\u003d7138\\\u0026st\u003d33](http://www.boot-land.net/forums/index.php?showtopic\u003d7138\u0026st\u003d33 \"External link\")  \nand particularly:  \n\u003e You may want to play a bit with this:  \n\u003e [http://www.boot-land...?showtopic\u003d2959](http://www.boot-land.net/forums/?showtopic\u003d2959 \"External link\")\n\n@cdob  \n\u003e The secure work arround:  \n\u003e entry 0 holds current XP installation partition definition  \n\u003e entry 1 points to whole USB drive\nThis ***may*** pose a problem, see the comment to the /SORT command of MBRWIZ:  \n[http://mbrwizard.com/reference.shtml](http://mbrwizard.com/reference.shtml \"External link\")  \n\u003e /Sort - It isn\u0027t uncommon for the partition entries in the MBR to be unsorted after reinstalling Windows or restoring a Ghost or Acronis disk image. This means that the partition order in the MBR won\u0027t match the order on disk. Normally this wasn\u0027t a problem until Windows NT/2K/XP came along with its new boot loader, and the requirement that each partition entry in the boot.ini must point to the actual partition number. This option will sort the entries in the MBR to match their physical order on disk.\nThat\u0027s the reason why I previously theorized using:  \n\u003e So, if I get it right we could have:  \n\u003e\n\u003e * entry 1 \"fixed\" to the Extended Partition (pointing to EPBR of it) switching between visible/invisible\n\u003e * entry 0 \"variable\" with partnew \"switching\" from XP_disk.img and actual bootsector of (one of the) Logical Volume(s) inside Extended\n\u003e\n\u003e \u003cbr /\u003e\n\u003e\nthis way the Sort order should remain valid and we don\u0027t have duplicate entries (that may result in blue screen).  \nOf course Entry 0 could also point to the Primary or ro an image within Primary.  \n\njaclaz   \n"
    },
    {
      "id": "61000",
      "timestamp": "2009-03-01T12:09:58+00:00",
      "author": "tinybit",
      "content": "According to discussion above and also with reference to discussion in the Chinese forum, I feel the disk write restrictions should rescind/cancel utterly(with absolutely no side conditions attached).   \n"
    },
    {
      "id": "61335",
      "timestamp": "2009-03-04T08:33:14+00:00",
      "author": "Luca\u0027s",
      "content": "![:cheers:](http://reboot.pro/public/style_emoticons/default/cheers.gif)   \n\nehm, i don\u0027t want to bother but...just to know...how should i proceed now?  \nwait for a grub4dos development or start testing cdob\u0027s way?  \nplease tell me. thanks.   \n"
    },
    {
      "id": "61339",
      "timestamp": "2009-03-04T09:03:33+00:00",
      "author": "was_jaclaz",
      "content": "[http://download.gna....-2009-03-03.zip](http://download.gna.org/grub4dos/grub4dos-0.4.4-2009-03-03.zip \"External link\")  \n\n\u003e 2009-03-03 fixed memory overflow issue with (rd). **canceled restrictions on some disk write commands.**\n\nTime to start experimenting......  \n\njaclaz   \n"
    },
    {
      "id": "61360",
      "timestamp": "2009-03-04T13:00:15+00:00",
      "author": "Luca\u0027s",
      "content": "Well, first of all thank you tinybit for enhancing grub4dos.  \n\nThere are a few problems though.  \n\nI have overwritten grldr to setups partition, and modified menu.lst as follows:  \n\n```\ncolor black/cyan yellow/cyan\n\ntimeout 30\n\ndefault /default\n\n\n\ntitle find and load NTLDR of Windows NT/2K/XP\n\nPartnew \u0026#40;hd0,3\u0026#41; 0x17 \u0026#40;hd0,0\u0026#41;+1\n\nPartnew \u0026#40;hd0,0\u0026#41; 0x07 \u0026#40;hd0,1\u0026#41;+1\n\nPartnew \u0026#40;hd0,1\u0026#41; 0x17 \u0026#40;hd0,3\u0026#41;+1\n\nPartnew \u0026#40;hd0,3\u0026#41; 0 0 0\n\nfind --set-root uuid \u0026#40;\u0026#41; a7e931de-01a7-11de-abf5-005056c00008\n\nchainloader /ntldr\n\n\n\n\n\ntitle rehide setups partition\n\nPartnew \u0026#40;hd0,3\u0026#41; 0x17 \u0026#40;hd0,0\u0026#41;+1\n\nPartnew \u0026#40;hd0,0\u0026#41; 0x07 \u0026#40;hd0,1\u0026#41;+1\n\nPartnew \u0026#40;hd0,1\u0026#41; 0x17 \u0026#40;hd0,3\u0026#41;+1\n\nPartnew \u0026#40;hd0,3\u0026#41; 0 0 0\n```\n\n\u003cbr /\u003e\n\n(i had found the setups partition uuid with ddlistw.cmd)  \n\nWell it behaves weirdly:  \nfirst of all it shows only the first \u0027title\u0027 choice (the \u0027Rehide setups partition\u0027 choice is not shown).  \nI should be right in argueing what it depends on: it only sees the \u0027title\u0027 entries with commands other than partnew. In fact, when i pressed \u0027e\u0027 to edit the first-title commands, it showed just the final part with find and chainloader. No trace of partnews.  \n\nNonetheless, i have tried to launch the first \u0027title\u0027 choice. Execution of the find command results in an error: it says it cannot find file. so, wrong uuid?  \nAnyway i\u0027m quite sure partnew commands are not seen, for i\u0027ve also checked, within windows, if the first \u0027title\u0027 choice execution produced something: but no change to the partition table at all.  \n\nI don\u0027t know to what all this is due to, but certainly i have to fix it.  \n\n**EDIT:** as per the \u0027uuid\u0027-command results, uuid of the setups partition is 9A4826F44826CEB7. i don\u0027t understand why this discrepancy, anyway, using that value, the find command works.   \n"
    },
    {
      "id": "61400",
      "timestamp": "2009-03-04T18:29:38+00:00",
      "author": "Luca\u0027s",
      "content": "oops. ![:cheers:](http://reboot.pro/public/style_emoticons/default/cheers.gif)   \ni\u0027ve realized that \"lowcasing\" the partnew-command writing, everything works perfectly as desired. ![:cheers:](http://reboot.pro/public/style_emoticons/default/cheers.gif)   \ni didn\u0027t knew the grub4dos syntax parser is case-sensitive. anyway sorry for having been hasty.  \n\nso, next step? do i need to test the stick on legacy machines?   \n"
    },
    {
      "id": "61413",
      "timestamp": "2009-03-04T19:48:33+00:00",
      "author": "was_jaclaz",
      "content": "GOOD. ![:cheers:](http://reboot.pro/public/style_emoticons/default/cheers.gif)  \n\nThe Rule of the Thumb is easy:  \nDONT DO LIKE I\u0027M DOING NOW ![:cheers:](http://reboot.pro/public/style_emoticons/default/cheers.gif), and use only small letters for anything in grub4dos menu.lst (exception made for the text in the title, which of course is completely \"free\") including file and directory names.  \n\nSame thing cannot be done on CD, where filenames/paths are CaSe SeNsItIvE.  \n\nThe uuid grub4dos \"understands\" is the result of issuing the command **uuid** ![:cheers:](http://reboot.pro/public/style_emoticons/default/cheers.gif) when having **root** on a given partition.  \n\nWhat do you mean by \"legacy machines\"? ![:cheers:](http://reboot.pro/public/style_emoticons/default/cheers.gif)  \n\n![:cheers:](http://reboot.pro/public/style_emoticons/default/cheers.gif)  \n\njaclaz   \n"
    },
    {
      "id": "61476",
      "timestamp": "2009-03-05T09:17:29+00:00",
      "author": "Luca\u0027s",
      "content": "Perfect.  \n\n\u003e What do you mean by \"legacy machines\"?\nI mean old machines where CHS definition is used..  \n\nanyway i must say i\u0027m eager: if this solution works, only step left is to populate the multiboot partition (and i imagine it is sufficient to edit the menu.lst created by winsetupfromusb).   \n"
    },
    {
      "id": "61478",
      "timestamp": "2009-03-05T10:08:28+00:00",
      "author": "was_jaclaz",
      "content": "\u003e Perfect.  \n\u003e\n\u003e \u003cbr /\u003e\n\u003e\n\u003e I mean old machines where CHS definition is used..  \n\u003e\n\u003e anyway i must say i\u0027m eager: if this solution works, only step left is to populate the multiboot partition (and i imagine it is sufficient to edit the menu.lst created by winsetupfromusb).\nHmmm, ![:cheers:](http://reboot.pro/public/style_emoticons/default/cheers.gif), it\u0027s not that easy to \"draw a line\" between \"old\" machines that use CHS and \"new\" machines that use LBA, there are also machines that have other limits in BIOS, it\u0027s largely a \"hit and miss\" game.  \n\nAnd yes ![:cheers:](http://reboot.pro/public/style_emoticons/default/cheers.gif), all you have to do is continue experimenting, adding things to the partitions and to menu.lst.  \n\njaclaz   \n"
    },
    {
      "id": "61480",
      "timestamp": "2009-03-05T10:23:22+00:00",
      "author": "Luca\u0027s",
      "content": "ah, okay.  \nso, should we consider the problem solved? ![:cheers:](http://reboot.pro/public/style_emoticons/default/cheers.gif)   \n"
    },
    {
      "id": "61481",
      "timestamp": "2009-03-05T10:38:43+00:00",
      "author": "was_jaclaz",
      "content": "\u003e ah, okay.  \n\u003e so, should we consider the problem solved? ![:cheers:](http://reboot.pro/public/style_emoticons/default/cheers.gif)\n\nThe problem is not \"solved\", it is just very, very improbable that it may happen.  \n\nOnce it will be reported to happen **tinybit** ***may*** have a reason to spend lots of time ![:cheers:](http://reboot.pro/public/style_emoticons/default/cheers.gif) to find a solution to it.  \n\nIf you want to make SURE that you won\u0027t suffer from the problem, simply do not use the partnew command.  \n\nStart experimenting with grub4dos internal \"dd\" command.  \n\nBasically:  \n1) you create a given MBR with all addresses correctly set and tested  \n2) you make a backup of it \"somewhere\" (file or unused hidden sector  \n3) loop to 1) untill you have all the MBR\u0027s versions you need  \n4) instead of partnew you use grub4dos dd to copy back and forth the MBR sector you want to boot with  \n\nThis way \"nothing\" is left to possible \"arbitrary\" assumptions of the partnew address LBA to CHS translation, you simply copy over fixed data you are sure of.  \n\nOr, alternatively, get back to the Freefdisk or MBRWiz approach after having booted DOS.  \n[http://www.boot-land...?...\u003d7138\\\u0026st\u003d28](http://www.boot-land.net/forums/index.php?showtopic\u003d7138\u0026st\u003d28 \"External link\")  \n\nall in all booting DOS on a modern machine will take only a few seconds more than just boting to grub4dos.  \n\n![:cheers:](http://reboot.pro/public/style_emoticons/default/cheers.gif)  \n\njaclaz   \n"
    },
    {
      "id": "61504",
      "timestamp": "2009-03-05T16:45:24+00:00",
      "author": "Luca\u0027s",
      "content": "so, thank you very much for all of your precious help and suggestions. ![:cheers:](http://reboot.pro/public/style_emoticons/default/cheers.gif)   \n\ni will adopt this strategy: to use partnew, and then if i have any problem to report it.  \nanyway i believe i won\u0027t need to.  \nthank you again.   \n"
    },
    {
      "id": "61505",
      "timestamp": "2009-03-05T17:06:05+00:00",
      "author": "was_jaclaz",
      "content": "Only too happy to have been of help. ![:cheers:](http://reboot.pro/public/style_emoticons/default/cheers.gif)  \n\nToo bad I couldn\u0027t trick you ![:cheers:](http://reboot.pro/public/style_emoticons/default/cheers.gif) into doing some more experiments. ![:cheers:](http://reboot.pro/public/style_emoticons/default/cheers.gif)  \n\nWe\u0027ll have to wait for some other people volunteering.....![:cheers:](http://reboot.pro/public/style_emoticons/default/cheers.gif)  \n\njaclaz   \n"
    },
    {
      "id": "61516",
      "timestamp": "2009-03-05T19:09:36+00:00",
      "author": "Luca\u0027s",
      "content": "what do you want to test?  \ni could do with another stick: it\u0027s only 1gb but for experiments it could fit....  \nif we begin to test, well, just one reservation: i will be here once in a while (or anyway less than before). my web connection bill is not so cheap, as things are ![:cheers:](http://reboot.pro/public/style_emoticons/default/cheers.gif)   \n"
    },
    {
      "id": "61520",
      "timestamp": "2009-03-05T19:47:40+00:00",
      "author": "was_jaclaz",
      "content": "No prob. ![:cheers:](http://reboot.pro/public/style_emoticons/default/cheers.gif)  \n\nWe are here for fun, one of the main Rules of the Board is #12 ![:cheers:](http://reboot.pro/public/style_emoticons/default/cheers.gif) , and there is the unwritten one that \"real\" life has ALWAYS preedence over \"online\" one.  \n\n\u003cbr /\u003e\n\n\u003e what do you want to test?\nCheck whether the dd command can be used to swap MBR\u0027s between real one and copies of them, if it takes noticeably more time, and the like.  \n\n\u003cbr /\u003e\n\n\u003cbr /\u003e\n\ni.e. something along the lines of:  \n\n```\ntitle backup current MBR to sector 62\n\ndd if\u003d\u0026#40;hd0\u0026#41; of\u003d\u0026#40;hd0\u0026#41; bs\u003d512 count\u003d1 skip\u003d0 seek\u003d61\n\n\n\n\n\ntitle find and load NTLDR of Windows NT/2K/XP\n\nPartnew \u0026#40;hd0,3\u0026#41; 0x17 \u0026#40;hd0,0\u0026#41;+1\n\nPartnew \u0026#40;hd0,0\u0026#41; 0x07 \u0026#40;hd0,1\u0026#41;+1\n\nPartnew \u0026#40;hd0,1\u0026#41; 0x17 \u0026#40;hd0,3\u0026#41;+1\n\nPartnew \u0026#40;hd0,3\u0026#41; 0 0 0\n\nfind --set-root uuid \u0026#40;\u0026#41; a7e931de-01a7-11de-abf5-005056c00008\n\nchainloader /ntldr\n\n\n\ntitle restore backed up MBR from sector 62\n\ndd if\u003d\u0026#40;hd0\u0026#41; of\u003d\u0026#40;hd0\u0026#41; bs\u003d512 count\u003d1 skip\u003d61 seek\u003d0\n```\n\n\u003cbr /\u003e\n\njaclaz   \n"
    },
    {
      "id": "61581",
      "timestamp": "2009-03-06T13:26:34+00:00",
      "author": "Luca\u0027s",
      "content": "So.  \nSituation is the same as before:  \n\nFirst partition: setups  \nSecond: data  \nThird: truecrypt  \n\nOnly differences are in the stick\u0027s disk-space, and in the fact that this time i didn\u0027t hide the truecrypt partition.  \nHere is a screenshot how the partition table looked like the very first time i created the partitions (with disk management):  \n[![beeblebrox.jpg](http://reboot.pro/uploads/monthly_03_2009/post-15106-1236345921_thumb.jpg)](http://reboot.pro/uploads/monthly_03_2009/post-15106-1236345921.jpg \"beeblebrox.jpg - Size: 26.98KB\"){#ipb-attach-url-7790-0-45908200-1676066545}   \nSetups is 200mb  \nData is 700mb  \nTruecrypt is 60mb.  \n\nRun first \u0027title\u0027 entry, then run second \u0027title\u0027 entry: main result is partitions order successfully changed (checked within windows).  \nRun third \u0027title\u0027 entry: result is MBR restored (checked within windows).  \nIt works 100% and it is at least as fast as the other method. Excellent. ![:cheers:](http://reboot.pro/public/style_emoticons/default/cheers.gif)   \nDo you mean this method also copies the CHS definition? If so, i think i will shift to it.  \n\nI don\u0027t understand though: why the 62nd sector and not, for example, the 63rd? And: couldn\u0027t it be overwritten by chance by some disk writing operation?  \n\nWe have not tried cdob\u0027s way anyway. I would have liked to experience what differs in the partition table between primary and logical partitions, and what method is used by logical partitions to address the disk sectors (LBA, CHS, and so on)...   \n"
    },
    {
      "id": "61584",
      "timestamp": "2009-03-06T14:08:00+00:00",
      "author": "was_jaclaz",
      "content": "Thanks for testing and reporting. ![:cheers:](http://reboot.pro/public/style_emoticons/default/cheers.gif)  \n\nYes, no problems with CHS, this method copies the WHOLE MBR, as-is. (of course if the CHS in the original MBR is wrong.....![:cheers:](http://reboot.pro/public/style_emoticons/default/cheers.gif))  \n\nOn a normal HD, first Head is 63 sectors.  \n\nNormally, 1st sector contains the MBR. (sector 1)  \n\nWhen grub4dos is installed to the MBR (grldr.mbr), it occupies a certain number of the first hidden sectors, in current release, the first 18. (older release are more \"compact\" if I am not mistaken)  \n\ngrldr.mbr provides an empty sector (sector 2) to hold a copy of the original MBR.  \n\nSee grub4dosreadme:  \n\u003e Optionally, if the MBR in the hard disk is a single sector MBR created by  \n\u003e Microsoft FDISK, it may be copied onto the second sector of GRLDR.MBR.  \n\u003e\n\u003e The second sector of GRLDR.MBR is called \"previous MBR\". When GRLDR not found,  \n\u003e \"previous MBR\" will be started.\n\nIf I am not mistaken, you need a total of 3 \"exchangeable\" MBR\u0027s, thus I thought that it could be suitable to:  \n- backup \"base\" MBR to sector 2 (as per default)  \n- backup \"1st changed\" MBR to sector 62  \n- backup \"2nd changed\" MBR to sector 63  \n\nThis way if in future grldr.mbr \"expands\", the settings remain valid until it becomes 30.5 Kbytes (61 sectors).  \n\nWriting to the 62nd sector was just to test with one of the \"set in my mind\" available addresses.  \n\nAs my ***personal*** view on the matter, of the 63 hidden sectors, 1st should be occupied by a \"conventional\" MBR and the other 62 should be empty. ![:cheers:](http://reboot.pro/public/style_emoticons/default/cheers.gif)   \n\nThis is being ***OVER**cautious* , but there are some programs, mainly partition managers like Partition Magic and Acronis products (did I say how I don\u0027t trust them fully? ![:cheers:](http://reboot.pro/public/style_emoticons/default/cheers.gif)) and a number of very old DOS Commercial programs that use the hidden sectors to \"authenticate\" themselves.  \n\nOnce you decide to \"forfait\" the \"rigorous\", \"integralist\" if you prefer, usage of the hidden sectors to allow for grub4dos grldr.mbr, I guess you can also use a couple more sectors to store the backups of the MBR. ![:cheers:](http://reboot.pro/public/style_emoticons/default/cheers.gif)  \n\nYou can also use a \"normal\" file in a partition (512 bytes in size - that you MUST create BEFORE using the grub4dos dd command) as \"storage\", but maybe it\u0027s even more prone to be overwritten/deleted by mistake. ![:cheers:](http://reboot.pro/public/style_emoticons/default/cheers.gif)  \n\n\u003cbr /\u003e\n\nYou shouldn\u0027t have any problem in testing **cdob** \u0027s way with an XP image.  \nThe image must be NOT containing a MBR.  \nYou can creatre/mount format one with IMDISK:  \n[http://www.boot-land...hp?showforum\u003d59](http://www.boot-land.net/forums/index.php?showforum\u003d59 \"External link\")  \n[http://www.ltr-data.se/opencode.html](http://www.ltr-data.se/opencode.html \"External link\")  \n\nMy idea with extended partition and volumes in it, was simply because since the address in the MBR to the Extended Partition points to the EPBR and not to actual Volumes inside it, ***maybe*** when booting XP won\u0027t see the (fake-primary) entry 0 created by partnew as a duplicate of the one in the various EPBR\u0027s:  \n[http://www.boot-land...?...\u003d7138\\\u0026st\u003d33](http://www.boot-land.net/forums/index.php?showtopic\u003d7138\u0026st\u003d33 \"External link\")  \n\nI guess that it can be now considered irrelevant/unuseful in your case, though it may have some merits for some other use. ![:cheers:](http://reboot.pro/public/style_emoticons/default/cheers.gif)   \n\nPersonally I see the last tested approach (backing up and restoring the whole MBR) as the \"safest\".  \n\n![:cheers:](http://reboot.pro/public/style_emoticons/default/cheers.gif)  \n\njaclaz   \n"
    },
    {
      "id": "61660",
      "timestamp": "2009-03-07T14:07:44+00:00",
      "author": "Luca\u0027s",
      "content": "\u003e it occupies a certain number of the first hidden sectors, in current release, the first 18.\nmm, during my experiments i have seen it\u0027s actually around 15/16.  \nanyway, i agree with all that you said. no urgent need to experiment the cdob\u0027s way too.  \n\nlet me say i have now tested the whole thing following the MBR backup way.  \ni have modified some details: data is the first partition, there is no choice to backup the MBR in menu.lst (only to restore it, since i had already backed it up to sector 62 with hdhacker), and i have added a choice just for the partnew commands to exchange the partition table entries. The core is the same though. And it works.  \nI am perfectly satisfied now, and i feel i could write a how-to guide.  \nEven if, to be honest: how can i locate in the first sector of the disk the hex part where the LBA and CHS values are saved?  \nthanks once again ![:cheers:](http://reboot.pro/public/style_emoticons/default/cheers.gif)   \n"
    },
    {
      "id": "61669",
      "timestamp": "2009-03-07T16:39:36+00:00",
      "author": "was_jaclaz",
      "content": "\u003e Even if, to be honest: how can i locate in the first sector of the disk the hex part where the LBA and CHS values are saved?  \n\u003e thanks once again ![:cheers:](http://reboot.pro/public/style_emoticons/default/cheers.gif)\n\nHmmm ![:cheers:](http://reboot.pro/public/style_emoticons/default/cheers.gif)  \n\nSearching/reading? ![:cheers:](http://reboot.pro/public/style_emoticons/default/cheers.gif)  \n[http://thestarman.pc.../mbr/index.html](http://thestarman.pcministry.com/asm/mbr/index.html \"External link\")  \n[http://thestarman.pc...br/Win2kmbr.htm](http://thestarman.pcministry.com/asm/mbr/Win2kmbr.htm \"External link\")  \n[http://thestarman.pc...in2kmbr.htm#CHS](http://thestarman.pcministry.com/asm/mbr/Win2kmbr.htm#CHS \"External link\")  \n\n[http://www.boot-land...?showtopic\u003d2959](http://www.boot-land.net/forums/?showtopic\u003d2959 \"External link\")  \n[http://www.boot-land...topic\u003d2959\\\u0026st\u003d2](http://www.boot-land.net/forums/?showtopic\u003d2959\u0026st\u003d2 \"External link\")  \n[http://home.att.net/...ot/w98b_mbr.htm](http://home.att.net/~rayknights/pc_boot/w98b_mbr.htm \"External link\")  \n[http://home.att.net/....htm#TblEntries](http://home.att.net/~rayknights/pc_boot/w98b_mbr.htm#TblEntries \"External link\")  \n\n[http://en.wikipedia....ter_boot_record](http://en.wikipedia.org/wiki/Master_boot_record \"External link\")  \n\n\u003cbr /\u003e\n\nUsing a Hex Editor that allows the use of templates? ![:cheers:](http://reboot.pro/public/style_emoticons/default/cheers.gif)  \n(most Commercial ones will have this feature)  \n\n[http://en.wikipedia....iki/Disk_editor](http://en.wikipedia.org/wiki/Disk_editor \"External link\")  \n\nFreeware:  \n[http://apps.tempel.org/iBored/](http://apps.tempel.org/iBored/ \"External link\")  \n\n\u003cbr /\u003e\n\nFreeware, but you will need to write a Template or Structure Viewer for MBR:  \n[http://www.hhdsoftwa...ditor-free.html](http://www.hhdsoftware.com/Products/home/hex-editor-free.html \"External link\")  \n[http://www.kibria.de/frhed.html](http://www.kibria.de/frhed.html \"External link\")  \n\nTiny Hexer (recommended ![:cheers:](http://reboot.pro/public/style_emoticons/default/cheers.gif)), here:  \n[http://www.mirkes.de/files/](http://www.mirkes.de/files/ \"External link\")  \n[http://www.mirkes.de/files/mpth_18.exe](http://www.mirkes.de/files/mpth_18.exe \"External link\")  \n\n(it already has Structure viewer for FAT16,32 and NTFS bootsectors, but not for MBR, it should not be difficult to write a decent template for MBR)  \n\n![:cheers:](http://reboot.pro/public/style_emoticons/default/cheers.gif)  \n\njaclaz   \n"
    },
    {
      "id": "90620",
      "timestamp": "2010-02-06T14:41:59+00:00",
      "author": "Zoso",
      "content": "wow! great thread. I need to read it ten more times. reminds me why I had to take a break from Boot-land.  \n\nI was loosing lots of sleep from reading all night every night combined with TMIS (Too Much Information Syndrom)  \n\nhey Luca\u0027s, about that how-to guide..   \n"
    },
    {
      "id": "90630",
      "timestamp": "2010-02-06T17:12:48+00:00",
      "author": "Luca\u0027s",
      "content": "\u003e hey Luca\u0027s, about that how-to guide..\n\n\u003cbr /\u003e\n\nwell...i wrote \u0027i could\u0027 for i knew i would had put no guide down in the near future. i know myself too bad LOL  \nwell, i have an iso image saved. but the language of the OS to be installed is italian, so it would be of no use.  \n\ni can\u0027t write a guide now.  \ni have not time.  \nmaybe after my exams. see you!   \n"
    },
    {
      "id": "169660",
      "timestamp": "2013-03-18T23:38:53+00:00",
      "author": "Motasem",
      "content": "great thread ![:thumbsup:](http://reboot.pro/public/style_emoticons/default/thumbsup.gif)\n\n"
    }
  ]
}