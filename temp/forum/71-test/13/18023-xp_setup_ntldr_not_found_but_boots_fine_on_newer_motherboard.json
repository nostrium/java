{
  "id": "18023",
  "title": "xp setup: ntldr not found, but boots fine on newer motherboard",
  "isPinned": false,
  "isFirstTopic": false,
  "isLocked": false,
  "tags": [],
  "forumNotes": [
    {
      "id": "166082",
      "timestamp": "2013-01-17T22:59:44+00:00",
      "author": "Fiction",
      "content": "This is basically a followup of this topic: [http://reboot.pro/to...ny-suggestions/](http://reboot.pro/topic/17968-odd-behaviour-from-an-old-pc-any-suggestions/ \"\")\n\nBut here I\u0027ll try to ask a more specific question. I\u0027ll do this in a different topic, because the question is slightly different and because the question I asked there was answered.\n\nThis is what I did:\n\n1 I used the HPformat tool (HPUSBFW.exe) to create a bootable dos usb flashdrive.\n\n2 I copied the following files to the flashdrive:\n\nCDROM\\\\OAKCDROM.SYS\n\nCONFIG.SYS\n\nEMM386.EXE\n\nHIMEM.SYS\n\nsmartdrv.exe\n\n3 I copied the I386 folder from a windows install cd to the flashdrive\n\n4 I boot the flashdrive\n\n5 started smartdrv and after that the I386\\\\winnt.exe and continued the dos part of the installation.\n\nThe next part (txtsetup) from the installation booted fine on the motherboard of my sony vaio VPCW21S1E,\n\nbut trying to boot this on asus a7v8x-mx motherboard I get a \u0027NTLDR is missing\u0027 message\n\nI did this to debug the boot process. I will repeat this: I am NOT trying to make a functional setup USB in this fashion. In the previous topic Sha0 told me the setup would probably not work unless forcing the drivers to load in an early stage, so I am aware of this. I just want to know where this difference comes from.\n\nNormally I would use Novicorp WinToFlash (it basically does the same thing WINNT.EXE does, but perhaps it does fix the possible driver issue as well). I noticed it would not work with the asus motherboard on the default FAT32 LBA setting. It only worked with this asus motherboard when I set the program to format the drive FAT16 LBA.\n\nIn the previous topic I thought the FAT16 option worked because the partition would then automatically be smaller then 2GB. I was thinking of a capacity limitation, but if you read the previous discussion, you will see we ruled this out.\n\nNow after some googling I found this: [http://wintoflash.co...0\\\u0026t\u003d32\\\u0026start\u003d0.](http://wintoflash.com/forum/viewtopic.php?f\u003d10\u0026t\u003d32\u0026start\u003d0. \"External link\")\n\n\u003e NTLDR is missing message mean the partition boot record can\u0027t find NTLRD file on partition. May be FAT16 may help to fix this - FAT16 partition boot record is smaller and more simple...\n\nDoes anyone here know why this motherboard will only load the xp txtsetup when using FAT16, while dos boots perfectly from FAT32?\n\nDo you think I will be possible to make a bookable flash drive, containting a xp setup with a size of more then 2GB? It really annoys me that I need to throw away most of the flashdrive\u0027s capacity, so I can use it on all op my computers independent of specs.\n\n\\*edit\\* added some extra details, to be more specific and avoid confusion.\n\n**Edited by Fiction, 17 January 2013 - 11:07 PM.**\n"
    },
    {
      "id": "166083",
      "timestamp": "2013-01-17T23:12:04+00:00",
      "author": "steve6375",
      "content": "Try different formats using RMPrepUSB and selecting FreeDOS\n\n1. FAT16 2GB FreeDOS (no overrides) , 5 Freedos folder\n\n2. AS above but add Boot as Hdd (2PTNs) override\n\n3. FAT32 FreeDOS (no overrides) , 5 Freedos folder\n\n4. as 3 but add Boot as Hdd (2PTNs) override\n\nReport back after trying all of these on all systems.\n\n"
    },
    {
      "id": "166087",
      "timestamp": "2013-01-18T01:03:57+00:00",
      "author": "ilko",
      "content": "Have you tried WinSetupFromUSB and the auto-format option, which uses[FBInst](http://reboot.pro/topic/7932-create-universal-flash-boot-disk-with-fbinst/ \"\"), which is considered quite suitable for picky BIOS-es?\n\nTry [1.0 beta8](http://code.google.com/p/winsetupfromusb/downloads/detail?name\u003dWin%20Setup_1_0_beta8.7z \"External link\"), use auto-format option, use NTFS or the other file systems and options presented if need to.\n\nIf you are into testing bootability only, you don\u0027t have to select any other options in the program.\n\nThis way you will end up with USB stick partitioned and formatted by FBInst in its special way, an option upon boot whether to continue to Grub4dos or launch PLoP boot manager, and if nothing was selected you will get to grub4dos command prompt.\n\nPLoP is also a good option to try on picky motherboards, should you be able to start it.\n\nAlternatively, there is FBInstTool, which also uses FBInst internally, but it could be a bit trickier for you to get going.\n\n[http://code.google.c...-2012-12-21.zip](http://code.google.com/p/winsetupfromusb/downloads/detail?name\u003dFbinstTool-2012-12-21.zip \"External link\")\n\n[http://bbs.wuyou.com....php?tid\u003d189221](http://bbs.wuyou.com/viewthread.php?tid\u003d189221 \"External link\")\n\n"
    },
    {
      "id": "166127",
      "timestamp": "2013-01-18T17:25:12+00:00",
      "author": "Wonko the Sane",
      "content": "You are likely to be hitting a whole range of issues this way.\n\nThat approach (you are perfectly free to take for good my word for it or completely ignore it, of course) makes very little sense as a \"debug method\".\n\nOf ALL the available methods to partition a USB stick, as you were already told, BTW, the HP USB Format utility is NOT the one to use (as we have better tools and more \"granular\" control of what happens):\n\n[http://reboot.pro/to...tions/?p\u003d165830](http://reboot.pro/topic/17968-odd-behaviour-from-an-old-pc-any-suggestions/?p\u003d165830 \"\")\n\nSo I will have to ask:\n\nWHAT EXACTLY is your GOAL? ![:unsure:](http://reboot.pro/public/style_emoticons/default/unsure.png)\n\nIf it is to actually install the XP to a given machine, then use this one (tested, very similar to the one you are now testing, but fully working) WINNT.EXE based approach:\n\n[http://www.911cd.net...topic\u003d16713\\\u0026hl\u003d](http://www.911cd.net/forums//index.php?showtopic\u003d16713\u0026hl\u003d \"External link\")\n\nOtherwise, do the following:\n\nRight after the running of HPUSBFW.exe copy to the root of the stick:\n\n* NTLDR\n* BOOT.INI (\\*any\\* boot.ini will do, if needed it will be edited later)\n* NTDETECT.COM\n* grub.exe and grldr \\\u003c- get these from last \"featured\" build on chenall\u0027s page: [http://code.google.c.../downloads/list](http://code.google.com/p/grub4dos-chenall/downloads/list \"External link\")\n\nthen copy the other DOS files you mentioned\n\nEdit BOOT.INI and add to it a line like : C:\\\\grldr\u003d\"grub4dos\"\n\nBoot the stick (to DOS) and on command line run grub.exe\n\nAt the command prompt enter:\n\n```\n\n\n\n\n\nchainloader /ntldr\nboot\n```\n\nTry selecting the grub4dos entry in boot.ini.\n\nAt the grub4dos command prompt enter:\n\n```\n\n\n\n\n\nchainloader /io.sys\n boot\n```\n\nIf everything works as expected you will be back to DOS.\n\nThis time you will have a bootable stick that besides DOS contains grub4dos that can be used to inspect the contents of the source and target disk/exchange disks/do more things like checking geometries and what not (i.e. putting you in a condition to actually \"debug\" something).\n\nAbout BIOS limitations and FAT16, 32 etc, read the USB FAQ #10 here:\n\n[http://jaclaz.alterv...SB/USBfaqs.html](http://jaclaz.altervista.org/Projects/USB/USBfaqs.html \"External link\")\n\nAND read here:\n\n[http://www.911cd.net...showtopic\u003d24395](http://www.911cd.net/forums//index.php?showtopic\u003d24395 \"External link\")\n\nwhy exactly the HPUSBFW utility is NOT advised (and ++incidentally++ ![:w00t:](http://reboot.pro/public/style_emoticons/default/w00t.gif) the EXACT answer - most probably - to your EXACT issue related to an Asus BIOS :wink: or however a related report and a working \"debug/test\" method/tool)\n\n![:cheers:](http://reboot.pro/public/style_emoticons/default/cheers.gif)\n\nWonko\n\n"
    },
    {
      "id": "166137",
      "timestamp": "2013-01-19T00:20:29+00:00",
      "author": "Fiction",
      "content": "@steve6375\n\nI would like to try your approach first. However, do you want me to just test if I can boot into freedos or do you want me to run winnt as well?\n\nsmartdrv does not work with freedos, or so it seems, therefore it takes ages for winnt.exe to complete. It is the NTLDR boot-loader that is of interest here, since the noted behaviour only applied to this loader. See below for more details.\n\n@ilko\n\nThat looks promising, I might have a look into it, but for now I am curious about steve6375\u0027s idea.\n\n@Wonko the Sane\n\nAh, we meet again :tongue:\n\nI hoped I was being clear and specific enough this time, but it appears my intentions are still vague.\n\nI\u0027ll try to explain the \u0027goal\u0027 a bit better. See below.\n\nA few days back I used Novicorp WinToFlash to transfer a xp installation source onto a usb drive and noticed it would boot just fine on my sony notebook, but would not work on the asus mobo pc.\n\nSo now, there are actually 2 goals:\n\n1 learn something about motherboard specificness when booting: why this difference?\n\n2 get the asus mobo computer to boot into a windows xp usb drive with a partition larger then 2GB, unless I know for sure this is not possible.\n\nLike I said in the intro: the asus mobo boots dos just fine, both FAT16 (2GIB) and FAT32 (max size), I then ran smartdrv to reduce install time and ran winnt.exe.\n\nBoth computers started winnt.exe just fine, but when it completed it asked to reboot, in order to boot the new NTLDR it installed. This is where the difference gets noticed: the sony pc boots the NTLDR just fine, but the ASUS mobo pc would only boot from it when formatting the partition as FAT16. At first I thought using FAT16 worked just because after formatting FAT16 the partition would be smaller then 2GiB. However in the previous topic we excluded the possibility of a partition size limitation being involved.  \n\nNow in my first post of this new thread, you could read why I\u0027m now thinking the FAT16/32 difference has something to do with it: according to the WinToFlash treat a FAT16 MBR is smaller and less complex.\n\nIt is still weird however, FAT32 boots to dos just fine, but booting the NTLDR fails when using FAT32 on the asus mobo pc.\n\n"
    },
    {
      "id": "166139",
      "timestamp": "2013-01-19T01:28:31+00:00",
      "author": "steve6375",
      "content": "\u003e Both computers started winnt.exe just fine, but when it completed it asked to reboot, in order to boot the new NTLDR it installed. This is where the difference gets noticed: the sony pc boots the NTLDR just fine, but the ASUS mobo pc would only boot from it when formatting the partition as FAT16.\n\nDo you mean that after winnt.exe and reboot, you are rebooting**from the internal hard disk** - and it is at this point you get the \u0027cannot find ntldr\u0027 message?\n\nWhat do you format the internal HDD as (FAT32, NTFS) and is this done manually or do you have a winnt.sif or some other automation method?\n\n"
    },
    {
      "id": "166150",
      "timestamp": "2013-01-19T11:48:23+00:00",
      "author": "Wonko the Sane",
      "content": "\u003e Now in my first post of this new thread, you could read why I\u0027m now thinking the FAT16/32 difference has something to do with it: according to the WinToFlash treat a FAT16 MBR is smaller and less complex.  \n\u003e It is still weird however, FAT32 boots to dos just fine, but booting the NTLDR fails when using FAT32 on the asus mobo pc.\nWell, what you still seem to miss is that - as posted - this is one of the most known issues, and it most probably has to do with disk geometry, conflicting CHS/LBA or possibly a specific quirk of that Asus BIOS.  \n\nDo take some time reading the given links, BOTH the possible \"causes\" and hopefully some \"remedies\" are provided in them.  \n\nAs well, the thread on 911CD should give you an idea of what to check and how, right now your \"useful for debug\" setup (with no offence whatsoever intended :smile:) is simply not \"good enough\" to provide you meaningful \"debug\" details.  \n\nDo prepare the stick as suggested and try using it, with the sequence of operations that you provided.  \n\nIn theory the USB stick gets drive letter C: and the partition on the internal hard disk will get drive letter D:.  \nThen, when you install through WINNT.EXE the C: wiil be \"boot\" volume (what MS calls the other way round \"System\") and D: will be \"system\" volume (what MS calls the other way round \"boot\"), consequently the NTLDR will be copied to C: and not to D:.  \nSee also (only seemingly unrelated):  \n[http://www.multiboot....uk/system.html](http://www.multibooters.co.uk/system.html \"External link\")  \n\nIt is possible that this does not happen on the Sony motherboard (which will mark the Sony as \"queer\" BIOS) but it does on the Asus one (in which case the Asus BIOS is \"normal\"), but I suspect that you are rebooting with the stick still attached, in which case the Asus \"smart\" geometry guess coupled with the UNbalanced partitioning the HP USB tool makes will play a role in it (and be the actual cause).  \nSince you did not provide enough details, I cannot say more.  \n\n\u003cbr /\u003e\n\n![:cheers:](http://reboot.pro/public/style_emoticons/default/cheers.gif)  \nWonko   \n"
    },
    {
      "id": "166152",
      "timestamp": "2013-01-19T13:08:10+00:00",
      "author": "Fiction",
      "content": "Perhaps I\u0027m still not being specific enough.\n\nRight now we are not doing anything with the internal drive. The winnt.exe copies the temporary files to the usb device and replaced the dos boot-loader (on the flash drive!) with the NTLDR bootloader. The internal drive is only accessed during the txtsetup phase, where we are presented with the option to repartition and select a partition on which to install xp. There does not seem to be any difference in content when the winnt.exe ran on the asus mobo or on the sony one. In both cases there actually is a NTLDR file on de flashdrive. However on the asus mobo the NTLDR simply wont load for some reason.\n\nIf I run the WINNT.exe on the asus mobo, it will boot just fine on the sony mobo when finished, but the asus mobo will tell me that \u0027NTLDR is not found\u0027. But I know it is on the flash drive when this error is being displayed.\n\nThis, however, does not happen when I used FAT16. I think there is something wrong with the way the asus mobo is interpreting the FAT32 MBR. But for some reason this is not a problem when booting dos. Because of this, I thought that maybe hexediting the MBR (after winnt.exe is finished) would make it bootable on the asus mobo, but my knowledge of assembly is limited and I would not know where to start.\n\nI hope the behaviour is more clear to you guys now.\n\nI will read the links, but first I\u0027d like to be sure we understand each other, to avoid reading long pages of content I might not be interested in.\n\n"
    },
    {
      "id": "166155",
      "timestamp": "2013-01-19T14:43:22+00:00",
      "author": "steve6375",
      "content": "So are you saying that the same USB stick, formatted to 1.8GB as FAT16 works, but when formatted as FAT32 and 1.8GB does not boot on the Asus?\n\n"
    },
    {
      "id": "166160",
      "timestamp": "2013-01-19T15:17:39+00:00",
      "author": "steve6375",
      "content": "Experiment\n\n1. Ensure the BIOS on the Asus is set to boot from USB HDD and not USB-ZIP\n\n2.Take your FAT32 pen which does not boot on the Asus but does boot on the Sony, install grub4dos onto it (e.g. use RMPrepUSB or grubinst and add grldr), boot it and go to grub4dos console (type c) - then type **blocklist /ntldr** - and also **geometry** what result do you get? Try on both systems and for FAT16 and FAT32.\n\nP.S. Did you try formatting as FAT32 on the Asus, copying the files, rebooting on the Asus to do the first phase, and then rebooting on Asus for the 2nd phase.?\n\nP.P.S. You can view head and sector parameters of MBR and PBR by using RMPrepUSB **Drive_Info** (use 0 for MBR and P1 for PBR).\n\n"
    },
    {
      "id": "166163",
      "timestamp": "2013-01-19T16:01:10+00:00",
      "author": "Wonko the Sane",
      "content": "\u003e I will read the links, but first I\u0027d like to be sure we understand each other, to avoid reading long pages of content I might not be interested in.\n\nWell, no. ![:(](http://reboot.pro/public/style_emoticons/default/sad.png)\n\u003e So now, there are actually 2 goals:  \n\u003e 1 **learn** something about motherboard specificness when booting: why this difference?  \n\u003e 2 get the asus mobo computer to boot into a windows xp usb drive with a partition larger then 2GB, unless I know for sure this is not possible.\n\n\u003cbr /\u003e\n\nYou are coming here asking for support and saying that you want to **learn** , if you choose the **RED** pill, there is a price for it. (and rabbit holes may be deeper than what you might think)  \n\nRest assured that by reading attentively the given links you will not only learn something USEFUL, you will also understand WHY exactly that is happening, how to verify WHAT is happening AND HOW to solve the issue (which BTW is partially due to the wrong choice you made for the USB partitioning/formatting tool).\n\nAnd these are not \"long pages\":\n\u003e About BIOS limitations and FAT16, 32 etc, read the USB FAQ #10 here:\n\u003e\n\u003e [http://jaclaz.alterv...SB/USBfaqs.html](http://jaclaz.altervista.org/Projects/USB/USBfaqs.html \"External link\")\n\u003e\n\u003e AND read here:\n\u003e\n\u003e [http://www.911cd.net...showtopic\u003d24395](http://www.911cd.net/forums//index.php?showtopic\u003d24395 \"External link\")\n\u003e\n\u003e why exactly the HPUSBFW utility is NOT advised (and ++incidentally++ ![:w00t:](http://reboot.pro/public/style_emoticons/default/w00t.gif) the EXACT answer - most probably - to your EXACT issue related to an Asus BIOS :wink: or however a related report and a working \"debug/test\" method/tool)\n\nthey are a single FAQ/FGA and a single thread, made of 14 (fourteen) posts of which only the first 12 (twelve) are actually relevant (and they are VERY relevant) to your issue.\n\n\u003cbr /\u003e\n\n\u003cbr /\u003e\n\n![:cheers:](http://reboot.pro/public/style_emoticons/default/cheers.gif)  \nWonko\n\n"
    },
    {
      "id": "166164",
      "timestamp": "2013-01-19T16:32:00+00:00",
      "author": "Fiction",
      "content": "Ok, I am sorry if I sounded a little lazy. I just wanted to make sure you guys understand the fact that winnt.exe only effects the flashdrive itself, not the internal disk. (As far as I can tell.)\n\nYou are, of course, completely correct: I\u0027ll take that darn red pill :tongue:. I\u0027ll read all of it. After that I\u0027ll report back.\n\n"
    },
    {
      "id": "166179",
      "timestamp": "2013-01-19T19:37:25+00:00",
      "author": "Fiction",
      "content": "Ok, apparently I waited for to long and my edit button disappeared. Sorry for the double post.\n\n@Wonko\n\nI am terribly sorry. I thought you where not understanding me correctly but in fact you were spot on. This 911cd topic is indeed about a similar problem.\n\nFirst I read [http://jaclaz.alterv...SB/USBfaqs.html](http://jaclaz.altervista.org/Projects/USB/USBfaqs.html \"External link\")\n\nthe FAQ seems for the most part focused on booting a xp INSTALL from usb and why this is not possible. Note however that\n\nI just want to boot the setup, not xp itself.\n\nFAQ #10 seemed more usefull but very empiric. It basically states \u0027if it does not work in a certain way, try a different\n\none\u0027. It lists a lot of possible \u0027variations\u0027 to try, but I\u0027m not sure whether I am dealing with any of these.\n\nThen I started reading the [http://www.911cd.net...showtopic\u003d24395](http://www.911cd.net/forums//index.php?showtopic\u003d24395 \"External link\")\n\nI noticed directly that my knowledge of assembly is not \u0027limited\u0027 but nearly 0. That\u0027s probably why I disliked reading it at first (I did already read that FAQ).\n\nI did not understand all of this, but let\u0027s see what I did understand.\n\nOne of the first links in the thread is: [http://blog.clemens....dows_3170.html.](http://blog.clemens.endorphin.org/2007/12/removing-chs-based-access-from-windows_3170.html. \"External link\")\n\nIt basically states (I think) that there is something wrong, or \u0027not smart\u0027 in the windows boot loader:\n\u003e The generic method contained in the boot loader to read a sector from disk is \"clever\" as it checks whether the sector is below the maximum sector index that is reachable with the CHS geometry reported by the BIOS. If not, it uses the LBA interface of the BIOS. If yes, the cleverness of the boot loader suddenly vanishes. Instead of using the BIOS reported geometry to break the absolute sector down into its CHS components, the boot loader uses a geometry stored in the so called BIOS parameter block. That\u0027s a section of the first sector embedded into the boot loader that hard codes such values as head per cylinder and sectors per heads into the boot loader. If the hard coded values are different from the ones used by the BIOS, the calculation produces wrong values. So, if you move your partition to a BIOS that exposes a different geometry to the boot loader than is hard coded in the boot loader the whole thing blows up. Brilliant Microsoft design, as ever.\n\nThis could explain why the the error started when the NTLDR was installed: this boot loader is more sensitive to LBA/CHS differences.\n\nFurther:\n\u003e If you have \"balanced data\" (meaning that NO matter if you use CHS data or LBA data you always have the same start and end sector) you won\u0027t need most (if not all) of these patches, AND some BIOSes may be \"sensible\" to \"orthodox\" partitioning, i.e. having both beginning and end sector on Cylinder and Head boundary.\n\nNot completely sure what it means to \u0027always have the same start and end sector\u0027 but according to this forum, some BIOSes (possibly mine) are sensible to this.\n\nNot sure how this is linked together but it seems quite possible that is is a LBA/CHS issue (damn I barely know what their difference is) and possibly both the asus mobo and the NTLDR type boot record are sensitive for this. This must be why it only goes wrong when both issues \u0027meet\u0027 at the same time.\n\nPossibly it could work if I formatted the volume in a LBA/CHS \u0027balanced\u0027 way, something the HP tool does not do.\n\nI am sorry, I read it all but I do not understand all of it. Could you translate this to a \u0027lower level\u0027 or do you know an other article to boost mine?\n\nWould RMPrepUSB do format \u0027balanced\u0027 or do I need [http://reboot.pro/to...tch-001-alpha/,](http://reboot.pro/topic/3191-mbrbatch-001-alpha/, \"\") as I have no idea how to use this.\n\nCould I somehow use tinyhexer to check whether or not the drive has been formatted \u0027balanced\u0027?\n\n@Steve\n\n\u003e So are you saying that the same USB stick, formatted to 1.8GB as FAT16 works, but when formatted as FAT32 and 1.8GB does not boot on the Asus?\n\nThat\u0027s almost what I\u0027m saying but not exactly. Both of them work when booting to dos, but when winnt.exe finishes the flashdrive no longer boots to dos, it boots onto the NTLDR that the winnt.exe placed on the flash drive. The sony boots this NTLDR fine, the asus tells me \u0027NTLDR not found\u0027.\n\n\\*edit\\* however, I must admit I did not try the \\\u003c2Gib and FAT32 combination yet, since I was using the HP tool and otherwise WintoFlash, both are limited in their options.\n\nI\u0027ll try using RMPrespUSB now. If it formats \u0027balanced\u0027 perhaps the whole \u0027problem\u0027 will be gone, so I\u0027ll first try a maximum size parition.\n\n**Edited by Fiction, 19 January 2013 - 07:44 PM.**\n"
    },
    {
      "id": "166185",
      "timestamp": "2013-01-19T20:14:56+00:00",
      "author": "Sha0",
      "content": "There is no reason for a **BIOS** on one motherboard to use the same **C/H/S** geometry for a USB storage device as another BIOS on another motherboard.\n\nIf you have code on the USB storage device (such as the code the **winnt.exe** is installing) that uses C/H/S geometry information, then switching BIOSes risks having that code malfunction, as the geometry might not be the same. The solution is simple: Either do not use code that cares about this geometry information, or do not switch BIOSes. :smile:\n\n"
    },
    {
      "id": "166188",
      "timestamp": "2013-01-19T20:27:31+00:00",
      "author": "steve6375",
      "content": "\u003e There is no reason for a **BIOS** on one motherboard to use the same **C/H/S** geometry for a USB storage device as another BIOS on another motherboard.\n\u003e\n\u003e If you have code on the USB storage device (such as the code the **winnt.exe** is installing) that uses C/H/S geometry information, then switching BIOSes risks having that code malfunction, as the geometry might not be the same. The solution is simple: Either do not use code that cares about this geometry information, or do not switch BIOSes. :smile:\n\nThat was what I was trying to prove ![:dubbio:](http://reboot.pro/public/style_emoticons/default/dubbio.gif) . Also, it may be that if the USB drive was prepared using the Asus, and then booted and tested on the Asus, it might then work on the Sony...\n\n"
    },
    {
      "id": "166190",
      "timestamp": "2013-01-19T20:32:10+00:00",
      "author": "Wonko the Sane",
      "content": "@Fiction\n\nThe Faqs have a date of release (and you were explicitly pointed to #10 only).\n\nWe did learn something new in the meantime :wink:, but you cannot get the basics without *getting the basics* (and have a quick look at history).\n\nA working solution (though not particularly elegant :blush:) was found at the time, see the \"companion page\":\n\n[http://jaclaz.alterv...B/USBstick.html](http://jaclaz.altervista.org/Projects/USB/USBstick.html \"External link\")\n\nYou may use Tinyhexer (possibly with my MBRview structure viewer):\n\n[http://reboot.pro/to...-hexer-scripts/](http://reboot.pro/topic/8734-tiny-hexer-scripts/ \"\")\n\nto read the (most probably wrong) data the HP USB tool wrote in your stick partition table, then use this (still mine) worksheet to verify/check/play with numbers:\n\n[http://reboot.pro/to...a-translations/](http://reboot.pro/topic/2959-chs-lba-translations/ \"\")\n\nget the updated v2 from here: [http://reboot.pro/to...ations/?p\u003d74116](http://reboot.pro/topic/2959-chs-lba-translations/?p\u003d74116 \"\")\n\nAnyway, you understood most of the given resources correctly ![:thumbup:](http://reboot.pro/public/style_emoticons/default/thumbup.gif).\n\nThere are several different issues that may play a role, in your case as per the given link it is very likely it is a \"quirk\" of the Asus BIOS.\n\nTo get another idea of what happens when two BIOSes disagreee on the geometry of disk device, check this thread (again only *seemingly* unrelated):\n\n[http://www.911cd.net...topic\u003d23408\\\u0026hl\u003d](http://www.911cd.net/forums//index.php?showtopic\u003d23408\u0026hl\u003d \"External link\")\n\nSome additional (interesting) innfo related to:\n\n[http://blog.clemens....ndows_3170.html](http://blog.clemens.endorphin.org/2007/12/removing-chs-based-access-from-windows_3170.html \"External link\")\n\ncan be found here (when we actually gained knowledge of the above):\n\n[http://www.911cd.net...91](http://www.911cd.net/forums//index.php?showtopic\u003d21702\u0026st\u003d120\u0026p\u003d154091\u0026#entry154091 \"External link\")\n\n![:cheers:](http://reboot.pro/public/style_emoticons/default/cheers.gif)\n\nWonko\n\n"
    },
    {
      "id": "166209",
      "timestamp": "2013-01-20T11:25:05+00:00",
      "author": "Fiction",
      "content": "@Sha0 \\\u0026 steve\n\nDoes this mean I should run winnt.exe on the asus, or should I format the drive on the asus as well?\n\n@Wonko\n\nI\u0027ll play with the four byte MBR patch for a while (in combination with running winnt.exe on the asus)\n\nI really like be able to understand when a device has been formatted \u0027ballanced\u0027 and how I should fix this myself.\n\nThis: [http://jaclaz.alterv...B/USBstick.html](http://jaclaz.altervista.org/Projects/USB/USBstick.html \"External link\") is still a bit hard for me and btw most of thos utilities are no longer available using those links.\n\nI still have a difficult time knowing what all involved values in MBRview are (lol @ Kansas City Shuffle) and what they should be.\n\nI guess I\u0027ll re-read [http://jaclaz.alterv.../USBstick.html,](http://jaclaz.altervista.org/Projects/USB/USBstick.html, \"External link\") since it IS explained in there. Perhaps I can ask a more specific question about the first thing I do not understand.\n\nInteresting as it might be to do this manually once, this seems like a lot to do each time I need to boot somehting.\n\nIs there no utility to format the thing correctly in one go?\n\nPerhaps I should try this guy [http://reboot.pro/to...atch-001-alpha/](http://reboot.pro/topic/3191-mbrbatch-001-alpha/ \"\") after all?\n\nDo know that my forum activity will drop soon, since my study will start asking a fair amount of my time. I will continue to read posts on this thread, however I might not be able to respond on a daily basis. I hope this will not be a problem.\n\n\\*edit\\*\n\nI tried this: formated the drive using RMPrepUSB on my sony pc, then ran winnt.exe on the asus pc. When completed used tiny hexer to patch the 4 bytes. Result: it reads the contents of the boot.ini, and displays is, but when I try to pick the install option\n\u003e C:\\\\$WIN_NT$.\\~BT\\\\BOOTSECT.DAT \u003d \"Windows XP Installation/Upgrade\"\n\nI once again get the \u0027NTLDR is missing\u0027 message.\n\nI\u0027ll try playing with the boot.ini content.\n\n\\*edit2\\* most noticeable thing I got when changing the boot.ini was a hal.dll error.\n\nIt looks as if NTLDR switches back to CHS even with the four bytes patched. I\u0027ll try formating the device using the asus pc, but I think \u0027balancing\u0027 the drive has a greater chance.\n\n**Edited by Fiction, 20 January 2013 - 12:05 PM.**\n"
    },
    {
      "id": "166219",
      "timestamp": "2013-01-20T15:37:59+00:00",
      "author": "Wonko the Sane",
      "content": "Well, here we have a problem. ![:ph34r:](http://reboot.pro/public/style_emoticons/default/scared9.gif)  \nThere is NO \"**4** bytes **MBR** patch\" that I can recall.  \nThere are two different **4** bytes **PBR** (or bootsector) patches, one for FAT32 and one for NTFS.\n\nAnd a \"**3** bytes\"**MBR** patch (actually originated by the HP USB format utility) which we didn\u0027t talk about specifically (but that is linked in one of the given pages on 911CD):  \n[http://reboot.pro/to...s-info/?p\u003d14607](http://reboot.pro/topic/2246-grub4dos-info/?p\u003d14607 \"\")\n\nThe essence of balanced CHS/LBA is the following (do play a bit with the given CHS/LBA translating spreadsheet).\n\nIn a partition table the SAME (objectively) data is written TWO times according to TWO different standards.\n\nScope of a partition table entry is to univocally identify a \"region\" of the disk.\n\nThe CHS standard identifies a region by mentioning WHERE it starts and WHERE it ends.\n\nThe LBA standard identifies a region by mentioning HOW MANY sectors are before it\u0027s start and HOW MANY sectors is the region long.\n\nThe CHS uses as units sectors BUT uses them along a convention that \"groups\" sectors into \"heads\" and that groups \"heads\" into \"cylinders\".\n\nThink of the normal decimal system we use, you know that when you sum 9+1 you get 1 ten and that when you sum 99+1 you get 1 hundred.\n\nThe nice part of the decimal system is that \"groups\" like ten or hundred contain ten times the lesser level \"group\".\n\nWith CHS you have to take into account the geometry, i.e. the max number of items available, just like when you make 9+1 you are sayin that you have 1 ten and 0 units, BUT the max number of items available is not \"standard\" and can vary.\n\nPlease follow me.\n\nIf you had a \"fictional\" disk that had 10 sectors per head and 10 heads per cylinder, you would call first sector 001, second one 002, etc. ninth one 009, tenth one 010, eleventh one 011, etc.. ninetyninth one 099, hundredth one 100, etc.\n\nLet\u0027s try writing the above in HTU notation (Hundreds/Tens/Units), you would have 0/0/1, 0/0/2, 0/0/9, 0/1/0 0/1/1 0/9/9 and 1/0/0.\n\nBut if you had a \"strange\" numerical system where a ten is made out of 32 units and a hundredth was made of 64 tens, what would happen?\n\nSector #32 would be 0/0/32, #33 0/1/1, sector #2047 (64\\*32-1\u003d2047) will become 0/63/32, #2048 1/0/1.\n\nSo, let\u0027s say that you have a partition that starts on sector #33, it will be expressed in a geometry of n/64/32 as 0/1/1.\n\nIf it is 2016 sectors in size, it will end on sector #2048, i.e. on 0/63/32.\n\nNow let\u0027s see LBA.\n\nHow many sectors are before sector #33? Obviosly 32.\n\nHow many sectors are in the partition? Obviously 2016 /we decided by design this number).\n\nCongratulations, you have a valid, **balanced** partition table entry:\n\n0/1/1 - 0/63/32 - 32 - 2016\n\n(you can use EITHER of the TWO addressing methods to identify EXACTLY the SAME region on disk)\n\nBUT while the LBA addresses will remain the same NO MATTER which geometry is used (how many units make a ten and how many tens make a hundred) the CHS do NOT.\n\nIf you write that same partition entry on a device with a geometry of (say) n/16/63 what would happen?\n\nThe beginning is NOT anymore 0/1/1 but raher 0/0/33.\n\nThe end is NOT anymore 0/63/32 but rather 0/32/32.\n\nOn this device the SAME partition area will be expressed as:\n\n0/0/33 - 0/32/32 - 32 - 2016\n\nI hope this makes it more clear.\n\nNow a question for you.\n\nWhat do you think that EXACTLY is C:\\\\$WIN_NT$.\\~BT\\\\BOOTSECT.DAT? (i.e. what are it\u0027s contents? Try opening that file with tinyhexer and have a look at it)\n\n![:cheers:](http://reboot.pro/public/style_emoticons/default/cheers.gif)\n\nWonko\n\n"
    },
    {
      "id": "166244",
      "timestamp": "2013-01-20T23:32:55+00:00",
      "author": "Fiction",
      "content": "I need to get out early tomorrow so I wont be able to have a detailed look at your last post until at best tomorrow evening or at worst Wednesday. However I\u0027d like to say something about this\n\n\u003e Well, here we have a problem. ![:ph34r:](http://reboot.pro/public/style_emoticons/default/scared9.gif)  \n\u003e There is NO \"**4** bytes **MBR** patch\" that I can recall.  \n\u003e There are two different **4** bytes **PBR** (or bootsector) patches, one for FAT32 and one for NTFS\n\nI guess I meant the PBR. I read [http://en.wikipedia....ter_boot_record](http://en.wikipedia.org/wiki/Master_boot_record \"External link\") and am now aware that there are multiple bootsectors and that the MBR is the fist sector (do I understand correctly?). I am sorry I am wasting your time with my noobishness. I am sure you spend enough time explaining trivial things to noobs as is. It is really appreciated however.\n\nI jumped a bit ahead and took a look at the bootsect.dat. I was to curious to wait for tomorrow with this.\n\nIt seems like it contains a FAT32 bootsector. \u0027bootsect\u0027 I guess it should have rung a bell.\n\nIt is all there even the UNMODIFIED! 4 bytes I patched in the boot-sector on the drive itself... It seems worth a try to NOP these too...\n\n\\*edit\\*\n\nI still need to read your \u0027balancing tips\u0027 in your previous post. However I wanted to tell you that I could not wait to try NOP-ing the bytes in the bootsect.dat and it actually worked :tongue:\n\nI was able to successfully boot the txtsetup on a maximum size FAT32 partition on the asus FOR THE FIRST TIME. So we (aka you) are definitely on the right track: this IS a CHS issue indeed.\n\n**Edited by Fiction, 20 January 2013 - 11:43 PM.**\n"
    },
    {
      "id": "166260",
      "timestamp": "2013-01-21T10:05:17+00:00",
      "author": "Wonko the Sane",
      "content": "\u003e ....  \n\u003e I was to curious to wait for tomorrow with this.  \n\u003e ....  \n\u003e However I wanted to tell you that I could not wait to try NOP-ing the bytes in the bootsect.dat and it actually worked :tongue:  \n\u003e\n\u003e I was able to successfully boot the txtsetup on a maximum size FAT32 partition on the asus FOR THE FIRST TIME. So we (aka you) are definitely on the right track: this IS a CHS issue indeed.\n\nYep ![:thumbsup:](http://reboot.pro/public/style_emoticons/default/thumbsup.gif)  \nCuriosity - besides killing the cat ![:w00t:](http://reboot.pro/public/style_emoticons/default/w00t.gif) - does give some small satisfactions from time to time. :wink:  \n\nWrong attitude:  \nSpoiler  \n![n69eaamybv.jpg](http://media.fakeposters.com/results/2009/07/24/n69eaamybv.jpg)\n\n\u003cbr /\u003e\n\nRight ![:thumbup:](http://reboot.pro/public/style_emoticons/default/thumbup.gif) (though dangerous ![:ph34r:](http://reboot.pro/public/style_emoticons/default/scared9.gif)) one:\n\n\u003cbr /\u003e\n\nSpoiler  \n![curiosity-curiosity-cat-demotivational-p](http://3.bp.blogspot.com/-GMKlRy8Md7E/Tj2z5PUwy0I/AAAAAAAAAHc/bl4A_TkGbsY/s1600/curiosity-curiosity-cat-demotivational-poster-1260571018.jpg)\n\n\u003cbr /\u003e\n\nDon\u0027t worry :smile:, it does take some time to get all these pieces of info and assemble them together in a \"valid\" picture.\n\n![:cheers:](http://reboot.pro/public/style_emoticons/default/cheers.gif)\n\nWonko\n\n"
    },
    {
      "id": "166281",
      "timestamp": "2013-01-21T13:44:24+00:00",
      "author": "steve6375",
      "content": "You could always patch the file using grub4dos, if you reboot to grub4dos before it boots from the HDD  \n\n```\ntitle Patch \\\\$WIN_NT$.~BT\\\\BOOTSECT.DAT\n\nset OS\u003d\nset BT\u003d\nif exist (hd0,0)/$WIN_NT$.~BT/BOOTSECT.DAT set BT\u003d(hd0,0)/$WIN_NT$.~BT/BOOTSECT.DAT\nif exist (hd1,0)/$WIN_NT$.~BT/BOOTSECT.DAT set BT\u003d(hd1,0)/$WIN_NT$.~BT/BOOTSECT.DAT\nif exist (hd1,1)/$WIN_NT$.~BT/BOOTSECT.DAT set BT\u003d(hd1,1)/$WIN_NT$.~BT/BOOTSECT.DAT\nif exist (hd1,2)/$WIN_NT$.~BT/BOOTSECT.DAT set BT\u003d(hd1,2)/$WIN_NT$.~BT/BOOTSECT.DAT\nif \"%BT%\"\u003d\u003d\"\" pause --wait\u003d3 Cannot find /$WIN_NT$.~BT/BOOTSECT.DAT \u0026\u0026 configfile /menu.lst\n# detect OS\ncat --skip\u003d3 --length\u003d8 --locate\u003dMSWIN4.1 %BT% \u003e nul \u0026\u0026 set OS\u003dFAT32\ncat --skip\u003d3 --length\u003d8 --locate\u003dMSDOS5.0 %BT% \u003e nul \u0026\u0026 set OS\u003dFAT32\ncat --skip\u003d3 --length\u003d4 --locate\u003dNTFS %BT% \u003e nul \u0026\u0026 set OS\u003dNTFS\nif \"%OS%\"\u003d\u003d\"\"  pause --wait\u003d3 Sorry - can\u0027t determine OS of BOOTSECT.DAT \u0026\u0026 configfile /menu.lst\necho FOUND %OS%\ncat --hex --length\u003d0xf0 %BT%\nset /p ASK\u003dPress Y to patch file (Y/N): \nif not /i \"%ASK%\"\u003d\u003d\"Y\" configfile /menu.lst || echo -e \\n\\r\necho Patched file is now...\nif \"%OS%\"\u003d\u003d\"FAT32\" cat --skip\u003d0xe6 --locate\u003d\\x0f\\x82\\x4a\\x00 --replace\u003d\\x90\\x90\\x90\\x90 %BT% \u003e nul\nif \"%OS%\"\u003d\u003d\"NTFS\" cat --skip\u003d0xd9 --locate\u003d\\x0f\\x82\\x3a\\x00 --replace\u003d\\x90\\x90\\x90\\x90 %BT% \u003e nul\nif not \"%OS%\"\u003d\u003d\"\" cat --hex --length\u003d0xf0 %BT%\necho Finished - press a key to continue...\npause\n```\n\n\u003cbr /\u003e\n\n"
    },
    {
      "id": "166335",
      "timestamp": "2013-01-21T21:26:27+00:00",
      "author": "Fiction",
      "content": "@Wonko\n\nI read your post. I\u0027m not sure I understand correctly when it is NOT balanced then.\n\nI looked at the worksheet, but it is not intuitive to me what values I should put in there myself and what once should be calculated automatically. About the value\u0027s I should put in there myself: how should I determine those? Preferably I\u0027d use windows 7/xp compatible software while running these systems (if possible). I guess I could use your MBRviewer script for tiny hexer to help me write the worksheet values onto the bootsectors?\n\n@steve\n\nInteresting, I did not know I could patch files using grub4dos. However I have access to a second computer so this should not be necessary.\n\n"
    },
    {
      "id": "166363",
      "timestamp": "2013-01-22T10:50:40+00:00",
      "author": "Wonko the Sane",
      "content": "\u003e @Wonko  \n\u003e I read your post. I\u0027m not sure I understand correctly when it is NOT balanced then.\n\nIn the example posted, imagine that you have this entry:  \n0/1/1 - 0/63/32 - 32 - 2016  \nAs seen, this is perfectly \"balanced\" on a BIOS that detects the device as m/64/32.  \nThis means that IF the BIOS uses CHS only (let\u0027s say with a partition type of 06 - FAT 16 CHS mapped) it will find the PBR on first sector of the second cylynder, i.e. 32\\*1+1\u003d33: it\u0027s the 33rd sector.  \nOf course IF the BIOS uses LBA only (let\u0027s say with a partition type of 0E - FAT 16 LBA mapped) it will find the PBR after 32 sectors, i.e. 32+1\u003d33: it\u0027s the 33rd sector.  \nBut what happens on another BIOS that sees the device as having a geometry of n/16/63?  \nFor LBA there are NO issues, as 32+1\u003d33: it\u0027s still the 33rd sector.  \nFor CHS the first sector of the second cylinder *suddenly* becomes 63\\*1+1\u003d64: it is the 64th sector, of course since NO PBR is there in this BIOS it won\u0027t be found.\n\nThe SAME partition entry will be \"balanced\" on a m/64/32 geometry BUT unbalanced on a n/16/63.\n\nBUT what the HP USB Format utility often does is something slightly different.\n\nLet\u0027s assume that the hypothetical device does have a n/16/63 geometry and a total capacity of 3180 ![:w00t:](http://reboot.pro/public/style_emoticons/default/w00t.gif) sectors.\n\nThe HP utility will try to use ALL available sectors, so the LBA part will be obviously \"63-3117\".\n\nThe **P**BR will have this data:\n\n* sectors before 63\n* total sectors 3117\n* number of sectors 63\n* number of heads 16\n\nBut what happens to the CHS?\n\nThe starting triplet is easy, it will be 0/1/1.\n\nThe ending one will be tricky. ![:dubbio:](http://reboot.pro/public/style_emoticons/default/dubbio.gif)\n\nThe CHS on n/16/63 corresponding to LBA \"63-3117\" (try making it on the spreadsheet) is 3/2/30.\n\nBUT the HP formatting utility uses \"orthodox\" partitioning where a partition should alway end on a cylinder boundary.\n\nThe highest cylinder boundary BEFORE 3/2/30 is (obviously) 2/15/63, and this is the value that the HP tool will write.\n\nSo you will have a partition table of:\n\n0/1/1 - 2/15/63 - 63 - 3117\n\nwhich is UNbalanced on \\*any\\* geometry.\n\nA BIOS may (legitimately or not) calculate the size of the partition from the CHS data (try doing it on the spreadsheet) and the result will be a corresponding LBA of 63-2961.\n\nThe BIOS now, knowing that the partition is 2961 sectors in size, may access the PBR and check the number of sector written in there (which will be 3117) and since 2961 is different from 3117 could throw an error.\n\n\u003e I looked at the worksheet, but it is not intuitive to me what values I should put in there myself and what once should be calculated automatically. About the value\u0027s I should put in there myself: how should I determine those? Preferably I\u0027d use windows 7/xp compatible software while running these systems (if possible). I guess I could use your MBRviewer script for tiny hexer to help me write the worksheet values onto the bootsectors?  \n\nThere are several sheets in the spreadsheet.\n\nIn that version V2 the \"main\" sheet is the one called \"PTtables\".\n\nIn it you can:\n\n1. define the geometry of the device in cells F4:H4\n2. define MBR+hidden sectors (as CHS only. but the \"orthodox\" partiioning has alway 0/0/1-0/0/S where S in the number of sectors in H4)\n3. input some data in either of the three available modes **CHS** -\\\u003eLBA, **LBA** -\\\u003eCHS, **Numsec**-\\\u003eCHS\n\nFor the reason stated, unless you define a CHS geometry first, the sheet will calculate \"wrong\" data.\n\nOnce you are satisfied with the result, you can (manually) write the values in the PT_to_MBR sheet and obtain the resulting \"look\" (and hex values) those data will have in an actual hex editor.\n\nThe other way round, you can write the hex values of a MBR you have opened with tinyhexer or other hex editor in the MBR_to_PT sheet and obtain a \"readable\" partition table (same that you would get using directly PTView with tinyhexer).\n\n![:cheers:](http://reboot.pro/public/style_emoticons/default/cheers.gif)\n\nWonko\n\n"
    },
    {
      "id": "167195",
      "timestamp": "2013-02-04T20:07:26+00:00",
      "author": "Fiction",
      "content": "Ok, I hope you still check this treat from time to time :tongue:\n\nI am trying to \u0027balance\u0027 a 4GB (NOT GiB!) flashdrive. So the first thing I\u0027ll need to know is how many sectors per head and heads per cylinder I am dealing with. Is this a BIOS specific thing, or is this writen in the sector 0 somewhere?\n\n"
    },
    {
      "id": "167199",
      "timestamp": "2013-02-04T20:23:26+00:00",
      "author": "Wonko the Sane",
      "content": "\u003e Ok, I hope you still check this treat from time to time :tongue:  \n\u003e\n\u003e I am trying to \u0027balance\u0027 a 4GB (NOT GiB!) flashdrive. So the first thing I\u0027ll need to know is how many sectors per head and heads per cylinder I am dealing with. Is this a BIOS specific thing, or is this writen in the sector 0 somewhere?\n\nNo, first thing that you need to know is device capacity, EXACT one, in bytes (or sectors).\n\n\u003cbr /\u003e\n\nThe most reliable (in my *perverted*mind) way to do this is detailed here:\n\n[http://reboot.pro/to...-alpha/?p\u003d38197](http://reboot.pro/topic/5000-managing-mbrs-by-jaclaz-mbrbatch-release-001-alpha/?p\u003d38197 \"\")\n\njust run dsfo redirecting to nul and jolt down the size in bytes.\n\nRMPREPUSB should have provisions to test (or just compute) size correctly, BTW.\n\nThen you can use the 255/63 HS geometry allright.\n\n![:cheers:](http://reboot.pro/public/style_emoticons/default/cheers.gif)\n\nWonko\n\n"
    },
    {
      "id": "166082",
      "timestamp": "2013-01-17T22:59:44+00:00",
      "author": "Fiction",
      "content": "This is basically a followup of this topic: [http://reboot.pro/to...ny-suggestions/](http://reboot.pro/topic/17968-odd-behaviour-from-an-old-pc-any-suggestions/ \"\")\n\nBut here I\u0027ll try to ask a more specific question. I\u0027ll do this in a different topic, because the question is slightly different and because the question I asked there was answered.\n\nThis is what I did:\n\n1 I used the HPformat tool (HPUSBFW.exe) to create a bootable dos usb flashdrive.\n\n2 I copied the following files to the flashdrive:\n\nCDROM\\\\OAKCDROM.SYS\n\nCONFIG.SYS\n\nEMM386.EXE\n\nHIMEM.SYS\n\nsmartdrv.exe\n\n3 I copied the I386 folder from a windows install cd to the flashdrive\n\n4 I boot the flashdrive\n\n5 started smartdrv and after that the I386\\\\winnt.exe and continued the dos part of the installation.\n\nThe next part (txtsetup) from the installation booted fine on the motherboard of my sony vaio VPCW21S1E,\n\nbut trying to boot this on asus a7v8x-mx motherboard I get a \u0027NTLDR is missing\u0027 message\n\nI did this to debug the boot process. I will repeat this: I am NOT trying to make a functional setup USB in this fashion. In the previous topic Sha0 told me the setup would probably not work unless forcing the drivers to load in an early stage, so I am aware of this. I just want to know where this difference comes from.\n\nNormally I would use Novicorp WinToFlash (it basically does the same thing WINNT.EXE does, but perhaps it does fix the possible driver issue as well). I noticed it would not work with the asus motherboard on the default FAT32 LBA setting. It only worked with this asus motherboard when I set the program to format the drive FAT16 LBA.\n\nIn the previous topic I thought the FAT16 option worked because the partition would then automatically be smaller then 2GB. I was thinking of a capacity limitation, but if you read the previous discussion, you will see we ruled this out.\n\nNow after some googling I found this: [http://wintoflash.co...0\\\u0026t\u003d32\\\u0026start\u003d0.](http://wintoflash.com/forum/viewtopic.php?f\u003d10\u0026t\u003d32\u0026start\u003d0. \"External link\")\n\n\u003e NTLDR is missing message mean the partition boot record can\u0027t find NTLRD file on partition. May be FAT16 may help to fix this - FAT16 partition boot record is smaller and more simple...\n\nDoes anyone here know why this motherboard will only load the xp txtsetup when using FAT16, while dos boots perfectly from FAT32?\n\nDo you think I will be possible to make a bookable flash drive, containting a xp setup with a size of more then 2GB? It really annoys me that I need to throw away most of the flashdrive\u0027s capacity, so I can use it on all op my computers independent of specs.\n\n\\*edit\\* added some extra details, to be more specific and avoid confusion.\n\n**Edited by Fiction, 17 January 2013 - 11:07 PM.**\n"
    },
    {
      "id": "166083",
      "timestamp": "2013-01-17T23:12:04+00:00",
      "author": "steve6375",
      "content": "Try different formats using RMPrepUSB and selecting FreeDOS\n\n1. FAT16 2GB FreeDOS (no overrides) , 5 Freedos folder\n\n2. AS above but add Boot as Hdd (2PTNs) override\n\n3. FAT32 FreeDOS (no overrides) , 5 Freedos folder\n\n4. as 3 but add Boot as Hdd (2PTNs) override\n\nReport back after trying all of these on all systems.\n\n"
    },
    {
      "id": "166087",
      "timestamp": "2013-01-18T01:03:57+00:00",
      "author": "ilko",
      "content": "Have you tried WinSetupFromUSB and the auto-format option, which uses[FBInst](http://reboot.pro/topic/7932-create-universal-flash-boot-disk-with-fbinst/ \"\"), which is considered quite suitable for picky BIOS-es?\n\nTry [1.0 beta8](http://code.google.com/p/winsetupfromusb/downloads/detail?name\u003dWin%20Setup_1_0_beta8.7z \"External link\"), use auto-format option, use NTFS or the other file systems and options presented if need to.\n\nIf you are into testing bootability only, you don\u0027t have to select any other options in the program.\n\nThis way you will end up with USB stick partitioned and formatted by FBInst in its special way, an option upon boot whether to continue to Grub4dos or launch PLoP boot manager, and if nothing was selected you will get to grub4dos command prompt.\n\nPLoP is also a good option to try on picky motherboards, should you be able to start it.\n\nAlternatively, there is FBInstTool, which also uses FBInst internally, but it could be a bit trickier for you to get going.\n\n[http://code.google.c...-2012-12-21.zip](http://code.google.com/p/winsetupfromusb/downloads/detail?name\u003dFbinstTool-2012-12-21.zip \"External link\")\n\n[http://bbs.wuyou.com....php?tid\u003d189221](http://bbs.wuyou.com/viewthread.php?tid\u003d189221 \"External link\")\n\n"
    },
    {
      "id": "166127",
      "timestamp": "2013-01-18T17:25:12+00:00",
      "author": "Wonko the Sane",
      "content": "You are likely to be hitting a whole range of issues this way.\n\nThat approach (you are perfectly free to take for good my word for it or completely ignore it, of course) makes very little sense as a \"debug method\".\n\nOf ALL the available methods to partition a USB stick, as you were already told, BTW, the HP USB Format utility is NOT the one to use (as we have better tools and more \"granular\" control of what happens):\n\n[http://reboot.pro/to...tions/?p\u003d165830](http://reboot.pro/topic/17968-odd-behaviour-from-an-old-pc-any-suggestions/?p\u003d165830 \"\")\n\nSo I will have to ask:\n\nWHAT EXACTLY is your GOAL? ![:unsure:](http://reboot.pro/public/style_emoticons/default/unsure.png)\n\nIf it is to actually install the XP to a given machine, then use this one (tested, very similar to the one you are now testing, but fully working) WINNT.EXE based approach:\n\n[http://www.911cd.net...topic\u003d16713\\\u0026hl\u003d](http://www.911cd.net/forums//index.php?showtopic\u003d16713\u0026hl\u003d \"External link\")\n\nOtherwise, do the following:\n\nRight after the running of HPUSBFW.exe copy to the root of the stick:\n\n* NTLDR\n* BOOT.INI (\\*any\\* boot.ini will do, if needed it will be edited later)\n* NTDETECT.COM\n* grub.exe and grldr \\\u003c- get these from last \"featured\" build on chenall\u0027s page: [http://code.google.c.../downloads/list](http://code.google.com/p/grub4dos-chenall/downloads/list \"External link\")\n\nthen copy the other DOS files you mentioned\n\nEdit BOOT.INI and add to it a line like : C:\\\\grldr\u003d\"grub4dos\"\n\nBoot the stick (to DOS) and on command line run grub.exe\n\nAt the command prompt enter:\n\n```\n\n\n\n\n\nchainloader /ntldr\nboot\n```\n\nTry selecting the grub4dos entry in boot.ini.\n\nAt the grub4dos command prompt enter:\n\n```\n\n\n\n\n\nchainloader /io.sys\n boot\n```\n\nIf everything works as expected you will be back to DOS.\n\nThis time you will have a bootable stick that besides DOS contains grub4dos that can be used to inspect the contents of the source and target disk/exchange disks/do more things like checking geometries and what not (i.e. putting you in a condition to actually \"debug\" something).\n\nAbout BIOS limitations and FAT16, 32 etc, read the USB FAQ #10 here:\n\n[http://jaclaz.alterv...SB/USBfaqs.html](http://jaclaz.altervista.org/Projects/USB/USBfaqs.html \"External link\")\n\nAND read here:\n\n[http://www.911cd.net...showtopic\u003d24395](http://www.911cd.net/forums//index.php?showtopic\u003d24395 \"External link\")\n\nwhy exactly the HPUSBFW utility is NOT advised (and ++incidentally++ ![:w00t:](http://reboot.pro/public/style_emoticons/default/w00t.gif) the EXACT answer - most probably - to your EXACT issue related to an Asus BIOS :wink: or however a related report and a working \"debug/test\" method/tool)\n\n![:cheers:](http://reboot.pro/public/style_emoticons/default/cheers.gif)\n\nWonko\n\n"
    },
    {
      "id": "166137",
      "timestamp": "2013-01-19T00:20:29+00:00",
      "author": "Fiction",
      "content": "@steve6375\n\nI would like to try your approach first. However, do you want me to just test if I can boot into freedos or do you want me to run winnt as well?\n\nsmartdrv does not work with freedos, or so it seems, therefore it takes ages for winnt.exe to complete. It is the NTLDR boot-loader that is of interest here, since the noted behaviour only applied to this loader. See below for more details.\n\n@ilko\n\nThat looks promising, I might have a look into it, but for now I am curious about steve6375\u0027s idea.\n\n@Wonko the Sane\n\nAh, we meet again :tongue:\n\nI hoped I was being clear and specific enough this time, but it appears my intentions are still vague.\n\nI\u0027ll try to explain the \u0027goal\u0027 a bit better. See below.\n\nA few days back I used Novicorp WinToFlash to transfer a xp installation source onto a usb drive and noticed it would boot just fine on my sony notebook, but would not work on the asus mobo pc.\n\nSo now, there are actually 2 goals:\n\n1 learn something about motherboard specificness when booting: why this difference?\n\n2 get the asus mobo computer to boot into a windows xp usb drive with a partition larger then 2GB, unless I know for sure this is not possible.\n\nLike I said in the intro: the asus mobo boots dos just fine, both FAT16 (2GIB) and FAT32 (max size), I then ran smartdrv to reduce install time and ran winnt.exe.\n\nBoth computers started winnt.exe just fine, but when it completed it asked to reboot, in order to boot the new NTLDR it installed. This is where the difference gets noticed: the sony pc boots the NTLDR just fine, but the ASUS mobo pc would only boot from it when formatting the partition as FAT16. At first I thought using FAT16 worked just because after formatting FAT16 the partition would be smaller then 2GiB. However in the previous topic we excluded the possibility of a partition size limitation being involved.  \n\nNow in my first post of this new thread, you could read why I\u0027m now thinking the FAT16/32 difference has something to do with it: according to the WinToFlash treat a FAT16 MBR is smaller and less complex.\n\nIt is still weird however, FAT32 boots to dos just fine, but booting the NTLDR fails when using FAT32 on the asus mobo pc.\n\n"
    },
    {
      "id": "166139",
      "timestamp": "2013-01-19T01:28:31+00:00",
      "author": "steve6375",
      "content": "\u003e Both computers started winnt.exe just fine, but when it completed it asked to reboot, in order to boot the new NTLDR it installed. This is where the difference gets noticed: the sony pc boots the NTLDR just fine, but the ASUS mobo pc would only boot from it when formatting the partition as FAT16.\n\nDo you mean that after winnt.exe and reboot, you are rebooting**from the internal hard disk** - and it is at this point you get the \u0027cannot find ntldr\u0027 message?\n\nWhat do you format the internal HDD as (FAT32, NTFS) and is this done manually or do you have a winnt.sif or some other automation method?\n\n"
    },
    {
      "id": "166150",
      "timestamp": "2013-01-19T11:48:23+00:00",
      "author": "Wonko the Sane",
      "content": "\u003e Now in my first post of this new thread, you could read why I\u0027m now thinking the FAT16/32 difference has something to do with it: according to the WinToFlash treat a FAT16 MBR is smaller and less complex.  \n\u003e It is still weird however, FAT32 boots to dos just fine, but booting the NTLDR fails when using FAT32 on the asus mobo pc.\nWell, what you still seem to miss is that - as posted - this is one of the most known issues, and it most probably has to do with disk geometry, conflicting CHS/LBA or possibly a specific quirk of that Asus BIOS.  \n\nDo take some time reading the given links, BOTH the possible \"causes\" and hopefully some \"remedies\" are provided in them.  \n\nAs well, the thread on 911CD should give you an idea of what to check and how, right now your \"useful for debug\" setup (with no offence whatsoever intended :smile:) is simply not \"good enough\" to provide you meaningful \"debug\" details.  \n\nDo prepare the stick as suggested and try using it, with the sequence of operations that you provided.  \n\nIn theory the USB stick gets drive letter C: and the partition on the internal hard disk will get drive letter D:.  \nThen, when you install through WINNT.EXE the C: wiil be \"boot\" volume (what MS calls the other way round \"System\") and D: will be \"system\" volume (what MS calls the other way round \"boot\"), consequently the NTLDR will be copied to C: and not to D:.  \nSee also (only seemingly unrelated):  \n[http://www.multiboot....uk/system.html](http://www.multibooters.co.uk/system.html \"External link\")  \n\nIt is possible that this does not happen on the Sony motherboard (which will mark the Sony as \"queer\" BIOS) but it does on the Asus one (in which case the Asus BIOS is \"normal\"), but I suspect that you are rebooting with the stick still attached, in which case the Asus \"smart\" geometry guess coupled with the UNbalanced partitioning the HP USB tool makes will play a role in it (and be the actual cause).  \nSince you did not provide enough details, I cannot say more.  \n\n\u003cbr /\u003e\n\n![:cheers:](http://reboot.pro/public/style_emoticons/default/cheers.gif)  \nWonko   \n"
    },
    {
      "id": "166152",
      "timestamp": "2013-01-19T13:08:10+00:00",
      "author": "Fiction",
      "content": "Perhaps I\u0027m still not being specific enough.\n\nRight now we are not doing anything with the internal drive. The winnt.exe copies the temporary files to the usb device and replaced the dos boot-loader (on the flash drive!) with the NTLDR bootloader. The internal drive is only accessed during the txtsetup phase, where we are presented with the option to repartition and select a partition on which to install xp. There does not seem to be any difference in content when the winnt.exe ran on the asus mobo or on the sony one. In both cases there actually is a NTLDR file on de flashdrive. However on the asus mobo the NTLDR simply wont load for some reason.\n\nIf I run the WINNT.exe on the asus mobo, it will boot just fine on the sony mobo when finished, but the asus mobo will tell me that \u0027NTLDR is not found\u0027. But I know it is on the flash drive when this error is being displayed.\n\nThis, however, does not happen when I used FAT16. I think there is something wrong with the way the asus mobo is interpreting the FAT32 MBR. But for some reason this is not a problem when booting dos. Because of this, I thought that maybe hexediting the MBR (after winnt.exe is finished) would make it bootable on the asus mobo, but my knowledge of assembly is limited and I would not know where to start.\n\nI hope the behaviour is more clear to you guys now.\n\nI will read the links, but first I\u0027d like to be sure we understand each other, to avoid reading long pages of content I might not be interested in.\n\n"
    },
    {
      "id": "166155",
      "timestamp": "2013-01-19T14:43:22+00:00",
      "author": "steve6375",
      "content": "So are you saying that the same USB stick, formatted to 1.8GB as FAT16 works, but when formatted as FAT32 and 1.8GB does not boot on the Asus?\n\n"
    },
    {
      "id": "166160",
      "timestamp": "2013-01-19T15:17:39+00:00",
      "author": "steve6375",
      "content": "Experiment\n\n1. Ensure the BIOS on the Asus is set to boot from USB HDD and not USB-ZIP\n\n2.Take your FAT32 pen which does not boot on the Asus but does boot on the Sony, install grub4dos onto it (e.g. use RMPrepUSB or grubinst and add grldr), boot it and go to grub4dos console (type c) - then type **blocklist /ntldr** - and also **geometry** what result do you get? Try on both systems and for FAT16 and FAT32.\n\nP.S. Did you try formatting as FAT32 on the Asus, copying the files, rebooting on the Asus to do the first phase, and then rebooting on Asus for the 2nd phase.?\n\nP.P.S. You can view head and sector parameters of MBR and PBR by using RMPrepUSB **Drive_Info** (use 0 for MBR and P1 for PBR).\n\n"
    },
    {
      "id": "166163",
      "timestamp": "2013-01-19T16:01:10+00:00",
      "author": "Wonko the Sane",
      "content": "\u003e I will read the links, but first I\u0027d like to be sure we understand each other, to avoid reading long pages of content I might not be interested in.\n\nWell, no. ![:(](http://reboot.pro/public/style_emoticons/default/sad.png)\n\u003e So now, there are actually 2 goals:  \n\u003e 1 **learn** something about motherboard specificness when booting: why this difference?  \n\u003e 2 get the asus mobo computer to boot into a windows xp usb drive with a partition larger then 2GB, unless I know for sure this is not possible.\n\n\u003cbr /\u003e\n\nYou are coming here asking for support and saying that you want to **learn** , if you choose the **RED** pill, there is a price for it. (and rabbit holes may be deeper than what you might think)  \n\nRest assured that by reading attentively the given links you will not only learn something USEFUL, you will also understand WHY exactly that is happening, how to verify WHAT is happening AND HOW to solve the issue (which BTW is partially due to the wrong choice you made for the USB partitioning/formatting tool).\n\nAnd these are not \"long pages\":\n\u003e About BIOS limitations and FAT16, 32 etc, read the USB FAQ #10 here:\n\u003e\n\u003e [http://jaclaz.alterv...SB/USBfaqs.html](http://jaclaz.altervista.org/Projects/USB/USBfaqs.html \"External link\")\n\u003e\n\u003e AND read here:\n\u003e\n\u003e [http://www.911cd.net...showtopic\u003d24395](http://www.911cd.net/forums//index.php?showtopic\u003d24395 \"External link\")\n\u003e\n\u003e why exactly the HPUSBFW utility is NOT advised (and ++incidentally++ ![:w00t:](http://reboot.pro/public/style_emoticons/default/w00t.gif) the EXACT answer - most probably - to your EXACT issue related to an Asus BIOS :wink: or however a related report and a working \"debug/test\" method/tool)\n\nthey are a single FAQ/FGA and a single thread, made of 14 (fourteen) posts of which only the first 12 (twelve) are actually relevant (and they are VERY relevant) to your issue.\n\n\u003cbr /\u003e\n\n\u003cbr /\u003e\n\n![:cheers:](http://reboot.pro/public/style_emoticons/default/cheers.gif)  \nWonko\n\n"
    },
    {
      "id": "166164",
      "timestamp": "2013-01-19T16:32:00+00:00",
      "author": "Fiction",
      "content": "Ok, I am sorry if I sounded a little lazy. I just wanted to make sure you guys understand the fact that winnt.exe only effects the flashdrive itself, not the internal disk. (As far as I can tell.)\n\nYou are, of course, completely correct: I\u0027ll take that darn red pill :tongue:. I\u0027ll read all of it. After that I\u0027ll report back.\n\n"
    },
    {
      "id": "166179",
      "timestamp": "2013-01-19T19:37:25+00:00",
      "author": "Fiction",
      "content": "Ok, apparently I waited for to long and my edit button disappeared. Sorry for the double post.\n\n@Wonko\n\nI am terribly sorry. I thought you where not understanding me correctly but in fact you were spot on. This 911cd topic is indeed about a similar problem.\n\nFirst I read [http://jaclaz.alterv...SB/USBfaqs.html](http://jaclaz.altervista.org/Projects/USB/USBfaqs.html \"External link\")\n\nthe FAQ seems for the most part focused on booting a xp INSTALL from usb and why this is not possible. Note however that\n\nI just want to boot the setup, not xp itself.\n\nFAQ #10 seemed more usefull but very empiric. It basically states \u0027if it does not work in a certain way, try a different\n\none\u0027. It lists a lot of possible \u0027variations\u0027 to try, but I\u0027m not sure whether I am dealing with any of these.\n\nThen I started reading the [http://www.911cd.net...showtopic\u003d24395](http://www.911cd.net/forums//index.php?showtopic\u003d24395 \"External link\")\n\nI noticed directly that my knowledge of assembly is not \u0027limited\u0027 but nearly 0. That\u0027s probably why I disliked reading it at first (I did already read that FAQ).\n\nI did not understand all of this, but let\u0027s see what I did understand.\n\nOne of the first links in the thread is: [http://blog.clemens....dows_3170.html.](http://blog.clemens.endorphin.org/2007/12/removing-chs-based-access-from-windows_3170.html. \"External link\")\n\nIt basically states (I think) that there is something wrong, or \u0027not smart\u0027 in the windows boot loader:\n\u003e The generic method contained in the boot loader to read a sector from disk is \"clever\" as it checks whether the sector is below the maximum sector index that is reachable with the CHS geometry reported by the BIOS. If not, it uses the LBA interface of the BIOS. If yes, the cleverness of the boot loader suddenly vanishes. Instead of using the BIOS reported geometry to break the absolute sector down into its CHS components, the boot loader uses a geometry stored in the so called BIOS parameter block. That\u0027s a section of the first sector embedded into the boot loader that hard codes such values as head per cylinder and sectors per heads into the boot loader. If the hard coded values are different from the ones used by the BIOS, the calculation produces wrong values. So, if you move your partition to a BIOS that exposes a different geometry to the boot loader than is hard coded in the boot loader the whole thing blows up. Brilliant Microsoft design, as ever.\n\nThis could explain why the the error started when the NTLDR was installed: this boot loader is more sensitive to LBA/CHS differences.\n\nFurther:\n\u003e If you have \"balanced data\" (meaning that NO matter if you use CHS data or LBA data you always have the same start and end sector) you won\u0027t need most (if not all) of these patches, AND some BIOSes may be \"sensible\" to \"orthodox\" partitioning, i.e. having both beginning and end sector on Cylinder and Head boundary.\n\nNot completely sure what it means to \u0027always have the same start and end sector\u0027 but according to this forum, some BIOSes (possibly mine) are sensible to this.\n\nNot sure how this is linked together but it seems quite possible that is is a LBA/CHS issue (damn I barely know what their difference is) and possibly both the asus mobo and the NTLDR type boot record are sensitive for this. This must be why it only goes wrong when both issues \u0027meet\u0027 at the same time.\n\nPossibly it could work if I formatted the volume in a LBA/CHS \u0027balanced\u0027 way, something the HP tool does not do.\n\nI am sorry, I read it all but I do not understand all of it. Could you translate this to a \u0027lower level\u0027 or do you know an other article to boost mine?\n\nWould RMPrepUSB do format \u0027balanced\u0027 or do I need [http://reboot.pro/to...tch-001-alpha/,](http://reboot.pro/topic/3191-mbrbatch-001-alpha/, \"\") as I have no idea how to use this.\n\nCould I somehow use tinyhexer to check whether or not the drive has been formatted \u0027balanced\u0027?\n\n@Steve\n\n\u003e So are you saying that the same USB stick, formatted to 1.8GB as FAT16 works, but when formatted as FAT32 and 1.8GB does not boot on the Asus?\n\nThat\u0027s almost what I\u0027m saying but not exactly. Both of them work when booting to dos, but when winnt.exe finishes the flashdrive no longer boots to dos, it boots onto the NTLDR that the winnt.exe placed on the flash drive. The sony boots this NTLDR fine, the asus tells me \u0027NTLDR not found\u0027.\n\n\\*edit\\* however, I must admit I did not try the \\\u003c2Gib and FAT32 combination yet, since I was using the HP tool and otherwise WintoFlash, both are limited in their options.\n\nI\u0027ll try using RMPrespUSB now. If it formats \u0027balanced\u0027 perhaps the whole \u0027problem\u0027 will be gone, so I\u0027ll first try a maximum size parition.\n\n**Edited by Fiction, 19 January 2013 - 07:44 PM.**\n"
    },
    {
      "id": "166185",
      "timestamp": "2013-01-19T20:14:56+00:00",
      "author": "Sha0",
      "content": "There is no reason for a **BIOS** on one motherboard to use the same **C/H/S** geometry for a USB storage device as another BIOS on another motherboard.\n\nIf you have code on the USB storage device (such as the code the **winnt.exe** is installing) that uses C/H/S geometry information, then switching BIOSes risks having that code malfunction, as the geometry might not be the same. The solution is simple: Either do not use code that cares about this geometry information, or do not switch BIOSes. :smile:\n\n"
    },
    {
      "id": "166188",
      "timestamp": "2013-01-19T20:27:31+00:00",
      "author": "steve6375",
      "content": "\u003e There is no reason for a **BIOS** on one motherboard to use the same **C/H/S** geometry for a USB storage device as another BIOS on another motherboard.\n\u003e\n\u003e If you have code on the USB storage device (such as the code the **winnt.exe** is installing) that uses C/H/S geometry information, then switching BIOSes risks having that code malfunction, as the geometry might not be the same. The solution is simple: Either do not use code that cares about this geometry information, or do not switch BIOSes. :smile:\n\nThat was what I was trying to prove ![:dubbio:](http://reboot.pro/public/style_emoticons/default/dubbio.gif) . Also, it may be that if the USB drive was prepared using the Asus, and then booted and tested on the Asus, it might then work on the Sony...\n\n"
    },
    {
      "id": "166190",
      "timestamp": "2013-01-19T20:32:10+00:00",
      "author": "Wonko the Sane",
      "content": "@Fiction\n\nThe Faqs have a date of release (and you were explicitly pointed to #10 only).\n\nWe did learn something new in the meantime :wink:, but you cannot get the basics without *getting the basics* (and have a quick look at history).\n\nA working solution (though not particularly elegant :blush:) was found at the time, see the \"companion page\":\n\n[http://jaclaz.alterv...B/USBstick.html](http://jaclaz.altervista.org/Projects/USB/USBstick.html \"External link\")\n\nYou may use Tinyhexer (possibly with my MBRview structure viewer):\n\n[http://reboot.pro/to...-hexer-scripts/](http://reboot.pro/topic/8734-tiny-hexer-scripts/ \"\")\n\nto read the (most probably wrong) data the HP USB tool wrote in your stick partition table, then use this (still mine) worksheet to verify/check/play with numbers:\n\n[http://reboot.pro/to...a-translations/](http://reboot.pro/topic/2959-chs-lba-translations/ \"\")\n\nget the updated v2 from here: [http://reboot.pro/to...ations/?p\u003d74116](http://reboot.pro/topic/2959-chs-lba-translations/?p\u003d74116 \"\")\n\nAnyway, you understood most of the given resources correctly ![:thumbup:](http://reboot.pro/public/style_emoticons/default/thumbup.gif).\n\nThere are several different issues that may play a role, in your case as per the given link it is very likely it is a \"quirk\" of the Asus BIOS.\n\nTo get another idea of what happens when two BIOSes disagreee on the geometry of disk device, check this thread (again only *seemingly* unrelated):\n\n[http://www.911cd.net...topic\u003d23408\\\u0026hl\u003d](http://www.911cd.net/forums//index.php?showtopic\u003d23408\u0026hl\u003d \"External link\")\n\nSome additional (interesting) innfo related to:\n\n[http://blog.clemens....ndows_3170.html](http://blog.clemens.endorphin.org/2007/12/removing-chs-based-access-from-windows_3170.html \"External link\")\n\ncan be found here (when we actually gained knowledge of the above):\n\n[http://www.911cd.net...91](http://www.911cd.net/forums//index.php?showtopic\u003d21702\u0026st\u003d120\u0026p\u003d154091\u0026#entry154091 \"External link\")\n\n![:cheers:](http://reboot.pro/public/style_emoticons/default/cheers.gif)\n\nWonko\n\n"
    },
    {
      "id": "166209",
      "timestamp": "2013-01-20T11:25:05+00:00",
      "author": "Fiction",
      "content": "@Sha0 \\\u0026 steve\n\nDoes this mean I should run winnt.exe on the asus, or should I format the drive on the asus as well?\n\n@Wonko\n\nI\u0027ll play with the four byte MBR patch for a while (in combination with running winnt.exe on the asus)\n\nI really like be able to understand when a device has been formatted \u0027ballanced\u0027 and how I should fix this myself.\n\nThis: [http://jaclaz.alterv...B/USBstick.html](http://jaclaz.altervista.org/Projects/USB/USBstick.html \"External link\") is still a bit hard for me and btw most of thos utilities are no longer available using those links.\n\nI still have a difficult time knowing what all involved values in MBRview are (lol @ Kansas City Shuffle) and what they should be.\n\nI guess I\u0027ll re-read [http://jaclaz.alterv.../USBstick.html,](http://jaclaz.altervista.org/Projects/USB/USBstick.html, \"External link\") since it IS explained in there. Perhaps I can ask a more specific question about the first thing I do not understand.\n\nInteresting as it might be to do this manually once, this seems like a lot to do each time I need to boot somehting.\n\nIs there no utility to format the thing correctly in one go?\n\nPerhaps I should try this guy [http://reboot.pro/to...atch-001-alpha/](http://reboot.pro/topic/3191-mbrbatch-001-alpha/ \"\") after all?\n\nDo know that my forum activity will drop soon, since my study will start asking a fair amount of my time. I will continue to read posts on this thread, however I might not be able to respond on a daily basis. I hope this will not be a problem.\n\n\\*edit\\*\n\nI tried this: formated the drive using RMPrepUSB on my sony pc, then ran winnt.exe on the asus pc. When completed used tiny hexer to patch the 4 bytes. Result: it reads the contents of the boot.ini, and displays is, but when I try to pick the install option\n\u003e C:\\\\$WIN_NT$.\\~BT\\\\BOOTSECT.DAT \u003d \"Windows XP Installation/Upgrade\"\n\nI once again get the \u0027NTLDR is missing\u0027 message.\n\nI\u0027ll try playing with the boot.ini content.\n\n\\*edit2\\* most noticeable thing I got when changing the boot.ini was a hal.dll error.\n\nIt looks as if NTLDR switches back to CHS even with the four bytes patched. I\u0027ll try formating the device using the asus pc, but I think \u0027balancing\u0027 the drive has a greater chance.\n\n**Edited by Fiction, 20 January 2013 - 12:05 PM.**\n"
    },
    {
      "id": "166219",
      "timestamp": "2013-01-20T15:37:59+00:00",
      "author": "Wonko the Sane",
      "content": "Well, here we have a problem. ![:ph34r:](http://reboot.pro/public/style_emoticons/default/scared9.gif)  \nThere is NO \"**4** bytes **MBR** patch\" that I can recall.  \nThere are two different **4** bytes **PBR** (or bootsector) patches, one for FAT32 and one for NTFS.\n\nAnd a \"**3** bytes\"**MBR** patch (actually originated by the HP USB format utility) which we didn\u0027t talk about specifically (but that is linked in one of the given pages on 911CD):  \n[http://reboot.pro/to...s-info/?p\u003d14607](http://reboot.pro/topic/2246-grub4dos-info/?p\u003d14607 \"\")\n\nThe essence of balanced CHS/LBA is the following (do play a bit with the given CHS/LBA translating spreadsheet).\n\nIn a partition table the SAME (objectively) data is written TWO times according to TWO different standards.\n\nScope of a partition table entry is to univocally identify a \"region\" of the disk.\n\nThe CHS standard identifies a region by mentioning WHERE it starts and WHERE it ends.\n\nThe LBA standard identifies a region by mentioning HOW MANY sectors are before it\u0027s start and HOW MANY sectors is the region long.\n\nThe CHS uses as units sectors BUT uses them along a convention that \"groups\" sectors into \"heads\" and that groups \"heads\" into \"cylinders\".\n\nThink of the normal decimal system we use, you know that when you sum 9+1 you get 1 ten and that when you sum 99+1 you get 1 hundred.\n\nThe nice part of the decimal system is that \"groups\" like ten or hundred contain ten times the lesser level \"group\".\n\nWith CHS you have to take into account the geometry, i.e. the max number of items available, just like when you make 9+1 you are sayin that you have 1 ten and 0 units, BUT the max number of items available is not \"standard\" and can vary.\n\nPlease follow me.\n\nIf you had a \"fictional\" disk that had 10 sectors per head and 10 heads per cylinder, you would call first sector 001, second one 002, etc. ninth one 009, tenth one 010, eleventh one 011, etc.. ninetyninth one 099, hundredth one 100, etc.\n\nLet\u0027s try writing the above in HTU notation (Hundreds/Tens/Units), you would have 0/0/1, 0/0/2, 0/0/9, 0/1/0 0/1/1 0/9/9 and 1/0/0.\n\nBut if you had a \"strange\" numerical system where a ten is made out of 32 units and a hundredth was made of 64 tens, what would happen?\n\nSector #32 would be 0/0/32, #33 0/1/1, sector #2047 (64\\*32-1\u003d2047) will become 0/63/32, #2048 1/0/1.\n\nSo, let\u0027s say that you have a partition that starts on sector #33, it will be expressed in a geometry of n/64/32 as 0/1/1.\n\nIf it is 2016 sectors in size, it will end on sector #2048, i.e. on 0/63/32.\n\nNow let\u0027s see LBA.\n\nHow many sectors are before sector #33? Obviosly 32.\n\nHow many sectors are in the partition? Obviously 2016 /we decided by design this number).\n\nCongratulations, you have a valid, **balanced** partition table entry:\n\n0/1/1 - 0/63/32 - 32 - 2016\n\n(you can use EITHER of the TWO addressing methods to identify EXACTLY the SAME region on disk)\n\nBUT while the LBA addresses will remain the same NO MATTER which geometry is used (how many units make a ten and how many tens make a hundred) the CHS do NOT.\n\nIf you write that same partition entry on a device with a geometry of (say) n/16/63 what would happen?\n\nThe beginning is NOT anymore 0/1/1 but raher 0/0/33.\n\nThe end is NOT anymore 0/63/32 but rather 0/32/32.\n\nOn this device the SAME partition area will be expressed as:\n\n0/0/33 - 0/32/32 - 32 - 2016\n\nI hope this makes it more clear.\n\nNow a question for you.\n\nWhat do you think that EXACTLY is C:\\\\$WIN_NT$.\\~BT\\\\BOOTSECT.DAT? (i.e. what are it\u0027s contents? Try opening that file with tinyhexer and have a look at it)\n\n![:cheers:](http://reboot.pro/public/style_emoticons/default/cheers.gif)\n\nWonko\n\n"
    },
    {
      "id": "166244",
      "timestamp": "2013-01-20T23:32:55+00:00",
      "author": "Fiction",
      "content": "I need to get out early tomorrow so I wont be able to have a detailed look at your last post until at best tomorrow evening or at worst Wednesday. However I\u0027d like to say something about this\n\n\u003e Well, here we have a problem. ![:ph34r:](http://reboot.pro/public/style_emoticons/default/scared9.gif)  \n\u003e There is NO \"**4** bytes **MBR** patch\" that I can recall.  \n\u003e There are two different **4** bytes **PBR** (or bootsector) patches, one for FAT32 and one for NTFS\n\nI guess I meant the PBR. I read [http://en.wikipedia....ter_boot_record](http://en.wikipedia.org/wiki/Master_boot_record \"External link\") and am now aware that there are multiple bootsectors and that the MBR is the fist sector (do I understand correctly?). I am sorry I am wasting your time with my noobishness. I am sure you spend enough time explaining trivial things to noobs as is. It is really appreciated however.\n\nI jumped a bit ahead and took a look at the bootsect.dat. I was to curious to wait for tomorrow with this.\n\nIt seems like it contains a FAT32 bootsector. \u0027bootsect\u0027 I guess it should have rung a bell.\n\nIt is all there even the UNMODIFIED! 4 bytes I patched in the boot-sector on the drive itself... It seems worth a try to NOP these too...\n\n\\*edit\\*\n\nI still need to read your \u0027balancing tips\u0027 in your previous post. However I wanted to tell you that I could not wait to try NOP-ing the bytes in the bootsect.dat and it actually worked :tongue:\n\nI was able to successfully boot the txtsetup on a maximum size FAT32 partition on the asus FOR THE FIRST TIME. So we (aka you) are definitely on the right track: this IS a CHS issue indeed.\n\n**Edited by Fiction, 20 January 2013 - 11:43 PM.**\n"
    },
    {
      "id": "166260",
      "timestamp": "2013-01-21T10:05:17+00:00",
      "author": "Wonko the Sane",
      "content": "\u003e ....  \n\u003e I was to curious to wait for tomorrow with this.  \n\u003e ....  \n\u003e However I wanted to tell you that I could not wait to try NOP-ing the bytes in the bootsect.dat and it actually worked :tongue:  \n\u003e\n\u003e I was able to successfully boot the txtsetup on a maximum size FAT32 partition on the asus FOR THE FIRST TIME. So we (aka you) are definitely on the right track: this IS a CHS issue indeed.\n\nYep ![:thumbsup:](http://reboot.pro/public/style_emoticons/default/thumbsup.gif)  \nCuriosity - besides killing the cat ![:w00t:](http://reboot.pro/public/style_emoticons/default/w00t.gif) - does give some small satisfactions from time to time. :wink:  \n\nWrong attitude:  \nSpoiler  \n![n69eaamybv.jpg](http://media.fakeposters.com/results/2009/07/24/n69eaamybv.jpg)\n\n\u003cbr /\u003e\n\nRight ![:thumbup:](http://reboot.pro/public/style_emoticons/default/thumbup.gif) (though dangerous ![:ph34r:](http://reboot.pro/public/style_emoticons/default/scared9.gif)) one:\n\n\u003cbr /\u003e\n\nSpoiler  \n![curiosity-curiosity-cat-demotivational-p](http://3.bp.blogspot.com/-GMKlRy8Md7E/Tj2z5PUwy0I/AAAAAAAAAHc/bl4A_TkGbsY/s1600/curiosity-curiosity-cat-demotivational-poster-1260571018.jpg)\n\n\u003cbr /\u003e\n\nDon\u0027t worry :smile:, it does take some time to get all these pieces of info and assemble them together in a \"valid\" picture.\n\n![:cheers:](http://reboot.pro/public/style_emoticons/default/cheers.gif)\n\nWonko\n\n"
    },
    {
      "id": "166281",
      "timestamp": "2013-01-21T13:44:24+00:00",
      "author": "steve6375",
      "content": "You could always patch the file using grub4dos, if you reboot to grub4dos before it boots from the HDD  \n\n```\ntitle Patch \\\\$WIN_NT$.~BT\\\\BOOTSECT.DAT\n\nset OS\u003d\nset BT\u003d\nif exist (hd0,0)/$WIN_NT$.~BT/BOOTSECT.DAT set BT\u003d(hd0,0)/$WIN_NT$.~BT/BOOTSECT.DAT\nif exist (hd1,0)/$WIN_NT$.~BT/BOOTSECT.DAT set BT\u003d(hd1,0)/$WIN_NT$.~BT/BOOTSECT.DAT\nif exist (hd1,1)/$WIN_NT$.~BT/BOOTSECT.DAT set BT\u003d(hd1,1)/$WIN_NT$.~BT/BOOTSECT.DAT\nif exist (hd1,2)/$WIN_NT$.~BT/BOOTSECT.DAT set BT\u003d(hd1,2)/$WIN_NT$.~BT/BOOTSECT.DAT\nif \"%BT%\"\u003d\u003d\"\" pause --wait\u003d3 Cannot find /$WIN_NT$.~BT/BOOTSECT.DAT \u0026\u0026 configfile /menu.lst\n# detect OS\ncat --skip\u003d3 --length\u003d8 --locate\u003dMSWIN4.1 %BT% \u003e nul \u0026\u0026 set OS\u003dFAT32\ncat --skip\u003d3 --length\u003d8 --locate\u003dMSDOS5.0 %BT% \u003e nul \u0026\u0026 set OS\u003dFAT32\ncat --skip\u003d3 --length\u003d4 --locate\u003dNTFS %BT% \u003e nul \u0026\u0026 set OS\u003dNTFS\nif \"%OS%\"\u003d\u003d\"\"  pause --wait\u003d3 Sorry - can\u0027t determine OS of BOOTSECT.DAT \u0026\u0026 configfile /menu.lst\necho FOUND %OS%\ncat --hex --length\u003d0xf0 %BT%\nset /p ASK\u003dPress Y to patch file (Y/N): \nif not /i \"%ASK%\"\u003d\u003d\"Y\" configfile /menu.lst || echo -e \\n\\r\necho Patched file is now...\nif \"%OS%\"\u003d\u003d\"FAT32\" cat --skip\u003d0xe6 --locate\u003d\\x0f\\x82\\x4a\\x00 --replace\u003d\\x90\\x90\\x90\\x90 %BT% \u003e nul\nif \"%OS%\"\u003d\u003d\"NTFS\" cat --skip\u003d0xd9 --locate\u003d\\x0f\\x82\\x3a\\x00 --replace\u003d\\x90\\x90\\x90\\x90 %BT% \u003e nul\nif not \"%OS%\"\u003d\u003d\"\" cat --hex --length\u003d0xf0 %BT%\necho Finished - press a key to continue...\npause\n```\n\n\u003cbr /\u003e\n\n"
    },
    {
      "id": "166335",
      "timestamp": "2013-01-21T21:26:27+00:00",
      "author": "Fiction",
      "content": "@Wonko\n\nI read your post. I\u0027m not sure I understand correctly when it is NOT balanced then.\n\nI looked at the worksheet, but it is not intuitive to me what values I should put in there myself and what once should be calculated automatically. About the value\u0027s I should put in there myself: how should I determine those? Preferably I\u0027d use windows 7/xp compatible software while running these systems (if possible). I guess I could use your MBRviewer script for tiny hexer to help me write the worksheet values onto the bootsectors?\n\n@steve\n\nInteresting, I did not know I could patch files using grub4dos. However I have access to a second computer so this should not be necessary.\n\n"
    },
    {
      "id": "166363",
      "timestamp": "2013-01-22T10:50:40+00:00",
      "author": "Wonko the Sane",
      "content": "\u003e @Wonko  \n\u003e I read your post. I\u0027m not sure I understand correctly when it is NOT balanced then.\n\nIn the example posted, imagine that you have this entry:  \n0/1/1 - 0/63/32 - 32 - 2016  \nAs seen, this is perfectly \"balanced\" on a BIOS that detects the device as m/64/32.  \nThis means that IF the BIOS uses CHS only (let\u0027s say with a partition type of 06 - FAT 16 CHS mapped) it will find the PBR on first sector of the second cylynder, i.e. 32\\*1+1\u003d33: it\u0027s the 33rd sector.  \nOf course IF the BIOS uses LBA only (let\u0027s say with a partition type of 0E - FAT 16 LBA mapped) it will find the PBR after 32 sectors, i.e. 32+1\u003d33: it\u0027s the 33rd sector.  \nBut what happens on another BIOS that sees the device as having a geometry of n/16/63?  \nFor LBA there are NO issues, as 32+1\u003d33: it\u0027s still the 33rd sector.  \nFor CHS the first sector of the second cylinder *suddenly* becomes 63\\*1+1\u003d64: it is the 64th sector, of course since NO PBR is there in this BIOS it won\u0027t be found.\n\nThe SAME partition entry will be \"balanced\" on a m/64/32 geometry BUT unbalanced on a n/16/63.\n\nBUT what the HP USB Format utility often does is something slightly different.\n\nLet\u0027s assume that the hypothetical device does have a n/16/63 geometry and a total capacity of 3180 ![:w00t:](http://reboot.pro/public/style_emoticons/default/w00t.gif) sectors.\n\nThe HP utility will try to use ALL available sectors, so the LBA part will be obviously \"63-3117\".\n\nThe **P**BR will have this data:\n\n* sectors before 63\n* total sectors 3117\n* number of sectors 63\n* number of heads 16\n\nBut what happens to the CHS?\n\nThe starting triplet is easy, it will be 0/1/1.\n\nThe ending one will be tricky. ![:dubbio:](http://reboot.pro/public/style_emoticons/default/dubbio.gif)\n\nThe CHS on n/16/63 corresponding to LBA \"63-3117\" (try making it on the spreadsheet) is 3/2/30.\n\nBUT the HP formatting utility uses \"orthodox\" partitioning where a partition should alway end on a cylinder boundary.\n\nThe highest cylinder boundary BEFORE 3/2/30 is (obviously) 2/15/63, and this is the value that the HP tool will write.\n\nSo you will have a partition table of:\n\n0/1/1 - 2/15/63 - 63 - 3117\n\nwhich is UNbalanced on \\*any\\* geometry.\n\nA BIOS may (legitimately or not) calculate the size of the partition from the CHS data (try doing it on the spreadsheet) and the result will be a corresponding LBA of 63-2961.\n\nThe BIOS now, knowing that the partition is 2961 sectors in size, may access the PBR and check the number of sector written in there (which will be 3117) and since 2961 is different from 3117 could throw an error.\n\n\u003e I looked at the worksheet, but it is not intuitive to me what values I should put in there myself and what once should be calculated automatically. About the value\u0027s I should put in there myself: how should I determine those? Preferably I\u0027d use windows 7/xp compatible software while running these systems (if possible). I guess I could use your MBRviewer script for tiny hexer to help me write the worksheet values onto the bootsectors?  \n\nThere are several sheets in the spreadsheet.\n\nIn that version V2 the \"main\" sheet is the one called \"PTtables\".\n\nIn it you can:\n\n1. define the geometry of the device in cells F4:H4\n2. define MBR+hidden sectors (as CHS only. but the \"orthodox\" partiioning has alway 0/0/1-0/0/S where S in the number of sectors in H4)\n3. input some data in either of the three available modes **CHS** -\\\u003eLBA, **LBA** -\\\u003eCHS, **Numsec**-\\\u003eCHS\n\nFor the reason stated, unless you define a CHS geometry first, the sheet will calculate \"wrong\" data.\n\nOnce you are satisfied with the result, you can (manually) write the values in the PT_to_MBR sheet and obtain the resulting \"look\" (and hex values) those data will have in an actual hex editor.\n\nThe other way round, you can write the hex values of a MBR you have opened with tinyhexer or other hex editor in the MBR_to_PT sheet and obtain a \"readable\" partition table (same that you would get using directly PTView with tinyhexer).\n\n![:cheers:](http://reboot.pro/public/style_emoticons/default/cheers.gif)\n\nWonko\n\n"
    },
    {
      "id": "167195",
      "timestamp": "2013-02-04T20:07:26+00:00",
      "author": "Fiction",
      "content": "Ok, I hope you still check this treat from time to time :tongue:\n\nI am trying to \u0027balance\u0027 a 4GB (NOT GiB!) flashdrive. So the first thing I\u0027ll need to know is how many sectors per head and heads per cylinder I am dealing with. Is this a BIOS specific thing, or is this writen in the sector 0 somewhere?\n\n"
    },
    {
      "id": "167199",
      "timestamp": "2013-02-04T20:23:26+00:00",
      "author": "Wonko the Sane",
      "content": "\u003e Ok, I hope you still check this treat from time to time :tongue:  \n\u003e\n\u003e I am trying to \u0027balance\u0027 a 4GB (NOT GiB!) flashdrive. So the first thing I\u0027ll need to know is how many sectors per head and heads per cylinder I am dealing with. Is this a BIOS specific thing, or is this writen in the sector 0 somewhere?\n\nNo, first thing that you need to know is device capacity, EXACT one, in bytes (or sectors).\n\n\u003cbr /\u003e\n\nThe most reliable (in my *perverted*mind) way to do this is detailed here:\n\n[http://reboot.pro/to...-alpha/?p\u003d38197](http://reboot.pro/topic/5000-managing-mbrs-by-jaclaz-mbrbatch-release-001-alpha/?p\u003d38197 \"\")\n\njust run dsfo redirecting to nul and jolt down the size in bytes.\n\nRMPREPUSB should have provisions to test (or just compute) size correctly, BTW.\n\nThen you can use the 255/63 HS geometry allright.\n\n![:cheers:](http://reboot.pro/public/style_emoticons/default/cheers.gif)\n\nWonko\n\n"
    },
    {
      "id": "167204",
      "timestamp": "2013-02-04T22:50:14+00:00",
      "author": "Fiction",
      "content": "Ok, I\u0027ll start looking for it\u0027s size in bytes then. I\u0027ll use suggested method. Why the 255/63 geometry? Is this just \u0027agreed on\u0027 or something? If so, then perhaps the asus motherboard discussed earlier might have a different idea of how many sectors there are in a head, and how many heads there are per cylinder. This could then explain earlier behaviour. If so, how would I determine the geometry this bios uses and make the device \u0027balanced\u0027 according to this motherboard.\n\nOr perhaps I am just jumping to conclusions now, impatient as always :tongue:\n\n\\*edit\\*\n\ndsfo returns:\n\n\\\\\\\\.\\\\PHYSICALDRIVE1 - The drive cannot find the sector requested.  \nThis error can probably be ignored.  \nOK, 3880452096 bytes, 281.472s, MD5 \u003d 7e948aa5aeb933d27efc12e5eec3ee71\n\nSo if this error can indeed be ignored, then 3880452096/512\u003d7579008 sectors, right?\n\nWindows disk management tells me 3.61GiB and since 3.880GB/(1.024\\^3)\u003d3.613 GiB, this seems about right, however we might not spot a sector more or less on this scale\n\n.\n\nAnd this thing sells for 4 GB \u003d/ looks like a 0.2 GB rip-off to me.\n\n**Edited by Fiction, 04 February 2013 - 11:23 PM.**\n"
    },
    {
      "id": "167232",
      "timestamp": "2013-02-05T09:46:28+00:00",
      "author": "Wonko the Sane",
      "content": "\u003e So if this error can indeed be ignored, then 3880452096/512\u003d7579008 sectors, right?\n\nYes. :smile:\n\nThe 255/63 is the most common geometry for anything bigger than 512 Mb AND it is the \"default\" one in Windows NT starting from 2K.\n\nIf you think about it a little, knowing that the max value of cylinder is 1024, and knowing that the most common HS geometries are:\n\n255/63\n\n128/63 \\\u003c- rare\n\n64/63 \\\u003c- rare\n\n16/63\n\n64/32 \\\u003c- original NT and some CF cards and the like\n\nand the \"queer\" (a number of Lenovo\u0027s and a few HP\u0027s, mainly laptops use this one, but normally NOT for USB connected devices, only for \"internal\" disks):\n\n240/63\n\nYou can draw some lines about maximum capacity that you can address in CHS:\n\n**1024\\*255\\*63\\*512\u003d8,422,686,720** \\\u003c- 7th size barrier at 7.88 GiB/8.46 GB \\\u003c- 2nd GREAT CHS size barrier\n\n1024\\*240\\*63\\*512\u003d7,927,234,560 \\\u003c- 6th size barrier at 7.38 GiB /7.93 GB\n\n1024\\*128\\*63\\*512\u003d4,227,858,432\n\n1024\\*64\\*63\\*512\u003d2,113,929,216\n\n**1024\\*16\\*63\\*512\u003d528,482,304** \\\u003c- 1st size barrier at 504 MiB /528 MB \\\u003c- 1st GREAT CHS size barrier\n\n1024\\*64\\*32\\*512\u003d1,073,741,824\n\nSee also:\n\n[http://www.pcguide.c...d/bios/size.htm](http://www.pcguide.com/ref/hdd/bios/size.htm \"External link\")\n\n(AND connected pages)\n\n**bolded** ones are the most common and 16/63 tops at 528 Mb, which leaves us with only 255/63 as likely candidate.\n\n![:cheers:](https://reboot.pro/public/style_emoticons/default/cheers.gif)\n\nWonko\n\n"
    },
    {
      "id": "167238",
      "timestamp": "2013-02-05T10:35:33+00:00",
      "author": "Fiction",
      "content": "Ok, so then what do you thing this motherboard is being \u0027sensitive\u0027 about? Is it just that other motherboards use LBA ALWAYS even though the xp bootsector suggests otherwise, or is it indeed possible that the ASUS bios decided on a different geometry. If so how would I determine what this geometry is?\n\n"
    },
    {
      "id": "167244",
      "timestamp": "2013-02-05T11:26:08+00:00",
      "author": "Wonko the Sane",
      "content": "\u003e Ok, so then what do you thing this motherboard is being \u0027sensitive\u0027 about? Is it just that other motherboards use LBA ALWAYS even though the xp bootsector suggests otherwise, or is it indeed possible that the ASUS bios decided on a different geometry.\nSome ASUS BIOS have been reported as being \"queer\", but there is no \"definite answer\". If so how would I determine what this geometry is?\nBy experimenting.  \n\n![:cheers:](https://reboot.pro/public/style_emoticons/default/cheers.gif)  \nWonko   \n"
    },
    {
      "id": "167248",
      "timestamp": "2013-02-05T11:45:46+00:00",
      "author": "steve6375",
      "content": "You could install grub4dos on the boot drive, boot to grub4dos and then type\n\n**geometry**\n\n**geometry --tune**\n\n**chainloader /ntldr**\n\n**boot**\n\nand see what you get (and if it fixes the problem)?\n\n"
    },
    {
      "id": "167285",
      "timestamp": "2013-02-05T19:37:19+00:00",
      "author": "Fiction",
      "content": "Ill first try to get it 255/63 balanced\n\nand perhaps then (if it does not work) a few more from wonko\u0027s list.\n\nAfter that ill try the grub4dos from steve\n\n"
    },
    {
      "id": "167287",
      "timestamp": "2013-02-05T19:49:10+00:00",
      "author": "steve6375",
      "content": "OK, if you install grub4dos, you can later uninstall it again and install standard MBR using RMPrepUSB Ctrl-B.\n\n"
    },
    {
      "id": "167289",
      "timestamp": "2013-02-05T20:13:37+00:00",
      "author": "Fiction",
      "content": "What do you mean \u0027standard MBR\u0027? BTW it looks as if RMPrepUSB formatted the drive 255/63 \u0027balanced\u0027. So apparently, this is not the geometry the bios is looking for.\n\nYour method will tell me what geometry the bios uses?\n\n"
    },
    {
      "id": "167292",
      "timestamp": "2013-02-05T20:36:49+00:00",
      "author": "Wonko the Sane",
      "content": "He means \"Standard MBR **CODE**\" (NOT \"data\", i.e. the partition table entries and disk signature that remain UNMODIFIED when you write ONLY a different CODE part).\n\nI hoped that this point was clear.\n\nGo back to DOS and fdisk /MBR command explanation:  \n[http://support.micro.../kb/69013/en-us](http://support.microsoft.com/kb/69013/en-us \"External link\")\n\n![:cheers:](https://reboot.pro/public/style_emoticons/default/cheers.gif)\n\nWonko\n\n"
    },
    {
      "id": "167296",
      "timestamp": "2013-02-05T21:04:31+00:00",
      "author": "steve6375",
      "content": "As I understand the current situation, you have a solution (patch the bytes in bootsect.dat) - so the objective now is that **for the sake of curiosity**, you want to boot from USB and see what the disk geometry is reported by the BIOS as. Is this correct?\n\nIf this is so, install grub4dos on your USB disk and boot to grub4dos and use commands I suggested.\n\nYou can never fix it by changing the USB partition geometry - if you fix it for one BIOS, it will probably not work on a different BIOS. The 4 byte bootsect.dat patch is the best solution.\n\n"
    },
    {
      "id": "167298",
      "timestamp": "2013-02-05T21:16:10+00:00",
      "author": "Fiction",
      "content": "Indeed, I want to be able to boot the device without the 4byte patch, as a conformation of \u0027good understanding\u0027. I am trying to install grub4dos right now, but have not done this before so I\u0027m not sure how this should be done. I\u0027m trying a mixture of trial and error and bits and pieces from all over the web. I got something working a few minutes back, but it was just an ordinary bootloader, no command screen to type these commands in. When I succeed I\u0027ll let you know.\n\n"
    },
    {
      "id": "167299",
      "timestamp": "2013-02-05T21:18:32+00:00",
      "author": "steve6375",
      "content": "To install grub4dos\n\n1. Run RMPrepUSB\n\n2. Click on the**Install grub4dos**button (the clue is in the name!)\n\n3. Follow the prompts (choose MBR and hit Enter to copy grldr file)\n\nNot too difficult is it? ![:dubbio:](https://reboot.pro/public/style_emoticons/default/dubbio.gif)\n\n"
    },
    {
      "id": "167301",
      "timestamp": "2013-02-05T21:40:01+00:00",
      "author": "Fiction",
      "content": "Yeah, I just saw the button right before you posted. I wanted to edit the post, but you out-posted me. I feel a bit silly now. :tongue:\n\nAnyway the commands return:\n\n\u003e geometry\n\u003e\n\u003e drive 0x80(LBA): C/H/S\u003d471/255/63, Sector Count/Size\u003d7572096/512\n\u003e\n\u003e Partition num: 0, active, Filesystem type is fat, partition type 0x0C\n\ngeometry --tune returns the exact same thing\n\n\u003e chainloader /ntldr\n\u003e\n\u003e Error 15: File not found\n\nThis is probably because I recently reformatted the drive. This command is to manually load the ntldr bootloader is it not? Then this will not tell me mutch about the geometry will it?\n\n\u003e boot\n\u003e\n\u003e Error 8: Kernel must be loaded before booting\n\npossibly the same reason.\n\nSo what does this tell us? That this bios actually DOES use the 255/63 geometry?\n\n\\*edit\\*\n\nBTW while running this, the MBR according to jaclaz MBRview looks like:\n\n\u003e ![26178174.png](http://img706.imageshack.us/img706/1166/26178174.png)\n\n\u003cbr /\u003e\n\n**Edited by Fiction, 05 February 2013 - 09:56 PM.**\n"
    },
    {
      "id": "167306",
      "timestamp": "2013-02-05T22:55:27+00:00",
      "author": "steve6375",
      "content": "It seems that way. The [article](http://blog.clemens.endorphin.org/2007/12/removing-chs-based-access-from-windows_3170.html \"External link\") states that ntldr not found occurs when the partition is within 1024/255/63 and the BIOS geometry does not match the parameters in the PBR.\n\nThe BIOS geometry seems to be 255/63.\n\nSo you need to generate the \u0027ntldr not found\u0027 state on the USB drive and then look at the PBR heads/sectors values in the bootsect.dat (and the USB PBR too) or attach the file to a post.\n\n"
    },
    {
      "id": "167320",
      "timestamp": "2013-02-06T10:32:32+00:00",
      "author": "Wonko the Sane",
      "content": "Hold your horses.  \n\nThe chainloader /ntldr giving error 15 has NOTHING to do with geometry, MBR or PBR (it means that the file is NOT on the drive which is currently root)  \n\ntry instead:  \n\n```\nls\n```\n\n\u003cbr /\u003e\n\nand:  \n\n```\nfind --set-root /ntldr\nroot\nls\n```\n\n\u003cbr /\u003e\n\n@Fiction  \nWhen talking of **P** artition **T** ables entries, the **PT** view is more suited :wink:.  \n\n![:cheers:](https://reboot.pro/public/style_emoticons/default/cheers.gif)  \nWonko   \n"
    },
    {
      "id": "167361",
      "timestamp": "2013-02-06T19:23:20+00:00",
      "author": "steve6375",
      "content": "I have been experimenting with WinToFlash a little and written up my findings.\n\nPlease see [**tutorial 102**](http://www.rmprepusb.com/tutorials/wintoflash \"External link\")\n\nIt shows how you can convert the USB stick to NTFS so that the Stage 1 text mode install will run faster.\n\n"
    },
    {
      "id": "167364",
      "timestamp": "2013-02-06T20:01:31+00:00",
      "author": "Fiction",
      "content": "Thanks but I prefere FAT32 since it can be \u0027optimized for quick removal\u0027.\n\n@Wonko\n\nThe device was partitioned as follows:\n\nbC 0\n\nbH 1\n\nbS 1\n\neC 470\n\neH 254\n\neS 63\n\nStart 63\n\nNum 7566552\n\nYou excel sheet suggested changing de eS 63 to eS 1, but this did not work (using tiny hexer). The table cell was coloured red, so perhaps this cell\u0027s value needs to stay 63 for compadibility reasons. My next try was:\n\nI changed that (using tiny hexer) to\n\nbC 0\n\nbH 1\n\nbS 1\n\neC 470\n\neH 254\n\neS 63\n\nStart 63\n\nNum 7566614\n\nSince we did conclude earlier that there are 7579008 available sectors, so I thought this might work. It did not.\n\nIs it actually possible to change these values using tiny hexer like i did, or am I supposed to reformat the thing afterwards?\n\n"
    },
    {
      "id": "167366",
      "timestamp": "2013-02-06T20:46:33+00:00",
      "author": "Wonko the Sane",
      "content": "Well, you don\u0027t actually need the spreadsheet to verify a set of values (if you prefer, converting CHS to LBA is trivial, LBA to CHS is slightly more complex).\n\n0/1/1 is LBA 63\n\n(470+1)\u003d471\n\n(254+1) \u003d255\n\n63\u003d63\n\n471\\*255\\*63\u003d7566615 \\\u003c- this is absolute end sector (i.e. it is the sector at offset 756614 or - if you prefer - there are 756614 sectors before this)\n\nBut there are 63 sectors before, so the size (number of sectors in the partition) is:\n\n7566615-63\u003d7566552\n\nA balanced setup with 255/63 geometry is:\n\n0/1/1 - 470/254/63 - 63/756552\n\nAnd my spreadsheet does give these same values.\n\nSo, I am wondering if there is a misunderstanding somewhere. ![:unsure:](https://reboot.pro/public/style_emoticons/default/unsure.png)\n\n![:cheers:](https://reboot.pro/public/style_emoticons/default/cheers.gif)  \nWonko\n\n"
    },
    {
      "id": "167377",
      "timestamp": "2013-02-06T22:30:51+00:00",
      "author": "Fiction",
      "content": "What I did: I pasted 7566552 inside of (#0 LBA\\\u003eCHS row of PTtables) the \u0027End addr LBA\u0027 column of the, this value is called \u0027num sectors\u0027 in PT view. The sheets suggested to me: 470/254/1 But displayed the 1 in red. I tried this and it did not work. Then I thought, perhas the red cell means it could couse some sort of problems for a value like that, so I filled in 470/254/63 in the CHS\\\u003eLBA the LBA end adress became 7566614. However I now realize the \u0027LBA end adress should probbably be the absolute adress, not the relative one. The LBA value in PT view is relative then? I thought the sheets would be made so peaple could just copy stuff from PT view over. Appereantly I should have added the offset fist.  \n\nAnyway if that value is balanced, then I\u0027m nowhere anyway, since these are the values the device had from the start, I\u0027m possitive they do not work \u003d/ Any idea what the bios might be doing, if the CHS would actually BE balanced, but would still not work?\n\n\\*edit\\*\n\nYou add this \u00271\u0027 to the cylinders and the heads because they do start at 0, while the sectors start at 1?\n\n\\*edit 2\\*\n\nif i understand correctly now, the \u0027LBA end adress\u0027 as it is called in the sheet is the not just the absolute value, but the absolute value -1, because it is an adress and these start at 0?\n\n**Edited by Fiction, 06 February 2013 - 10:40 PM.**\n"
    },
    {
      "id": "167392",
      "timestamp": "2013-02-07T11:22:15+00:00",
      "author": "steve6375",
      "content": "@Fiction - did you take a look at my **[Tutorial 102](http://www.rmprepusb.com/tutorials/wintoflash \"External link\")** ?\n\nIt has a way of *avoiding*using bootsect.dat and ntldr for the 1st stage Setup - thus no need to patch it and it should work on all systems.\n\nre. using NTFS - in my case using standard FAT32, the copyfiles 1st stage took over 70 minutes - when I converted the same stick to NTFS, the same stage took **4 minutes**!\n\n"
    },
    {
      "id": "167393",
      "timestamp": "2013-02-07T11:36:33+00:00",
      "author": "Wonko the Sane",
      "content": "The columns of data that you actually have in a partition table are:\n\n\u003e Type/Boot/bCyl/bHead/bSect/eCyl/eHead/eSect/Start Sector/Num Sectors\n\nall the other ones are not there.\n\nI think I can see the misunderstanding that happened.\n\nThe CHS data has two sets of values that are BOTH \"addresses\" (the begin address and the end address, each one in CHS notation).\n\nEach of the set of values identify a sector.\n\nThe LBA data has instead two values that are not addresses.\n\nStart Sector (which is often referred to as \"Sectors before\") can be thought as an address, but as a matter of fact is the number of sectors before a given one.\n\nNum Sectors is not an address at all, it is a quantity, the number of sectors included in the partition.\n\nAn LBA address is an offset (or if you prefer an address 0 based), whilst Start Sector (or \"Sectors Before\") represents also a LBA address, Num Sectors does not.\n\nThe first LBA sector in your partition is LBA sector 63 \u003d Sectors Before 63 \u003d Start Sector 63.\n\nThe last LBA sector in your partition is LBA sector 7556614 (i.e. 63+756652-1).\n\nFirst sector in LBA notation is LBA 0, or if you prefer is the sector that has 0 sectors before it.\n\nSecond sector in LBA notation is LBA 1 (or the sector that has 1 sectors before it), etc.\n\n64th sector (CHS 0/1/1) in LBA notation is LBA 63 (or the sector that has 63 sectors before it).\n\nSo you have something that starts on 64th sector (LBA 63), and is 756652 sectors long.\n\nIt\u0027s final LBA address will be 63+756652-1\u003d7556614 (there are 7556614 sectors before it).\n\nThe CHS data in a partition table represent (both sets) addresses.\n\nThe LBA data in a partition table represent (respectively) an address (Start Sector) and a length (Num Sectors) \\\u003c- it is not \"pure\" LBA data.\n\nThe three sets in the spreadsheet are needed because you can have:\n\n* CHS address data (both addresses)\n* LBA address data (both addresses) \\\u003c- \"pure\" LBA data\n* \"NumSec\" which are one address and one length. \\\u003c- \"mixed\" LBA data as actually written in a partition table entry\n\nThe LBA data that you can read in (or want to write to) a partition table entry are \"mixed\" data, composed of one address and one length/extension.\n\nI hope that now the idea is more clear.\n\n![:cheers:](https://reboot.pro/public/style_emoticons/default/cheers.gif)\n\nWonko\n\n\u003cbr /\u003e\n\n"
    },
    {
      "id": "167423",
      "timestamp": "2013-02-08T00:01:02+00:00",
      "author": "Fiction",
      "content": "I think it is.\n\n\u003e The last LBA sector in your partition is LBA sector 7556614 (i.e. 63+756652-1).\n\nYou mean the sector with 63+756652-1 sectors \u0027in front of it\u0027 right? That\u0027s where the \u0027-1\u0027 comes from.\n\nI think I already did understand most of the other stuff you just said, I just mixed up the \u0027Num sec\u0027 and \u0027lba end adress\u0027 columns while using the sheets.\n\nThis is why: I thought the sheets would be made in such a way, to allow data from PT view to be copied in directly. However, in PT view we have \u0027num sec\u0027 which is calculaded automatically by the sheets. In stead I need to fill in the \u0027lba end adress\u0027. Which in this case would be numsec+63-1 indeed.\n\nSo now the sheets agree and 0\\\\1\\\\1 470\\\\254\\\\63 63\\\\7566552 is \u0027balanced\u0027. However I tried using this geometry a couple of times before. I\u0027m quite sure this one does not work on the asus motherboard. But according to grub4dos the geometry the bios uses is 255\\\\63 and we are using this now. So why won\u0027t it work? Is it possible this bios simply cannot use CHS properly altogether? How would I test this?\n\n"
    },
    {
      "id": "167433",
      "timestamp": "2013-02-08T11:34:19+00:00",
      "author": "Wonko the Sane",
      "content": "\u003e I think it is.  \n\u003e\n\u003e You mean the sector with 63+756652-1 sectors \u0027in front of it\u0027 right? That\u0027s where the \u0027-1\u0027 comes from.\n\nYes and no.  \n\nLBA addresses sectors with \"base\" 0.  \nIn technical terms, this means that a LBA address is an offset.  \nIn layman terms this equates to say that a LBA address is \"how many sectors are before it\".  \n\nWhen you count items, you start by 1.  \nThe mentioned formula should actually be written as 63+(756652-1).  \nExample, imagine a (small) device made of 6 sectors:  \n1st sector is LBA 0   \n2nd sector is LBA 1  \n3rd sector is LBA 2  \n4th sector is LBA 3  \n5th sector is LBA 4  \n6th sector is LBA 5  \nImagine to have 1 hidden sector and two (very small) partitions, each two sectors long.  \nThe length (extensions) will be:  \nHidden sectors: 1  \n1st partition: 2  \n2nd partition: 2  \nUnused sectors: 1  \n1+2+2+1\u003d6  \n\nThe beginning of the hidden sectors is at LBA address 0.  \nThe beginning (first sector) of the 1st partition is at LBA 1  \nThe end (last sector) of the first partition is at LBA 2  \nThe beginning (first sector) of the 2nd partition is at LBA 3.  \nThe end (last sector) of the first partition is at LBA 4  \n\nIn the partition table you will have this LBA data:  \n1st partition **1**/**2**  \n2nd partition **3**/**2**  \n\nThe **green** numbers are already LBA addresses, the **red** ones are the extensions of the partitions.  \n\nCHS numbering uses for S numbering starting from 1, of course in this case Heads and Cylinders will be 0.  \nSo you will have:  \n1st partition **0/0/2 - 0/0/3**  \n2nd partition **0/0/4 - 0/0/5**  \nthese are ALL addresses,  \nIf you want to know the extension of the partition from the CHS data, you need to:  \n1st partition **3-2**+1\u003d**2**  \n2nd partition **5-4** +1\u003d**2**  \nBecause when you calculate the number of items in a range you have to add 1.  \nWhen yoy do the reverse, i.e. calculate an end of a range, as an address, you need to subtract it.  \n\nBack to main topic, now.  \nWHAT is the problem? ![:unsure:](https://reboot.pro/public/style_emoticons/default/unsure.png)  \nYou have now a \"balanced\" CHS and LBA address.  \nThis will allow to have \\*any\\* kind of BIOS that recognizes to that device a BIOS HS geometry of 255/63 to recognize the partition correctly, NO matter if it uses the CHS or the LBA data (or both) in the partition table.  \nNO doubt that \\*any\\* MBR code with this data will be able to get to the PBR or bootsector (BUT a number of BIOSes night have issues with the MBR code itself, as they \"look for a given \"pattern\" in the CODE).  \nThe usual recommendation is to use a \"known\" MBR code (like the \"standard\" DOS one or the \"standard\" Windows 2K/XP one).  \nThe idea (mine) is that BIOS programmers with more than one neuron (but not exceeding the limit of two) while might have senselessly written some check on the code, has actually tested the bootability with the most common MBR code found around.  \nSee:  \n[http://reboot.pro/to...d-i-have-found/](http://reboot.pro/topic/10503-most-compatible-usb-stick-grub4dos-method-i-have-found/ \"\")  \nAND a number of BIOSes may NOT \"like\" USB devices bigger than (say) 256 Mb or 512 Mb or 1 Gb or 2 Gb (admittedly oldish motherboards only).  \n\nLet\u0027s say that the MBR code is executed correctly by the BIOS and that it will \"land\" on the right sector (the PBR or bootsector of first, active partition).  \nWhat code is there?  \nWhich data is in the BPB (BIOS PARAMETER BLOCK)?  \nHow these will result when combined with what the \\*whatever\\* the BIOS might (or might not) do?  \nIn theory, the BIOS should have detected a HS geometry of 255/63, and if in the PBR BPB containf the same 255/63 everything should be fine and dandy.  \nBut if either the HS geometry has been set by BIOS diffeerently or \\*something else\\* happened, a bootsector code that actually checks the HS data may be the reason for failure in booting.  \nAnd we get back to:  \n[http://blog.clemens....ndows_3170.html](http://blog.clemens.endorphin.org/2007/12/removing-chs-based-access-from-windows_3170.html \"External link\")  \nby removing the check for HS data in the bootsector, we remove this possibility, and only the \"sectors before\" field of the BPB is used (but still \\*something else\\* in the BIOS may happen).  \nSo, the check is not performed, the partition start is set correctly, the next step is loading the operating system \"system file\" or bootloader/bootmanager.  \nAnd here there may be another hiccup, the code in this latter may (as an example) be unable to \"find itself\" if the file is positioned beyond a given \"limit\" (this could be one of the CHS limits, 4 Gb on CDFS or another arbitrary limit).  \n\nThe \"right\" procedure (before entering \"special\" partitioning/formatting like fbinst might do or the three-ways approach and without using other \"dedicated\" apps) is the following:\n\n* partition the stick from 2K/XP Disk Manager (you will need to install a filter driver) or use MBRBATCH or an image of the stick in a VM\n* format the stick from 2K/XP\n* copy to the newly made partition just NTLDR and BOOT.INI (the boot.ini needs to have at least two entries, I would suggest one of the two pointing to grldr (and add grldr to root also)\n* try booting from it and see if you get to the BOOT.INI choices\n* verify that the CHS and LBA are balanced (they will be)\n* patch the bootsector code to remove the CHS check\n* try booting from it and see if you get to the BOOT.INI choices\n* patch the MBR with the HP Patch\n* try booting from it and see if you get to the BOOT.INI choices\n\nThis is all you can do (again set aside \"special\" tools and approaches) to have a \"most compatible\" stick.  \n\nBUT (isn\u0027t there always a but) there might be still an issue, which is those BIOS that believe a stick to be a \"hard disk like\" device ONLY if they find in it\u0027s partition table TWO entries (two partitions).  \n\nSo you need to actually (BTW this is what RMPREPUSB does) \"shrink\" a little bit the first partition and add a small \"fake\" partition, one cylinder in size (between steps #1 and #2 above).  \nYou have now:  \n0/1/1 - 470/254/63 - 63/756552  \nthis must be changed to:  \n0/1/1 - 469/254/63 - 63/7550487  \n470/0/1 - 470/254/63 -7550550/16065\n\n![:cheers:](https://reboot.pro/public/style_emoticons/default/cheers.gif)\n\nWonko\n\n\u003cbr /\u003e\n\n"
    },
    {
      "id": "167437",
      "timestamp": "2013-02-08T12:37:28+00:00",
      "author": "Fiction",
      "content": "\u003e partition the stick from 2K/XP Disk Manager (you will need to install a filter driver) or use MBRBATCH or an image of the stick in a VM\n\nWhat is \u0027a filter driver\u0027 and how do I install it? And why should this format be done from inside 2K/XP?\n\u003e try booting from it and see if you get to the BOOT.INI choices\n\nI don\u0027t think there will be a different behaviour form how the device is formatted right now, wich is: it boots when the 4MBR bytes are patched, it does not when they are not.\n\n\u003e ... with the HP Patch\n\nThis is the same Patch as the one from Clemens? Why do you call it \u0027HP\u0027 then?\n\nBTW the website states:\n\u003e Instead of using the BIOS reported geometry to break the absolute sector down into its CHS components, the boot loader uses a geometry stored in the so called BIOS parameter block.\n\nDoes this mean there is a \u0027suggested geometry\u0027 for the bootloader to use, that might not nessisarily be 255/63, stored in te BPB. If so I should probbably check these value\u0027s first and perhaps change them to 255/63? As stated before: the device would boot fine when patching the 4 bytes.\n\nI do not have access to the flashdrive right now but I\u0027ll have a look at this as soon as I get home.\n\u003e So you need to actually (BTW this is what RMPREPUSB does) \"shrink\" a little bit the first partition and add a small \"fake\" partition, one cylinder in size (between steps #1 and #2 above).\n\nI will try, but I dont think it will change anything, given that the CHS values happened to be correct in the first place, and I think WinToFlash does use this as well. And as stated before: this would not work. So I will try this, but it does not sound that promissing.\n\n\\*edit\\*\n\nIf the BPB would be to blame, then wy would it work on a different pc in the first place, considering that the bootsector code points to/uses these value\u0027s?\n\n**Edited by Fiction, 08 February 2013 - 12:53 PM.**\n"
    },
    {
      "id": "167440",
      "timestamp": "2013-02-08T14:14:51+00:00",
      "author": "Wonko the Sane",
      "content": "Sometimes I feel like ![:frusty:](https://reboot.pro/public/style_emoticons/default/frusty.gif)\n\nYou don\u0027t ***have to*** partition under 2K/XP, you can manually write the XP/2K MBR code and manually write the partition table entry(ies).\n\nWe have talked - I thought at length enough - about the 4 bytes patch \"by Clemens\" that is a patch to the **P** BR code and about the HP patch, which is 3 bytes and it is a patch to the (2K/XP) **M**BR code:\n\n[http://reboot.pro/to...board/?p\u003d166219](http://reboot.pro/topic/18023-xp-setup-ntldr-not-found-but-boots-fine-on-newer-motherboard/?p\u003d166219 \"\")\n\nExplanation:\n\nOn some BIOSes the booting does not \"reach\" the PBR unless the code is the \"right\" one AND the partitioning is the \"right\" one AND the MBR code is \"patched\".\n\nIn layman\u0027s terms, if you left your car parked for a few months AND you lost it\u0027s keys, your PRIMARY need is to find them keys, BEFORE checking if the battery is still live, or if you prefer, you solve issues in the order they present themselves.\n\nThe booting goes like this:\n\nBIOS-\\\u003eMBR-\\\u003ePBR-\\\u003eSystem file or bootloader/bootmanager\n\nIf there is any issue when \"jumping\" from MBR to PBR, it makes little sense to have a patched PBR (that would theoretically work IF ONLY the booting could reach it).\n\nYour particular BIOS, coupled with that particular stick, needs just the \"ignore CHS\", or \"Clemens\", or \"4 byte patch to the **P**BR\", another BIOS might NOT need it, but it might need the MBR patch (or the second fake partition or \"balanced CHS/LBA\", or \\*something else\\*).\n\nThe idea is all these \"patches\" and \"settings/data\" remain compatible with \"good\" BIOSes, whilst each of them addresses (and hopefully solves) a particular issue found with a specific BIOS.\n\nFor that specific BIOS, you evidently need only one of these (the \"ignore CHS\" patch), your specific issue is solved for that specific motherboard (which is good :smile:), but the idea was to provide you with means to make the stick \"more compatible\" with \"more motherboards\", not just that specific one.\n\nYou chose the **RED** pill, remember?\n\nAnother couple rabbit holes:\n\n[http://homepage.ntlw...name-field.html](http://homepage.ntlworld.com./jonathan.deboynepollard/FGA/volume-boot-block-oem-name-field.html \"External link\")\n\n[http://homepage.ntlw...eter-block.html](http://homepage.ntlworld.com./jonathan.deboynepollard/FGA/bios-parameter-block.html \"External link\")\n\n![:cheers:](https://reboot.pro/public/style_emoticons/default/cheers.gif)\n\nWonko\n\n"
    },
    {
      "id": "167441",
      "timestamp": "2013-02-08T14:23:25+00:00",
      "author": "steve6375",
      "content": "The problem is with the code in the bootsect.dat which is run on the 1st stage boot.\n\nThis can be completely avoided by installing grub4dos and running setupldr instead - then we do not have any issue!\n\nAs I show in my [tutorial 102](http://www.rmprepusb.com/tutorials/wintoflash \"External link\")... ![:dubbio:](https://reboot.pro/public/style_emoticons/default/dubbio.gif)\n\n"
    },
    {
      "id": "167442",
      "timestamp": "2013-02-08T15:00:27+00:00",
      "author": "Wonko the Sane",
      "content": "\u003e The problem is with the code in the bootsect.dat which is run on the 1st stage boot.\n\u003e\n\u003e This can be completely avoided by installing grub4dos and running setupldr instead - then we do not have any issue!\n\u003e\n\u003e As I show in my [tutorial 102](http://www.rmprepusb.com/tutorials/wintoflash \"External link\")... ![:dubbio:](https://reboot.pro/public/style_emoticons/default/dubbio.gif)\n\n...as long as the grub4dos MBR code is actually run by BIOS (hey, are you not the same **steve6375** here? :wink:):\n\n[http://reboot.pro/to...d-i-have-found/](http://reboot.pro/topic/10503-most-compatible-usb-stick-grub4dos-method-i-have-found/ \"\")\n\nSo, possibly instead of \"installing\" grub4dos one could chainload grldr from BOOT.INI....\n\nBTW, Wintoflash uses some \"old\" methods that were changed (since years, actually) where it all began:\n\n[http://www.msfn.org/...ndows-from-usb/](http://www.msfn.org/board/forum/157-install-windows-from-usb/ \"External link\")\n\n![:cheers:](https://reboot.pro/public/style_emoticons/default/cheers.gif)\n\nWonko\n\n"
    },
    {
      "id": "167447",
      "timestamp": "2013-02-08T15:52:20+00:00",
      "author": "steve6375",
      "content": "\u003e ...as long as the grub4dos MBR code is actually run by BIOS (hey, are you not the same **steve6375** here? :wink:):\n\u003e\n\u003e [http://reboot.pro/to...d-i-have-found/](http://reboot.pro/topic/10503-most-compatible-usb-stick-grub4dos-method-i-have-found/ \"\")\n\nYes, I am the same one that patched grubinst.exe to fix the MBR issue and the same one that includes the modified grubinst in RMPrepUSB ![:dubbio:](https://reboot.pro/public/style_emoticons/default/dubbio.gif)\n\nYour proposal is  \nstd mbr -\\\u003e **PBR -\\\u003e ntldr -\\\u003e boot.ini** -\\\u003e glrdr -\\\u003e menu.lst -\\\u003e setupldr.bin  \ninstead of using just grub4dos...  \ngrub4dos MBR -\\\u003e grldr -\\\u003e menu.lst -\\\u003e setupldr.bin  \n\nYes, replacing\n\n```\nC:\\$WIN_NT$.~BT\\BOOTSECT.DAT \u003d \"1st, text mode setup (Boot from flash again after finished)\"\n```\n\nwith\n\n```\nc:\\grldr\u003d\"GRUB4DOS - 1st, text mode setup (Boot from flash again after finished)\"\n```\n\nin the boot.ini also works (as long as you copy over grldr to the root of the USB drive and have a menu.lst).  \nPersonally, I prefer to use the grub4dos boot process so I can see if there is a problem and then try to fix it. Using some XP files to boot probably breaks copyright and if there is a problem with newer h/w it is not easily fixed.  \nGuess it is just a question of what you feel most is trustworthy? ![:dubbio:](https://reboot.pro/public/style_emoticons/default/dubbio.gif)  \n\n"
    },
    {
      "id": "167448",
      "timestamp": "2013-02-08T16:22:47+00:00",
      "author": "Wonko the Sane",
      "content": "\u003e Guess it is just a question of what you feel most is trustworthy? ![:dubbio:](https://reboot.pro/public/style_emoticons/default/dubbio.gif)\n\nNo, it is not about \"trusting\" that particular patch :smile: it is about probabilities.\n\nWe have direct evidence that at least one BIOS programmer made it so that a given MBR code was not booted.\n\nWe have direct evidence that a patch kindly provided by **steve6375** ![:worship:](https://reboot.pro/public/style_emoticons/default/worship.gif) solves ***that*** problem.\n\nBut this tells nothing about the ***n*** other possible ways a BIOS programmer may have §@ç#ed the booting sequence.\n\nI do believe that even the less neuron gifted BIOS programmer would never have delivered (or the actual PC maker accepted) a BIOS that would not boot from the two most common MBR codes, the DOS or the 2K/XP ones, that represent the two MBR codes used in (say) 97% of all PC\u0027s since 1995 and up to 2008, and possibly still more than 50% today.\n\nIs it a very remote probability that a BIOS doesn\u0027t like a given MBR code? (yes, but we have at least this Acer case ).\n\nIs it a more remote probability that the DOS or 2K/XP MBR code has not been tested successfully? (yes, IMHO).\n\nFor the record, from the little we have learned/understood from the \"HP patch\", it is likely that also the 2K/XP MBR caused \"strange behaviour\", at least initially, with some BIOSes, so we may hypotize the existence of BIOS programmers without ANY neuron ![:unsure:](https://reboot.pro/public/style_emoticons/default/unsure.png) ![:ph34r:](https://reboot.pro/public/style_emoticons/default/scared9.gif).\n\nMost probably we should now think at the Windows 7 MBR as \"the most common and that must have been tested successfully\", though.\n\nPlease understand how there is an additional (++potential++) issue (as in \"unusual\" or \"not standard\") with the grub4dos \"installed\" which is the use of a few \"hidden sectors\", the fact that till now no related issue in booting were ever recorded makes this a very marginal problem.\n\nYou may want to acknowledge that even the good MS guys (that ***in theory*** should know what they are doing) have managed to mess BIG in writing their things as this (OT but connected in principle) experience shows:\n\n[http://reboot.pro/to...itioning-issue/](http://reboot.pro/topic/9897-vistawin7-versus-xp-partitioning-issue/ \"\")\n\nThis case is particularly interesting, basically the good MS guys established themselves a *de facto* standard, suddenly changed it without checking how the previous implementation of their tools was not only incompatible, but downright destructive, with the new \"standard\".\n\n![:cheers:](https://reboot.pro/public/style_emoticons/default/cheers.gif)\n\nWonko\n\n"
    },
    {
      "id": "167458",
      "timestamp": "2013-02-08T19:56:11+00:00",
      "author": "Fiction",
      "content": "\u003e Sometimes I feel like \\[![:frusty:](https://reboot.pro/public/style_emoticons/default/frusty.gif)\\]\n\nI am sorry. This is all new to me so I do not always understand the first time I read something. Or I might not remember it the first time. I forgot the 3 byte thing was mentioned. I am sorry for this :S Ill just try all of your suggestions. I\u0027ll let you know the results, also I read the two \u0027rabbit holes\u0027.\n\n\u003e For that specific BIOS, you evidently need only one of these (the \"ignore CHS\" patch), your specific issue is solved for that specific motherboard (which is good \\[:)\\] ), but the idea was to provide you with means to make the stick \"more compatible\" with \"more motherboards\", not just that specific one.\n\nAh, well then this is probably part of our misunderstanding. I am, right now, for the most part curious about this specific ASUS motherboard. We now know that the 4 byte patch works well, but I\u0027d like to know why it is needed for this mobo while it is not needed for a different one. The ASUS geometry seems to be 255/63 and the drive is formatted balanced for this geometry. So why is the 4 byte patch needed then? Don\u0027t get me wrong, I\u0027d love to learn how to get the drive as compatible as possible, but right now most of my curiosity lies with this specific motherboard. Could we focus on this first? Or is this difficult to determine?\n\n"
    },
    {
      "id": "167461",
      "timestamp": "2013-02-08T20:13:55+00:00",
      "author": "steve6375",
      "content": "\u003e Ah, well then this is probably part of our misunderstanding. I am, right now, for the most part curious about this specific ASUS motherboard. We now know that the 4 byte patch works well, but I\u0027d like to know why it is needed for this mobo while it is not needed for a different one. The ASUS geometry seems to be 255/63 and the drive is formatted balanced for this geometry. So why is the 4 byte patch needed then? Don\u0027t get me wrong, I\u0027d love to learn how to get the drive as compatible as possible, but right now most of my curiosity lies with this specific motherboard. Could we focus on this first? Or is this difficult to determine?\n\nWell, I agree that it is curious. Geometry seems to be correct, but maybe you could post the actual MBR, PBR and bootsect.dat from that actual USB drive that fails to boot on the ASUS?\n\nRMPrepUSB Disk-\\\u003eFile will do this for you, and if you use Disk Info and File Info you can also get the PBR and MBR contents nicely displayed into text files.\n\nAm I correct in thinking both FAT32 and FAT16 give the problem?\n\nAm I correct in thinking that it does not matter if you run WinToFlash to prepare the USB drive on the ASUS itself, it still fails?\n\nOnce I have these files, and if the CHS looks correct in MBR, PBR and bootsect.dat, then the next step would be to dis-assemble the bootsect.dat code.\n\nThis should be identical to the PBR, except for some NOVICORP text changes and the NTLDR string being changed to $LDR$ - but we need to see it.\n\nPlease use the latest version of RMPrepUSB (2.1.657) as this will parse and display PBR parameters when you use File Info on bootsect.dat.\n\nMake sure you take these files from a failing USB drive, freshly prepared by WinToFlash.\n\n"
    },
    {
      "id": "167466",
      "timestamp": "2013-02-08T20:40:02+00:00",
      "author": "Fiction",
      "content": "\u003e Am I correct in thinking both FAT32 and FAT16 give the problem?\n\nNo, there is no problem at all when using FAT16.\n\u003e Am I correct in thinking that it does not matter if you run WinToFlash to prepare the USB drive on the ASUS itself, it still fails?\n\nYes, it still fails. However, I stopped using WinToFlash while testing this issue. In stead I format the flashdrive as a dos startup \u0027floppy\u0027. Then I copy the I386 folder to the drive, boot DOS (succesfully!) and run WINNT.EXE. Now WINNT.EXE changes the bootcode to load NTLDR (also created by WINNT.EXE, allong with a boot.ini and a $LDR$) This then normally boots the setup from the bootsect.dat. The problem I am facing with this method is this: as soon as winnt.exe changes the bootsector, the device becomes unbootable on this motherboard.\n\nI am quite sure that the winnt.exe changes the bootsector, then backs up the old one in a file called \u0027bootsect.dos\u0027. This file can be used to boot dos right after ntldr was loaded. You can add this by writing a line for it in the boot.ini. So the old bootsector is no longer important. It is the sector made by winnt.exe that shows this behaviour. Although I do not know if all values are changed, or if some are kept in the new boot sector.\n\nOn the sony pc this new boot code works fine, on the asus motherboard it gives me a NTLDR not found error. It does not get to the boot.ini lines.\n\nThe problem I am now trying to understand is this one: the drive, prepared by winnt.exe wont boot on this ASUS but will on my sony pc. It does not matter if the winnt.exe was run on the asus mobo pc. I do think I tried formatting it on that pc as well, same thing. However, the drive set up by WinToFlash behaves very much the same. (I suspect the program mimics the things done by winnt.exe, the folder structure created looks exactly the same).\n\nI cannot upload the requested data right now, I just tried something that messed up the partition. I\u0027ll parition the thing again using RMPrepUSB to create the dos part. When winnt.exe is done, I\u0027ll upload the data. Could take a few hours, not sure if I\u0027m able to upload it today, perhaps it\u0027ll be tomorrow.\n\n\\*edit\\*\n\nAdded the bootsect.dos part of the \u0027story\u0027.\n\n**Edited by Fiction, 08 February 2013 - 08:57 PM.**\n"
    },
    {
      "id": "167469",
      "timestamp": "2013-02-08T21:06:58+00:00",
      "author": "steve6375",
      "content": "That is even weirder!\n\nSo if you copy the i386 files to the USB, boot to DOS and run Winnt on the Asus, it fails to boot to setupldr? Are you absolutely sure this is correct?\n\nIt would be good to test booting by putting the special [diagnostic boot code](http://www.rmprepusb.com/tutorials/diagnose-bios \"External link\") included with RMPrepUSB on the stick and booting the Asus from that to see what you get -\n\n"
    },
    {
      "id": "167471",
      "timestamp": "2013-02-08T21:22:37+00:00",
      "author": "Fiction",
      "content": "Well, I\u0027m not sure sure, but the winnt.exe runs fine all the way to the part were it asks input before reboot. And here is were it all goes wrong. The sony will boot the drive fine in this state, however the asus does not get to the boot.ini. I know this, because paching the 4 bytes of the bootsector, but NOT in the bootsect.dat allows me to at least see the boot choice menu from the boot.ini. If I do not patch the bootsect.dat, I will get the same NTLDR not found error when selecting the txtsetup entry to start booting the unpatched bootsect.dat. So:\n\nbootsector not patched; asus\\\u003entldr not found, sony\\\u003eboots fine.\n\nBootsector pached but bootsect.dat unmodified; asus\\\u003ereaches the boot.ini entries, but fails booting the bootsect.dat, sony\\\u003e still boots fine\n\nBoth the bootsector and the bootsect.dat patched: both boot just fine.\n\n\\*edit\\*\n\nBTW, I did try running winnt.exe on the asus pc as well. Same story.\n\n**Edited by Fiction, 08 February 2013 - 09:23 PM.**\n"
    },
    {
      "id": "167473",
      "timestamp": "2013-02-08T21:49:30+00:00",
      "author": "steve6375",
      "content": "Well it sounds like the drive geometry on the USB drive (prepared in WIndows and so is 255/63) does not match the drive geometry from the BIOS.\n\nIf you could actually format the USB drive after booting to DOS **from the Asus**, then the PBR would have the correct ASUS BIOS geometry. Because the Asus BIOS geometry is not used when the FAT32 PBR is written, it probably has non-matching geometry in the PBR.\n\nRunning the TESTMBR from the special [diagnostic boot code](http://www.rmprepusb.com/tutorials/diagnose-bios \"External link\") would be good to do.\n\nAlso, I wonder what error messages you would see if you prepare a **FreeDos**FAT32 USB drive and booted the Asus from it - Freedos usually complains about drive/BIOS geometry mismatch.\n\n"
    },
    {
      "id": "167474",
      "timestamp": "2013-02-08T22:13:17+00:00",
      "author": "Fiction",
      "content": "\u003e Well it sounds like the drive geometry on the USB drive (prepared in WIndows and so it 255/63) does not match the drive geometry from the BIOS.\n\nI agree, but the geometry command in grub4dos returned 255/63. I thought this meant the bios uses the 255/63 geometry. If not, then what was this about?\n\u003e If you could actually format the USB drive after booting to DOS **from the Asus**, then the PBR would have the correct ASUS BIOS geometry. Because the Asus BIOS geometry is not used when the FAT32 PBR is written, it probably has non-matching geometry in the PBR.\n\nWhat do you suggest? backing up the bootcode (PBR excluded) using tinyhexer, formating and then restoring it? If I just reformat the thing, then it wont be looking for a NTLDR right?\n\u003e Also, I wonder what error messages you would see if you prepare a FreeDos FAT32 USB drive and booted the Asus from it - Freedos usually complains about drive/BIOS geometry mismatch.\n\nI used freedos a while back and did not notice it, but I\u0027ll try this.\n\n"
    },
    {
      "id": "167486",
      "timestamp": "2013-02-09T11:09:20+00:00",
      "author": "Wonko the Sane",
      "content": "\u003e Could we focus on this first? Or is this difficult to determine?\n\nSure we can focus on this :smile:.\n\nAnd yes, it will be tricky ![:unsure:](https://reboot.pro/public/style_emoticons/default/unsure.png), in the sense that it has already been determined: you have a mismatch of CHS induced by the BIOS, so I am failing to understand what exactly are you wanting to determine ![:dubbio:](https://reboot.pro/public/style_emoticons/default/dubbio.gif).\n\nThe exact behaviour has been analyzed by **Legorol**, here (already given link on post #4):\n\n[http://www.911cd.net...showtopic\u003d24395](http://www.911cd.net/forums//index.php?showtopic\u003d24395 \"External link\")\n\nspecifically for an ASUS BIOS, so I wonder WHAT exactly you are after, I thought you were missing some background knowledge to understand that thread, but now you should have them.\n\nIn that thread, **Legorol** used successfully **COD11**\u0027s testing MBR:\n\n[http://reboot.pro/to...code-and-grldr/](http://reboot.pro/topic/12436-usbzipls120-booting-with-minimalist-mbr-code-and-grldr/ \"\")\n\nI am failing to see why you didn\u0027t ALREADY experimented with it (and report actual results/data).\n\n![:cheers:](https://reboot.pro/public/style_emoticons/default/cheers.gif)\n\nWonko\n\n"
    },
    {
      "id": "167493",
      "timestamp": "2013-02-09T12:05:56+00:00",
      "author": "Fiction",
      "content": "Well, in that case, then once again I don\u0027t fully understand all of it yet. \u003d/ sorry.\n\nWhat is confusing me:\n\ngrub4dos geometry returned 255/63 I thought this meant that the bios was using this geometry? The drive is formatted with a 255/63 geometry, balanced.\n\nIf the BIOS is using a different geometry, then what would that geometry be? To what geometry should I change the drive, to make it boot-able without changing the boot-code itself.\n\nAfter reading the referenced page again, I got even more questions (sorry once again :S):\n\u003e So what I saw is that the Dell Laptop was emulating the drive to have 32 heads; this is where the problem was all along! All the tools I used seemed to have all partitioned/formatted the stick assuming 255 heads.\n\nThis seems to assume, the asus motherboard they are talking about uses a 32/64 geometry.\n\u003e The Asus BIOS seems to be very smart about what geometry it emulates, and is going out of its way to try and be compatible. It is actually reading the BPB\u0027s Sectors per track and Number of heads information from the VBR, and emulates the CHS geometry to match that!\n\nBut what about the 32/64 geometry then?\n\nIs it using this geometry to find the VBR (the VBR is the first sector of the parition right? so the bios would need to find the partiion before being able to read this?) and once it does find the VBR it starts using the values in there? Or what?\n\nIf this would be the same for my asus mobo, then is the following happening? The bios reads the BPB\u0027s Sectors per track in the PBP and starts using this, then it tries to find the VBR using it\u0027s default number of heads, 32 and fails to find the VBR because of the used 255 geometry. If I would find the VBR is would switch to 255 heads, because the VBR states this is being used?\n\n\\*edit\\*\n\nThe toolbox zip-file at [http://reboot.pro/to...code-and-grldr/](http://reboot.pro/topic/12436-usbzipls120-booting-with-minimalist-mbr-code-and-grldr/ \"\") is no longer downloadable.\n\n**Edited by Fiction, 09 February 2013 - 12:07 PM.**\n"
    },
    {
      "id": "167494",
      "timestamp": "2013-02-09T12:40:54+00:00",
      "author": "Wonko the Sane",
      "content": "\u003e \\*edit\\*\n\u003e\n\u003e The toolbox zip-file at [http://reboot.pro/to...code-and-grldr/](http://reboot.pro/topic/12436-usbzipls120-booting-with-minimalist-mbr-code-and-grldr/ \"\") is no longer downloadable.\n\nAttached.\n\n![:cheers:](https://reboot.pro/public/style_emoticons/default/cheers.gif)\n\nWonko  \n\n#### Attached Files {#attach_wrap}\n\n* [![Attached File](http://reboot.pro/public/style_extra/mime_types/zip.gif)](http://reboot.pro/index.php?s\u003d6c6dfe2e1653a5ddcce923f7ea887fea\u0026app\u003dcore\u0026module\u003dattach\u0026section\u003dattach\u0026attach_id\u003d14151 \"Download attachment\") [**MINI_MBR.ZIP**](http://reboot.pro/index.php?s\u003d6c6dfe2e1653a5ddcce923f7ea887fea\u0026app\u003dcore\u0026module\u003dattach\u0026section\u003dattach\u0026attach_id\u003d14151 \"Download attachment\") **150.2KB** 352 downloads\n\n"
    },
    {
      "id": "167496",
      "timestamp": "2013-02-09T12:43:53+00:00",
      "author": "steve6375",
      "content": "The issue is with FAT32 - there is no issue with FAT16.\n\nMaybe one easy way to see what is going on is to try FlashBoot\n\n[This post](http://reboot.pro/topic/12436-usbzipls120-booting-with-minimalist-mbr-code-and-grldr/#entry120445 \"\") is interesting - note that the disk number reported by the BIOS is no. 0 (\u003dfloppy) and not 128 (80h - HDD) - also note that the BIOS reports H\u003d16 S\u003d63.\n\nI have looked at the in the FAT32 BIOS and this is what it does:\n\n1. Make an Int 13h AH\u003d8 call using the drive number (L) passed to it buy the BIOS when it booted (should be 80h for HDD, but may be 0\u003dFDD if wrong!)\n\n2. Calculate total number of sectors on disk L (this uses the old BIOS code - so max it can return is 1023x255x63\u003d8GB)\n\n3. Ensure BPB 16-bit values at 16h and 2ah are 0000h - which they are\n\n4. Get value of reserved sectors at BPB+1ch \u003d 63 - add 12 to it (so we are ready to read code at 63+12)\n\n5. Compare the LBA address that we are about to read from the disk with total number of sectors on the boot disk calculated in step 2\n\n6.1 If it is below then convert to CHS values and use AH\u003d2 to read the disk sector - Note: this uses the BPB parameters at 18h (sectors per track) and 1ah (hds per cylinder) - so the values in the BPB must match what is returned by the BIOS AH\u003d8 call or it will load the wrong sector!\n\n6.2 If it is not below, then check if EBIOS is present - if EBIOS is present use EBIOS function Read\u003d42h to read LBA addressed disk sector\n\nThe patch makes the code in red run all the time (6.1 and the check in 6.2 is not performed).\n\nSo what could be going wrong is that the values returned in CX and DH by the BIOS from the Get Disk Geometry call at step 1 are 0\u0027s (or at least less than 75) or possible not 255x63.\n\nAnother post also suggests that the grub4dos geometry command may not be displaying what the BIOS actually returns.\n\nWe need to interrogate the BIOS geometry call (AH\u003d8). I think Flashboot does this, TESTMBR from RMPrepUSB does this (link gave earlier). and so does the code pointed to earlier by Wonko.\n\n**Or** you could install grub4dos, add the grubutils bios utility to your stick, go the the grub4dos command line and type in\n\n```\n/bios int\u003d0x13 edx\u003d0x80 eax\u003d0x0800\n```\n\nand see what is returned in ECX and EDX.\n\nECX\u003d0000FEFF EDX\u003d0000FE02 is returned by my system for my 8GB USB drive which means 1023x255x63 which is correct.\n\n"
    },
    {
      "id": "167520",
      "timestamp": "2013-02-09T20:04:56+00:00",
      "author": "Motasem",
      "content": "well i was stuck in this fourm for a week trying to post new thread about this but i cant dono why\n\nyou asking for more space while lba16 is limiting you -- right i have same problem and my sugest was this  \n----------\n\ni have a bootable usb and i have installed grub loader and everything works fine\n\ninstall boot in it is\n\n7.iso\n\nxp.iso\n\nhbcd.iso\n\nnow if i load win7 iso it loades very fast without showing like winxp.iso file 16m/614m and counting untill it load all iso file in memory so i wornder why iso for win7 load without this ? and winxp.iso loades so slow so i think of something els\n\nbefor i get to this fourm i was using win2flash and it was great and fast untill i think of something called mutliboot usb so google lead me to this fourm\n\nso my major question is how to integrate the win2flash winxp made files into grub ? so if the files of win2flash for winxp after extraction is like this [http://grabout.com/YcRpclue](http://grabout.com/YcRpclue \"External link\")\n\nand my real multiboot usb now is like this [http://grabout.com/CqM6fkdm](http://grabout.com/CqM6fkdm \"External link\")\n\nso how to copy win2flash files and make it work ( start setup of winxp extracted files ) into grub menu\n\ni try to make it but with too many problems and failure  \nthe boot.ini in win2flash is this\n\n\u003cbr /\u003e\n\n\\[Boot Loader\\]  \nTimeout\u003d30  \nDefault\u003dmulti(0)disk(0)rdisk(1)partition(1)\\\\WINDOWS  \n\\[Operating Systems\\]  \nC:\\\\$WIN_NT$.\\~BT\\\\BOOTSECT.DAT \u003d \"1st, text mode setup (Boot from flash again after finished)\"  \nmulti(0)disk(0)rdisk(1)partition(1)\\\\WINDOWS\u003d\"2nd, GUI mode setup, continue setup + 1st start of Windows\" /fastdetect  \nC:\\\\ \u003d \"---\\\u003e DEBUG, in case of HAL.DLL or NTOSKRNL.EXE not found errors \\\u003c---\"  \nmulti(0)disk(0)rdisk(1)partition(2)\\\\WINDOWS\u003d\"Debug boot rDisk 1 partition 2\" /fastdetect  \nmulti(0)disk(0)rdisk(1)partition(3)\\\\WINDOWS\u003d\"Debug boot rDisk 1 partition 3\" /fastdetect  \nmulti(0)disk(0)rdisk(1)partition(4)\\\\WINDOWS\u003d\"Debug boot rDisk 1 partition 4\" /fastdetect  \nmulti(0)disk(0)rdisk(2)partition(1)\\\\WINDOWS\u003d\"Debug boot rDisk 2 partition 1\" /fastdetect  \nmulti(0)disk(0)rdisk(2)partition(2)\\\\WINDOWS\u003d\"Debug boot rDisk 2 partition 2\" /fastdetect  \nmulti(0)disk(0)rdisk(2)partition(3)\\\\WINDOWS\u003d\"Debug boot rDisk 2 partition 3\" /fastdetect  \nmulti(0)disk(0)rdisk(2)partition(4)\\\\WINDOWS\u003d\"Debug boot rDisk 2 partition 4\" /fastdetect\n\nso what files i need to copy from win2flash setup of xp to my bootable ( grub ) flash and what lines i have to add from boot.ini so i can start winsetup without iso ?  \n\ni hope i find solution for this  \n\n"
    },
    {
      "id": "167523",
      "timestamp": "2013-02-09T20:13:49+00:00",
      "author": "steve6375",
      "content": "[http://www.rmprepusb...ials/wintoflash](http://www.rmprepusb.com/tutorials/wintoflash \"External link\")\n\n"
    },
    {
      "id": "167524",
      "timestamp": "2013-02-09T20:24:36+00:00",
      "author": "Motasem",
      "content": "this is wide complicated steve thanks for that but would you please write me here the steps you know what i have as you where with me all steps to make my flash botable\n\ni just need to copy the winxp files as i already have them in another flash disk and i need to know what lines to add to menu.lst and one more thing my flash is already ntfs i dont want to format it lba16 i want to use it all 8g space\n\n"
    },
    {
      "id": "167525",
      "timestamp": "2013-02-09T20:25:59+00:00",
      "author": "Wonko the Sane",
      "content": "**Motasem**, really, you should start a NEW TOPIC if you need assistance and NOT hi-jack other people\u0027s thread with your issues.\n\nAnd this is the SECOND time I suggest you this:\n\n[http://reboot.pro/to...-isos/?p\u003d167321](http://reboot.pro/topic/14285-error-60-contiguous-isos/?p\u003d167321 \"\")\n\nit\u0027s just a matter of keeping things together, so that they can be found later - if needed - and to have meaningful (and related) search results.\n\nAre you having issues with creating new topics?\n\nGo here:\n\n[http://reboot.pro/fo...-boot-anywhere/](http://reboot.pro/forum/71-boot-from-usb-boot-anywhere/ \"\")\n\ncan you see a button with \"Start New Topic\" on it?\n\nWhat happens if you click on it?\n\nIf nothing try again, this time here:\n\n[http://reboot.pro/fo...24-hello-world/](http://reboot.pro/forum/24-hello-world/ \"\")\n\nThere might be an issue with the board ![:unsure:](https://reboot.pro/public/style_emoticons/default/unsure.png), but I doubt it ![:dubbio:](https://reboot.pro/public/style_emoticons/default/dubbio.gif)\n\n![:cheers:](https://reboot.pro/public/style_emoticons/default/cheers.gif)\n\nWonko\n\n"
    },
    {
      "id": "167526",
      "timestamp": "2013-02-09T20:28:39+00:00",
      "author": "Motasem",
      "content": "so im at the same end for the secund time you warn me ? man why dont you just help me i cant start new topic i have no access for that and its not my problem just tell me what to do please do me a favor\n\n"
    },
    {
      "id": "167527",
      "timestamp": "2013-02-09T20:29:39+00:00",
      "author": "steve6375",
      "content": "\u003e this is wide complicated steve thanks for that but would you please write me here the steps you know what i have as you where with me all steps to make my flash botable\n\u003e\n\u003e i just need to copy the winxp files as i already have them in another flash disk and i need to know what lines to add to menu.lst and one more thing my flash is already ntfs i dont want to format it lba16 i want to use it all 8g space\n\nDid you actually read for more than 10 seconds?\n\nIn your case, just copy the files and folders to your USB drive and use the menu that I gave for NTFS.\n\n"
    },
    {
      "id": "167529",
      "timestamp": "2013-02-09T20:51:39+00:00",
      "author": "Wonko the Sane",
      "content": "\u003e so im at the same end for the secund time you warn me ? man why dont you just help me i cant start new topic i have no access for that and its not my problem just tell me what to do please do me a favor\n\nI asked you to do something, if you do and report what happens, then I can***try*** to call the attention of a board Admin that may hopefully solve the issue (if any).\n\nYou are perfectly free to hi-jack other people threads as far as I am concerned, I did not \"warn\" you, I tried to explain you why thread hijacking is fundamentally wrong (and unpolite), and suggested you a possible way to troubleshoot the problem.\n\nDo what you see fit.\n\n![:cheers:](https://reboot.pro/public/style_emoticons/default/cheers.gif)\n\nWonko\n\n"
    },
    {
      "id": "167530",
      "timestamp": "2013-02-09T20:53:48+00:00",
      "author": "Motasem",
      "content": "im sorry i didnt mean anything wrong i have a respect for you admins and support  \nim testing after im done i will report like the same old time for problem of contiguse file of win7\n\n"
    },
    {
      "id": "167532",
      "timestamp": "2013-02-09T21:04:41+00:00",
      "author": "Motasem",
      "content": "first try i copy all files from win2flash of xp setup i copy those 2 folders $WIN_NT$.\\~BT / $WIN_NT$.\\~LS\n\nand add to my existing menu.lst this lines from your tut\n\ntitle Install XP using WinToFlash\\\\nStandard WinToFlash install\\\\nSelect 1st, reboot to this menu again and select 2nd\n\u003e chainloader /ntldr  \n\u003e title Stage 1 - Install XP using WinToFlash\\\\nUse if first menu gives NTLDR IS MISSING error after selecting 1st.  \n\u003e chainloader /$WIN_NT$.\\~BT/setupldr.bin\n\u003e title Patch \\\\\\\\$WIN_NT$.\\~BT\\\\\\\\BOOTSECT.DAT\\\\nUse this if you get an NTLDR IS MISSING error after selecting 1st.\n\u003e set OS\u003d\n\u003e set BT\u003d  \n\u003e # Note: this only works on FAT volumes as grub4dos cannot patch small \\\u003c1K files on NTFS volumes!\n\u003e if exist (hd0,0)/$WIN_NT$.\\~BT/BOOTSECT.DAT set BT\u003d(hd0,0)/$WIN_NT$.\\~BT/BOOTSECT.DAT\n\u003e if exist (hd1,0)/$WIN_NT$.\\~BT/BOOTSECT.DAT set BT\u003d(hd1,0)/$WIN_NT$.\\~BT/BOOTSECT.DAT\n\u003e if exist (hd1,1)/$WIN_NT$.\\~BT/BOOTSECT.DAT set BT\u003d(hd1,1)/$WIN_NT$.\\~BT/BOOTSECT.DAT\n\u003e if exist (hd1,2)/$WIN_NT$.\\~BT/BOOTSECT.DAT set BT\u003d(hd1,2)/$WIN_NT$.\\~BT/BOOTSECT.DAT\n\u003e if \"%BT%\"\u003d\u003d\"\" pause --wait\u003d3 Cannot find /$WIN_NT$.\\~BT/BOOTSECT.DAT \\\u0026\\\u0026 configfile /menu.lst\n\u003e # detect OS\n\u003e cat --skip\u003d3 --length\u003d0x52 --locate\u003dFAT32 %BT% \\\u003e nul \\\u0026\\\u0026 set OS\u003dFAT32\n\u003e cat --skip\u003d3 --length\u003d8 --locate\u003dMSWIN4.1 %BT% \\\u003e nul \\\u0026\\\u0026 set OS\u003dFAT32\n\u003e cat --skip\u003d3 --length\u003d8 --locate\u003dMSDOS5.0 %BT% \\\u003e nul \\\u0026\\\u0026 set OS\u003dFAT32\n\u003e if \"%OS%\"\u003d\u003d\"\" pause --wait\u003d3 Sorry - can\u0027t determine OS of BOOTSECT.DAT \\\u0026\\\u0026 configfile /menu.lst\n\u003e echo FOUND %OS% at %BT%\n\u003e cat --hex --length\u003d0xf0 %BT%\n\u003e set /p ASK\u003dPress Y to patch file (Y/N):\n\u003e if not /i \"%ASK%\"\u003d\u003d\"Y\" configfile /menu.lst \\|\\| echo -e \\\\n\\\\r\n\u003e echo Patched file is now...\n\u003e if \"%OS%\"\u003d\u003d\"FAT32\" cat --skip\u003d0xe6 --locate\u003d\\\\x0f\\\\x82\\\\x4a\\\\x00 --replace\u003d\\\\x90\\\\x90\\\\x90\\\\x90 %BT% \\\u003e nul\n\u003e cat --hex --length\u003d0xf0 %BT%\n\u003e echo Finished - press a key to boot to the WinToFlash installer...\n\u003e pause\n\u003e chainloader /ntldr  \n\u003e ----------  \n\u003e i restart my pc and try to boot it says ntldr is mission to back and copy ( ntldr, $LDR$, ntdetect, txtsetup.sif ) and other boot files to root of my usb dir  \n\u003e the secund boot i try the first line of start winxp setup from win2flash i got message says  \n\u003e ( windows cannot start hal.dll missing or corrupt )  \n\u003e i try the secund line of start winxp ( the computer restarts and boot again my grub menu )\n\n"
    },
    {
      "id": "167534",
      "timestamp": "2013-02-09T21:09:39+00:00",
      "author": "steve6375",
      "content": "You need the menu in 7.3 - under the heading \u0027Converting to NTFS\u0027 - there is a clue in the heading!\n\n"
    },
    {
      "id": "167535",
      "timestamp": "2013-02-09T21:15:11+00:00",
      "author": "Fiction",
      "content": "@steve\n\u003e Another post also suggests that the grub4dos geometry command may not be displaying what the BIOS actually returns.\n\nThat would indeed explain a lot.\n\n\u003e We need to interrogate the BIOS geometry call (AH\u003d8).\n\nYeah, I\u0027m not yet much of a assembly hero. I don\u0027t know what you mean by AH\u003d8 in this context, but perhaps I forgot something that was already explained. I must admit, I do not understand all of your FAT32 BIOS list. Bit if I understand correctly, the geometry used by the bios get\u0027s loaded into the registers at some point in the boot up process. So I should find a MBR code that displays these registers.\n\n\u003e I think Flashboot does this, TESTMBR from RMPrepUSB does this (link gave earlier). and so does the code pointed to earlier by Wonko.\n\u003e\n\u003e Or you could install grub4dos, add the grubutils bios utility to your stick, go the the grub4dos command line and type in\n\u003e /grub int\u003d0x13 edx\u003d0x80 eax\u003d0x0800  \n\u003e and see what is returned in ECX and EDX.\n\nI\u0027ll try all of these methods and see if they are consistent. I did already run MBR-SPY.\n\nI understand the (unmodified) MBR-SPY MBR code returns registry values when they contain the correct values? It returned:\n\nCS\u003d0000  \nDS\u003d0000  \nES\u003d0000  \nSS\u003d0000\n\nAX\u003dF000  \nBX\u003d7C00  \nCX\u003d0001  \nDX\u003d0080\n\nBP\u003d1000  \nSP\u003d03F6  \nIP\u003d7C00\n\nSI\u003d0005  \nDI\u003d0000  \nFG\u003d0246\n\nAX\u003df000  \nDX\u003d0080\n\nIf so, how should I calculate the geometry from this\n\n"
    },
    {
      "id": "167536",
      "timestamp": "2013-02-09T21:17:42+00:00",
      "author": "steve6375",
      "content": "With MBR-SPY you need to keep pressing Enter - you should get about 5 sets of results -...\n\nMight be best to take a photo...\n\n"
    },
    {
      "id": "167537",
      "timestamp": "2013-02-09T21:23:12+00:00",
      "author": "Fiction",
      "content": "Ok, then perhaps this isn\u0027t the easiest tool. I\u0027ll try the grub method first then.\n\n"
    },
    {
      "id": "167538",
      "timestamp": "2013-02-09T21:26:19+00:00",
      "author": "steve6375",
      "content": "The first set of results you posted shows the number of sectors per track returned in CX \u003d 1 !!!!\n\nUnfortunately, MBR-SPY does not return the number of heads or cylinders - the author seems to deliberately destroy DH and most of CX!!!\n\nWhich is why I recommend my TESTMBR code...\n\n"
    },
    {
      "id": "167540",
      "timestamp": "2013-02-09T21:46:13+00:00",
      "author": "Motasem",
      "content": "ok i did it and copy these lines\n\u003e title Stage 1 - XP install\\\\nThis runs the first stage text mode setup  \n\u003e chainloader /$WIN_NT$.\\~BT/setupldr.bin \\|\\| chainloader /$LDR$  \n\u003e title Stage 2 - XP install\\\\nChoose the 2nd stage 2 GUI option  \n\u003e chainloader /ntldr  \n\u003e now i try to boot again and start winsetup first stage  \n\u003e it boot and loding files but after loading at end it says starting windows setup ( the step b4 format and chose drive ) then i got error after setup is starting windows with error indecates that ( windows must creat \\\\windows folder in order to install windows ) and i have 2 options down ( enter \u003d retry F3 \u003d quit )  \n\n"
    },
    {
      "id": "167541",
      "timestamp": "2013-02-09T22:03:18+00:00",
      "author": "steve6375",
      "content": "So what system are you booting it on and does it have a working internal hard drive in IDE mode?\n\n"
    },
    {
      "id": "167542",
      "timestamp": "2013-02-09T22:28:00+00:00",
      "author": "Motasem",
      "content": "Yes its the same i successfull installed xp and 7 from iso Now new thing happen i resrart pc and boot again and it works so i started step 1 and formated c drive and copy files and pc restart so i booted again from usb and chose stage 2 to continue setup but i got error ( windows could not start because the following file is messing or corrupt \\\\system32\\\\hal.dll Btw im testing on my pc and this message sent from my samsubg mobile Im waiting replay...thanks   \n"
    },
    {
      "id": "167544",
      "timestamp": "2013-02-09T22:37:38+00:00",
      "author": "Fiction",
      "content": "Ok, I thought I could install the grub4dos bios utility by just copying the bios file to the drive, but when I type /grub followed by whatever, it returns: \u0027warning! no such command: /grub\u0027\n\nI tried the TESTMBR, MBR1P63S would not boot,  \nMBR1P32S returned:\n\n80  \n0000 7F03 003F 032B  \nLHDD0 00  \nSHDD0 00\n\nIf I understand correctly from [http://www.rmprepusb...s/diagnose-bios](http://www.rmprepusb.com/tutorials/diagnose-bios \"External link\")\n\nThe 7F is the number of heads: 128  \n03 is the number of disks detected. This is correct as there are 2 internal harddisks (perhaps I should have mentioned this)\n\n003F so 63 sectors per track  \n032B 812 cylinders?\n\nDoes this mean a 812/128/63 geometry?\n\nSo I might be dealing with a rare 128/63 bios!\n\nThis does not matter for the internal disk, because it is to large to be accesed by CHS anyway and the bios swiches to LBA in this case, right?\n\n\\*edit\\*\n\n@steve\n\nCould you explain to me why the first file would not boot? I have a feeling it should be obvious now, but it somehow isn\u0027t to me.\n\n**Edited by Fiction, 09 February 2013 - 10:39 PM.**\n"
    },
    {
      "id": "167545",
      "timestamp": "2013-02-09T22:54:15+00:00",
      "author": "steve6375",
      "content": "Yes, looks like a weird 128 heads per cylinder!\n\nNo idea why the MBR1P63 did not work!\n\nre \u0027/grub\u0027, try typing the name of the file that you copied in order to run it - e.g. /bios (or it it had an extension type the full name - e.g. /bios.g4e)\n\n"
    },
    {
      "id": "167546",
      "timestamp": "2013-02-09T23:08:13+00:00",
      "author": "Fiction",
      "content": "Tried that /bios would not work either.\n\nIs the bios file the only one that should be copied to the flashdrive (aside from grldr) or should I copy some other files over? Does it matter that the grub4does was installed in the MBR, not the PBR?\n\n\\*edit\\*\n\nI looked at the MBR1P63 file. Tiny hexer (MBR view) tells me the partition start sector is 0/0/1 lba 63. But is 0/0/1 not LBA 0?\n\nDoes this mean the MBR1P63 files is unblanced, even for 255/63, or is there a reason for picking these values? I would expect to see 0/1/1 not 0/0/1\n\n\\*edit\\*\n\nI changed the 0/0/1 to 0/1/1 using tiny hexer. Now the MBR1P63 version boots fine. It returns exactly the same thing as the MBR1P32 did.\n\nDoest this mean my version of MBR1P63 is corrupt, or is the version currently shipped with the RMPrepUSB unbalanced?\n\n**Edited by Fiction, 09 February 2013 - 11:27 PM.**\n"
    },
    {
      "id": "167547",
      "timestamp": "2013-02-09T23:14:46+00:00",
      "author": "steve6375",
      "content": "try\n\nls /bios\n\nif that doesn\u0027t list the file, then try\n\nls /\n\nif you copied the file \u0027bios\u0027 to the root of the boot drive, then /bios should work (as long as you also typed in the other bits of the line of course!), i.e.\n\n```\n/bios int\u003d0x13 edx\u003d0x80 eax\u003d0x0800\n```\n\ndoh! ![:frusty:](http://reboot.pro/public/style_emoticons/default/frusty.gif) just noticed my mistake! I said /grub when I should have said /bios !!!! Sorry!!!!\n\n"
    },
    {
      "id": "167548",
      "timestamp": "2013-02-09T23:22:10+00:00",
      "author": "steve6375",
      "content": "P.S. as the BIOS expects 7F for the no. hds, if you hexedit the BPB (sec 63) offset 1ah to 007F then it might get a bit further.\n\n"
    },
    {
      "id": "167555",
      "timestamp": "2013-02-09T23:40:05+00:00",
      "author": "Fiction",
      "content": "I am sorry, the page did not refresh correctly, so I edited my previous post instead of posting a new one.\n\nLet me quote myself, so make the discussion easier for you:\n\u003e \\*edit\\*\n\u003e\n\u003e I looked at the MBR1P63 file. Tiny hexer (MBR view) tells me the partition start sector is 0/0/1 lba 63. But is 0/0/1 not LBA 0?\n\u003e\n\u003e Does this mean the MBR1P63 files is unblanced, even for 255/63, or is there a reason for picking these values? I would expect to see 0/1/1 not 0/0/1\n\u003e\n\u003e \\*edit\\*\n\u003e\n\u003e I changed the 0/0/1 to 0/1/1 using tiny hexer. Now the MBR1P63 version boots fine. It returns exactly the same thing as the MBR1P32 did.\n\u003e\n\u003e Doest this mean my version of MBR1P63 is corrupt, or is the version currently shipped with the RMPrepUSB unbalanced?\n\nDoes the partition on your version of MBR1P63 start at 0/0/1 or at 0/1/1? Could you verify this?\n\nI\u0027ll try booting a 128 balanced grub drive tomorrow. The /bios command would not work as it is now (255 balanced in stead of 128). But ls did find the file, weird enough.\n\n"
    },
    {
      "id": "167556",
      "timestamp": "2013-02-10T00:05:27+00:00",
      "author": "steve6375",
      "content": "Just checked the source asm and it does say 0,0,1 for some of them which is wrong (unbalanced)! Not sure how that happened! I will fix it tomorrow!\n\nHowever, it should not affect whether or not the TESTMBR boots. All the code is in the MBR. The PBR is never loaded by my code.\n\nSo the actual values of the start CHS of the partition table should be irrelevant and make no difference to whether the MBR code runs or not!\n\nSo it is very interesting that you say that the MBR1P63S does not run, but that it does when you patch the start head number to be 1 instead of 0!\n\nThat should not make any difference!\n\nThe BIOS should just load the MBR and run it. What error did it give (if any) with MBR1P63S or did it just hang or what?\n\n"
    },
    {
      "id": "167558",
      "timestamp": "2013-02-10T01:04:16+00:00",
      "author": "Fiction",
      "content": "It told me there was no boot-able disk...\n\n\\*edit\\*\n\nHowever, 0/0/1 points to the MBR does it not? Perhaps the bios thought sector 0 was the first partition sector and therefore thought there was no MBR code? I must admit, it is odd. Why read the geometry before the MBR bootcode?\n\nWould there be an easy way to test this behaviour? (What a weird bios!)\n\n**Edited by Fiction, 10 February 2013 - 01:09 AM.**\n"
    },
    {
      "id": "167562",
      "timestamp": "2013-02-10T08:58:01+00:00",
      "author": "steve6375",
      "content": "Try setting hd0 sec2   \n"
    },
    {
      "id": "167563",
      "timestamp": "2013-02-10T09:43:31+00:00",
      "author": "Fiction",
      "content": "since the bios uses 812 cylinders and 128 head, I seem limited to 6547905 sectors in thirst partition in order for it to be balanced. This is a 3.12 GiB limit for the 1st parition isn\u0027t it? Then why does the bios swich to chs at all for the 3.7 GiB partition earlier, if the volume clearly exceeds the bios\u0027s chs capability?\n\n\u003e Try setting hd0 sec2\n\nWhere should I do that, grub4dos?\n\n"
    },
    {
      "id": "167564",
      "timestamp": "2013-02-10T09:53:36+00:00",
      "author": "steve6375",
      "content": "Use disk editor to edit the first sector of the disk.\n\nInstall MBR1P63S\n\nRun RMPrepUSB\n\nSeelct USB drive and Press CTRL-D\n\nSet Start\u003d0 No Sectors\u003d1\n\nClick Sequential Read\n\nClick Display and Edit Buffer\n\nChange text that is displayed\n\n01B0 07 B4 0E CD 10 C3 00 00 - 00 00 00 00 00 00 80 00 .´ÍÃ.. ......€.  \n01C0 01 00 0B FE 7F EE 3F 00 - 00 00 F0 56 79 00 00 00 ...þî?. ..ðVy...  \nchange to  \n01B0 07 B4 0E CD 10 C3 00 00 - 00 00 00 00 00 00 80 00 .´ÍÃ.. ......€.  \n01C0 02 00 0B FE 7F EE 3F 00 - 00 00 F0 56 79 00 00 00 ...þî?. ..ðVy...  \n\nClick on Write Using Buffer\n\nExit\n\n"
    },
    {
      "id": "167565",
      "timestamp": "2013-02-10T10:04:14+00:00",
      "author": "steve6375",
      "content": "It is not the BIOS switching to CHS, it is the code in the PBR.\n\nCode can access the disk via Int 13h calls to the BIOS.\n\nThe BIOS had the old method which uses AH\u003d2 and you put the CHS values in the registers before you make the call. This had an 8GB limitation.\n\nLater the BIOS spec, added AH\u003d42h which took LBA values instead of CHS values.\n\nSo now there are two ways to read/write sectors, AH\u003d2 or AH\u003d42h.\n\nThe code in the PBR loads the start position of the 2nd stage of the FAT32 boot code (at sector PBR(63)+12).\n\nIf that position is over the 128x63x812 position then the code in the PBR chooses to use EBIOS (LBA) calls to the BIOS, if the position is less than 128x63x812 (which it is), then the code in the PBR calls the old CHS BIOS interface and converts the LBA address to CHS using the parameters in the PBR BPB table (i.e. using 255x63). That code loaded at 63+12 searches the filesystem for the ntldr file - but has problems (probably tries to access head 129 (as it thinks there are 255 heads) and the BIOS rejects the command as having an illegal head value)?\n\n"
    },
    {
      "id": "167566",
      "timestamp": "2013-02-10T10:52:13+00:00",
      "author": "Fiction",
      "content": "Interesting, it seems like the xp boot code does not care that much about the actual geometry listed in the MBR. I left those values \u0027wrong\u0027 namely 254 etc, aka 255/63 balanced.\n\nI only changed the BPB value for the heads to 128, same for the bootsect.dat. Now the xp install drive boots like a charm... Perhaps it just notices that the values in the mbr are higher then the max values based on 128 heads and it resides on using LBA?\n\nOr...\n\u003e It is not the BIOS switching to CHS, it is the code in the PBR.\n\nDo you mean by this, that the MBR geometry values are ignored, when determining whether or not to use CHS?\n\nDoes the XP boot code only read the number of heads in the BPB and reside to use CHS accordingly? This would indeed explain why I would not boot before, the bios got a number of heads bigger then 128 and did know where to look for the ntldr. So this does not actually seem like a balancing issue. Apparently the bios boots fine onto the drive despite the geometry as described in the MBR seems \u0027weird\u0027 to it. I guess the bios just thought: \u0027dont understand, let\u0027s use LBA\u0027. It probbably was only the xp boot code that thought it was a good idea to look for the NTDLR using 255 heads chs. This way, none of them check whether or not the entire partition is equally large using chs/lba. I\u0027ll test if this is true, by changing the MBR CHS values to make them no longer 255/63 balanced (but ill still use more than 128 heads, in order for the bios to switch to lba).\n\nAfter this test I\u0027ll try the things you suggested.\n\n\\*edit\\*\n\nOk, so as long as 128 heads are suggested by the BPB, this partition table boots fine:\n\n![weirdchs.png](http://img39.imageshack.us/img39/6206/weirdchs.png)\n\nWhile the CHS end values are clearly messed up (even the starting sector!). However, because the values seem \u0027weird\u0027 to the 128 heads bios, it happily switches to LBA. Microsoft should try this as well, switching to LBA when CHS fails :wink:\n\n\\*edit2\\*\n\nNow I am curious... would the bios be smart enough to switch to lba if the number of heads stays below 128, but the start and end sector CHS are completely wrong. I\u0027ll test one more time, with eHead\u003d120\n\n\\*edit3\\*\n\nIt actually is that smart ![:o](http://reboot.pro/public/style_emoticons/default/ohmy.png)\n\nIt did boot the 120 eheads drive just fine. I am starting to suspect it will always use LBA if it is supported by the MBR. Wich makes it even weirder that it would care about the MBR1P63S chs start sector \u003d/\n\nWhy check CHS before deciding to boot the MBR when you run LBA anyway?\n\n\\*edit4\\*\n\u003e Use disk editor to edit the first sector of the disk.\n\u003e\n\u003e Install MBR1P63S\n\u003e Run RMPrepUSB\n\u003e\n\u003e Seelct USB drive and Press CTRL-D\n\u003e Set Start\u003d0 No Sectors\u003d1\n\u003e\n\u003e Click Sequential Read\n\u003e Click Display and Edit Buffer\n\u003e\n\u003e Change text that is displayed\n\u003e 01B0 07 B4 0E CD 10 C3 00 00 - 00 00 00 00 00 00 80 00 .´ÍÃ.. ......€.  \n\u003e 01C0 01 00 0B FE 7F EE 3F 00 - 00 00 F0 56 79 00 00 00 ...þî?. ..ðVy...  \n\u003e change to  \n\u003e 01B0 07 B4 0E CD 10 C3 00 00 - 00 00 00 00 00 00 80 00 .´ÍÃ.. ......€.  \n\u003e 01C0 02 00 0B FE 7F EE 3F 00 - 00 00 F0 56 79 00 00 00 ...þî?. ..ðVy...\n\u003e\n\u003e Click on Write Using Buffer\n\u003e Exit\n\nI did this. It boots fine and displays the same results as seen before (128 heads, 812 cylinders).\n\nWhat does this flip from 01 to 02 imply?\n\n**Edited by Fiction, 10 February 2013 - 11:50 AM.**\n"
    },
    {
      "id": "167571",
      "timestamp": "2013-02-10T12:01:42+00:00",
      "author": "Fiction",
      "content": "Ok, I seem to be disallowed any more edits to the previous post ![:loleverybody:](http://reboot.pro/public/style_emoticons/default/loleverybody.gif)\n\nAnyway, I noticed, using tiny hexer, what this byte does. It is the start sector number. So changing it from 0/0/1 to 0/0/2 makes it instantly boot-able. This seems to agree with my suggestion that the bios notices the partition starts at the MBR sector and thinks \u0027there is no way this drive actually contains a bootable parition\u0027. Still wondering why it would use CHS for this.\n\nHowever, before we agree this is a correct conclusion: the 0/0/1 variant start working for some reason. Eh, what? The only think I can think of that I changed was that I disallowed the bios from booting onto the internal harddisk (I disabled booting from disk0 in the bios).\n\nI\u0027ll test a few thinks to see if I can reproduce this.\n\nA different suggestion is that I was sloppy creating the MBR. The first few times I used tinyhexer for the job. I started using the RMPrepUSB file\\\u003edrive function for the more recent few...\n\n"
    },
    {
      "id": "167572",
      "timestamp": "2013-02-10T12:08:29+00:00",
      "author": "steve6375",
      "content": "It must regard 0/0/1 as an invalid start sector I suppose?\n\nBefore you do any tests - use RMPrepUSB CLEAN to ensure no old PBR is around.\n\n"
    },
    {
      "id": "167573",
      "timestamp": "2013-02-10T12:16:58+00:00",
      "author": "Fiction",
      "content": "Not sure if you read my last post?\n\nIt seems like the bios settings do have something to matter with this. Setting disk0 as a secondary boot device makes it completely ignore the MBR1P63S and boot straight into the disk0. Perhaps I did confuse this behaviour with the \u0027no disk found\u0027 error. I most cases. Ignoring a drive and displaying this message is the same thing.\n\nI\u0027ll test some more. I\u0027ll do more then just a single test before editing again. Otherwise my edit button might vanish again ![:loleverybody:](http://reboot.pro/public/style_emoticons/default/loleverybody.gif)\n\n"
    },
    {
      "id": "167574",
      "timestamp": "2013-02-10T12:19:19+00:00",
      "author": "steve6375",
      "content": "Make sure you switch off the test PC each time. Some BIOSes remember the device format if you just warm reboot - so ALWAYS switch off every time you change the USB contents.\n\n"
    },
    {
      "id": "167576",
      "timestamp": "2013-02-10T12:23:41+00:00",
      "author": "Wonko the Sane",
      "content": "Try writing these values in the partition table:\n\n0C-80-1023-254-63-1023-254-63-63-7566552\n\n![:unsure:](http://reboot.pro/public/style_emoticons/default/unsure.png)\n\nBTW, till now we are exactly in the situation described by the originally referenced post, if for \\*any\\* reason the ASUS bios does not \"like\" the partition table or the geometry reported by the device, it will *automagically* determine a suitable geometry, disregarding the values in the PBR BPB.\n\nIn **Legorol**\u0027s case the \"determined\" Head number was 64, in your case it is 128.\n\nThis must be connected to the size of the device, **Legorol** was using a 1Gb stick, you are using a 4 Gb stick.\n\nIt makes sense:\n\n1024\\*64\\*63\\*512\u003d2,113,929,216\n\n1024\\*128\\*63\\*512\u003d4,227,858,432\n\nAs a matter of fact these geometries are easily replicable in Qemu (+Qemu manager), whose (Bochs originated) BIOS is a \"strict\" one.\n\n![:cheers:](http://reboot.pro/public/style_emoticons/default/cheers.gif)\n\nWonko\n\n"
    },
    {
      "id": "167578",
      "timestamp": "2013-02-10T12:38:25+00:00",
      "author": "Fiction",
      "content": "@steve Good to know, but I did this untill now I used \u0027cold\u0027 boots.\n\nAnyway, with HDD0 as second boot device the flashdrive is ignored with the CHS start sector 0/0/1, but is booted from both when using 0/1/1 or 0/1/2\n\nWhen it is the only boot device it boots anyway.\n\nSeems like the bios is checking the drive, to see if it looks bootable (apparently a chs start sector that does not imply the MBR seems like one of the criteria), otherwise it will boot a different drive.\n\nWhen the HDD0 is removed from the boot list, it has no choice and decides to boot from the device against its \u0027better\u0027 judgement.\n\nIn this case it does no longer care if the CHS start is 0/0/1 or not!\n\n... weird\n\n@Wonko\n\nIndeed this is probably happening. I am sorry I did not yet understand that part untill now. ![:suda:](https://reboot.pro/public/style_emoticons/default/suda.gif) I\u0027ll mole that over. What I do not understand however, is the following: this would anly make sence if the bios allows 1024 cylinders. I thought it was limmited to 812 according to this MBRTEST?\n\n\u003e if for \\*any\\* reason the ASUS bios does not \"like\" the partition table or the geometry reported by the device\n\nWhy would it not like the 255/63 balanced drive then? ![:confused1:](https://reboot.pro/public/style_emoticons/default/confused1.gif)\n\n\\*edit\\*\n\nHang on a sec! Wonko, I don\u0027t think this is happening at all! I just realized, I am using a 4GB stick containing the xp setup for some boot tests. But id did write the TESTMBR to a 7 GB drive! It still returned 128. I think it I using 128 as default. Can this not be true?\n\n**Edited by Fiction, 10 February 2013 - 12:45 PM.**\n"
    },
    {
      "id": "167579",
      "timestamp": "2013-02-10T12:45:00+00:00",
      "author": "Wonko the Sane",
      "content": "\u003e Why would it not like the 255/63 balanced drive then? ![:confused1:](https://reboot.pro/public/style_emoticons/default/confused1.gif)\n\nBecause it is \"exceeding\" the size of the device.\n\nIt seems (like the mentioned Qemu) the BIOS tries to \"optimize\" the number of heads, using the minimal amount needed to CHS map the whole device.\n\nNow, why would have **~~jaclaz~~** **Wonko** have originally added to his batches MBRBATCH/MKIMG the possibility to choose a CHS geometry? ![:dubbio:](https://reboot.pro/public/style_emoticons/default/dubbio.gif)\n\n(remember this happened before the \"quirk\" about the MS PBR code check for geometry emerged and a way to patch it was found for it) :wink:\n\nIf it happens on the 7 Gb one then all the previous nice explanations are not true. ![:w00t:](https://reboot.pro/public/style_emoticons/default/w00t.gif)\n\nAre you sure?\n\nReally sure?\n\nCan you try again from scratch (zeroed sticks)?\n\n![:cheers:](https://reboot.pro/public/style_emoticons/default/cheers.gif)\n\nWonko\n\n"
    },
    {
      "id": "167581",
      "timestamp": "2013-02-10T13:03:38+00:00",
      "author": "Fiction",
      "content": "Damn now I look foolish. I got the USB sizes mixed up. It is a 3.8 GB UFD :S This is why they print the sizes on them nowdays (this one is a bit older).\n\nI\u0027ll try a 32 one. If the number of heads changes, you are probably correct.\n\n\\*edit\\*\n\nI am sorry wonko! You were of course completely correct!\n\nThe 32 GB drive returned:\n\n80  \n0000 FE03 003F 03FF  \nLHDD0 00  \nSHDD0 00\n\nHowever I still do not understand why the bios would use 812 cylinders for the 4GB flashdrive...?\n\n**Edited by Fiction, 10 February 2013 - 01:10 PM.**\n"
    },
    {
      "id": "167590",
      "timestamp": "2013-02-10T14:59:40+00:00",
      "author": "Wonko the Sane",
      "content": "\u003e However I still do not understand why the bios would use 812 cylinders for the 4GB flashdrive...?\n\nMaybe it doesn\u0027t and more simply there is a glitch in the matrix.\n\nThe number of Cylinders is however completely irrelevant.\n\nThe max numbers of Cylinders possible with CHS addressing is 1024.\n\nThe PBR is (normally) well before Cylinder 812 and the parts of the geometry checked by the \"botched\" MS PBR code are just Heads and Sectors.\n\nNow, be nice, try making on the stick a partition:\n\n0C-80-815-0-1-938-127-63-6572160-999936\n\nWhat happens?\n\n![:cheers:](https://reboot.pro/public/style_emoticons/default/cheers.gif)\n\nWonko\n\n"
    },
    {
      "id": "167596",
      "timestamp": "2013-02-10T15:50:30+00:00",
      "author": "steve6375",
      "content": "\u003e However I still do not understand why the bios would use 812 cylinders for the 4GB flashdrive...?\n\nThe AH\u003d8 int 13h call returns the Disk Geometry of the disk specified by DL (\u003d80h\u003dthe boot disk). The BIOS normally derives this info from a call to the disk to ask it\u0027s total sector capacity and then the BIOS divides this into CHS to return the geometry of that disk (so you never get 1023 unless the disk is 8GB or more in size). Many BIOSes look at the End CHS values in the partition table to determine what HdsperCyl and SecsperTrack it has (it assumes that partitions always end on a whole cylinder!) - others just assume 255x63 (some odd ones assume 240 HdsperCyl!) - this BIOS it seems, just works on the size of the disk and used the lowest poss. heads per cyl value - very strange! I have not seen that before!\n\n"
    },
    {
      "id": "167598",
      "timestamp": "2013-02-10T16:03:15+00:00",
      "author": "Wonko the Sane",
      "content": "\u003e very strange! I have not seen that before!\n\nAs said, do some tests in Qemu (+Qemu Manager) and you will see that behaviour.\n\nTry partitioning/formatting with fdisk/format from DOS images (RAW, 00\u0027ed) in Qemu and you will see how the same approach is used to establish geometry based on the size of the image mapped as hard disk.\n\n![:cheers:](https://reboot.pro/public/style_emoticons/default/cheers.gif)\n\nWonko\n\n"
    },
    {
      "id": "167601",
      "timestamp": "2013-02-10T16:12:07+00:00",
      "author": "steve6375",
      "content": "But that is not the point. This is a partitioned USB disk not a Zero\u0027d disk. HS values can be derived from the partition table by the BIOS.\n\nA USB disk with the TEST MBR under QEMU shows 255x63 geometry.\n\n"
    },
    {
      "id": "167605",
      "timestamp": "2013-02-10T16:21:42+00:00",
      "author": "Fiction",
      "content": "@wonko\n\nI wanted to try your batch file for this but your batch file tells me \u0027(NOT YET AVAILABLE)\u0027? Or am I misreading?\n\nWat program is best suited for making a \u0027details\u0027 image like this? I am not skilled enough to make a complete MBR from scratch :tongue:\n\nI clean this way:\n\nusing windows 7 diskpart clean function to clean the sectors BEHIND sector 0\n\nusing the RMPrepUSB clean function to clean the MBR itself.\n\nHow to proceed from this? I could format the thing using MPrepUSB or the win7 diskpart and then change the existing values using mHex...\n\nWhat do you suggest I boot from this suggested parition? NTLDR? or are we still talking about the MBR1P63S?\n\nI can do that while waiting on clarification :tongue:. I\u0027ll just copy the MBR1P63S MBR over and change the MBR to fit these specs:\n\nPartition Type\u003d0c\n\n\u0027active\u0027\u003d80\n\nbCyl\u003d815\n\nbhead\u003d0\n\nbsec\u003d1\n\necyl\u003d938\n\nehead\u003d127\n\nesect\u003d63\n\nstart sec\u003d6572160\n\nnum sect\u003d999936\n\nAssuming you use the same syntax as in you sheets. Which you probably do, since it all lines up :tongue:\n\nBooted from it, the asus mobo displays:\n\n80\n\n0000 7f03 003f 032b\n\nlhdd0 00\n\nshdd0 00\n\naka 812/128/63 ...\n\nNo interesting stuff yet. You probably meant something else to boot from this partition? I could try installing grub4dos on it...\n\nAfter that, I guess I\u0027d better wait until you tell me what to boot from this :tongue:\n\ngrub4dos boots fine from this partition\n\nI notices I was just typing something wrong when trying to use /bios, so I got it working. The command /bios int\u003d0x13 edx\u003d0x80 eax\u003d0x0800 returns:\n\necx\u003d0000caff\n\nedx\u003d00007f03\n\nthis \u00277f03\u0027 seems really familiar :tongue:\n\nOk, but this was just trying to get the partition correct and see if it would boot. It will. Now please tell me what I should boot from it :tongue:\n\n**Edited by Fiction, 10 February 2013 - 05:17 PM.**\n"
    },
    {
      "id": "167619",
      "timestamp": "2013-02-10T17:20:52+00:00",
      "author": "Wonko the Sane",
      "content": "\u003e But that is not the point. This is a partitioned USB disk not a Zero\u0027d disk. HS values can be derived from the partition table by the BIOS.\n\u003e\n\u003e A USB disk with the TEST MBR under QEMU shows 255x63 geometry.\n\nOh, yes, it is the point.\n\nI am NOT talking of a USB disk (which is mounted through the provision of the \"main\" windows and that will have 255/63) I am talking of an image mounted as hard diks in Qemu (+Qemu Manager).\n\nTry partitioning and formatting the disk from DOS in the QEMU VM.\n\nThen apply to the image (from Windows) just the NT bootsector (UNpatched) and a NTLDR+BOOT.INI.\n\n\u003e I wanted to try your batch file for this but your batch file tells me \u0027(NOT YET AVAILABLE)\u0027? Or am I misreading?\n\nWHICH batch? (I did produce more than one :wink:).\n\n![:cheers:](https://reboot.pro/public/style_emoticons/default/cheers.gif)  \nWonko\n\n"
    },
    {
      "id": "167629",
      "timestamp": "2013-02-10T19:06:45+00:00",
      "author": "Fiction",
      "content": "This one [http://reboot.pro/to...atch-001-alpha/](http://reboot.pro/topic/3191-mbrbatch-001-alpha/ \"\")\n\nIs this the wrong one?\n\nYou still did not tell me what to boot \u003d/ Of what use is a correctly partitioned drive, if it doesn\u0027t boot.\n\n"
    },
    {
      "id": "167641",
      "timestamp": "2013-02-10T20:56:36+00:00",
      "author": "Wonko the Sane",
      "content": "\u003e This one [http://reboot.pro/to...atch-001-alpha/](http://reboot.pro/topic/3191-mbrbatch-001-alpha/ \"\")  \n\u003e Is this the wrong one?\nI don\u0027t know, there are at least three versions of MBRBATCH and three of MKIMG on that thread.  \n\nHave you got all the needed tools? ![:dubbio:](https://reboot.pro/public/style_emoticons/default/dubbio.gif)  \n\nHave you read the thread and found - among the others - this post? ![:whistling:](https://reboot.pro/public/style_emoticons/default/happy22.gif)  \n\n[http://reboot.pro/to...ge-2#entry91491](http://reboot.pro/topic/3191-mbrbatch-001-alpha/page-2#entry91491 \"\")  \n\u003e You still did not tell me what to boot \u003d/ Of what use is a correctly partitioned drive, if it doesn\u0027t boot.\nI am afraid I don\u0027t understand ![:unsure:](https://reboot.pro/public/style_emoticons/default/unsure.png)  \n\n![:cheers:](https://reboot.pro/public/style_emoticons/default/cheers.gif)  \nWonko   \n"
    },
    {
      "id": "167658",
      "timestamp": "2013-02-10T22:23:41+00:00",
      "author": "Fiction",
      "content": "\u003e Maybe it doesn\u0027t and more simply there is a glitch in the matrix.\n\u003e\n\u003e The number of Cylinders is however completely irrelevant.\n\u003e\n\u003e The max numbers of Cylinders possible with CHS addressing is 1024.\n\u003e\n\u003e The PBR is (normally) well before Cylinder 812 and the parts of the geometry checked by the \"botched\" MS PBR code are just Heads and Sectors.\n\u003e\n\u003e Now, be nice, try making on the stick a partition:\n\u003e\n\u003e 0C-80-815-0-1-938-127-63-6572160-999936\n\u003e\n\u003e What happens?\n\u003e\n\u003e ![:cheers:](https://reboot.pro/public/style_emoticons/default/cheers.gif)\n\u003e\n\u003e Wonko\n\nI made the partition, but \u0027nothing happens\u0027, since it is just a partition table. I do not know what bootloader you thought should go with it. Was this about NTLDR, grub4dos, MBR1P63S, freedos maybe? Right now I have a partition table entry as suggested, but it is not bootable as there is no bootable code in the MBR, only a partition table \u003d/ By the way, I do not understand the interest in this parition entry. The drive size remains the same (4GB), so it will be accessed by 128 head, like you explained. Why is this particularity entry of interest?  \n\nOr... perhaps it was to show that more sectors then the 812 form earlier can be used and still be boot able? If so, Why are you suggesting a 0C partition for this test an not a 0B?\n\n\\*edit\\*\n\nComing to thing of it... I tested if the bios would switch to LBA if it could not find the VBR earlier... I used 0C as well! Perhaps I should retry this using 0B. I\u0027ll do this tomorrow.\n\n**Edited by Fiction, 10 February 2013 - 10:31 PM.**\n"
    },
    {
      "id": "167660",
      "timestamp": "2013-02-10T22:41:14+00:00",
      "author": "Wonko the Sane",
      "content": "The issue is with the NT/2K PBR code (the one invoking NTLDR), which PBR code do you want to test if not this one? ![:dubbio:](https://reboot.pro/public/style_emoticons/default/dubbio.gif) (with and without the 4 byte \"Clemens Patch\")\n\nI spent a lot of keypresses to explain why I consider the \"right\" MBR code to be used ALWAYS the 2K/XP one (and if the case patch it with the three bytes patch, \"HP patch\") ![:frusty:](https://reboot.pro/public/style_emoticons/default/frusty.gif)\n\nThen you need in ROOT of the filesystem a copy of NTLDR and a BOOT.INI with at least two entries.\n\nYep :smile:, you stated how that BIOS can see only 812 Cylinders, a good way to check if this is true is having the PBR (the first thing accessed from the MBR) reside beyond this limit and see what happens (815 is given only because I like to press the 5 key :wink:).\n\nThe 0B would have been NEXT experiment (once we have results for the 0C).\n\n![:cheers:](https://reboot.pro/public/style_emoticons/default/cheers.gif)\n\nWonko\n\n\u003cbr /\u003e\n\n"
    },
    {
      "id": "167670",
      "timestamp": "2013-02-11T00:23:00+00:00",
      "author": "Fiction",
      "content": "\u003e which PBR code do you want to test if not this one?\n\nI am sorry to frustrate you, but that was not evident to me. Yes, we are meanly talking about the NTLDR. But we used close to every bootloader supported by RMPrepUSB while \u0027testing bios behaviour\u0027 during this threat. Next time you suggest a test, could you be specific about the idea behind it. It might be trivial to you (you probably thought \u0027815 start head says it all\u0027), but I\u0027m new in this field and I do not always draw the same conclusions as you do.\n\nWhile I am at it, I\u0027d still like to clear the air about something. Please allow me to explain my seemingly uninterested behaviour in the posts on the first few pages of this threat. Since I\u0027d like to clear the air about this, since I am not sure actually HOW annoyed you are because of this...\n\nYou suggested a lot of very useful and interesting sites, but they used words I did not yet understand and assumed knowledge that was not present with me at that time to be \u0027common\u0027. Some threads got to their conclusions before I had a clue at the basic ideas.\n\nSince I did not really understand more than half of what I was reading, I also had trouble remembering what I had just read. (it is harder to remember something you do not understand)  \nOn top of this, I have dyslexia and reading a long piece of text, in a small font, without much whitespace is a REAL chore to me. A chore however I am more than willing to do :tongue: (aka it\u0027s more than worth the trouble to me)\n\nPlease do not interpret this post as an insult or something, I am just trying to explain my behaviour, it is actually\n\nintended as a sort of thorough apology for not being able to keep up at the same pace.\n\nIn order to optimize communication, would you be so kind to slow down and explain thoroughly?\n\nFor example, when you say \u0027please create a 0C-80-815-0-1-938-127-63-6572160-999936 partition\u0027. Please tell me the \u0027columns of these correspond to those in the sheets. It was only the last time you posted it, I noticed that.\n\nPerhaps it is useful to list the things I did not yet understand before reading this threat, so you guys know what\n\nlevel I am currently on.\n\nBefore reading all of this I did not yet know:  \nWhat the difference is between a MBR and a VBR  \nWhat is meant by BPB  \nWhat a sector is  \nThat something called CHS exists  \nThat something called LBA exists  \nWhat their differences are  \nThat (boot) sectors are hexeditable  \nThat the partition table is located inside of the MBR\n\nThat the BPB is located in the VBR\n\nThat VBR and PBR are the same thing\n\nThat in a CHS adress: cylinder and head both start at 0, while \u0027sector\u0027 starts at 1.\n\nand the details on all of these things. And probably more that won\u0027t jump to mind right now.  \nI think I do understand these things right now, which feels lake a major improvement to me :tongue:. Consider this a list of the most important accomplishments while you guide me through the rabbit hole.  \nOf course, it is hard to understand things when someone is talking about VBR or BPB when you do not know where they are located.\n\nI think I have myself to blame for the miscommunication:\n\nI should have told you I did not know what these things meant, in stead of pretending to understand some of it, while I did not. But these are my first few threats on this forum and you guys all seem so knowledgeable. I felt intimidated :S\n\nPS\n\nI\u0027ll see if the suggested partition boots to NTLDR tomorrow.\n\n**Edited by Fiction, 11 February 2013 - 12:26 AM.**\n"
    },
    {
      "id": "167674",
      "timestamp": "2013-02-11T00:55:55+00:00",
      "author": "Wonko the Sane",
      "content": "Well, rest assured, the matter ***is*** complex. ![:ph34r:](https://reboot.pro/public/style_emoticons/default/scared9.gif)\n\nThe whole issue is with \"teaching style\", I tend to leave something not fully explained to:\n\n1. see if the padawan is attentive\n2. see if he/she is can connect the dots in autonomy\n3. be allowed to shout/vent a bit (still to further \"push\" the padawan to learn and reason along his/her own mental paths)\n\nIn most cases this works better and faster than anything else (and BTW seemingly it is working in your case also ![:thumbup:](https://reboot.pro/public/style_emoticons/default/thumbup.gif), if you didn\u0027t realize it, you have been taking part to a crash course on booting matters at what can be considered \"advanced level\" :wink:).\n\n![:cheers:](https://reboot.pro/public/style_emoticons/default/cheers.gif)\n\nWonko\n\n"
    },
    {
      "id": "167675",
      "timestamp": "2013-02-11T01:09:38+00:00",
      "author": "Fiction",
      "content": "\u003e 1. be allowed to shout/vent a bit (still to further \"push\" the padawan to learn and reason along his/her own mental paths)\n\nAh, so this:\n\n\u003e I spent a lot of keypresses to explain why I consider the \"right\" MBR code to be used ALWAYS the 2K/XP one (and if the case patch it with the three bytes patch, \"HP patch\") ![:frusty:](https://reboot.pro/public/style_emoticons/default/frusty.gif)\n\nwas part of that?\n\nI guess I get intimidated to quickly... in general.\n\nComing to think of it... that might explain a few reactions from my environment as well! ![:loleverybody:](https://reboot.pro/public/style_emoticons/default/loleverybody.gif)\n\n"
    },
    {
      "id": "167712",
      "timestamp": "2013-02-11T17:19:13+00:00",
      "author": "Fiction",
      "content": "I am experiencing more difficulty then expected while testing this partition. I created the bootcode in the MBR using RMPrepUSB then I changed the partition table, destroying the PBR in the process. This is what made it hard: I did not know how to fix the PBR. I tried simpy bakcing up and restoring the PBR but this would not boot. After a while I decided to use a bootsect.exe to to the trick. This would at least boot on a pc with a \u0027normal\u0027 bios. After that I tested it on the weird asus bios\n\nSo what about the weird asus bios? Well it would not boot with a \u0027default\u0027 BPB, but it would boot if I changed the head in there to 128 in stead of 255. I hear you thinking: that is the behaviour of the PBR, right? Well I\u0027m not sure about that, I did not get a NTLDR warning, nor a warning from the MBR (\u0027Invalid partition table. Error loading operating system. Missing operating system.\u0027). No, I got a bios warning: \u0027disk boot failure, insert system disk and press enter\u0027. Seemingly the bios wont even look at the MBR of the drive! I should probably check if the HP patch has any effect on this (I only read about a NTFS version and I\u0027m using FAT32 but I\u0027ll re-read).\n\nFurther more, berhaps I should try a different version of your batch thingy (I\u0027ll try to find the newest version), sins partitioning this way seems like an unnecessary amount of work this way.\n\n"
    },
    {
      "id": "167729",
      "timestamp": "2013-02-12T00:03:32+00:00",
      "author": "Fiction",
      "content": "\u003e (I only read about a NTFS version and I\u0027m using FAT32 but I\u0027ll re-read).\n\nFail, that would not matter for the MBR would it? I got confused because I thought the \u002706CA\u0027 here [http://reboot.pro/to...s-info/?p\u003d14607](http://reboot.pro/topic/2246-grub4dos-info/?p\u003d14607 \"\") was an address.\n\nThere is however just one B80102 combination of bytes, so this should be \u0027it\u0027.\n\nI am still not completely confident about the mbrbatch usage, but I\u0027m getting there. I\u0027ll run some more tests as soon as I can.\n\n\\*edit\\*\n\nIs address in the second sentence the correct word, or is it called an \u0027offset\u0027?\n\n**Edited by Fiction, 12 February 2013 - 12:05 AM.**\n"
    },
    {
      "id": "167730",
      "timestamp": "2013-02-12T00:25:16+00:00",
      "author": "Wonko the Sane",
      "content": "\u003e Fail, that would not matter for the MBR would it? I got confused because I thought the \u002706CA\u0027 here [http://reboot.pro/to...s-info/?p\u003d14607](http://reboot.pro/topic/2246-grub4dos-info/?p\u003d14607 \"\") was an address.\n\u003e\n\u003e There is however just one B80102 combination of bytes, so this should be \u0027it\u0027.\n\u003e\n\u003e I am still not completely confident about the mbrbatch usage, but I\u0027m getting there. I\u0027ll run some more tests as soon as I can.\n\u003e\n\u003e \\*edit\\*\n\u003e\n\u003e Is address in the second sentence the correct word, or is it called an \u0027offset\u0027?\n\nTechnically, they are \"addresses\" expressed as \"offsets\".\n\nOr if you prefer an address (in a file) is normally expressed as an offset.\n\nPlease consider that the ones here (including the mentioned:06CA)\n\n[http://thestarman.pc...br/Win2kmbr.htm](http://thestarman.pcministry.com/asm/mbr/Win2kmbr.htm \"External link\")\n\nare \"virtual\" addesses in the sense that they represent (as offset) the addresses where the code ***++will++be once loaded***into memory.\n\nYou want to have a look at the 2K MBR code with a \"offline\" disassembler/viewer, such as ~~biew~~ beye:\n\n[http://beye.sourcefo...beye_intro.html](http://beye.sourceforge.net/en/beye_intro.html \"External link\")\n\n[http://beye.sourcefo...et/en/beye.html](http://beye.sourceforge.net/en/beye.html \"External link\")\n\n[http://sourceforge.n...eye/files/biew/](http://sourceforge.net/projects/beye/files/biew/ \"External link\")\n\nwhich will keep the same addresses (offsets) as in the actual MBR.\n\n![:cheers:](https://reboot.pro/public/style_emoticons/default/cheers.gif)\n\nWonko\n\n"
    },
    {
      "id": "167761",
      "timestamp": "2013-02-12T16:44:14+00:00",
      "author": "Fiction",
      "content": "I do have a little less free time, so I\u0027ll read all of that at my own pace. I still wanted to tell you that I think I understand the MBR batch now, do I understand correctly that there is no way to specify a starting sector?\n\n\\*edit\\*\n\nI found this as well: [http://samuelkerr.com/?p\u003d262](http://samuelkerr.com/?p\u003d262 \"External link\")\n\n\u003e 0000h - 01B7h Code Area (440 bytes)  \n\u003e 01B8h - 01BBh Disk Signature (4 bytes)  \n\u003e 01BCh - 01BDh Generally Zeroed out (2 bytes)  \n\u003e 01BEh - 01FDh List of Partition Records (4 16-byte structures)  \n\u003e 01FEh - 01FFh MBR Signature (2 bytes - Must be AA55h)\n\nIs this the case for every MBR, independent of the boot code?\n\nThis would be interesting, I could just clean the drive, create the partition table (and perhaps the aa55/disk signature), format using for instance diskpart and then add the code manually.\n\nI guess these are all \"virtual\" addesses as well. What would the corresponding \u0027real\u0027 adresses be then? I guess the answer to this lies somewhere in the links you posted earlier :tongue:\n\nThe biggest problems left then are then:\n\n1what about the PBR\n\n2what should the disk signature be?\n\n**Edited by Fiction, 12 February 2013 - 05:20 PM.**\n"
    },
    {
      "id": "167763",
      "timestamp": "2013-02-12T18:05:31+00:00",
      "author": "Wonko the Sane",
      "content": "\u003e I do have a little less free time, so I\u0027ll read all of that at my own pace. I still wanted to tell you that I think I understand the MBR batch now, do I understand correctly that there is no way to specify a starting sector?\n\nYes.\n\nSure you can specify a start sector (i guess you mean a start sector for a partition).\n\n\u003e \\*edit\\*\n\u003e\n\u003e I found this as well: [http://samuelkerr.com/?p\u003d262](http://samuelkerr.com/?p\u003d262 \"External link\")\n\u003e\n\u003e Is this the case for every MBR, independent of the boot code?\n\nYes, that is the \"standard\".\n\n\u003e This would be interesting, I could just clean the drive, create the partition table (and perhaps the aa55/disk signature), format using for instance diskpart and then add the code manually.\n\nExactly.\n\nBTW you NEED the 55AA magic bytes.\n\nDon\u0027t worry much (or don\u0027t worry at all) about disk signature.\n\nAs soon as a NT based system will access that MBR as part of a disk it will automagically add the disk signature if those four bytes are 00, otherwise you can write \\*any\\* number.\n\nAs an example I often use in experiment (as form of respect towards the friend **cdob** ![:worship:](https://reboot.pro/public/style_emoticons/default/worship.gif)) a signature of CD0BCD0B.\n\nThe issue may come if you connect two disks with same signature to the same NT system at the same time.\n\u003e I guess these are all \"virtual\" addesses as well. What would the corresponding \u0027real\u0027 adresses be then? I guess the answer to this lies somewhere in the links you posted earlier :tongue:\n\nJust open a dump of the MBR in ~~biew~~ beye :wink:.\n\n\u003e The biggest problems left then are then:\n\u003e\n\u003e 1what about the PBR\n\u003e\n\u003e 2what should the disk signature be?\n\nThe PBR (just like the MBR) is made of two parts, CODE and DATA.\n\nTraditionally (DOS) you had FDISK that ONLY wrote the MBR DATA, i.e. the partition table and the magic bytes 55AA (and you needed to run FDISK /MBR to write the CODE to the MBR.\n\nFORMAT instead not ONLY did write the DATA in the PBR, i.e. the BPB and the magic bytes 55AA, but also the CODE.\n\nIn NT system, when you partition a disk instead, IF there is not the 55AA magic bytes in the MBR, the disk is \"initialized\" which basically means that the CODE is written to it, before you start creating partitions.\n\nThe FORMAT command has remained using the same paradigm, under NT as well when you format a volume BOTH DATA (BPB+magic bytes) and CODE are written to the PBR/VBR.\n\nAdditionally (and this is where MBRbatch comes useful) the NT FORMAT \"trusts\" the info that it can read in the partition table (with a couple exceptions, see the MBRbatch thread) where some CHS based partition ID\u0027s may (FAT16 and FAT32) may be changed silently by FORMAT to the corresponding LBA ID\u0027s.\n\n![:cheers:](https://reboot.pro/public/style_emoticons/default/cheers.gif)\n\nWonko\n\n"
    },
    {
      "id": "167808",
      "timestamp": "2013-02-13T14:28:51+00:00",
      "author": "Wonko the Sane",
      "content": "On second thought, you may be more at ease using this:\n\n[http://reboot.pro/to...-v0100-release/](http://reboot.pro/topic/11857-createrawimg-v0100-release/ \"\")\n\ninstead.\n\n![:cheers:](https://reboot.pro/public/style_emoticons/default/cheers.gif)\n\nWonko\n\n"
    },
    {
      "id": "167821",
      "timestamp": "2013-02-13T20:57:45+00:00",
      "author": "Fiction",
      "content": "I must admit I like GUIs. I\u0027m know public opinion is that GUIs aren\u0027t \u0027pro\u0027, but I\u0027m very visually focused. This program will be useful in the future.\n\nI got Lancelot\u0027s verion of the batchfiles working. What is the advantage of mkimg above create? The fact that mkimg does not need a file containing the MBR code, because it is loading this from a system file? I need to provide this file myself since I am using x64 win7 on the system preparing the flash drive. I think it might be a better idea to keep a copy of the mbr content. Seems like create would be more useful in this case. If I understand correctly after using create you still need to use edit, to add the partition table.\n\nI think using edit for the partition table is probably a good idea, since you can not specify a start sector in create... or can you?\n\nI keep thinking using tiny hexer and doing all of this manually is more fun as well :tongue:.\n\n\\*edit\\*\n\nI suppose the KCS checksum can be left al 0-s as well?\n\n\\*edit2\\*\n\nOfftopic, but I skimmed this:\n\n[http://www.911cd.net...pic\u003d21242\\\u0026st\u003d60](http://www.911cd.net/forums//index.php?showtopic\u003d21242\u0026st\u003d60 \"External link\")\n\nDo I understand correctly that you use this method to boot the OS just enough to load the drivers for the external device and a bit later continue the booting from this device, in order to continue from a different drive the booting originally started from?\n\nThat\u0027s brilliant :tongue:\n\n**Edited by Fiction, 13 February 2013 - 09:47 PM.**\n"
    },
    {
      "id": "167833",
      "timestamp": "2013-02-13T22:43:19+00:00",
      "author": "Wonko the Sane",
      "content": "\u003e Do I understand correctly that you use this method to boot the OS just enough to load the drivers for the external device and a bit later continue the booting from this device, in order to continue from a different drive the booting originally started from?\n\u003e\n\u003e That\u0027s brilliant :tongue:\n\nYep ![:thumbsup:](https://reboot.pro/public/style_emoticons/default/thumbsup.gif), that\u0027s the Kansas City Shuffle, like any confidence trick:\n\n[http://en.wikipedia....Confidence_game](http://en.wikipedia.org/wiki/Confidence_game \"External link\")\n\nit ***is*** clever. (and you need an ++artist++ - in this case **s4e** - and a \"++sucker++ \" - in this case the MS XP, and sometimes one or more shills - in this case **Dietmar** , **jaclaz** , **cdob** and**karyonix**).\n\nThe trick is to make the *gullible* XP believe that booting was started since the beginning from the \"external device\", while in reality it began from the KCS image.\n\nBTW, and to be picky as always :wink:, you are talking of the KCS**sum** (i.e. something that needs to be added in order to match a given KCS checksum), not of the checksum.\n\nThis is only needed on the image MBR to match the \"real device\" KCS checksum, not only it can, but it should be left all 00\u0027s everywhere if not on a KCS image.\n\nAnd yes, you need to edit the MBR if using MKIMG, if you prefer MBRBATCH is a \"fine tweaking\" tool, while mkimg is a sort of \"wizard\" to deliver in a few steps a base \"generic\" image, suitable for USB sticks and the like.\n\n![:cheers:](https://reboot.pro/public/style_emoticons/default/cheers.gif)\n\nWonko\n\n"
    },
    {
      "id": "168640",
      "timestamp": "2013-03-02T16:18:24+00:00",
      "author": "Fiction",
      "content": "Ok, this might verry well be a problem caused by a weak understanding of the matter, but I\u0027m trying to test a few differnent partitiontabels, and see if the drive is bootable.\n\nHowever, I\u0027m unable to get both the PBR and the MBR code to work propperly, without reformatting the entire drive.\n\nCan you guys advice me tools that are able to:\n\n1 add bootcode (both ntldr and bootmgr, preferably a msdos bootcode) to the mbr and pbr without altering the partition table RMPrepUSB reformats the entire drive if I hit \u00276 Prepare Drive\u0027\n\n2 Partially unrelated: Something I could install on windows 7 that would be able to run winnt32.exe. I am running winnt32.exe from virtualbox now, when needed and is slows down the process a fair bit.\n\nIf I recall correclty RMPrepUSB had a File\\\u003eUSB function, but I thought it wrote to the MBR only? I\u0027ve seen the words \u0027NTLDR\u0027 and \u0027BOOTMGR\u0027 mentioned literally in the PBR, so I am confident some bootcode has to be written to the PBR right?\n\n"
    },
    {
      "id": "168657",
      "timestamp": "2013-03-02T21:12:44+00:00",
      "author": "Fiction",
      "content": "\\*no edit button\\*\n\nI installed xp on a reliable (i think) pc an used that to run winnt32, but it did not create a bootsect.dat.\n\nNot sure If I got any switches wrong, or if my xp source iso is not up for the job (I slipstreamed sp3 in there some time ago). Perhaps I should re-rip the source...\n\nFor now I\u0027ll use the dos\\\u0026winnt.exe method, since it worked in the past and I need to install xp to a pc before monday.\n\nBy the way: the questions this topic was stared with are pretty much awnsered. I know now why the old asus mobo was behaving \u0027odd\u0027 and I have learnd quite a lot about booting and the chs lba addressing scheme differences.\n\nI\u0027d like to keep asking small questions in here, is it\u0027s ok. And I\u0027ll post the results on the \u0027moved partition\u0027 test as soon as I get (in my view) reliable results. I\u0027ll mark this treat solved, as the most important questions are answered.\n\n\\*edit:fixed a sentence\\*\n\n\\*edit2\\*\n\nBTW The method I used with winnt32 was winnt32.exe /cmp:\"testcommand\" /makelocalsource /noreboot /syspart:\\\u003cUFDletter\\\u003e: /tempdrive:\\\u003cUFDletter\\\u003e:\n\nI got this method working the first time I tried it, but forgot to add a command to the winnt.sif to rename the files and folders on the UFD before the setup deletes them, so far I could not reproduce.\n\nI\u0027m not sure what I did different. Possibly I forgot the /noreboot the first time. I could try that...\n\nBut it has to wait untill the XP system I\u0027m installing is working propperly.\n\n**Edited by Fiction, 02 March 2013 - 09:23 PM.**\n"
    },
    {
      "id": "168679",
      "timestamp": "2013-03-03T11:19:24+00:00",
      "author": "Wonko the Sane",
      "content": "\u003e Ok, this might verry well be a problem caused by a weak understanding of the matter, but I\u0027m trying to test a few differnent partitiontabels, and see if the drive is bootable.\n\u003e\n\u003e However, I\u0027m unable to get both the PBR and the MBR code to work propperly, without reformatting the entire drive.\n\u003e\n\u003e Can you guys advice me tools that are able to:\n\u003e\n\u003e 1 add bootcode (both ntldr and bootmgr, preferably a msdos bootcode) to the mbr and pbr without altering the partition table RMPrepUSB reformats the entire drive if I hit \u00276 Prepare Drive\u0027\n\u003e\n\u003e 2 Partially unrelated: Something I could install on windows 7 that would be able to run winnt32.exe. I am running winnt32.exe from virtualbox now, when needed and is slows down the process a fair bit.\n\u003e\n\u003e If I recall correclty RMPrepUSB had a File\\\u003eUSB function, but I thought it wrote to the MBR only? I\u0027ve seen the words \u0027NTLDR\u0027 and \u0027BOOTMGR\u0027 mentioned literally in the PBR, so I am confident some bootcode has to be written to the PBR right?\n\nYou can have:\n\nMBRFIX:  \n[http://www.sysint.no...ting/mbrfix.htm](http://www.sysint.no/nedlasting/mbrfix.htm \"External link\")\n\nyou should already have bootsect.exe:\n\n[http://technet.micro...7(v\u003dws.10).aspx](http://technet.microsoft.com/en-us/library/cc749177(v\u003dws.10).aspx \"External link\")\n\nplease understand how the version coming with Windows 7 has an added **/mbr** switch:\n\n[http://technet.micro...7(v\u003dws.10).aspx](http://technet.microsoft.com/en-us/library/dd744577(v\u003dws.10).aspx \"External link\")\n\nAdditionally, to replace code in the MBR is extremely simple, the CODE is just the first 440 bytes -or 446 including disk signature, so you can use any dd-like tool, take care - if you use dsfi/dsfo - that it wants \"whole sectors\", i.e. multiples of 512 bytes - when **writing to** device (whilst 440 or any number of bytes is OK on files), see here:\n\n[http://reboot.pro/to...-alpha/?p\u003d29134](http://reboot.pro/topic/3191-mbrbatch-001-alpha/?p\u003d29134 \"\")\n\n![:cheers:](http://reboot.pro/public/style_emoticons/default/cheers.gif)\n\nWonko\n\n"
    },
    {
      "id": "168682",
      "timestamp": "2013-03-03T12:04:51+00:00",
      "author": "steve6375",
      "content": "You can use RMPrepUSB to replace the MBR boot code with either standard (actually win7) MBR, grub4dos mbr or wee MBR without changing the serial number or partition table on the disk.\n\nUse the BootLoaders menu tab at the top of RMPrepUSB.\n\n"
    },
    {
      "id": "168753",
      "timestamp": "2013-03-04T11:32:31+00:00",
      "author": "Fiction",
      "content": "\u003e you should already have bootsect.exe:\n\n\u003e I am experiencing more difficulty then expected while testing this partition. I created the bootcode in the MBR using RMPrepUSB then I changed the partition table, destroying the PBR in the process. This is what made it hard: I did not know how to fix the PBR. I tried simpy bakcing up and restoring the PBR but this would not boot. After a while I decided to use a bootsect.exe to to the trick. This would at least boot on a pc with a \u0027normal\u0027 bios. After that I tested it on the weird asus bios\n\u003e\n\u003e So what about the weird asus bios? Well it would not boot with a \u0027default\u0027 BPB, but it would boot if I changed the head in there to 128 in stead of 255. I hear you thinking: that is the behaviour of the PBR, right? Well I\u0027m not sure about that, I did not get a NTLDR warning, nor a warning from the MBR (\u0027Invalid partition table. Error loading operating system. Missing operating system.\u0027). No, I got a bios warning: \u0027disk boot failure, insert system disk and press enter\u0027. Seemingly the bios wont even look at the MBR of the drive! I should probably check if the HP patch has any effect on this (I only read about a NTFS version and I\u0027m using FAT32 but I\u0027ll re-read).\n\u003e\n\u003e Further more, berhaps I should try a different version of your batch thingy (I\u0027ll try to find the newest version), sins partitioning this way seems like an unnecessary amount of work this way.\n\nI appears I do ![:frusty:](http://reboot.pro/public/style_emoticons/default/frusty.gif)  \nSpend so much time trying to do it with tiny hexer I forgot. ![:frusty:](http://reboot.pro/public/style_emoticons/default/frusty.gif)  \nBootsect does the job well, except for the dos code, but I actually DID get that working using tiny hexer yesterday (have not tryed on volumes with a \u0027weird\u0027 starting sector yet, but should work I suppose).\n\nAf few more intelegent questions (I hope):\n\n1 I looked the the second and third sector from the volume (PBR) they all (3) seem like bootsectors to me... all three of them ended with \u0027magic bytes\u0027. The second sector was all 0-s execept for 2 groups of 4 or so nonzero bytes. The third sector seemed like an important piece of code. I think the third sector contains more bootcode and the second one contains some volume-specific bytes.\n\nAm I correct here?\n\nAny of you know what these bytes in the second cluster are?\n\n2 I am getting pretty tired of testing if a flashdrive should be bootable by normall computers or not. All this rebooting. Virtual box and VmWare do not support usb booting. I know I could do this indirectly, but I heard about Qemu? However it seems it is only downloadable als tar.bz2. How should I \u0027compile\u0027 this file in windows?\n\n"
    },
    {
      "id": "168755",
      "timestamp": "2013-03-04T11:48:11+00:00",
      "author": "Wonko the Sane",
      "content": "#1 it depends (obviously) by the filesystem used AND (in the case of FAT32) on WHICH OS was used to format the partition.\n\nRead:\n\n[http://thestarman.pc.../mbr/index.html](http://thestarman.pcministry.com/asm/mbr/index.html \"External link\")\n\n\\*everything\\* ![:w00t:](http://reboot.pro/public/style_emoticons/default/w00t.gif), but specifically:\n\n[http://thestarman.pc...r/ntFAT32BR.htm](http://thestarman.pcministry.com/asm/mbr/ntFAT32BR.htm \"External link\")\n\nand:\n\n[http://thestarman.pc...mbr/MSWIN41.htm](http://thestarman.pcministry.com/asm/mbr/MSWIN41.htm \"External link\")\n\nIn a nutshell the FAT32 bootrecord is actually THREE sectors long.\n\n* If formatted in DOS, it is made of sectors 0,1,2.\n* If formatted in NT based systems it is made of sectors 0,1,12\n* If formatted under ReactOS ![:w00t:](http://reboot.pro/public/style_emoticons/default/w00t.gif), it is made of sectors 0,1,14\n\n#2\n\nMeet Qemu Manager :wink::\n\n[http://reboot.pro/to...ger#entry167861](http://reboot.pro/topic/18163-memdisk-limit-creating-bootable-dos-image/?hl\u003dmanager#entry167861 \"\")\n\n(home site is down currently, hence use the Wayback Machine)\n\n![:cheers:](http://reboot.pro/public/style_emoticons/default/cheers.gif)\n\nWonko\n\n"
    },
    {
      "id": "168757",
      "timestamp": "2013-03-04T11:53:26+00:00",
      "author": "steve6375",
      "content": "RMPrepUSB has QEMU and is designed to be used with USB Flash drives.\n\nIt also can install different bootloaders, will give you info on MBR and PBRs and allows to to edit sectors (CTRL+D). etc. etc. etc.\n\n"
    },
    {
      "id": "168759",
      "timestamp": "2013-03-04T12:03:24+00:00",
      "author": "Wonko the Sane",
      "content": "\u003e RMPrepUSB has QEMU and is designed to be used with USB Flash drives.\n\u003e\n\u003e It also can install different bootloaders, will give you info on MBR and PBRs and allows to to edit sectors (CTRL+D). etc. etc. etc.\n\nGood :smile:, I guess we should close the board, ask ALL other programmers around to delete their web pages and tools and replace \\*everything\\* with a link to RMPREPUSB? ![:dubbio:](http://reboot.pro/public/style_emoticons/default/dubbio.gif)\n\n(we will need to make an exception for **wimb** and his tools ![:thumbsup:](http://reboot.pro/public/style_emoticons/default/thumbsup.gif) that apparently, like or together with RMPREPUSB, are the answer to \\*all\\* and \\*any\\* problem)\n\nJust for the record, though RMPREPUSB is an exceptionally good program ![:worship:](http://reboot.pro/public/style_emoticons/default/worship.gif), it\u0027s functions simply CANNOT be compared to a full fledged VM GUI for Qemu.\n\nAdditionally, of course IMHO ![:ph34r:](http://reboot.pro/public/style_emoticons/default/scared9.gif), the general idea is to have **Fiction** learn about the matter at hand (as opposed to contributing to make yet another \"trained monkey\" only capable to push a few buttons in sequence) ![:ranting2:](http://reboot.pro/public/style_emoticons/default/ranting2.gif).\n\n![:cheers:](http://reboot.pro/public/style_emoticons/default/cheers.gif)\n\nWonko\n\n"
    }
  ]
}