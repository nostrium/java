{
  "id": "21513",
  "title": "How to swap install.wim/install.esd/install.swm* during installation?",
  "isPinned": false,
  "isFirstTopic": false,
  "isLocked": false,
  "tags": [],
  "forumNotes": [
    {
      "id": "203482",
      "timestamp": "2017-05-11T16:28:18+00:00",
      "author": "Guest_AnonVendetta_*",
      "content": "I have a handful of ISOs, containing different editions of Windows. I currently make Easy2Boot imgPTN files from each ISO. But it would be more convenient to combine them all into a single imgPTN. How can I swap out these files, depending on which edition I want to install? Can it be done with a script, so that setup installs from the correct file? Or would I better better off creating a custom mega wim/esd/swm\\* that contains all the editions? I could always split them into swm since the file would be huge. I would also need to be able to run the setup in either legacy or BIOS mode. I spend alot of time installing and configuring Windows for others, so this would be very convenient.\n\nThanks!\n\n"
    },
    {
      "id": "203484",
      "timestamp": "2017-05-11T16:47:25+00:00",
      "author": "steve6375",
      "content": "Convert one of the Windows 10 x86 ISOs to a .imgPTN file (FAT32) using Chandra\u0027s Split_WinISO utility.\n\nUse the MPI button and not the other button.\n\nWhen asked about winpeshl.ini and setupcmd.cmd - say YES.\n\nThis will create .imgPTN file and a modified boot.wim.\n\nNow copy all other Install.wim files over and rename as required.\n\nNow edit the \\\\auto.cmd file to pick any XML file you want and any install.wim you want.\n\nSetup can be told what wim file to use with /installfrom:(path) option\n\nsee [https://technet.micr...6(v\u003dws.10).aspx](https://technet.microsoft.com/en-gb/library/cc766446(v\u003dws.10).aspx \"External link\")\n\nNow this will make either an x86 or x64 .imgPTN file. Repeat to make another .imgPTN file for the other type.\n\nHowever...\n\nPersonally, I would just make a FAT32 WinPE .imgPTN file which can 32-bit or 64-bit boot.\n\n[http://www.rmprepusb...ual-32-64bit-pe](http://www.rmprepusb.com/tutorials/127-make-dual-32-64bit-pe \"External link\")\n\nThen you boot in any mode - use \\\\e2b\\\\Switch_e2b.exe or one of the other scripts in that same folder to switch back to the E2B partition - now you can run [WinNTSetup](http://www.easy2boot.com/add-payload-files/windows-install-isos/winntsetup/ \"External link\") from the E2B drive and pick any ISO on the E2B drive and any XML file (if you wish).\n\n"
    },
    {
      "id": "203485",
      "timestamp": "2017-05-11T19:17:20+00:00",
      "author": "Guest_AnonVendetta_*",
      "content": "Thanks for the info. I personally only use x64 original MSDN ISOs that I get from torrents and file-sharing sites, then compare the hash against what is on MSDN. Windows installed from MSDN sources are generally not already activated, so they either have to provide their own key or activate another way (how they go about that, I could care less). I have rarely had to install x86 Windows for anyone, nearly everyone I know has x64-capable hardware, but if I do then I just create a standalone USB drive for that install. I assume that the x86 instructions you\u0027re giving will work for x64 too. But why, exactly, do you say to use x86? I\u0027ve always assumed that you need to use an x64 ISO to install an x64 Windows, and an x86 ISO to install an x86 Windows. For installing via command-line I just use 10\u0027s WAIK tools, obtained via GetWAIKTools. This one WAIK alone works for everything from Vista to 10 as well as the Server editions.\n\nFor splitting WIMs into SWMs I just use WinToolkit, split into 3000MB chunks, with a custom EI.cfg and PID.txt when necessary. That particular chunk size seems to work well, when combined with one or both of the config files.\n\nIn the CMD file can I specify an ESD or SWMs, in addition to regular WIMs? XML file? Where are those?\n\nWhen you mention WinNTSetup, you say you can pick any ISO. But don\u0027t you mean imgPTN? In my original I said \"I would also need to be able to run the setup in either legacy or BIOS mode\". But I meant legacy or UEFI mode.\n\nI don\u0027t have much of a use for PEs, except maybe to restore a backup in an emergency or other repairs/maintenance, I much prefer to use the regular Windows setup in combination with ImageX and BCDBoot.\n\nOn a side note, do you know how I can get Windows to automatically assign drive letters of my choice, then run an unattend answer file? I have a file called relocate.xml that I use to move C:\\\\Users from C drive to another partition. It also handles the Registry edits. But I would like for this to run automatically during install, or immediately after rebooting into the initial setup wizard. The method I use now involves manually entering Audit Mode during initial setup, then changing drive letters as appropriate, then using CMD to process the script. I found it on TenForums, works quite well as it seems to be officially supported on 10 as of a certain build (cant remember which one), it even survives upgrades, repair install/refresh/reset.\n\nThanks!\n\n"
    },
    {
      "id": "203486",
      "timestamp": "2017-05-11T19:29:46+00:00",
      "author": "steve6375",
      "content": "So just use Chandra\u0027s Split_WinISO on a 64-bit Win 10 ISO. I only said x86 as an example.\n\nThen proceed as I described.\n\nAFAIK, you can specify ESD and .SWM files for Setup.\n\nBut if you are familiar with WAIK tools, you can use DISKPART scripts to partition the target drive and DISM or ImageX to apply the image.\n\nIf you are MBR booting, just use the E2B menu system\n\nIf you want to UEFI-boot - you need to switch in a .imgPTN image for FAT32.\n\nre. WinNTSetup\n\nYou copy all you ISOs to E2B in the normal way.\n\nYou copy WinNTSetup.exe\u0027s etc. as described in link I gave to E2B drive\n\nYou have a .imgPTN file - in your case it could be a converted 64-bit Win 10 Install ISO with the \\\\sources\\\\install.wim deleted.\n\nYou switch to the .imgPTN file and boot to WinPE\n\nYou press SHIFT+F10 to get to console and \\\\e2b\\\\Switch_E2B to restore the E2B partition (it is easier if you boot to a \u0027decent\u0027 WinPE that has Explorer and a Desktop!)\n\nNow you run WinNTSetup.exe from the E2B partition.\n\nWinNTSetup allows you to pick any ISO (it will mount it for you) and any XML file (if you are using one).\n\nYou can also pick a Diskpart script file and it will execute it for you to partition the target drive first.\n\n"
    },
    {
      "id": "203489",
      "timestamp": "2017-05-11T19:50:07+00:00",
      "author": "Guest_AnonVendetta_*",
      "content": "Thanks for the clarification.\n\nI don\u0027t trust diskpart to partition anything except maybe a flash drive, for everything else I use GParted. For applying the image I use ImageX (I know it\u0027s deprecated and DISM superceded it, but it works fine so I\u0027ll keep using it), then BCDBoot to install boot files. Microshaft is such a fuckup of a company, half the time they get shit wrong, so I don\u0027t really trust their tools.\n\nFor moving my Users folder, the drive letter for the new location must be assigned in advance, or the script will fail. As of now I run Sysprep from Audit mode, but am looking for a quicker way.\n\n"
    }
  ]
}