{
  "id": "19498",
  "title": "BSOD 0x7B when changing Win 7 USB installation to AHCI",
  "isPinned": false,
  "isFirstTopic": false,
  "isLocked": false,
  "tags": [],
  "forumNotes": [
    {
      "id": "181632",
      "timestamp": "2014-01-21T07:33:05+00:00",
      "author": "Skux",
      "content": "I used the NT 6.x fast installer to install windows 7 ultimate 32-bit to an external hard drive. This all went fine, and it ran on my laptop fine (after I moved it to a USB 2.0 port rather than a USB 3.0 one).\n\nThen, since I have 8GB RAM, I decided to re-install with the 64-bit version of Win7 ultimate. Then when I tried to boot from my laptop, I got BSOD 0x7B during boot. After much trial and error, I found out that I could boot it by changing the SATA mode to IDE. However I want to be able to leave my SATA mode on AHCI (for the other OS). So I tried many different methods (most only differing slightly) to change to AHCI. These methods mostly consisted of changing the msahci service to Start\u003d0.\n\nNo matter what I do, I still get BSOD 0x7B when in AHCI mode. I have tried adding my device to CriticalDeviceDatabase, to no avail.\n\nWhat could be causing this, and how do I fix it?\n\nNote: I followed the exact same installation procedure for the 32 and 64 bit versions. It beats me as to why the 32-bit version worked.\n\n**Edited by Skux, 21 January 2014 - 07:36 AM.**\n"
    },
    {
      "id": "181655",
      "timestamp": "2014-01-21T20:09:38+00:00",
      "author": "cdob",
      "content": "Which Windows 7 release did you used? Gold or SP1?  \n\nDo not use a Windows 7 gold to install and add SP1 later.  \nUse a Windows 7 SP1 DVD to install.  \n\nWhich hardware do you use?  \nCan be a timing issue too. Try Wait4UFD [http://reboot.pro/to...-booting/page-6](http://reboot.pro/topic/14427-waitbt-for-usb-booting/page-6 \"\") Be aware, the amd64 driver is not signed.   \n"
    },
    {
      "id": "181663",
      "timestamp": "2014-01-22T05:35:20+00:00",
      "author": "Skux",
      "content": "Windows 7 SP1.\n\nI am installing it on a Western Digital Elements 1042. PC Specs:\n\nIntel i5 cpu. Intel HD 4000 graphics. 8GB RAM. Laptop is an HP ProBook 6570b.\n\nI tried using WaitBt and Wait4UFD, neither fixed the problem.\n\nEdit: If it helps, I think it worked with the 32-bit installation with AHCI when I plugged it into the USB 3.0 port by mistake. It booted once on USB 3.0, then subsequent boots failed until I switched it to a USB 2.0 port. I tried this with the 64-bit installation but it didn\u0027t work (wouldn\u0027t boot from USB 3.0 port at all).\n\n**Edited by Skux, 22 January 2014 - 06:34 AM.**\n"
    },
    {
      "id": "181664",
      "timestamp": "2014-01-22T06:49:02+00:00",
      "author": "Skux",
      "content": "SOLVED!!!!!\n\nAfter editing my last post, what I typed made me think... (about USB 3.0). I decided I would try installing the USB 3.0 drivers, setting them to Start\u003d0 Group\u003dBoot Bus Extender and try using the USB 3.0 port in AHCI mode.\n\nAnd BOOM! It worked. And now I can use the speedy USB 3.0 ports ![:D](http://reboot.pro/public/style_emoticons/default/biggrin.png)\n\nThank you cdob for your time.\n\n"
    },
    {
      "id": "181675",
      "timestamp": "2014-01-22T15:02:49+00:00",
      "author": "cdob",
      "content": "\u003e And now I can use the speedy USB 3.0 ports\nCongratulations.  \n\nI wonder:  \nDid adding USB 3.0 drivers solve the USB 2.0 error too?  \nCan you boot from USB 2.0 ports now?   \n"
    },
    {
      "id": "181691",
      "timestamp": "2014-01-23T08:44:32+00:00",
      "author": "Skux",
      "content": "No, adding USB 3.0 drivers did not fix the USB 2.0 error (Still BSODed).\n\nI have another question - I am trying to do it on another computer now that has no option in the BIOS to change SATA mode... how do I go about fixing BSOD 0x7B for this? I have tried installing the AHCI driver for it (Intel 7 Series Chipset Family SATA AHCI driver), to no avail.\n\n"
    },
    {
      "id": "181701",
      "timestamp": "2014-01-23T19:47:00+00:00",
      "author": "cdob",
      "content": "\u003e No, adding USB 3.0 drivers did not fix the USB 2.0 error (Still BSODed).\nThanks for report. Well you never know at USB boot.  \n\n\u003e I have another question - I am trying to do it on another computer now that has no option in the BIOS to change SATA mode... how do I go about fixing BSOD 0x7B for this? I have tried installing the AHCI driver for it (Intel 7 Series Chipset Family SATA AHCI driver), to no avail.\nThere should be no IDE/AHCI drive required at all.  \nThe true issue is unknown at x64 still. Remids to timing or driver load order.  \n[http://reboot.pro/to...-windows-7-sp1/](http://reboot.pro/topic/14186-usb-hdd-boot-and-windows-7-sp1/ \"\")  \n\nWhich USB driver version do you use? Try KB2862330-v2 version too.  \n[http://support.micro....com/kb/2862330](http://support.microsoft.com/kb/2862330 \"External link\")  \n[https://www.microsof...s.aspx?id\u003d40541](https://www.microsoft.com/download/details.aspx?id\u003d40541 \"External link\")   \n"
    },
    {
      "id": "181722",
      "timestamp": "2014-01-24T05:19:08+00:00",
      "author": "Skux",
      "content": "Thank you so so so much cdob!!!!!\n\nIn that link, I used your batch script (the one which sets BootDriverFlags and PollBootPartitionTimeout), and it worked like a charm!!!\n\nOnce again, THANK YOU!\n\n"
    },
    {
      "id": "181725",
      "timestamp": "2014-01-24T09:54:54+00:00",
      "author": "Skux",
      "content": "It also fixed the USB 2.0 error for the other computer.\n\nNow I have another problem. Sometimes when I plug a flash drive in, the system BSODs with error code 0xF4.\n\n"
    }
  ]
}