{
  "id": "19472",
  "title": "Advise to run Win7 from RamDrive on 128 GB CAD station",
  "isPinned": false,
  "isFirstTopic": false,
  "isLocked": false,
  "tags": [],
  "forumNotes": [
    {
      "id": "181367",
      "timestamp": "2014-01-10T12:32:21+00:00",
      "author": "QuEP",
      "content": "```\nGentlemen, I’ve got an interesting question for you. It is is actually a two step question.\nCan it be done (how), and maybe more important : is it advisable !?\n\nProblem description.\nI just started using a dual processor water-cooled workstation with 128 GB Ram for 3D \nmodelling and rendering large factory layouts with thousands of files opened simultaneously. \nThis is incredible RAM hungry and processor intensive work. Although I invested heavily \nin top notch hardware, I still feel the need to improve responsiveness of this system.  \nAlthough the 20 cores have nicely reduced the typical render time from 10+ hours down \nto 2+ hours (nice but these are unmanned nightly hours anyway), the biggest problem \nremains the actual 3D modelling which unfortunately remains a single thread operation. \nA rebuild / save operation on the highest level can take anywhere from 10 to 30 minutes. \nThis is a very big problem, because you end up not saving often enough, and therefore\n losing a lot of difficult to remember work regulary  (in practice it is so easy to make \nmistakes or getting jammed with so many files open).\n\nHardware description : Asus Z9PE-D8 WS Motherboard, dual Xeon E5-2690v2 processors \nwith 10 cores each, 8x16GB DDR-3 RAM (1866MHz in Quad channel configuration), \nNvidia Quadro K4000, 1TB SSD Samsung 840 EVO (for SYS and Work data), \n2x 3TB sata in Raid 1 for storage.\n\nThe slow rebuilding / saving is not a SSD speed or data file size issue. A typical large \nproject only has 1 to 10 GB as data files on SSD (takes far less than a minute to \nread or save), but requires up to 50 GB of working RAM for 3D modelling and up to \n75 GB for rendering. This means rebuilding the models on screen primarily requires \nserious number crunching between processor and RAM only. For this reason I just \nupgraded the original 64 GB to the fastest 1866 MHz RAM possible. Due to the Quad \nchannel configuration the next step up was 128 GB, which even for my RAM hungry \napplication is over kill (normal workload is between 25 and 50 GB).\n\nFor starters I have moved the temp and back up files to a RamDisk. This seriously \nhelped responsiveness, although this is difficult to quantify. The 10 GB reserved \nspace is nicely cleaned up every restart, but runs out of space quickly during a busy \nmodelling sessions. That made me think more about possibilities of the incredible \nfast Ram drives. \n\nAt the moment I’m experimentally running 3D modelling data files from a 40 GB RAM drive ! \nThis volatile disc is automatically saved to and opened from a mirror on the SSD during \nstart up and shutdown. Due to the already fast SSD, this  seems to only add well over \na minute to this BOOT procedure (that is absolutely nothing compared to immense \ndaily lost time on rebuilds / save operations). Worried about volatility, I use GoodSync to automatically synchronise only the changed files every 15 minutes. Which so far has \nnot been noticeable in performance, and no issues with locked files yet (although \nGoodSync claims to be good at retrying locked files, this remains a worry under \ninvestigation). Again this RAM procedure helped responsiveness a bit again, \nalthough still difficult to quantify. \n\nInstalled Drives_Meter_V2.4.gadget and GPU_Meter_V2.4.gadget to see what is \ngoing on. You need to set monitor speed real short to see any drive action at all \n(even during 10 minute out of business rebuilt !). Now it becomes interesting : \nAt 0.1 sec monitor speed you see very frequent drive action at C: (thus windows 7 \nand CAD software), but never prolonged (maybe 10% of time, but not noticeable \non 1s monitor fequence). The RAM data on the other hand peaks full seconds but \nvery rarily (only at start of opening or end of saving operation).\n\nI think this tells me two things : \nIssue 1 is bad news: most of the rebuilt time is appereantly wasted on number \ncrunching which only can be speeded up by overclocking or such (processors \ndo not come much faster yet). Although more difficult for XEON processors, \nthere is quite some fine tuning room within this excellent Asus board \n(but a bit risqué on such expensive system, so out of the question for right \nnow on this brand new system).\n\nIssue 2 is the reason for this forum question : very frequently very small \ninstructions are needed from Win and the CAD software. Windows running \non NTSF drives is quite bad with large numbers of small files. I personally \nthink / hope that running WIN + apps  from RAM will help responsiveness \nmore than doing that with data files themselves (with far over 1 TB on data files \nthat would require a lot of confusing drive shuffeling anyway). The CAD \nsoftware needs to be installed on the same drive as windows. Can the \nWin7 pro 64-bit be trimmed down enough to run from RAM ? \nThe RAM drive is assigned a regular letter and claims to be available early \nenough for WIN boot to be mounted. Currently the win directory is an \nastonishing 22 GB and all programs together another 20 GB. \nI could comfortably assign a 40+ GB RAM drive, but a lot of junk can \nprobably be eliminated (any suggestions on cleaning / optimizing procedures ?).\n\nThe main question remains: would running Win7 from a RAMdrive be advisable ?\n\nAlthough keeping the boot mirror up to date will be a headache, I honestly \nthink it has some advantages too. Any system I have sofar used so intensively, \nalways severely suffered from cluttered down windows installations within a \nfew month of use. Really the only thing that seems to help is a rigouress \n4 or 6 times a year a system format with complete freshly installed windows \nand programs. On such large systems that is a lot of work, but improves \nresponsiveness incredibly. If you keep the boot mirror clean and turn of all \nautomatic updates, then you could check and run updates weekly or monthly \n(only updating the boot mirror as needed with a fresh un-cluttered but updated \ncopy). Undoubtly this remains a head ache, but probably wouldn’t waste as \nmuch time as the 4 times or often re-installations per year now.\n\nSo … can it be done ? Do you boot specialists think it could make this thing fly faster ? Would you judge it as  advisable ? Remember with current 10 to 30  minute \nrebuilt times, you lose a lot of volatile data as well (simply because you cannot \nafford to save more often).\n\nSorry about this awfully long worded question, but this might not be run of the\n mill system management or gaming performance for most specialist. \nAlthough on the other hand, there must be more idiots like me suffering from \nlong rebuilt times.\n\nThanks for your time, any help will be appreciated !\n\n```\n\nMy sincere excuses for the cluttered tekst. I had this text written seperately in Word, and could not get the Word or regular paste icons to function properly . I only managed to paste it as unformatted code.\n\n"
    },
    {
      "id": "181374",
      "timestamp": "2014-01-10T20:46:48+00:00",
      "author": "bblaauw",
      "content": "Booting Windows into RAM might be possible, but I haven\u0027t looked into this, sorry. Alternatives might be some enterprise system like FusionIO, ZeusRAM or the Texas Memory Systems RAMSAN products. I don\u0027t know if these are bootable.\n\n[](http://www.hyperossystems.co.uk/%C2) sells a technically outdated hardware Ramdisk up to 64GB, but it\u0027s over bootable SATA. bootable Flash on PCIe seems to be arriving just now to bypass SATA\u0027s IO and bandwidth limitations. (bootable) DRAM units on PCIe seems nearly non-existing. Last but not least there\u0027s SATADIMM.\n\n"
    },
    {
      "id": "181379",
      "timestamp": "2014-01-11T06:44:14+00:00",
      "author": "wimb",
      "content": "\u003e ```\n\u003e Can the Win7 pro 64-bit be trimmed down enough to run from RAM ? \n\u003e ```\n\nAnswer is Yes. :smile:\n\nYou need to Install FiraDisk driver in fresh installed x64 Win7 Source (Drive or VHD)\n\nand then use VHD_W7_Compact.exe to make New VHD of reduced size e.g. 2.5 GB\n\nThe new VHD has the same registry as original x64 Win7 but has limited number of files,\n\nso that it just behaves as normal as the original x64 Win7 OS\n\nx64 Win7 of Size 1.8 GB is booting from 2.5 GB RAMDISK loaded via Grub4dos Menu\n\n[http://reboot.pro/to...ct-make-mini-7/](http://reboot.pro/topic/18593-vhd-w7-compact-make-mini-7/ \"\")\n\n[http://reboot.pro/to...-22#entry150248](http://reboot.pro/topic/9830-universal-hdd-image-files-for-xp-and-windows-7/page-22#entry150248 \"\")\n\n![:cheers:](http://reboot.pro/public/style_emoticons/default/cheers.gif)\n\nThis picture shows the reduction in folder size in 1.8 GB x64 Win7 (2.5 GB VHD drive C:) as compared to Source Drive D:\n\n[![VHD_7x64_Fira.png](http://reboot.pro/uploads/monthly_01_2014/post-9517-0-60057800-1389422430_thumb.png)](http://reboot.pro/uploads/monthly_01_2014/post-9517-0-60057800-1389422430.png \"VHD_7x64_Fira.png - Size: 835.26KB\"){#ipb-attach-url-14745-0-34064300-1676066509}\n\n"
    },
    {
      "id": "181380",
      "timestamp": "2014-01-11T07:37:33+00:00",
      "author": "QuEP",
      "content": "Both gentlemen, thanks for the excellent suggestions !\n\nbblauw gave me a lot of hardware related leads to investigate. Sounds like i\u0027m just a bit early for this topic, but that I\u0027m not the only one looking into its possibilities ;-). This might be the safest route, since this high end CAD software is very sensitive for Windows tinkering by other applications. It is not as bad as it used to be, but it is still far safer not to install any games and as little as possible programs on serious workstations like this ;-).\n\nThe Firadisk / GrubDisk menu route and links of WimB sound very promising and tempting though ! I wouldn\u0027t have to trim down Win7 that far, but anywhere under 8GB would be nice. I only hastily read through your excellent links WimB , but do I understand correctly that you still need to keep the full Win installation available on another drive for live ( automatic ? ) references of missing files or such ? Somewhere you did refer to the possibility of using this procedure on a RAM disk. By the way, you are quite welcome to use this workstation as experiment for that purpose. I have an identical sized d: disc installed only for a Norton Ghost backup of the system (so fairly safe to experiment a bit).\n\nVery tempting to immidiately be diving heads on into these very interesting matters with huge potential. I read somewhere that they start running complete network servers from multiple 256 GB RAM drives. I can see why, because this DDR-3 1866 MHz is so much faster as the fastest RevoDrives or incredibly expensive high end server SSD solutions, and relatively cheap. In my case I only need the 128 GB installed RAM sometimes at the end of some Multi week projects. I might as well put it to work in the mean time ;-).\n\nI\u0027m very much behind on a big project, for which I need to put in a lot of hours this weekend. So tempting or not, looks like too much study and experiment material for this weekend. But I defenitely will dive in to these possibilities more in depth shortly.\n\nThanks Guy\u0027s, I will keep you posted !\n\n"
    },
    {
      "id": "181381",
      "timestamp": "2014-01-11T10:32:17+00:00",
      "author": "wimb",
      "content": "VHD_W7_Compact.exe will make Universal VHD files that can be copied and used on any system.\n\nRun first VHD_W7C_drivers.exe plugin to add useful extra drivers to makebt\\\\drivers folder.\n\nIt means you can keep such VHD files in stock as spare part and in fact the computer is reduced to 1 file.\n\nYou can use an USB-stick as Boot Drive and boot the VHD file located on internal harddisk (NTFS System Drive)\n\nIn this way fast loading of RAMDISK is obtained and there are no changes needed of your System.\n\nUse UFD_FORMAT.exe to make USB-Stick bootable with Boot Manager Menu.\n\n[http://reboot.pro/to...140-ufd-format/](http://reboot.pro/topic/19140-ufd-format/ \"\")\n\nUse UEFI_MULTI.exe to make any other HDD or USB drive bootable with the selected VHD file.\n\n[http://reboot.pro/to...boot-usb-drive/](http://reboot.pro/topic/18182-uefi-multi-make-multi-boot-usb-drive/ \"\")  \n\nAlthough not needed, but it can be handy to have the full Win7 available in case you encounter some missing files,\n\nwhich can be added then easily by using e.g. FreeCommander which has Compare and Synchronize menu.\n\nUse Grub4dos boot menu to select the VHD file which will be used to load a RAMDISK (can take few minutes).\n\nx64 Win7 is booting and running extremely fast from RAMDISK.\n\n"
    },
    {
      "id": "181407",
      "timestamp": "2014-01-12T07:01:13+00:00",
      "author": "QuEP",
      "content": "Ok great ... I\u0027m surely going to give this exciting possibility a try.\n\nI better allocate some serious time for this, because I have a lot of studying to catch up.\n\nBut with soo much in-depth discussions and tutorials as starting point, I should be able to find enough basic info about the used applications.\n\nThanks a lot WimB !!!\n\nNice forum also.\n\n"
    },
    {
      "id": "181442",
      "timestamp": "2014-01-13T22:13:38+00:00",
      "author": "sbaeder",
      "content": "My own opinion is more in line with the other posted question: Is it \"worth it\"?\n\nI doubt you will get a lot of speedup here. I would look to lower level benchmarking - evenb to the level of how the cache is structured on the processor chip you\u0027re using...While the Specs say 25MB, that is really 2.5 MB per core. I might turn off hyperthreading here, since the two threads on a given core may compete...\n\nBut the real issue is cache misses at the L1 and L2 level as well as the L3 level....Lets say you have a piece of code in some sort of a loop, and it causes an L1 cache miss each cycle...While it is OK to focus on the RAM to disk issues (i.e. why you want to look at a RAM drive), remember that there is a longer chain involved...\n\nInstructions (or Data) in processor \\\u003c- L1 \\\u003c- L2 \\\u003c- L3 \\\u003c- RAM \\\u003c-Paging file.\n\nAnd all of that happens before we even go to the file system, etc...\n\nMy guess is that Hyperthreading and/or poor design of your application is causing some sort of thrashing on the cache, and getting some lower level stats on that may help you pinpoint...(Not sure how in Windows to do this...In Linux, I\u0027d use DTrace stuff from the Kernel)...\n\nGood Luck.\n\n"
    },
    {
      "id": "181451",
      "timestamp": "2014-01-14T00:14:23+00:00",
      "author": "QuEP",
      "content": "Thanks sbaeder, I know you are right about the cache being poorly managed.\n\nUnfortunately my main CAD software (3D SolidWorks) doesn\u0027t run on Linux or Unix.\n\nI only ran this computer on Hyperthreading during its first day. Most of my personal working time is lost waiting for single thread rebuilt or save operations. Although in reality it bounces from one core to another, there are Always plenty cores available on 0% capacity for new threads. Nothing to be gained there, defenitely not worth the added overhead. Usually you see several cores flashing up until one hits 100% for several seconds (during which the rest comes to halt apart from some low level windows related overhead). With Hyperthreading active you can clearly see that the same happens put capped on 50%. So 39 threads are idle waiting for that 50% to finish up.\n\nI\u0027m afraid I\u0027m way over my head lost in Cache management. With the immense data set I work with, I fail to see what 2.5 Mb can really do. But yes I agree, the biggest problem might be the many small repeating instruction sets from the sotftware. Doubt if it can be influenced from within the software. I was hoping to put the whole application folder (4.7 GB and 12000 files) on the RAM disk, but that migh only be possible if Windows is residing on the same Disk. That is what started this search and topic.\n\nVaguely heard something before about forcing the Paging file on a RAM disk.\n\nLooks like I need to study up on this.\n\n"
    }
  ]
}