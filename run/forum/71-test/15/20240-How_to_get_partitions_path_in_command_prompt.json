{
  "id": "20240",
  "title": "How to get partitions path in command prompt?",
  "isPinned": false,
  "isFirstTopic": false,
  "isLocked": false,
  "tags": [],
  "forumNotes": [
    {
      "id": "189535",
      "timestamp": "2015-01-01T14:40:29+00:00",
      "author": "Peter80",
      "content": "Anyone know how can i get the partitions path in command prompt in Windows 7? I mean to list the partitions in this way:  \n\n\\\\Device\\\\Harddisk0\\\\Partition1  \n\\\\Device\\\\Harddisk0\\\\Partition2  \n\\\\Device\\\\Harddisk0\\\\Partition3  \n\nwith the corresponding drive letters.\n\n"
    },
    {
      "id": "189537",
      "timestamp": "2015-01-01T14:53:28+00:00",
      "author": "Wonko the Sane",
      "content": "You need a tool that exposes that particular form of links/names.\n\nTry with dd for windows (using the --list switch):\n\n[http://www.chrysocome.net/dd](http://www.chrysocome.net/dd \"External link\")\n\nSee also:\n\n[http://reboot.pro/to...st-and-ddlistw/](http://reboot.pro/topic/8219-ddlist-and-ddlistw/ \"\")\n\nOr try ListDosDevices:\n\n[http://www.uwe-siebe...ivetools_e.html](http://www.uwe-sieber.de/drivetools_e.html \"External link\")\n\nor check dosdev (it is possible that you have it as part of some SDK/WDK/whatever):\n\n[http://blogs.msdn.co.../04/477164.aspx](http://blogs.msdn.com/b/adioltean/archive/2005/10/04/477164.aspx \"External link\")\n\nor get the version by Olof:\n\n[http://www.ltr-data.se/opencode.html/](http://www.ltr-data.se/opencode.html/ \"External link\")\n\n![:duff:](https://reboot.pro/public/style_emoticons/default/duff.gif)\n\nWonko\n\n"
    },
    {
      "id": "189538",
      "timestamp": "2015-01-01T15:39:37+00:00",
      "author": "Peter80",
      "content": "Thanks, ListDosDevices does what i want. But are you sure this can\u0027t be done only through Windows command prompt? Because few days ago i managed to list the partition this way using only the command prompt but i don\u0027t remember what command i used then.\n\n"
    },
    {
      "id": "189540",
      "timestamp": "2015-01-01T16:33:13+00:00",
      "author": "Wonko the Sane",
      "content": "\u003e Thanks, ListDosDevices does what i want. But are you sure this can\u0027t be done only through Windows command prompt? Because few days ago i managed to list the partition this way using only the command prompt but i don\u0027t remember what command i used then.\n\nWhich specific Windows version are you running?\n\nIs it possible that dosdev from MS has made it\u0027s way from Resource Kit (or whatever into \"main\" OS)? ![:unsure:](https://reboot.pro/public/style_emoticons/default/unsure.png)\n\nOr maybe you were using WMI/wmic ![:dubbio:](https://reboot.pro/public/style_emoticons/default/dubbio.gif), this would normally do (example) for Physicaldrive enumeration:\n\u003e wmic diskdrive list brief\n\u003e\nit is very likely that a similar command can provide that kind of info, I\u0027ll have a look for it.\n\n![:duff:](https://reboot.pro/public/style_emoticons/default/duff.gif)\n\nWonko\n\n"
    },
    {
      "id": "189541",
      "timestamp": "2015-01-01T17:06:05+00:00",
      "author": "Peter80",
      "content": "I am using Windows 7 Ultimate x32.\n\n"
    },
    {
      "id": "189554",
      "timestamp": "2015-01-02T00:25:51+00:00",
      "author": "Zharif",
      "content": "What about using wmic?\n\nHere\u0027s an example in which I tried to mimic the volume indices.\n\nPlease open the file and read comments first.\n\nThen change the file extension from \\*.txt to \\*.cmd and run the batch file.\n\n#### Attached Files {#attach_wrap}\n\n* [![Attached File](http://reboot.pro/public/style_extra/mime_types/txt.gif)](http://reboot.pro/index.php?s\u003d25a5299391a75e96769998beb808d4e0\u0026app\u003dcore\u0026module\u003dattach\u0026section\u003dattach\u0026attach_id\u003d15226 \"Download attachment\") [**ZPart.txt**](http://reboot.pro/index.php?s\u003d25a5299391a75e96769998beb808d4e0\u0026app\u003dcore\u0026module\u003dattach\u0026section\u003dattach\u0026attach_id\u003d15226 \"Download attachment\") **1.29KB** 1001 downloads\n\n"
    },
    {
      "id": "189555",
      "timestamp": "2015-01-02T00:41:34+00:00",
      "author": "Zharif",
      "content": "Wait, I just found another batch of mine to demonstrate the abilities of wmic.\n\nI hope at least one of both files is of help.  \n\n#### Attached Files {#attach_wrap}\n\n* [![Attached File](http://reboot.pro/public/style_extra/mime_types/txt.gif)](http://reboot.pro/index.php?s\u003d25a5299391a75e96769998beb808d4e0\u0026app\u003dcore\u0026module\u003dattach\u0026section\u003dattach\u0026attach_id\u003d15227 \"Download attachment\") [**ZDriveProperties.txt**](http://reboot.pro/index.php?s\u003d25a5299391a75e96769998beb808d4e0\u0026app\u003dcore\u0026module\u003dattach\u0026section\u003dattach\u0026attach_id\u003d15227 \"Download attachment\") **3.67KB** 767 downloads\n\n"
    },
    {
      "id": "189562",
      "timestamp": "2015-01-02T08:52:17+00:00",
      "author": "Peter80",
      "content": "Thanks, the first script is listing the partitions in the way i need, but it doesn\u0027t seem to detect encrypted partitions. I have one partition encrypted with TrueCrypt and it doesn\u0027t showing in the list.\n\n"
    },
    {
      "id": "189565",
      "timestamp": "2015-01-02T10:43:59+00:00",
      "author": "Zharif",
      "content": "I found out the fist script is buggy.\n\nIt won\u0027t display the drive letter \"Name\" in the right order if one of the volumes doesn\u0027t have a drive letter assigned.\n\nMy assumption was, that the list containing the volume \"Name\" is already sorted. But on my Laptop with a hidden recovery partition \"wmic volume list \\\u003e test.txt\" this is not the case.\n\nScript needs revision -will work on it.\n\nMaybe jaclaz or Wonko could explain the drive/volume orders more properly.\n\nI never used encrypted drives with True Crypt, only files.\n\nHave a look if the DeviceID of your encrypted drive is shown in the full list of \"wmic volume\".\n\nTo get a report file of all wmic commands of interest:\n\n- open the command prompt\n\n- type: Type Nul \\\u003e test.txt\n\n- type: wmic volume list full \\\u003e\\\u003e test.txt\n\n- type: wmic logicaldisk list full \\\u003e\\\u003e test.txt\n\n- type: wmic partition list full \\\u003e\\\u003e test.txt\n\n- type: wmic diskdrive list full \\\u003e\\\u003e test.txt\n\nUsing this report file, you should be able to detect your encrypted partition somewhere.\n\nIf so, please report the values you found.\n\n"
    },
    {
      "id": "189566",
      "timestamp": "2015-01-02T12:20:38+00:00",
      "author": "Wonko the Sane",
      "content": "Still, it seems like there is not a \"plain\" WMI/wmic command that could have output by itself the \"\\\\Device\\\\Harddisk0\\\\Partition1\" kind of listing, from what I could find, the only thing that actually ouptuts that (and not the forms Disk#*m* , Partition#*n* or the \\\\\\\\.\\\\PhysicalDrive*n*, etc.) is the Operating System \"os\", like in WMIC os Get Systemdevice,\n\nBut it is a non-problem, as I see it, I already provided some methods to hopefully get that info.\n\nAs a matter of fact, to be exact, the given tools provide a slightly different \"system object\" as result. Peter80 possibly did not notice it. ![:w00t:](https://reboot.pro/public/style_emoticons/default/w00t.gif) ![:ph34r:](https://reboot.pro/public/style_emoticons/default/scared9.gif)\n\nThose specific kinds of objects should be accessible only by tools like WinObj or DMdiag, see also:\n\n[http://reboot.pro/to...-line-possible/](http://reboot.pro/topic/10169-resolvedmount-hidden-partition-command-line-possible/ \"\")\n\n[http://reboot.pro/to...emount-ramdisk/](http://reboot.pro/topic/2425-imdisk-commandline-script-to-createmount-ramdisk/ \"\")\n\nSo, the actual info asked for can be got from using dmdiag, as follows (example):\n\n```\ndmdiag /v | FIND \"\\Device\\\"\n```\n\nWhat remains is not \"how to do\" but rather \"how Peter80 did or seems to remember he did\". ![:dubbio:](https://reboot.pro/public/style_emoticons/default/dubbio.gif)\n\n@Zharif\n\nThe \"generic\" issue with WMI/wmic commands is usually that there are a lot of misconfigured WMI installs, so it is not always reliable and some properties/nodes are only available on a given OS release, as an example the alias you use in your script, \"volume\" as well as it\u0027s corresponding class \"Win32_volume\" is simply not there on XP.\n\nDue to the different nature of the hardware devices (hard disks, super-floppies and similar \"volumes\", ramdisks, CD/DVD\u0027s etc.) and to the complexity with which drive letters are assigned (if any) it is extremely complex to do that kind of mapping in a script, without \\*something\\* (like one of the mentioned programs) that wrap around the DosDevices API call, see also:\n\n[http://www.msfn.org/...etter-shifting/](http://www.msfn.org/board/topic/123929-updated-batch-file-for-ordering-drive-letter-shifting/ \"External link\")\n\n[http://www.msfn.org/...-drive-letters/](http://www.msfn.org/board/topic/124539-more-compatible-batch-file-for-ording-drive-letters/ \"External link\")\n\n[http://www.msfn.org/...ter-batch-file/](http://www.msfn.org/board/topic/126069-updated-on-feb-27-2011-ordering-messed-drive-letter-batch-file/ \"External link\")\n\n![:duff:](https://reboot.pro/public/style_emoticons/default/duff.gif)\n\nWonko\n\n"
    },
    {
      "id": "189574",
      "timestamp": "2015-01-02T15:08:37+00:00",
      "author": "Peter80",
      "content": "\u003e Using this report file, you should be able to detect your encrypted partition somewhere.  \n\u003e\n\u003e If so, please report the values you found.\n\nThis is the output i got from **wmic volume list full**. The encrypted volume is G:\n\n```\nAutomount  BlockSize  Capacity     Compressed  DeviceID                                           DirtyBitSet  DriveLetter  DriveType  FileSystem  FreeSpace   IndexingEnabled  Label       MaximumFileNameLength  Name  QuotasEnabled  QuotasIncomplete  QuotasRebuilding  SerialNumber  SupportsDiskQuotas  SupportsFileBasedCompression  SystemName  \nTRUE       4096       16908283904  FALSE       \\\\?\\Volume{a6075fe8-49b3-11e4-9a93-806e6f6e6963}\\  FALSE        C:           3          NTFS        1174044672  TRUE                         255                    C:\\   FALSE          FALSE             FALSE             11754484      TRUE                TRUE                          PETER-PC     \nTRUE       4096       67408752640  FALSE       \\\\?\\Volume{a6075fe9-49b3-11e4-9a93-806e6f6e6963}\\  FALSE        D:           3          NTFS        563142656   TRUE             Local Disc  255                    D:\\   FALSE          TRUE              FALSE             -1869481847   TRUE                TRUE                          PETER-PC     \nTRUE       4096       72135725056  FALSE       \\\\?\\Volume{a6075fea-49b3-11e4-9a93-806e6f6e6963}\\  FALSE        E:           3          NTFS        3329355776  TRUE                         255                    E:\\   FALSE          TRUE              FALSE             806272371     TRUE                TRUE                          PETER-PC     \nTRUE                                           \\\\?\\Volume{be1fc7bf-8dee-11e4-afa3-00a0d1954570}\\               G:           3                                                                                      G:\\                                                                                                                      PETER-PC     \nTRUE                                           \\\\?\\Volume{a6075fed-49b3-11e4-9a93-806e6f6e6963}\\               F:           5                                                                                      F:\\                                                                                                                      PETER-PC     \n\n```\n\n\u003cbr /\u003e\n\n"
    },
    {
      "id": "189575",
      "timestamp": "2015-01-02T15:20:31+00:00",
      "author": "Peter80",
      "content": "\u003e What remains is not \"how to do\" but rather \"how Peter80 did or seems to remember he did\". ![:dubbio:](https://reboot.pro/public/style_emoticons/default/dubbio.gif)\n\nI clearly remember i copied the path for the encrypted partition from the command prompt because i was trying to create a shortcut from which to mount the partition and for this i needed the partition path. With parameters it looks like this:  \n\n```\ntruecrypt.exe /q /v /lj \\Device\\Harddisk0\\Partition2\n```\n\n\u003cbr /\u003e\n\nI was probably have found the command on google but i can\u0027t remember where and i can\u0027t remember what the command was.\n\n"
    },
    {
      "id": "189576",
      "timestamp": "2015-01-02T15:43:52+00:00",
      "author": "Zharif",
      "content": "@Wonko,\n\nI see, thank you.\n\nIt\u0027s a pity I\u0027m not able to download some of the provided files. I don\u0027t want create a new account just for this special issue.\n\nWhat do you think about an initial approach to use mountvol values in combination with fsutil fsinfo volumeinfo?\n\nJaclaz wrote that mountvol doesn\u0027t detect imdisk volumes. But for the rest - is it \"reliable\" enough to get all local drives?\n\nMaybe combinations with a \\*vbs created via commandline using fso would provide extensive info, e.g. for network drives.\n\n@Peter80,\n\nAs seen, wmic volume didn\u0027t retrieve some useful info to determine drive encryption.\n\nJust for interest, could you post results of the other wmic commands?\n\n"
    },
    {
      "id": "189583",
      "timestamp": "2015-01-02T17:30:10+00:00",
      "author": "Peter80",
      "content": "\u003e As seen, wmic volume didn\u0027t retrieve some useful info to determine drive encryption.  \n\u003e\n\u003e Just for interest, could you post results of the other wmic commands?\n\n**wmic logicaldisk list full**\n\n```\nAccess  Availability  BlockSize  Caption  Compressed  ConfigManagerErrorCode  ConfigManagerUserConfig  Description       DeviceID  DriveType  ErrorCleared  ErrorDescription  ErrorMethodology  FileSystem  FreeSpace   InstallDate  LastErrorCode  MaximumComponentLength  MediaType  Name  NumberOfBlocks  PNPDeviceID  PowerManagementCapabilities  PowerManagementSupported  ProviderName  Purpose  QuotasDisabled  QuotasIncomplete  QuotasRebuilding  Size         Status  StatusInfo  SupportsDiskQuotas  SupportsFileBasedCompression  VolumeName  VolumeSerialNumber  \n0                                C:       FALSE                                                        Local Fixed Disk  C:        3                                                            NTFS        1174192128                              255                     12         C:                                                                                                               TRUE            FALSE             FALSE             16908283904                      TRUE                TRUE                                      00B35BF4            \n0                                D:       FALSE                                                        Local Fixed Disk  D:        3                                                            NTFS        563142656                               255                     12         D:                                                                                                               TRUE            TRUE              FALSE             67408752640                      TRUE                TRUE                          Local Disc  9091F889            \n0                                E:       FALSE                                                        Local Fixed Disk  E:        3                                                            NTFS        3329617920                              255                     12         E:                                                                                                               TRUE            TRUE              FALSE             72135725056                      TRUE                TRUE                                      300EBD73            \n                                 F:                                                                    CD-ROM Disc       F:        5                                                                                                                                        11         F:                                                                                                                                                                                                                                                                                      \n0                                G:                                                                    Local Fixed Disk  G:        3                                                                                                                                        12         G:                                                                                                                                                                                                                                                                                      \n\n\n```\n\n**wmic partition list full**\n\n```\nAccess\u003d\nAvailability\u003d\nBlockSize\u003d512\nBootable\u003dTRUE\nBootPartition\u003dTRUE\nConfigManagerErrorCode\u003d\nConfigManagerUserConfig\u003d\nDescription\u003dInstallable File System\nDeviceID\u003dDisk #0, Partition #0\nDiskIndex\u003d0\nErrorCleared\u003d\nErrorDescription\u003d\nErrorMethodology\u003d\nHiddenSectors\u003d\nIndex\u003d0\nInstallDate\u003d\nLastErrorCode\u003d\nName\u003dDisk #0, Partition #0\nNumberOfBlocks\u003d33023999\nPNPDeviceID\u003d\nPowerManagementCapabilities\u003d\nPowerManagementSupported\u003d\nPrimaryPartition\u003dTRUE\nPurpose\u003d\nRewritePartition\u003d\nSize\u003d16908287488\nStartingOffset\u003d1048576\nStatus\u003d\nStatusInfo\u003d\nType\u003dInstallable File System\n\n\nAccess\u003d\nAvailability\u003d\nBlockSize\u003d512\nBootable\u003dFALSE\nBootPartition\u003dFALSE\nConfigManagerErrorCode\u003d\nConfigManagerUserConfig\u003d\nDescription\u003dInstallable File System\nDeviceID\u003dDisk #0, Partition #1\nDiskIndex\u003d0\nErrorCleared\u003d\nErrorDescription\u003d\nErrorMethodology\u003d\nHiddenSectors\u003d\nIndex\u003d1\nInstallDate\u003d\nLastErrorCode\u003d\nName\u003dDisk #0, Partition #1\nNumberOfBlocks\u003d6995968\nPNPDeviceID\u003d\nPowerManagementCapabilities\u003d\nPowerManagementSupported\u003d\nPrimaryPartition\u003dTRUE\nPurpose\u003d\nRewritePartition\u003d\nSize\u003d3581935616\nStartingOffset\u003d16909336576\nStatus\u003d\nStatusInfo\u003d\nType\u003dInstallable File System\n\n\nAccess\u003d\nAvailability\u003d\nBlockSize\u003d512\nBootable\u003dFALSE\nBootPartition\u003dFALSE\nConfigManagerErrorCode\u003d\nConfigManagerUserConfig\u003d\nDescription\u003dExtended w/Extended Int 13\nDeviceID\u003dDisk #0, Partition #2\nDiskIndex\u003d0\nErrorCleared\u003d\nErrorDescription\u003d\nErrorMethodology\u003d\nHiddenSectors\u003d\nIndex\u003d2\nInstallDate\u003d\nLastErrorCode\u003d\nName\u003dDisk #0, Partition #2\nNumberOfBlocks\u003d272555759\nPNPDeviceID\u003d\nPowerManagementCapabilities\u003d\nPowerManagementSupported\u003d\nPrimaryPartition\u003dFALSE\nPurpose\u003d\nRewritePartition\u003d\nSize\u003d139548548608\nStartingOffset\u003d20493337088\nStatus\u003d\nStatusInfo\u003d\nType\u003dExtended w/Extended Int 13\n```\n\n**wmic diskdrive list full**\n\n```\nAvailability\u003d\nBytesPerSector\u003d512\nCapabilities\u003d{3,4,10}\nCapabilityDescriptions\u003d{\"Random Access\",\"Supports Writing\",\"SMART Notification\"}\nCompressionMethod\u003d\nConfigManagerErrorCode\u003d0\nConfigManagerUserConfig\u003dFALSE\nDefaultBlockSize\u003d\nDescription\u003dDisk drive\nDeviceID\u003d\\\\.\\PHYSICALDRIVE0\nErrorCleared\u003d\nErrorDescription\u003d\nErrorMethodology\u003d\nIndex\u003d0\nInstallDate\u003d\nInterfaceType\u003dIDE\nLastErrorCode\u003d\nManufacturer\u003d(Standard disk drives)\nMaxBlockSize\u003d\nMaxMediaSize\u003d\nMediaLoaded\u003dTRUE\nMediaType\u003dFixed hard disk media\nMinBlockSize\u003d\nModel\u003dHitachi HTS542516K9SA00 ATA Device\nName\u003d\\\\.\\PHYSICALDRIVE0\nNeedsCleaning\u003d\nNumberOfMediaSupported\u003d\nPartitions\u003d4\nPNPDeviceID\u003dIDE\\DISKHITACHI_HTS542516K9SA00_________________BBCOC33P\\5\u0026amp;243EB0E2\u0026amp;0\u0026amp;0.0.0\nPowerManagementCapabilities\u003d\nPowerManagementSupported\u003d\nSCSIBus\u003d0\nSCSILogicalUnit\u003d0\nSCSIPort\u003d2\nSCSITargetId\u003d0\nSectorsPerTrack\u003d63\nSignature\u003d855382575\nSize\u003d160039272960\nStatus\u003dOK\nStatusInfo\u003d\nSystemName\u003dPETER-PC\nTotalCylinders\u003d19457\nTotalHeads\u003d255\nTotalSectors\u003d312576705\nTotalTracks\u003d4961535\nTracksPerCylinder\u003d255\n```\n\n\u003cbr /\u003e\n\n"
    },
    {
      "id": "189584",
      "timestamp": "2015-01-02T18:11:28+00:00",
      "author": "Wonko the Sane",
      "content": "@Zharif  \nWhich files you cannot download?  \nJust post about them and I will upload them here.  \nMountvol uses the volume UUIDs, it is not useful for this, see also:  \n[http://www.msfn.org/...image/?p\u003d895199](http://www.msfn.org/board/topic/137714-install-xp-from-a-ram-loaded-iso-image/?p\u003d895199 \"External link\")\n\nBut, again what is the problem ![:w00t:](https://reboot.pro/public/style_emoticons/default/w00t.gif), dmdiag works, as well as dd --list works or can work, \\*like\\*:\n\n```\n@ECHO OFF\nSETLOCAL ENABLEEXTENSIONS ENABLEDELAYEDEXPANSION\n::Links from \\HardDiskM\\PartitionN to drive letters\n\nSET IsVolume\u003d0\nSET IsNTBlock\u003d0\nFOR /F \"tokens\u003d*\" %%A IN (\u0027dd --list 2^\u003e^\u00261\u0027) DO (\nSET ThisLine\u003d%%A\nSET ThisIncipit\u003d!ThisLine:~0,5!\nIF \"\\\\.\\V\"\u003d\u003d\"!ThisLine:~0,5!\" SET IsVolume\u003d1\u0026SET Thisvolume\u003d%%A\nIF !IsVolume!\u003d\u003d1 IF \"!ThisLine:~0,7!\"\u003d\u003d\"link to\" CALL :volume %%A\nIF !IsVolume!\u003d\u003d1 IF \"!ThisLine:~0,7!\"\u003d\u003d\"Mounted\" CALL :volume %%A\nIF \"NT Block\"\u003d\u003d\"!ThisLine:~0,8!\" SET IsVolume\u003d0\u0026 SET IsNTBlock\u003d1\nIF \"\\\\?\\Device\\H\"\u003d\u003d\"!ThisLine:~0,12!\" SET IsVolume\u003d0\u0026 SET IsNTBlock\u003d1\u0026SET ThisdeviceH\u003d%%A\nIF !IsNTBlock!\u003d\u003d1 IF \"!ThisLine:~0,7!\"\u003d\u003d\"link to\" CALL :deviceH \u003d%%A\n)\nFOR /F \"tokens\u003d2,4 delims\u003d\u003d?\" %%A IN (\u0027SET \\\\?\\D\u0027) DO (\nFOR /F \"tokens\u003d2,3,5 delims\u003d\u003d.\" %%C IN (\u0027SET \\\\.\\V^|FIND \"%%B\"\u0027) DO (\nECHO  %%E %%A\nREM ECHO  %%E %%A %%C\n)\n)\nGOTO :EOF\n\n\n:volume\nSET %Thisvolume%\u003d!%Thisvolume%!\u003d%3\nGOTO :EOF\n\n:deviceH\nSET %ThisdeviceH%\u003d!%ThisdeviceH%!%3\nGOTO :EOF\n```\n\n\u003cbr /\u003e\n\n@Peter80  \nMaybe you copied them not from the command line, but from the Truecrypt GUI. ![:unsure:](https://reboot.pro/public/style_emoticons/default/unsure.png) or using some other third party tool. ![:dubbio:](https://reboot.pro/public/style_emoticons/default/dubbio.gif)  \n[http://andryou.com/t...-line-usage.php](http://andryou.com/truecrypt/docs/command-line-usage.php \"External link\")  \n\n![:duff:](https://reboot.pro/public/style_emoticons/default/duff.gif)  \nWonko\n\n"
    },
    {
      "id": "189591",
      "timestamp": "2015-01-02T20:01:18+00:00",
      "author": "Peter80",
      "content": "\u003e Maybe you copied them not from the command line, but from the Truecrypt GUI. ![:unsure:](https://reboot.pro/public/style_emoticons/default/unsure.png) or using some other third party tool. ![:dubbio:](https://reboot.pro/public/style_emoticons/default/dubbio.gif)  \n\u003e\n\u003e [http://andryou.com/t...-line-usage.php](http://andryou.com/truecrypt/docs/command-line-usage.php \"External link\")\n\nNo, it was from the command prompt window and i didn\u0027t use third party tool.\n\n"
    },
    {
      "id": "189592",
      "timestamp": "2015-01-02T20:05:29+00:00",
      "author": "Zharif",
      "content": "@Wonko,\n\nthanks for your offer. Maybe I come back to it.\n\nThere\u0027s no problem for me to use third party tools like dmdiag or dd. I do use external cmdline tools everyday.\n\nI just tried to cover the initial question of Peter80 to do it somehow with onboard utilities only.\n\nHowever, such a task seems to be very interesting. I\u0027m curious if it is possible with build-in comdline tool only.\n\nThe attached script uses mountvol to get the UUIDs, get the corresponding drive letters (if available) and uses fsutil, in which the UUID were passed. Results are additional string info about the drive type and volume label (if available).\n\nWould you check it please?\n\nThe last and most difficult task is to find/get the associated HDD and Partition-Nr.  \n\n#### Attached Files {#attach_wrap}\n\n* [![Attached File](http://reboot.pro/public/style_extra/mime_types/txt.gif)](http://reboot.pro/index.php?s\u003d25a5299391a75e96769998beb808d4e0\u0026app\u003dcore\u0026module\u003dattach\u0026section\u003dattach\u0026attach_id\u003d15241 \"Download attachment\") [**ZPart.txt**](http://reboot.pro/index.php?s\u003d25a5299391a75e96769998beb808d4e0\u0026app\u003dcore\u0026module\u003dattach\u0026section\u003dattach\u0026attach_id\u003d15241 \"Download attachment\") **1.89KB** 539 downloads\n\n"
    },
    {
      "id": "189598",
      "timestamp": "2015-01-02T20:45:35+00:00",
      "author": "cdob",
      "content": "\u003e \\\\Device\\\\Harddisk0\\\\Partition1  \n\u003e \\\\Device\\\\Harddisk0\\\\Partition2  \n\u003e \\\\Device\\\\Harddisk0\\\\Partition3\n\u003e DeviceID\u003dDisk #0, Partition #0  \n\u003e DeviceID\u003dDisk #0, Partition #1  \n\u003e DeviceID\u003dDisk #0, Partition #2\n\nI wonder:  \ndoes DeviceID\u003dDisk #D, Partition #P+1 matches \\\\Device\\\\HarddiskD\\\\PartitionP ?   \n"
    },
    {
      "id": "189599",
      "timestamp": "2015-01-02T20:49:51+00:00",
      "author": "Wonko the Sane",
      "content": "@Zharif\n\nSure, but the original question was not that one, Peter80 remembers to have used a \"built-in\" tool in a simple way (without writing a batch for it), your nice Zpart thingy works fine here, but I am failing to see it\u0027s usefulness, as it simply outputs UUID\u0027s with drive letters, and the \"added info\" from fsutil are not seemingly useful.\n\nPlease note how if you try it you will have three possible results for the actual label:\n\n1. the actual label (good :smile:)\n2. a \"NA\" (good :smile:) though usually \"N/A\" is used when the volume has no label\n3. a \"non pronta\" (bad ![:(](https://reboot.pro/public/style_emoticons/default/sad.png)) in English that would be \"not ready\" but it depends on the parsing besides the localization if the device has a letter assigned but there is no media in it (empty CD/DVD drive or card reader without cards.\n\n![:duff:](https://reboot.pro/public/style_emoticons/default/duff.gif)\n\nWonko\n\n"
    },
    {
      "id": "189601",
      "timestamp": "2015-01-02T22:40:24+00:00",
      "author": "Zharif",
      "content": "Tests with XP, Vista and Win81x64:\n\nI found a way to output \"\\\\Device\\\\HarddiskVolume\\\u003cX\\\u003e\\\\\" value.\n\nIt\u0027s a fsutil command (fsutil resouce info \\\u003cDriveLetter or UUID\\\u003e).\n\nThis command is not available under XP.\n\nThe attached file checks for the OS. If it is not XP the mentioned string will be displayed additionally.\n\n\\\\Device\\\\HarddiskVolume\\\u003cX\\\u003e seems to get the partition number but not the HD number.\n\n@Wonko,\n\nRegarding post 3 and 8 I was sure Peter80 prefers not to use a third party tool. But I might be wrong.\n\nAbout the file:\n\nI know that the lbl thing is localised(\"non pronta\"). But till now I see no way to change this.\n\nPlease keep in mind that my effords are in an experimental stage.\n\nI worked for it in the last hours just for interest. So, please be patient.\n\nIn your eyes - what in particular is useful information?\n\nMy technical background info about HD structures is very limited.\n\nYour response creates the impression that I\u0027m on a wrong track.\n\nI would be very pleased if you show me the right direction.  \n\n#### Attached Files {#attach_wrap}\n\n* [![Attached File](http://reboot.pro/public/style_extra/mime_types/txt.gif)](http://reboot.pro/index.php?s\u003d25a5299391a75e96769998beb808d4e0\u0026app\u003dcore\u0026module\u003dattach\u0026section\u003dattach\u0026attach_id\u003d15245 \"Download attachment\") [**ZPart.txt**](http://reboot.pro/index.php?s\u003d25a5299391a75e96769998beb808d4e0\u0026app\u003dcore\u0026module\u003dattach\u0026section\u003dattach\u0026attach_id\u003d15245 \"Download attachment\") **3.9KB** 661 downloads\n\n"
    },
    {
      "id": "189609",
      "timestamp": "2015-01-03T09:10:15+00:00",
      "author": "Zharif",
      "content": "@Peter80,\n\nis your volume displayed now?\n\n"
    },
    {
      "id": "189611",
      "timestamp": "2015-01-03T09:49:28+00:00",
      "author": "Peter80",
      "content": "\u003e @Peter80,\n\u003e\n\u003e is your volume displayed now?\n\nThis is when it is mounted  \n\n```\nDrv:   G:\\\nLbl:   parameter is incorrect.\nType:  Fixed Drive\nUUID:  \\\\?\\Volume{be1fc7bf-8dee-11e4-afa3-00a0d1954570}\\\nDevID: N/A\n```\n\n\u003cbr /\u003e\n\n\u003cbr /\u003e\n\nThis is when it\u0027s dismounted  \n\n```\n Drv:   G:\\\n Lbl:   volume does not contain a recognized file system.\n Type:  Fixed Drive\n UUID:  \\\\?\\Volume{be1fc7bf-8dee-11e4-afa3-00a0d1954570}\\\n DevID: N/A\n```\n\n\u003cbr /\u003e\n\n"
    },
    {
      "id": "189612",
      "timestamp": "2015-01-03T09:58:15+00:00",
      "author": "Peter80",
      "content": "I think the right term for these partition paths i am trying to get is ARC paths and i am searching google to find cmd command that can list the ARC paths, but no luck so far. I found a utility from Sysinternals that can list partitions ARC paths, but it doesn\u0027t seem very accurate [http://technet.micro...s/bb896657.aspx](http://technet.microsoft.com/en-us/sysinternals/bb896657.aspx \"External link\")  \nIt shows that i have 12 partition, but i don\u0027t have that much, and it doesn\u0027t give much details about the partitions.\n\n"
    },
    {
      "id": "189613",
      "timestamp": "2015-01-03T10:05:02+00:00",
      "author": "Wonko the Sane",
      "content": "@Zharif\n\nDon\u0027t worry :smile:, I am very patient, you asked me to check it and I reported what I thought might need a refinement/bettering.\n\nPersonally I prefer to have things as \"narrow in scope\" as they can be, if the scope of the batch is to find all volume UUID\u0027s and output the corresponding drive letter and further info for each, it is fine as is, if the scope is to find a partition mapping then volumes corresponding to CD/DVD and multicard readers (not ready) should not even be displayed.\n\nI am sure that Peter80 has managed to do it \\*somehow\\* the issue here is that - unless there is some new, obscure command n Windows 7 that I know nothing about ![:w00t:](https://reboot.pro/public/style_emoticons/default/w00t.gif) ![:ph34r:](https://reboot.pro/public/style_emoticons/default/scared9.gif) - I believe there is no built-in command that will produce that output (and making a batch that assembles a set of commands - if possible - to create that output is surely not what he did at the time) ![:unsure:](https://reboot.pro/public/style_emoticons/default/unsure.png).\n\nLet\u0027s wait if someone comes out with this \"unknown\" command ![:dubbio:](https://reboot.pro/public/style_emoticons/default/dubbio.gif) for that, and let\u0027s see in the meantime what we (actually you) can get through the batches. ![:thumbsup:](https://reboot.pro/public/style_emoticons/default/thumbsup.gif)\n\n@Peter80\n\nNot really (an ArcPath is yet another thing) it goes like this:\n\nmulti(0)disk(0)rdisk(0)partition(1)\n\nyou can get it through recovery console in 2K and XP with map arc:\n\n[http://www.microsoft...s.mspx?mfr\u003dtrue](http://www.microsoft.com/resources/documentation/windows/xp/all/proddocs/en-us/recovery_console_cmds.mspx?mfr\u003dtrue \"External link\")\n\nbut it is not used in Vista ![:ph34r:](https://reboot.pro/public/style_emoticons/default/scared9.gif) or later.\n\n![:duff:](https://reboot.pro/public/style_emoticons/default/duff.gif)\n\nWonko\n\n"
    },
    {
      "id": "189632",
      "timestamp": "2015-01-03T18:39:36+00:00",
      "author": "Peter80",
      "content": "I still haven\u0027t found the cmd command i had used, but i found a NirSoft program that is listing the partitions the way i want with the corresponding letters for them: [http://nirsoft.net/u...etter_view.html](http://nirsoft.net/utils/drive_letter_view.html \"External link\")\n\n"
    },
    {
      "id": "189535",
      "timestamp": "2015-01-01T14:40:29+00:00",
      "author": "Peter80",
      "content": "Anyone know how can i get the partitions path in command prompt in Windows 7? I mean to list the partitions in this way:  \n\n\\\\Device\\\\Harddisk0\\\\Partition1  \n\\\\Device\\\\Harddisk0\\\\Partition2  \n\\\\Device\\\\Harddisk0\\\\Partition3  \n\nwith the corresponding drive letters.\n\n"
    },
    {
      "id": "189537",
      "timestamp": "2015-01-01T14:53:28+00:00",
      "author": "Wonko the Sane",
      "content": "You need a tool that exposes that particular form of links/names.\n\nTry with dd for windows (using the --list switch):\n\n[http://www.chrysocome.net/dd](http://www.chrysocome.net/dd \"External link\")\n\nSee also:\n\n[http://reboot.pro/to...st-and-ddlistw/](http://reboot.pro/topic/8219-ddlist-and-ddlistw/ \"\")\n\nOr try ListDosDevices:\n\n[http://www.uwe-siebe...ivetools_e.html](http://www.uwe-sieber.de/drivetools_e.html \"External link\")\n\nor check dosdev (it is possible that you have it as part of some SDK/WDK/whatever):\n\n[http://blogs.msdn.co.../04/477164.aspx](http://blogs.msdn.com/b/adioltean/archive/2005/10/04/477164.aspx \"External link\")\n\nor get the version by Olof:\n\n[http://www.ltr-data.se/opencode.html/](http://www.ltr-data.se/opencode.html/ \"External link\")\n\n![:duff:](https://reboot.pro/public/style_emoticons/default/duff.gif)\n\nWonko\n\n"
    },
    {
      "id": "189538",
      "timestamp": "2015-01-01T15:39:37+00:00",
      "author": "Peter80",
      "content": "Thanks, ListDosDevices does what i want. But are you sure this can\u0027t be done only through Windows command prompt? Because few days ago i managed to list the partition this way using only the command prompt but i don\u0027t remember what command i used then.\n\n"
    },
    {
      "id": "189540",
      "timestamp": "2015-01-01T16:33:13+00:00",
      "author": "Wonko the Sane",
      "content": "\u003e Thanks, ListDosDevices does what i want. But are you sure this can\u0027t be done only through Windows command prompt? Because few days ago i managed to list the partition this way using only the command prompt but i don\u0027t remember what command i used then.\n\nWhich specific Windows version are you running?\n\nIs it possible that dosdev from MS has made it\u0027s way from Resource Kit (or whatever into \"main\" OS)? ![:unsure:](https://reboot.pro/public/style_emoticons/default/unsure.png)\n\nOr maybe you were using WMI/wmic ![:dubbio:](https://reboot.pro/public/style_emoticons/default/dubbio.gif), this would normally do (example) for Physicaldrive enumeration:\n\u003e wmic diskdrive list brief\n\u003e\nit is very likely that a similar command can provide that kind of info, I\u0027ll have a look for it.\n\n![:duff:](https://reboot.pro/public/style_emoticons/default/duff.gif)\n\nWonko\n\n"
    },
    {
      "id": "189541",
      "timestamp": "2015-01-01T17:06:05+00:00",
      "author": "Peter80",
      "content": "I am using Windows 7 Ultimate x32.\n\n"
    },
    {
      "id": "189554",
      "timestamp": "2015-01-02T00:25:51+00:00",
      "author": "Zharif",
      "content": "What about using wmic?\n\nHere\u0027s an example in which I tried to mimic the volume indices.\n\nPlease open the file and read comments first.\n\nThen change the file extension from \\*.txt to \\*.cmd and run the batch file.\n\n#### Attached Files {#attach_wrap}\n\n* [![Attached File](http://reboot.pro/public/style_extra/mime_types/txt.gif)](http://reboot.pro/index.php?s\u003dfe4b247b6b6668c62b7e5aebade02c56\u0026app\u003dcore\u0026module\u003dattach\u0026section\u003dattach\u0026attach_id\u003d15226 \"Download attachment\") [**ZPart.txt**](http://reboot.pro/index.php?s\u003dfe4b247b6b6668c62b7e5aebade02c56\u0026app\u003dcore\u0026module\u003dattach\u0026section\u003dattach\u0026attach_id\u003d15226 \"Download attachment\") **1.29KB** 1001 downloads\n\n"
    },
    {
      "id": "189555",
      "timestamp": "2015-01-02T00:41:34+00:00",
      "author": "Zharif",
      "content": "Wait, I just found another batch of mine to demonstrate the abilities of wmic.\n\nI hope at least one of both files is of help.  \n\n#### Attached Files {#attach_wrap}\n\n* [![Attached File](http://reboot.pro/public/style_extra/mime_types/txt.gif)](http://reboot.pro/index.php?s\u003dfe4b247b6b6668c62b7e5aebade02c56\u0026app\u003dcore\u0026module\u003dattach\u0026section\u003dattach\u0026attach_id\u003d15227 \"Download attachment\") [**ZDriveProperties.txt**](http://reboot.pro/index.php?s\u003dfe4b247b6b6668c62b7e5aebade02c56\u0026app\u003dcore\u0026module\u003dattach\u0026section\u003dattach\u0026attach_id\u003d15227 \"Download attachment\") **3.67KB** 767 downloads\n\n"
    },
    {
      "id": "189562",
      "timestamp": "2015-01-02T08:52:17+00:00",
      "author": "Peter80",
      "content": "Thanks, the first script is listing the partitions in the way i need, but it doesn\u0027t seem to detect encrypted partitions. I have one partition encrypted with TrueCrypt and it doesn\u0027t showing in the list.\n\n"
    },
    {
      "id": "189565",
      "timestamp": "2015-01-02T10:43:59+00:00",
      "author": "Zharif",
      "content": "I found out the fist script is buggy.\n\nIt won\u0027t display the drive letter \"Name\" in the right order if one of the volumes doesn\u0027t have a drive letter assigned.\n\nMy assumption was, that the list containing the volume \"Name\" is already sorted. But on my Laptop with a hidden recovery partition \"wmic volume list \\\u003e test.txt\" this is not the case.\n\nScript needs revision -will work on it.\n\nMaybe jaclaz or Wonko could explain the drive/volume orders more properly.\n\nI never used encrypted drives with True Crypt, only files.\n\nHave a look if the DeviceID of your encrypted drive is shown in the full list of \"wmic volume\".\n\nTo get a report file of all wmic commands of interest:\n\n- open the command prompt\n\n- type: Type Nul \\\u003e test.txt\n\n- type: wmic volume list full \\\u003e\\\u003e test.txt\n\n- type: wmic logicaldisk list full \\\u003e\\\u003e test.txt\n\n- type: wmic partition list full \\\u003e\\\u003e test.txt\n\n- type: wmic diskdrive list full \\\u003e\\\u003e test.txt\n\nUsing this report file, you should be able to detect your encrypted partition somewhere.\n\nIf so, please report the values you found.\n\n"
    },
    {
      "id": "189566",
      "timestamp": "2015-01-02T12:20:38+00:00",
      "author": "Wonko the Sane",
      "content": "Still, it seems like there is not a \"plain\" WMI/wmic command that could have output by itself the \"\\\\Device\\\\Harddisk0\\\\Partition1\" kind of listing, from what I could find, the only thing that actually ouptuts that (and not the forms Disk#*m* , Partition#*n* or the \\\\\\\\.\\\\PhysicalDrive*n*, etc.) is the Operating System \"os\", like in WMIC os Get Systemdevice,\n\nBut it is a non-problem, as I see it, I already provided some methods to hopefully get that info.\n\nAs a matter of fact, to be exact, the given tools provide a slightly different \"system object\" as result. Peter80 possibly did not notice it. ![:w00t:](https://reboot.pro/public/style_emoticons/default/w00t.gif) ![:ph34r:](https://reboot.pro/public/style_emoticons/default/scared9.gif)\n\nThose specific kinds of objects should be accessible only by tools like WinObj or DMdiag, see also:\n\n[http://reboot.pro/to...-line-possible/](http://reboot.pro/topic/10169-resolvedmount-hidden-partition-command-line-possible/ \"\")\n\n[http://reboot.pro/to...emount-ramdisk/](http://reboot.pro/topic/2425-imdisk-commandline-script-to-createmount-ramdisk/ \"\")\n\nSo, the actual info asked for can be got from using dmdiag, as follows (example):\n\n```\ndmdiag /v | FIND \"\\Device\\\"\n```\n\nWhat remains is not \"how to do\" but rather \"how Peter80 did or seems to remember he did\". ![:dubbio:](https://reboot.pro/public/style_emoticons/default/dubbio.gif)\n\n@Zharif\n\nThe \"generic\" issue with WMI/wmic commands is usually that there are a lot of misconfigured WMI installs, so it is not always reliable and some properties/nodes are only available on a given OS release, as an example the alias you use in your script, \"volume\" as well as it\u0027s corresponding class \"Win32_volume\" is simply not there on XP.\n\nDue to the different nature of the hardware devices (hard disks, super-floppies and similar \"volumes\", ramdisks, CD/DVD\u0027s etc.) and to the complexity with which drive letters are assigned (if any) it is extremely complex to do that kind of mapping in a script, without \\*something\\* (like one of the mentioned programs) that wrap around the DosDevices API call, see also:\n\n[http://www.msfn.org/...etter-shifting/](http://www.msfn.org/board/topic/123929-updated-batch-file-for-ordering-drive-letter-shifting/ \"External link\")\n\n[http://www.msfn.org/...-drive-letters/](http://www.msfn.org/board/topic/124539-more-compatible-batch-file-for-ording-drive-letters/ \"External link\")\n\n[http://www.msfn.org/...ter-batch-file/](http://www.msfn.org/board/topic/126069-updated-on-feb-27-2011-ordering-messed-drive-letter-batch-file/ \"External link\")\n\n![:duff:](https://reboot.pro/public/style_emoticons/default/duff.gif)\n\nWonko\n\n"
    },
    {
      "id": "189574",
      "timestamp": "2015-01-02T15:08:37+00:00",
      "author": "Peter80",
      "content": "\u003e Using this report file, you should be able to detect your encrypted partition somewhere.  \n\u003e\n\u003e If so, please report the values you found.\n\nThis is the output i got from **wmic volume list full**. The encrypted volume is G:\n\n```\nAutomount  BlockSize  Capacity     Compressed  DeviceID                                           DirtyBitSet  DriveLetter  DriveType  FileSystem  FreeSpace   IndexingEnabled  Label       MaximumFileNameLength  Name  QuotasEnabled  QuotasIncomplete  QuotasRebuilding  SerialNumber  SupportsDiskQuotas  SupportsFileBasedCompression  SystemName  \nTRUE       4096       16908283904  FALSE       \\\\?\\Volume{a6075fe8-49b3-11e4-9a93-806e6f6e6963}\\  FALSE        C:           3          NTFS        1174044672  TRUE                         255                    C:\\   FALSE          FALSE             FALSE             11754484      TRUE                TRUE                          PETER-PC     \nTRUE       4096       67408752640  FALSE       \\\\?\\Volume{a6075fe9-49b3-11e4-9a93-806e6f6e6963}\\  FALSE        D:           3          NTFS        563142656   TRUE             Local Disc  255                    D:\\   FALSE          TRUE              FALSE             -1869481847   TRUE                TRUE                          PETER-PC     \nTRUE       4096       72135725056  FALSE       \\\\?\\Volume{a6075fea-49b3-11e4-9a93-806e6f6e6963}\\  FALSE        E:           3          NTFS        3329355776  TRUE                         255                    E:\\   FALSE          TRUE              FALSE             806272371     TRUE                TRUE                          PETER-PC     \nTRUE                                           \\\\?\\Volume{be1fc7bf-8dee-11e4-afa3-00a0d1954570}\\               G:           3                                                                                      G:\\                                                                                                                      PETER-PC     \nTRUE                                           \\\\?\\Volume{a6075fed-49b3-11e4-9a93-806e6f6e6963}\\               F:           5                                                                                      F:\\                                                                                                                      PETER-PC     \n\n```\n\n\u003cbr /\u003e\n\n"
    },
    {
      "id": "189575",
      "timestamp": "2015-01-02T15:20:31+00:00",
      "author": "Peter80",
      "content": "\u003e What remains is not \"how to do\" but rather \"how Peter80 did or seems to remember he did\". ![:dubbio:](https://reboot.pro/public/style_emoticons/default/dubbio.gif)\n\nI clearly remember i copied the path for the encrypted partition from the command prompt because i was trying to create a shortcut from which to mount the partition and for this i needed the partition path. With parameters it looks like this:  \n\n```\ntruecrypt.exe /q /v /lj \\Device\\Harddisk0\\Partition2\n```\n\n\u003cbr /\u003e\n\nI was probably have found the command on google but i can\u0027t remember where and i can\u0027t remember what the command was.\n\n"
    },
    {
      "id": "189576",
      "timestamp": "2015-01-02T15:43:52+00:00",
      "author": "Zharif",
      "content": "@Wonko,\n\nI see, thank you.\n\nIt\u0027s a pity I\u0027m not able to download some of the provided files. I don\u0027t want create a new account just for this special issue.\n\nWhat do you think about an initial approach to use mountvol values in combination with fsutil fsinfo volumeinfo?\n\nJaclaz wrote that mountvol doesn\u0027t detect imdisk volumes. But for the rest - is it \"reliable\" enough to get all local drives?\n\nMaybe combinations with a \\*vbs created via commandline using fso would provide extensive info, e.g. for network drives.\n\n@Peter80,\n\nAs seen, wmic volume didn\u0027t retrieve some useful info to determine drive encryption.\n\nJust for interest, could you post results of the other wmic commands?\n\n"
    },
    {
      "id": "189583",
      "timestamp": "2015-01-02T17:30:10+00:00",
      "author": "Peter80",
      "content": "\u003e As seen, wmic volume didn\u0027t retrieve some useful info to determine drive encryption.  \n\u003e\n\u003e Just for interest, could you post results of the other wmic commands?\n\n**wmic logicaldisk list full**\n\n```\nAccess  Availability  BlockSize  Caption  Compressed  ConfigManagerErrorCode  ConfigManagerUserConfig  Description       DeviceID  DriveType  ErrorCleared  ErrorDescription  ErrorMethodology  FileSystem  FreeSpace   InstallDate  LastErrorCode  MaximumComponentLength  MediaType  Name  NumberOfBlocks  PNPDeviceID  PowerManagementCapabilities  PowerManagementSupported  ProviderName  Purpose  QuotasDisabled  QuotasIncomplete  QuotasRebuilding  Size         Status  StatusInfo  SupportsDiskQuotas  SupportsFileBasedCompression  VolumeName  VolumeSerialNumber  \n0                                C:       FALSE                                                        Local Fixed Disk  C:        3                                                            NTFS        1174192128                              255                     12         C:                                                                                                               TRUE            FALSE             FALSE             16908283904                      TRUE                TRUE                                      00B35BF4            \n0                                D:       FALSE                                                        Local Fixed Disk  D:        3                                                            NTFS        563142656                               255                     12         D:                                                                                                               TRUE            TRUE              FALSE             67408752640                      TRUE                TRUE                          Local Disc  9091F889            \n0                                E:       FALSE                                                        Local Fixed Disk  E:        3                                                            NTFS        3329617920                              255                     12         E:                                                                                                               TRUE            TRUE              FALSE             72135725056                      TRUE                TRUE                                      300EBD73            \n                                 F:                                                                    CD-ROM Disc       F:        5                                                                                                                                        11         F:                                                                                                                                                                                                                                                                                      \n0                                G:                                                                    Local Fixed Disk  G:        3                                                                                                                                        12         G:                                                                                                                                                                                                                                                                                      \n\n\n```\n\n**wmic partition list full**\n\n```\nAccess\u003d\nAvailability\u003d\nBlockSize\u003d512\nBootable\u003dTRUE\nBootPartition\u003dTRUE\nConfigManagerErrorCode\u003d\nConfigManagerUserConfig\u003d\nDescription\u003dInstallable File System\nDeviceID\u003dDisk #0, Partition #0\nDiskIndex\u003d0\nErrorCleared\u003d\nErrorDescription\u003d\nErrorMethodology\u003d\nHiddenSectors\u003d\nIndex\u003d0\nInstallDate\u003d\nLastErrorCode\u003d\nName\u003dDisk #0, Partition #0\nNumberOfBlocks\u003d33023999\nPNPDeviceID\u003d\nPowerManagementCapabilities\u003d\nPowerManagementSupported\u003d\nPrimaryPartition\u003dTRUE\nPurpose\u003d\nRewritePartition\u003d\nSize\u003d16908287488\nStartingOffset\u003d1048576\nStatus\u003d\nStatusInfo\u003d\nType\u003dInstallable File System\n\n\nAccess\u003d\nAvailability\u003d\nBlockSize\u003d512\nBootable\u003dFALSE\nBootPartition\u003dFALSE\nConfigManagerErrorCode\u003d\nConfigManagerUserConfig\u003d\nDescription\u003dInstallable File System\nDeviceID\u003dDisk #0, Partition #1\nDiskIndex\u003d0\nErrorCleared\u003d\nErrorDescription\u003d\nErrorMethodology\u003d\nHiddenSectors\u003d\nIndex\u003d1\nInstallDate\u003d\nLastErrorCode\u003d\nName\u003dDisk #0, Partition #1\nNumberOfBlocks\u003d6995968\nPNPDeviceID\u003d\nPowerManagementCapabilities\u003d\nPowerManagementSupported\u003d\nPrimaryPartition\u003dTRUE\nPurpose\u003d\nRewritePartition\u003d\nSize\u003d3581935616\nStartingOffset\u003d16909336576\nStatus\u003d\nStatusInfo\u003d\nType\u003dInstallable File System\n\n\nAccess\u003d\nAvailability\u003d\nBlockSize\u003d512\nBootable\u003dFALSE\nBootPartition\u003dFALSE\nConfigManagerErrorCode\u003d\nConfigManagerUserConfig\u003d\nDescription\u003dExtended w/Extended Int 13\nDeviceID\u003dDisk #0, Partition #2\nDiskIndex\u003d0\nErrorCleared\u003d\nErrorDescription\u003d\nErrorMethodology\u003d\nHiddenSectors\u003d\nIndex\u003d2\nInstallDate\u003d\nLastErrorCode\u003d\nName\u003dDisk #0, Partition #2\nNumberOfBlocks\u003d272555759\nPNPDeviceID\u003d\nPowerManagementCapabilities\u003d\nPowerManagementSupported\u003d\nPrimaryPartition\u003dFALSE\nPurpose\u003d\nRewritePartition\u003d\nSize\u003d139548548608\nStartingOffset\u003d20493337088\nStatus\u003d\nStatusInfo\u003d\nType\u003dExtended w/Extended Int 13\n```\n\n**wmic diskdrive list full**\n\n```\nAvailability\u003d\nBytesPerSector\u003d512\nCapabilities\u003d{3,4,10}\nCapabilityDescriptions\u003d{\"Random Access\",\"Supports Writing\",\"SMART Notification\"}\nCompressionMethod\u003d\nConfigManagerErrorCode\u003d0\nConfigManagerUserConfig\u003dFALSE\nDefaultBlockSize\u003d\nDescription\u003dDisk drive\nDeviceID\u003d\\\\.\\PHYSICALDRIVE0\nErrorCleared\u003d\nErrorDescription\u003d\nErrorMethodology\u003d\nIndex\u003d0\nInstallDate\u003d\nInterfaceType\u003dIDE\nLastErrorCode\u003d\nManufacturer\u003d(Standard disk drives)\nMaxBlockSize\u003d\nMaxMediaSize\u003d\nMediaLoaded\u003dTRUE\nMediaType\u003dFixed hard disk media\nMinBlockSize\u003d\nModel\u003dHitachi HTS542516K9SA00 ATA Device\nName\u003d\\\\.\\PHYSICALDRIVE0\nNeedsCleaning\u003d\nNumberOfMediaSupported\u003d\nPartitions\u003d4\nPNPDeviceID\u003dIDE\\DISKHITACHI_HTS542516K9SA00_________________BBCOC33P\\5\u0026amp;243EB0E2\u0026amp;0\u0026amp;0.0.0\nPowerManagementCapabilities\u003d\nPowerManagementSupported\u003d\nSCSIBus\u003d0\nSCSILogicalUnit\u003d0\nSCSIPort\u003d2\nSCSITargetId\u003d0\nSectorsPerTrack\u003d63\nSignature\u003d855382575\nSize\u003d160039272960\nStatus\u003dOK\nStatusInfo\u003d\nSystemName\u003dPETER-PC\nTotalCylinders\u003d19457\nTotalHeads\u003d255\nTotalSectors\u003d312576705\nTotalTracks\u003d4961535\nTracksPerCylinder\u003d255\n```\n\n\u003cbr /\u003e\n\n"
    },
    {
      "id": "189584",
      "timestamp": "2015-01-02T18:11:28+00:00",
      "author": "Wonko the Sane",
      "content": "@Zharif  \nWhich files you cannot download?  \nJust post about them and I will upload them here.  \nMountvol uses the volume UUIDs, it is not useful for this, see also:  \n[http://www.msfn.org/...image/?p\u003d895199](http://www.msfn.org/board/topic/137714-install-xp-from-a-ram-loaded-iso-image/?p\u003d895199 \"External link\")\n\nBut, again what is the problem ![:w00t:](https://reboot.pro/public/style_emoticons/default/w00t.gif), dmdiag works, as well as dd --list works or can work, \\*like\\*:\n\n```\n@ECHO OFF\nSETLOCAL ENABLEEXTENSIONS ENABLEDELAYEDEXPANSION\n::Links from \\HardDiskM\\PartitionN to drive letters\n\nSET IsVolume\u003d0\nSET IsNTBlock\u003d0\nFOR /F \"tokens\u003d*\" %%A IN (\u0027dd --list 2^\u003e^\u00261\u0027) DO (\nSET ThisLine\u003d%%A\nSET ThisIncipit\u003d!ThisLine:~0,5!\nIF \"\\\\.\\V\"\u003d\u003d\"!ThisLine:~0,5!\" SET IsVolume\u003d1\u0026SET Thisvolume\u003d%%A\nIF !IsVolume!\u003d\u003d1 IF \"!ThisLine:~0,7!\"\u003d\u003d\"link to\" CALL :volume %%A\nIF !IsVolume!\u003d\u003d1 IF \"!ThisLine:~0,7!\"\u003d\u003d\"Mounted\" CALL :volume %%A\nIF \"NT Block\"\u003d\u003d\"!ThisLine:~0,8!\" SET IsVolume\u003d0\u0026 SET IsNTBlock\u003d1\nIF \"\\\\?\\Device\\H\"\u003d\u003d\"!ThisLine:~0,12!\" SET IsVolume\u003d0\u0026 SET IsNTBlock\u003d1\u0026SET ThisdeviceH\u003d%%A\nIF !IsNTBlock!\u003d\u003d1 IF \"!ThisLine:~0,7!\"\u003d\u003d\"link to\" CALL :deviceH \u003d%%A\n)\nFOR /F \"tokens\u003d2,4 delims\u003d\u003d?\" %%A IN (\u0027SET \\\\?\\D\u0027) DO (\nFOR /F \"tokens\u003d2,3,5 delims\u003d\u003d.\" %%C IN (\u0027SET \\\\.\\V^|FIND \"%%B\"\u0027) DO (\nECHO  %%E %%A\nREM ECHO  %%E %%A %%C\n)\n)\nGOTO :EOF\n\n\n:volume\nSET %Thisvolume%\u003d!%Thisvolume%!\u003d%3\nGOTO :EOF\n\n:deviceH\nSET %ThisdeviceH%\u003d!%ThisdeviceH%!%3\nGOTO :EOF\n```\n\n\u003cbr /\u003e\n\n@Peter80  \nMaybe you copied them not from the command line, but from the Truecrypt GUI. ![:unsure:](https://reboot.pro/public/style_emoticons/default/unsure.png) or using some other third party tool. ![:dubbio:](https://reboot.pro/public/style_emoticons/default/dubbio.gif)  \n[http://andryou.com/t...-line-usage.php](http://andryou.com/truecrypt/docs/command-line-usage.php \"External link\")  \n\n![:duff:](https://reboot.pro/public/style_emoticons/default/duff.gif)  \nWonko\n\n"
    },
    {
      "id": "189591",
      "timestamp": "2015-01-02T20:01:18+00:00",
      "author": "Peter80",
      "content": "\u003e Maybe you copied them not from the command line, but from the Truecrypt GUI. ![:unsure:](https://reboot.pro/public/style_emoticons/default/unsure.png) or using some other third party tool. ![:dubbio:](https://reboot.pro/public/style_emoticons/default/dubbio.gif)  \n\u003e\n\u003e [http://andryou.com/t...-line-usage.php](http://andryou.com/truecrypt/docs/command-line-usage.php \"External link\")\n\nNo, it was from the command prompt window and i didn\u0027t use third party tool.\n\n"
    },
    {
      "id": "189592",
      "timestamp": "2015-01-02T20:05:29+00:00",
      "author": "Zharif",
      "content": "@Wonko,\n\nthanks for your offer. Maybe I come back to it.\n\nThere\u0027s no problem for me to use third party tools like dmdiag or dd. I do use external cmdline tools everyday.\n\nI just tried to cover the initial question of Peter80 to do it somehow with onboard utilities only.\n\nHowever, such a task seems to be very interesting. I\u0027m curious if it is possible with build-in comdline tool only.\n\nThe attached script uses mountvol to get the UUIDs, get the corresponding drive letters (if available) and uses fsutil, in which the UUID were passed. Results are additional string info about the drive type and volume label (if available).\n\nWould you check it please?\n\nThe last and most difficult task is to find/get the associated HDD and Partition-Nr.  \n\n#### Attached Files {#attach_wrap}\n\n* [![Attached File](http://reboot.pro/public/style_extra/mime_types/txt.gif)](http://reboot.pro/index.php?s\u003dfe4b247b6b6668c62b7e5aebade02c56\u0026app\u003dcore\u0026module\u003dattach\u0026section\u003dattach\u0026attach_id\u003d15241 \"Download attachment\") [**ZPart.txt**](http://reboot.pro/index.php?s\u003dfe4b247b6b6668c62b7e5aebade02c56\u0026app\u003dcore\u0026module\u003dattach\u0026section\u003dattach\u0026attach_id\u003d15241 \"Download attachment\") **1.89KB** 539 downloads\n\n"
    },
    {
      "id": "189598",
      "timestamp": "2015-01-02T20:45:35+00:00",
      "author": "cdob",
      "content": "\u003e \\\\Device\\\\Harddisk0\\\\Partition1  \n\u003e \\\\Device\\\\Harddisk0\\\\Partition2  \n\u003e \\\\Device\\\\Harddisk0\\\\Partition3\n\u003e DeviceID\u003dDisk #0, Partition #0  \n\u003e DeviceID\u003dDisk #0, Partition #1  \n\u003e DeviceID\u003dDisk #0, Partition #2\n\nI wonder:  \ndoes DeviceID\u003dDisk #D, Partition #P+1 matches \\\\Device\\\\HarddiskD\\\\PartitionP ?   \n"
    },
    {
      "id": "189599",
      "timestamp": "2015-01-02T20:49:51+00:00",
      "author": "Wonko the Sane",
      "content": "@Zharif\n\nSure, but the original question was not that one, Peter80 remembers to have used a \"built-in\" tool in a simple way (without writing a batch for it), your nice Zpart thingy works fine here, but I am failing to see it\u0027s usefulness, as it simply outputs UUID\u0027s with drive letters, and the \"added info\" from fsutil are not seemingly useful.\n\nPlease note how if you try it you will have three possible results for the actual label:\n\n1. the actual label (good :smile:)\n2. a \"NA\" (good :smile:) though usually \"N/A\" is used when the volume has no label\n3. a \"non pronta\" (bad ![:(](https://reboot.pro/public/style_emoticons/default/sad.png)) in English that would be \"not ready\" but it depends on the parsing besides the localization if the device has a letter assigned but there is no media in it (empty CD/DVD drive or card reader without cards.\n\n![:duff:](https://reboot.pro/public/style_emoticons/default/duff.gif)\n\nWonko\n\n"
    },
    {
      "id": "189601",
      "timestamp": "2015-01-02T22:40:24+00:00",
      "author": "Zharif",
      "content": "Tests with XP, Vista and Win81x64:\n\nI found a way to output \"\\\\Device\\\\HarddiskVolume\\\u003cX\\\u003e\\\\\" value.\n\nIt\u0027s a fsutil command (fsutil resouce info \\\u003cDriveLetter or UUID\\\u003e).\n\nThis command is not available under XP.\n\nThe attached file checks for the OS. If it is not XP the mentioned string will be displayed additionally.\n\n\\\\Device\\\\HarddiskVolume\\\u003cX\\\u003e seems to get the partition number but not the HD number.\n\n@Wonko,\n\nRegarding post 3 and 8 I was sure Peter80 prefers not to use a third party tool. But I might be wrong.\n\nAbout the file:\n\nI know that the lbl thing is localised(\"non pronta\"). But till now I see no way to change this.\n\nPlease keep in mind that my effords are in an experimental stage.\n\nI worked for it in the last hours just for interest. So, please be patient.\n\nIn your eyes - what in particular is useful information?\n\nMy technical background info about HD structures is very limited.\n\nYour response creates the impression that I\u0027m on a wrong track.\n\nI would be very pleased if you show me the right direction.  \n\n#### Attached Files {#attach_wrap}\n\n* [![Attached File](http://reboot.pro/public/style_extra/mime_types/txt.gif)](http://reboot.pro/index.php?s\u003dfe4b247b6b6668c62b7e5aebade02c56\u0026app\u003dcore\u0026module\u003dattach\u0026section\u003dattach\u0026attach_id\u003d15245 \"Download attachment\") [**ZPart.txt**](http://reboot.pro/index.php?s\u003dfe4b247b6b6668c62b7e5aebade02c56\u0026app\u003dcore\u0026module\u003dattach\u0026section\u003dattach\u0026attach_id\u003d15245 \"Download attachment\") **3.9KB** 661 downloads\n\n"
    },
    {
      "id": "189609",
      "timestamp": "2015-01-03T09:10:15+00:00",
      "author": "Zharif",
      "content": "@Peter80,\n\nis your volume displayed now?\n\n"
    },
    {
      "id": "189611",
      "timestamp": "2015-01-03T09:49:28+00:00",
      "author": "Peter80",
      "content": "\u003e @Peter80,\n\u003e\n\u003e is your volume displayed now?\n\nThis is when it is mounted  \n\n```\nDrv:   G:\\\nLbl:   parameter is incorrect.\nType:  Fixed Drive\nUUID:  \\\\?\\Volume{be1fc7bf-8dee-11e4-afa3-00a0d1954570}\\\nDevID: N/A\n```\n\n\u003cbr /\u003e\n\n\u003cbr /\u003e\n\nThis is when it\u0027s dismounted  \n\n```\n Drv:   G:\\\n Lbl:   volume does not contain a recognized file system.\n Type:  Fixed Drive\n UUID:  \\\\?\\Volume{be1fc7bf-8dee-11e4-afa3-00a0d1954570}\\\n DevID: N/A\n```\n\n\u003cbr /\u003e\n\n"
    },
    {
      "id": "189612",
      "timestamp": "2015-01-03T09:58:15+00:00",
      "author": "Peter80",
      "content": "I think the right term for these partition paths i am trying to get is ARC paths and i am searching google to find cmd command that can list the ARC paths, but no luck so far. I found a utility from Sysinternals that can list partitions ARC paths, but it doesn\u0027t seem very accurate [http://technet.micro...s/bb896657.aspx](http://technet.microsoft.com/en-us/sysinternals/bb896657.aspx \"External link\")  \nIt shows that i have 12 partition, but i don\u0027t have that much, and it doesn\u0027t give much details about the partitions.\n\n"
    },
    {
      "id": "189613",
      "timestamp": "2015-01-03T10:05:02+00:00",
      "author": "Wonko the Sane",
      "content": "@Zharif\n\nDon\u0027t worry :smile:, I am very patient, you asked me to check it and I reported what I thought might need a refinement/bettering.\n\nPersonally I prefer to have things as \"narrow in scope\" as they can be, if the scope of the batch is to find all volume UUID\u0027s and output the corresponding drive letter and further info for each, it is fine as is, if the scope is to find a partition mapping then volumes corresponding to CD/DVD and multicard readers (not ready) should not even be displayed.\n\nI am sure that Peter80 has managed to do it \\*somehow\\* the issue here is that - unless there is some new, obscure command n Windows 7 that I know nothing about ![:w00t:](https://reboot.pro/public/style_emoticons/default/w00t.gif) ![:ph34r:](https://reboot.pro/public/style_emoticons/default/scared9.gif) - I believe there is no built-in command that will produce that output (and making a batch that assembles a set of commands - if possible - to create that output is surely not what he did at the time) ![:unsure:](https://reboot.pro/public/style_emoticons/default/unsure.png).\n\nLet\u0027s wait if someone comes out with this \"unknown\" command ![:dubbio:](https://reboot.pro/public/style_emoticons/default/dubbio.gif) for that, and let\u0027s see in the meantime what we (actually you) can get through the batches. ![:thumbsup:](https://reboot.pro/public/style_emoticons/default/thumbsup.gif)\n\n@Peter80\n\nNot really (an ArcPath is yet another thing) it goes like this:\n\nmulti(0)disk(0)rdisk(0)partition(1)\n\nyou can get it through recovery console in 2K and XP with map arc:\n\n[http://www.microsoft...s.mspx?mfr\u003dtrue](http://www.microsoft.com/resources/documentation/windows/xp/all/proddocs/en-us/recovery_console_cmds.mspx?mfr\u003dtrue \"External link\")\n\nbut it is not used in Vista ![:ph34r:](https://reboot.pro/public/style_emoticons/default/scared9.gif) or later.\n\n![:duff:](https://reboot.pro/public/style_emoticons/default/duff.gif)\n\nWonko\n\n"
    },
    {
      "id": "189632",
      "timestamp": "2015-01-03T18:39:36+00:00",
      "author": "Peter80",
      "content": "I still haven\u0027t found the cmd command i had used, but i found a NirSoft program that is listing the partitions the way i want with the corresponding letters for them: [http://nirsoft.net/u...etter_view.html](http://nirsoft.net/utils/drive_letter_view.html \"External link\")\n\n"
    },
    {
      "id": "189634",
      "timestamp": "2015-01-03T19:19:51+00:00",
      "author": "Wonko the Sane",
      "content": "\u003e I still haven\u0027t found the cmd command i had used, but i found a NirSoft program that is listing the partitions the way i want with the corresponding letters for them: [http://nirsoft.net/u...etter_view.html](http://nirsoft.net/utils/drive_letter_view.html \"External link\")\n\nNO. ![:(](http://reboot.pro/public/style_emoticons/default/sad.png)\n\nThis is what you \"want\":  \n**C:** \\\\Device**\\\\Harddisk0****\\\\Partition1**  \n\nThis is what that otherwise very nice Nirsoft tool (which is not command line) provides (as well as a number of other tools, including some of the mentioned ones):  \n**C:** \\\\Device**\\\\HarddiskVolume1** (besides the info that the volume belongs to \\\\\\\\?**\\\\PhysicalDrive0**)  \n\nThey are **NOT** the same (though they all in all link to the same volume/device :smile:).  \n\nHere is a snippet (edited) of the output of dd --list:  \n\u003e rawwrite dd for windows version 0.5.  \n\u003e Written by John Newbigin \\\u003cjn@it.swin.edu.au\\\u003e  \n\u003e This program is covered by the GPL. See copying.txt for details  \n\u003e Win32 Available Volume Information  \n\u003e \\\\\\\\.\\\\Volume{b0b284c3-8a33-11dd-8781-806d6172696f}\\\\  \n\u003e link to \\\\\\\\?\\\\Device**\\\\Harddisk0****\\\\Partition1**  \n\u003e fixed media  \n\u003e Mounted on \\\\\\\\.\\\\**c:**   \n\u003e ...  \n\u003e\n\u003e NT Block Device Objects  \n\u003e ...  \n\u003e \\\\\\\\?\\\\Device**\\\\Harddisk0****\\\\Partition1**  \n\u003e link to \\\\\\\\?\\\\Device**\\\\HarddiskVolume1**  \n\u003e ...\n\n\u003cbr /\u003e\n\nCan you see it?\n\nAnd here is a snippet of dmdiag -v:\n\n\u003e ...  \n\u003e ---------- Drive Letter Usage, Drive Type ----------  \n\u003e\n\u003e C: \u003d \\\\Device\\\\HarddiskVolume1 \\[Fixed\\]  \n\u003e\n\u003e ...  \n\u003e\n\u003e ---------- \\\\Device\\\\Harddisk0 ----------  \n\u003e\n\u003e \\\\Device\\\\Harddisk0\\\\DP(1)0x7e00-0x4a85ad0400+2 (Device)  \n\u003e \\\\Device\\\\Harddisk0\\\\DR0 (Device)  \n\u003e \\\\Device\\\\Harddisk0\\\\Partition0 (SymbolicLink) -\\\u003e \\\\Device\\\\Harddisk0\\\\DR0  \n\u003e \\\\Device\\\\Harddisk0\\\\Partition1 (SymbolicLink) -\\\u003e \\\\Device\\\\HarddiskVolume1  \n\u003e\n\u003e ...\n\u003e\n![:duff:](http://reboot.pro/public/style_emoticons/default/duff.gif)\n\nWonko\n\n"
    },
    {
      "id": "189638",
      "timestamp": "2015-01-03T20:37:48+00:00",
      "author": "Peter80",
      "content": "Yes, **\\\\Device\\\\HarddiskVolume1** is not the same as **\\\\Device\\\\Harddisk0\\\\Partition1** .  \nI missed that.\n\n"
    },
    {
      "id": "189642",
      "timestamp": "2015-01-03T21:45:53+00:00",
      "author": "erwan.l",
      "content": "Hi, note that vmount ( \u003chttp://reboot.pro/topic/19622-vmount/\u003e ) can also list partitions along with drive letters.   \n\nRegards,  \nErwan   \n"
    },
    {
      "id": "189645",
      "timestamp": "2015-01-04T02:42:23+00:00",
      "author": "Zharif",
      "content": "I think I found a way to display all physical drives and the corresponding partitions.\n\nThe following script creates a \\*vbs file that uses the wmi to retrieve the desired information.\n\nThe \\*vbs will be run and deleted afterwards.\n\nAll credits go to Ruediger Roesler, who posted his extensive script here:\n\n[https://gallery.tech...of-all-2a738404](https://gallery.technet.microsoft.com/scriptcenter/Shows-an-Overview-of-all-2a738404 \"External link\")\n\nI simply shrinked and modified his script to get a minimum of info only. It can be enhanced widely.\n\nTill now, settings of the vbs file display e.g. card readers but this can be changed by uncommenting two lines in the vbscript.\n\nWonko, what do you think?\n\nPeter80, is it of use for you?\n\n@Wonko,\n\nThanks for explaination. I\u0027m not worried at all. As so often, you went behind my \"language barriere\" to get what I really tried to say (or to do). Thanks.  \n\n#### Attached Files {#attach_wrap}\n\n* [![Attached File](http://reboot.pro/public/style_extra/mime_types/txt.gif)](http://reboot.pro/index.php?s\u003d8de5ad0a82a492e5c3a4b802c2ab42fd\u0026app\u003dcore\u0026module\u003dattach\u0026section\u003dattach\u0026attach_id\u003d15250 \"Download attachment\") [**ZShowDrives.txt**](http://reboot.pro/index.php?s\u003d8de5ad0a82a492e5c3a4b802c2ab42fd\u0026app\u003dcore\u0026module\u003dattach\u0026section\u003dattach\u0026attach_id\u003d15250 \"Download attachment\") **3.27KB** 493 downloads\n\n"
    },
    {
      "id": "189649",
      "timestamp": "2015-01-04T09:08:31+00:00",
      "author": "Peter80",
      "content": "\u003e Peter80, is it of use for you?\n\nThis is the output i am getting:\n\n```\n\\\\.\\PHYSICALDRIVE0 (Hitachi HTS542516K9SA00 ATA Device) Index:0\n Logical Drives:4\n \\Disk0\\Partition0\\  C:\n \\Disk0\\Partition1\\  G:\n \\Disk0\\Partition2\\  D: Local Disc\n  E:\n```\n\nThe path for E: partition is missing and also TrueCrypt shows G: partition as number 2, but it start the counting from C: as number 1 and it doesn\u0027t include zero in the order.\n\n\u003cbr /\u003e\n\n"
    },
    {
      "id": "189658",
      "timestamp": "2015-01-04T12:44:44+00:00",
      "author": "Zharif",
      "content": "@Peter80,\n\nE: is your CD-Rom drive and should not be displayed (referring to Wonko).\n\nI modified the VBScript to show fixed drives only.\n\nBut remember Wonkos explaination in post 27.\n\nI suppose that WMI win32_diskdrive enumerates disks as standard vb arrays (index starts with 0).\n\nCounting these starts with positive integers.\n\nBut at least modifiying the output in the way you need seems to be simple.\n\nThe attached script will give two different outputs in one line (just to compare):\n\nPartition.DeviceID \\| \\\\Disk\\\u003cDiskDriveIndex+1\\\u003e\\\\Partition\\\u003cPartitionIndex+1\\\u003e \\\u003cLogicalDiskVolumeLetter\\\u003e: \\\u003cLogicalDiskVolumeLabel\\\u003e\n\nI think your desired output should appear. Please try.  \n\n#### Attached Files {#attach_wrap}\n\n* [![Attached File](http://reboot.pro/public/style_extra/mime_types/txt.gif)](http://reboot.pro/index.php?s\u003d8de5ad0a82a492e5c3a4b802c2ab42fd\u0026app\u003dcore\u0026module\u003dattach\u0026section\u003dattach\u0026attach_id\u003d15263 \"Download attachment\") [**ZShowDrives.txt**](http://reboot.pro/index.php?s\u003d8de5ad0a82a492e5c3a4b802c2ab42fd\u0026app\u003dcore\u0026module\u003dattach\u0026section\u003dattach\u0026attach_id\u003d15263 \"Download attachment\") **3.23KB** 433 downloads\n\n"
    },
    {
      "id": "189659",
      "timestamp": "2015-01-04T15:51:12+00:00",
      "author": "Peter80",
      "content": "\u003e I think your desired output should appear. Please try.\n\nI got this output:\n\n```\n\\\\.\\PHYSICALDRIVE0 (Hitachi HTS542516K9SA00 ATA Device) HDIndex:0 HDCount:1\n Logical Drives:4\n Disk #0, Partition #0 | \\Disk1\\Partition1  C:\n Disk #0, Partition #1 | \\Disk1\\Partition2  G:\n Disk #0, Partition #2 | \\Disk1\\Partition3  D:   Local Disc\n  E:\n```\n\nAlso, drive E: is a partition, not CD-ROM:\n\n```\nDISKPART\u003e list volume\n\n  Volume ###  Ltr  Label        Fs     Type        Size     Status     Info\n  ----------  ---  -----------  -----  ----------  -------  ---------  --------\n  Volume 0     F                       DVD-ROM         0 B  No Media\n  Volume 1     C                NTFS   Partition     15 GB  Healthy    System\n* Volume 2     G                RAW    Partition   3416 MB  Healthy\n  Volume 3     D   Local Disc   NTFS   Partition     62 GB  Healthy\n  Volume 4     E                NTFS   Partition     67 GB  Healthy\n```\n\n\u003cbr /\u003e\n\n"
    },
    {
      "id": "189664",
      "timestamp": "2015-01-04T17:37:00+00:00",
      "author": "Zharif",
      "content": "Sorry, I see.\n\nBut furthermore it seems I misunderstood the code structure of the vbs.\n\nPlease try the attached new version with more extensive output.\n\nMain problem is to display all the desired results in a proper way.\n\nBut to go sure the original vbs is working correctly - would you please download it from the url below?\n\nCheck if drives, partitions and volumes are displayed correctly.\n\nOpen a command prompt and execute the original ShowDrives.vbs with: cscript //nologo showdrives.vbs.\n\nLink:\n\n[https://gallery.tech...of-all-2a738404](https://gallery.technet.microsoft.com/scriptcenter/Shows-an-Overview-of-all-2a738404 \"External link\")\n\nMy attached file is a vbs file.\n\nChange file extension to vbs and follow the steps above.\n\n#### Attached Files {#attach_wrap}\n\n* [![Attached File](http://reboot.pro/public/style_extra/mime_types/txt.gif)](http://reboot.pro/index.php?s\u003d8de5ad0a82a492e5c3a4b802c2ab42fd\u0026app\u003dcore\u0026module\u003dattach\u0026section\u003dattach\u0026attach_id\u003d15265 \"Download attachment\") [**test.txt**](http://reboot.pro/index.php?s\u003d8de5ad0a82a492e5c3a4b802c2ab42fd\u0026app\u003dcore\u0026module\u003dattach\u0026section\u003dattach\u0026attach_id\u003d15265 \"Download attachment\") **2.5KB** 423 downloads\n\n"
    },
    {
      "id": "189666",
      "timestamp": "2015-01-04T19:15:30+00:00",
      "author": "Peter80",
      "content": "The output from the original ShowDrives.vbs seems to be with no errors:\n\n```\n+++++++ Hitachi HTS542516K9SA00 ATA Device (\\\\.\\PHYSICALDRIVE0) ++++++++\n\nIndex:               0\nInterface Type:      IDE\nStatus:              OK\nCapacity:            149.048 GiB\nTo the decimal base: 160.039 GB\nBytes Per Sector:    512 Byte\nTotal Sectors:       312576705\nTotal Cylinders:     19457\nTotal Heads:         255\nTotal Tracks:        4961535\nSectors Per Track:   63\nTracks Per Cylinder: 255\nCapabilities:        Random Access\n                     Supports Writing\n                     SMART Notification\nManufacturer:        (Standard disk drives)\nMedia Type:          Fixed hard disk media\nNum Logical Drives:  4\nSignature:           32FC1A2F\n\nSCSI Bus:            0\nSCSI Logical Unit:   0\nSCSI TargetId:       0\nSCSI Port:           2\n\n    ---------------------- Disk #0, Partition #0 -----------------------\n\n        Type:     Installable File System\n\n        Capacity: 16,125.00 MiB\n\n        4KAligned: True\n\n        This is a primary partition.\n        Computer can be booted from this partition.\n        OS is using this active partition for boot.\n\n        ~~~~~~~~~~~~~~~~~~~~~~~~ Logical Drives ~~~~~~~~~~~~~~~~~~~~~~~~\n\n            C:\n            Filesystem: NTFS\n            Tot. Space: 16125 MiB\n            Free Space: 1117.31 MiB\n\n\n    ---------------------- Disk #0, Partition #1 -----------------------\n\n        Type:     Installable File System\n\n        Capacity: 3,416.00 MiB\n\n        4KAligned: True\n\n        This is a primary partition.\n\n        ~~~~~~~~~~~~~~~~~~~~~~~~ Logical Drives ~~~~~~~~~~~~~~~~~~~~~~~~\n\n            G:\n            Filesystem: Not ready.\n\n\n    ---------------------- Disk #0, Partition #2 -----------------------\n\n        Type:     Extended w/Extended Int 13\n\n        Capacity: 133,083.87 MiB\n\n        4KAligned: False\n\n\n        ~~~~~~~~~~~~~~~~~~~~~~~~ Logical Drives ~~~~~~~~~~~~~~~~~~~~~~~~\n\n            D:          Local Disc\n            Filesystem: NTFS\n            Tot. Space: 64286 MiB\n            Free Space: 537.05 MiB\n\n\n            E:\n            Filesystem: NTFS\n            Tot. Space: 68793.99 MiB\n            Free Space: 3176.52 MiB\n\n```\n\nBut if i try to run the attached .vbs script i got this error:\n\n```\nInput Error: There is no script engine for file extension \".bat\".\n```\n\n\u003cbr /\u003e\n\n**Edited by Peter80, 04 January 2015 - 07:16 PM.**\n"
    },
    {
      "id": "189667",
      "timestamp": "2015-01-04T19:23:02+00:00",
      "author": "Zharif",
      "content": "These are very good news.\n\nTry my script.\n\n- download\n\n- change file extension to vbs\n\n- execute by typing: cscript //nologo test.vbs\n\n"
    },
    {
      "id": "189668",
      "timestamp": "2015-01-04T20:45:27+00:00",
      "author": "Peter80",
      "content": "\u003e - change file extension to vbs\n\u003e\n\u003cbr /\u003e\n\nSorry, my mistake, i previously used .bat for extension.\n\nThis is the output i got now:\n\n```\n\\\\.\\PHYSICALDRIVE0 (Hitachi HTS542516K9SA00 ATA Device)\n Index:              0\n Media Type:         Fixed hard disk media\n Logical Drives:     4\n\n Disk #0, Partition #0\n Type:               Installable File System\n\n Logical Drives:\n VolumeLetter:       C:\n VolumeName:\n Filesystem:         NTFS\n\n\n Disk #0, Partition #1\n Type:               Installable File System\n\n Logical Drives:\n VolumeLetter:       G:\n VolumeName:\n Filesystem:         Not ready.\n\n\n Disk #0, Partition #2\n Type:               Extended w/Extended Int 13\n\n Logical Drives:\n VolumeLetter:       D:\n VolumeName:         Local Disc\n Filesystem:         NTFS\n\n VolumeLetter:       E:\n VolumeName:\n Filesystem:         NTFS\n```\n\n\u003cbr /\u003e\n\n"
    },
    {
      "id": "189670",
      "timestamp": "2015-01-04T21:02:21+00:00",
      "author": "Zharif",
      "content": "Your output looks promising.\n\nPlease give me some time to modify the output properly.\n\nWhat output style do you prefer?\n\nData (Device/PartitionID, VolumeLetter, VolumeName) in one Column or in one or two rows?\n\nDo you need some more info to display?\n\n\u003cbr /\u003e\n\n"
    },
    {
      "id": "189671",
      "timestamp": "2015-01-05T01:55:41+00:00",
      "author": "Zharif",
      "content": "Okay Peter80, new vbs with (hopefully) optimised code.\n\nPlease report.\n\n#### Attached Files {#attach_wrap}\n\n* [![Attached File](http://reboot.pro/public/style_extra/mime_types/txt.gif)](http://reboot.pro/index.php?s\u003d8de5ad0a82a492e5c3a4b802c2ab42fd\u0026app\u003dcore\u0026module\u003dattach\u0026section\u003dattach\u0026attach_id\u003d15268 \"Download attachment\") [**ZShowDrives.txt**](http://reboot.pro/index.php?s\u003d8de5ad0a82a492e5c3a4b802c2ab42fd\u0026app\u003dcore\u0026module\u003dattach\u0026section\u003dattach\u0026attach_id\u003d15268 \"Download attachment\") **1.77KB** 519 downloads\n\n"
    },
    {
      "id": "189675",
      "timestamp": "2015-01-05T09:23:42+00:00",
      "author": "Peter80",
      "content": "\u003e Okay Peter80, new vbs with (hopefully) optimised code.\n\u003e\n\u003e Please report.\n\nI got error when running the script:\n\n[![fz5eBZjl.jpg](http://i.imgur.com/fz5eBZjl.jpg)](http://i.imgur.com/fz5eBZj.jpg \"External link\")\n\n\u003e \u003cbr /\u003e\n\u003e\n\u003e \u003cbr /\u003e\n\u003e\n\u003e Your output looks promising.\n\u003e\n\u003e Please give me some time to modify the output properly.\n\u003e\n\u003e What output style do you prefer?\n\u003e\n\u003e Data (Device/PartitionID, VolumeLetter, VolumeName) in one Column or in one or two rows?\n\u003e\n\u003e Do you need some more info to display?\n\nDo the output as it more easy for you. I don\u0027t have special preferences.\n\nThis info will be enough.\n\n"
    },
    {
      "id": "189676",
      "timestamp": "2015-01-05T09:43:28+00:00",
      "author": "Zharif",
      "content": "Post edited:\n\nThis is, because you double-cklicked it.\n\nLines 8+9 prevent the script from beeing executed outside the command prompt.\n\nOpen command prompt and type: cscript /nologo ZShowDrives.vbs\n\n"
    },
    {
      "id": "189679",
      "timestamp": "2015-01-05T11:32:01+00:00",
      "author": "Peter80",
      "content": "I forget about cscript //nologo. This is the output i got:\n\n```\nE:\\Desktop\u003ecscript //nologo ZShowDrives.vbs\n\n\n\\\\.\\PHYSICALDRIVE0 (Hitachi HTS542516K9SA00 ATA Device)\n    Disk #0, Partition #0 | (\\Disk1\\Partition1)  C:\n    Disk #0, Partition #1 | (\\Disk1\\Partition2)  G:\n    Disk #0, Partition #2 | (\\Disk1\\Partition3)  D:\n    Disk #0, Partition #2 | (\\Disk1\\Partition3)  E:\n```\n\n\u003cbr /\u003e\n\n"
    },
    {
      "id": "189683",
      "timestamp": "2015-01-05T16:15:13+00:00",
      "author": "Zharif",
      "content": "Not okay?\n\n- LogicalDisk DeviceID C: is associated with the first partition of the first diskdrive\n\n- LogicalDisk DeviceID G: is associated with the second partition of the first diskdrive\n\n- LogicalDisk DeviceID\u0027s D: and E: are associated with the third partition of the first diskdrive,\n\nwhich is in fact ONE extended partition containing TWO logical disks\n\n(Wonko and/or other experts, correct me if I\u0027m wrong).\n\n"
    },
    {
      "id": "189688",
      "timestamp": "2015-01-05T19:59:38+00:00",
      "author": "Wonko the Sane",
      "content": "A side note about disks/partitions numbering.  \n\nWindows NT numbers disks starting at 0 (First disk is 0) and partitions as 0 (First partition on any disk is 0) BUT ONLY in SOME paths/notations, while disks ALWAYS start from 0, partitions in some notations start from 1, the first partition on first disk, i.e. \\\\\\\\.\\\\Physicaldrive0 is:  \nDisk #0, Partition #0  \n\\\\\\\\?\\\\Device\\\\Harddisk0\\\\Partition1  \n\\\\\\\\?\\\\Device\\\\HarddiskVolume1  \nmulti(0)disk(0)rdisk(0)partition(1)  \n\nThe partition entries in the MBR have been traditionally numbered base 0, i.e. first partition entry is partition entry #0.  \n\nLinux numbers disks starting from 0 and partitions starting from 1.  \n\nGRUB (the \"real\" thing, now senselessly called GRUB Legacy\") and grub4dos use partition entries to number partitions, thus first partition on a disk is \"the partition which addresses are in partition entry #0).  \n\nGRUB2 (the new thingy now senselessly called GRUB and creating more confusion than needed) adopts for compatibility with Linux the partition numbering from 1, but uses additionally a new rather unuseful/unneededly complex naming, depending on the type of the partition.  \n\nSome nice mismatching may additionally happen when (IF) the order of partition entries in the MBR (and possibly even in the EMBR chain) is not the same as the disk layout.  \n\n@Zharif  \nSee if the little batch attach would do :wink:.  \n\n![:duff:](http://reboot.pro/public/style_emoticons/default/duff.gif)  \nWonko  \n\n#### Attached Files {#attach_wrap}\n\n* [![Attached File](http://reboot.pro/public/style_extra/mime_types/zip.gif)](http://reboot.pro/index.php?s\u003d8de5ad0a82a492e5c3a4b802c2ab42fd\u0026app\u003dcore\u0026module\u003dattach\u0026section\u003dattach\u0026attach_id\u003d15271 \"Download attachment\") [**zdrivesOR.zip**](http://reboot.pro/index.php?s\u003d8de5ad0a82a492e5c3a4b802c2ab42fd\u0026app\u003dcore\u0026module\u003dattach\u0026section\u003dattach\u0026attach_id\u003d15271 \"Download attachment\") **971bytes** 386 downloads\n\n"
    },
    {
      "id": "189691",
      "timestamp": "2015-01-05T21:51:20+00:00",
      "author": "Zharif",
      "content": "\u003e Some nice mismatching may additionally happen when (IF) the order of partition entries in the MBR (and possibly even in the EMBR chain) is not the same as the disk layout.\n\u003e\nThis exactly is the reason for my delay in posting.\n\nI surely know, this story is old for you, but I just investigated drive/partition info since one day only.\n\nI connected an external USB-Drive to my PC and formatted it with a similar layout as Peter80 (MBR, two primary ones; order \\\u003cN: O:\\\u003eand one extended as a container for two partitions; order \\\u003cP and Q:\\\u003e).\n\nBy changing driveletters, the interesting thing is that mismatch occurs on the extended partition only.\n\n- Changing the drive letters of the two first partitions (e.g. O: N:) results in the same output for our scripts.\n\nIt seems that alphabetical order is ignored - DeviceID doesn\u0027t change.\n\n- Changing the drive letters inside the container (e.g. Q: P:) results in a change of the DeviceID.\n\nIt should not. In this case the alphabetical order of the driveletter seems to be relevant.\n\n- On my two fixed harddrives (GPT each with two partitions) no mismatch occurs by changing the driveletters.\n\n- Till now I didn\u0027t test results if you remove a driveletter.\n\nNormally, it wouldn\u0027t be a problem to simply count the logical drives found in the container.\n\nBut using wmi on a HD using the MBR partition table, the order for logical drives inside the container seems to change and will lead to false positive results.\n\n\u003e Disk #0, Partition #0  \n\u003e \\\\\\\\?\\\\Device\\\\Harddisk0\\\\Partition1  \n\u003e \\\\\\\\?\\\\Device\\\\HarddiskVolume1  \n\u003e multi(0)disk(0)rdisk(0)partition(1)\n\u003e\nIn regard to extended partitions, the last one seems to be the most reliable one cause it seems to be the only one providing info about an existing container partition.?\n\nSo, by by WMI???\n\nI know that api calls such as DosDevices(W), DeviceIO functions will access the harddrive/partition info.\n\nAt least I wonder how external software, such as partitioning software access the drives correctly.\n\nUsing api only or wmi? In regard of the observed wmi-behaviour, the latter seems to be a bad choice.\n\nThanks for explaination and your script.\n\nI would prefer to use \"OR\", rather than \"Z\". :-)\n\nI didn\u0027t know that the assoc statement could be directly put into commandline (should have read some more about the wmic syntax).\n\n@Peter80\n\nUse Wonkos\u0027 script.\n\nBut if you like, I could wrap the vbs into a batch and change the output in a similar/same way as Wonko did.\n\nYour choice...\n\n"
    },
    {
      "id": "189692",
      "timestamp": "2015-01-05T22:57:25+00:00",
      "author": "Zharif",
      "content": "Wonko,\n\nI did a closer look at your script\n\n\u003e ::- Find Hard disk partition, NT device, drive letter (IF any) corresponding  \n\u003e ::_ Handcrafted in order to comply with Occam\u0027s Razor and slightly obfuscated  \n\u003e ::_ for No reason but for the fun of doing it  \n\u003e ::_ (deobfuscationg it would be a good exercise for a batch writer)  \n\u003e ::_ by jaclaz on January 5, 2015\n\u003e\n\u003e ;IF %1.\u003d\u003d/?. CALL :-\n\u003e\n\u003e :_  \n\u003e ;IF %2.\u003d\u003d. FOR /F \"tokens\u003d\\*\" %%? IN (\u0027Type %\\~dpnx0\\^\\|FIND \"::-\"\\^\\|FIND /V \"FIND\"\u0027) DO ECHO %%?\\\u0026CALL :_ %%?\\\u0026GOTO :EOF\n\u003e\nSo cool, very nice. Lesson completed.\n\nI still have to investigate your \"SET /A $\u003d\" statement and the carets in the For /F loops.\n\nNotes:\n\nI interpret your \"comments\" as a personal request.\n\nBut Ockham? I was in the need to read some of his work in regard of medical scientific theory.\n\nAnyway, I like your comparison.\n\nZharif\n\n"
    },
    {
      "id": "189696",
      "timestamp": "2015-01-06T08:50:29+00:00",
      "author": "Peter80",
      "content": "\u003e @Peter80  \n\u003e\n\u003e Use Wonkos\u0027 script.\n\u003e\n\u003e But if you like, I could wrap the vbs into a batch and change the output in a similar/same way as Wonko did.\n\u003e\n\u003e Your choice...\n\nIt doesn\u0027t seem to detect all partitions, partition D: is missing:\n\n```\nE:\\Desktop\\zdrivesOR\u003ezdrivesOR.cmd\n::- Find Hard disk partition, NT device, drive letter (IF any) corresponding\nDisk#0, Partition #0 -\u003e \\HardDisk0\\Partition1 -\u003e C:\nDisk#0, Partition #1 -\u003e \\HardDisk0\\Partition2 -\u003e G:\nDisk#0, Partition #2 -\u003e \\HardDisk0\\Partition3 -\u003e E:\n```\n\n\u003cbr /\u003e\n\n"
    },
    {
      "id": "189697",
      "timestamp": "2015-01-06T09:30:38+00:00",
      "author": "Zharif",
      "content": "Yes, I see.\n\nWhile trying to \"deobfuscate\" Wonkos script I found out the error.\n\nHis script stores the DeviceID\u0027s as environmental variables.\n\nAlthough you have at least four partitions, only three DeviceID\u0027s are written to the environment (two primaries, and one extended).\n\nThe loop to get the associated driveletters works as expected, but cause wmic finds four driveletters one will be overwritten.\n\nThis is Wonkos script. It\u0027s his turn to correct this. I still didn\u0027t completed \"deobfuscation\".\n\nFurthermore real life (work) was calling me since yesterday. My spare time becomes limited.\n\n"
    },
    {
      "id": "189698",
      "timestamp": "2015-01-06T11:17:22+00:00",
      "author": "Wonko the Sane",
      "content": "Well, it was just some fun. :smile:\n\nthe \"clear\" batch is not really a batch, it is just a bunch of lines, three for loops, only to show how for simple things a simple batch can compete with the much more complex .vbs script (winning hands down :wink: when it comes to go through Ockham\u0027s Razor, or more plainly using the KISS principle).\n\nFind it attached in a simple, clear form.\n\nThe issue here is that - as often happens - there is the usual confusion between partitions, volumes and the \"whatever\" that gets a drive letter assigned in Windows NT, see also:\n\n[http://cquirke.mvps....x/partition.htm](http://cquirke.mvps.org/9x/partition.htm \"External link\")\n\nThe WMI path Win32_DiskPartition lists partitions (and **not** volumes/drives).\n\n\"starting\" with it means to have \"false\" results if an extended partition is involved, as what is found and expressed as:\n\nDisk #*m* , Partition #*n*\n\nis the disk # and the partition entry slot # in the MBR, and the extended partition (that may contain one or a zillion volumes) occupies a slot, independently from the number of volumes in it, and the \"trick\" of creating a \\\\Harddisk*m* \\\\partition*(n+1)* with that data fails miserably. ![:(](http://reboot.pro/public/style_emoticons/default/sad.png)\n\nON th eother hand, a volume that has not a drive letter assigned is not (according to the good MS guys and WMI) a logicalvolume, so it is \"transparent\" to WMI Path Win32_LogicalDiskToPartition or to Win32_LogicalDisk.\n\nAs hinted before, and AFAIK, WMI - at least in XP - simply misses some needed info, and there is the need to use another approach (or a mixed one making use of other built in programs, like Diskpart - which has it\u0027s own \"quirks\" and/or mountvol and/or fsutil, etc.).\n\n![:duff:](http://reboot.pro/public/style_emoticons/default/duff.gif)\n\nWonko\n\n#### Attached Files {#attach_wrap}\n\n* [![Attached File](http://reboot.pro/public/style_extra/mime_types/zip.gif)](http://reboot.pro/index.php?s\u003d8de5ad0a82a492e5c3a4b802c2ab42fd\u0026app\u003dcore\u0026module\u003dattach\u0026section\u003dattach\u0026attach_id\u003d15272 \"Download attachment\") [**mydrivesOR.zip**](http://reboot.pro/index.php?s\u003d8de5ad0a82a492e5c3a4b802c2ab42fd\u0026app\u003dcore\u0026module\u003dattach\u0026section\u003dattach\u0026attach_id\u003d15272 \"Download attachment\") **466bytes** 385 downloads\n\n"
    },
    {
      "id": "189699",
      "timestamp": "2015-01-06T12:46:07+00:00",
      "author": "Zharif",
      "content": "\u003cbr /\u003e\n\n\u003e \u003cbr /\u003e\n\u003e\n\u003e The WMI path Win32_DiskPartition lists partitions (and **not** volumes/drives).\n\nMy fault - I know. Inaccurate phrasing, so sorry.\n\nI got my info from your provided link and from here (german):\n\n[http://windows.micro...-logical-drives](http://windows.microsoft.com/de-de/windows-vista/what-are-partitions-and-logical-drives \"External link\")\n\nTell me, is it correct to denote one extended partition as one \"container partition\" for volumes (requirement: driveletter assigned)?\n\nAnd in regard to an extended partition that contains e.g. two volumes -\n\nwhat about this output/writing:\n\nDisk #0, Partition #0 \\| (\\\\Disk0\\\\Partition1) C:  \nDisk #0, Partition #1 \\| (\\\\Disk0\\\\Partition2) G:  \nDisk #0, Partition #2 \\| (\\\\Disk0\\\\Partition3\\\\Volume1) D:  \nDisk #0, Partition #2 \\| (\\\\Disk0\\\\Partition3\\\\Volume2) E:\n\nAbout WMI and XP:\n\nI tested the vbs on XP, Vista and Win8.1.\n\nAliases\u0027 diskdrive, logicaldisk and partition are available as well as their associated entries for DeviceID, Caption, Index and DiskIndex. As far as I understood, nothing more is needed here.\n\nBut anayway, my posted issue about alternating DiskDrive.DeviceID\u0027s will still persist.\n\n\u003cbr /\u003e\n\n"
    },
    {
      "id": "189701",
      "timestamp": "2015-01-06T13:44:12+00:00",
      "author": "Zharif",
      "content": "Here is the new script.\n\nBack to the roots - it\u0027s a cmd file and must be executed inside the command prompt.\n\n- open command prompt\n\n- type: ZShowDrives.cmd\n\nCreates the vbs, runs and deletes it.\n\nOutput is sorted (I put everything in a collection object) in three notations.\n\nIt (should) look like this:\n\nDisk #0, Partition #0 --\\\u003e \\\\Disk0\\\\Partition1 --\\\u003e \\\\Disk0\\\\Partition1\\\\Volume1 C:  \nDisk #0, Partition #1 --\\\u003e \\\\Disk0\\\\Partition2 --\\\u003e \\\\Disk0\\\\Partition2\\\\Volume1 D:  \nDisk #0, Partition #2 --\\\u003e \\\\Disk0\\\\Partition3 --\\\u003e \\\\Disk0\\\\Partition3\\\\Volume1 E:  \nDisk #0, Partition #2 --\\\u003e \\\\Disk0\\\\Partition3 --\\\u003e \\\\Disk0\\\\Partition3\\\\Volume2 G:\n\nPeter80, please report.  \n\n#### Attached Files {#attach_wrap}\n\n* [![Attached File](http://reboot.pro/public/style_extra/mime_types/txt.gif)](http://reboot.pro/index.php?s\u003d8de5ad0a82a492e5c3a4b802c2ab42fd\u0026app\u003dcore\u0026module\u003dattach\u0026section\u003dattach\u0026attach_id\u003d15277 \"Download attachment\") [**ZShowDrives.txt**](http://reboot.pro/index.php?s\u003d8de5ad0a82a492e5c3a4b802c2ab42fd\u0026app\u003dcore\u0026module\u003dattach\u0026section\u003dattach\u0026attach_id\u003d15277 \"Download attachment\") **3.45KB** 500 downloads\n\n"
    },
    {
      "id": "189702",
      "timestamp": "2015-01-06T14:05:43+00:00",
      "author": "Wonko the Sane",
      "content": "\u003e Tell me, is it correct to denote one extended partition as one \"container partition\" for volumes (requirement: driveletter assigned)?\n\nYep ![:thumbsup:](https://reboot.pro/public/style_emoticons/default/thumbsup.gif), if you want it more \"expanded\" see this thread starting from around here:  \n[http://reboot.pro/to...e-4#entry122274](http://reboot.pro/topic/13676-the-boot-process-a-step-by-step-approach-to-booting/page-4#entry122274 \"\")  \nand the \"final statement\" here:  \n[http://reboot.pro/to...e-6#entry123056](http://reboot.pro/topic/13676-the-boot-process-a-step-by-step-approach-to-booting/page-6#entry123056 \"\")  \nand check also this where the matter is *re-* discussed.  \n[http://reboot.pro/to...isk-management/](http://reboot.pro/topic/20011-gui-command-line-and-disk-management/ \"\")\n\nDon\u0027t worry :smile:, it ***is*** complex, and a large part of computer users and even of those considering themselves \"advanced\" computer users have this not fully clear.  \n\n\u003e And in regard to an extended partition that contains e.g. two volumes -  \n\u003e what about this output/writing:  \n\u003e Disk #0, Partition #0 \\| (\\\\Disk0\\\\Partition1) C:  \n\u003e Disk #0, Partition #1 \\| (\\\\Disk0\\\\Partition2) G:  \n\u003e Disk #0, Partition #2 \\| (\\\\Disk0\\\\Partition3\\\\Volume1) D:  \n\u003e Disk #0, Partition #2 \\| (\\\\Disk0\\\\Partition3\\\\Volume2) E:\n\nWell, **no** .  \nYou cannot invent syntax/paths. ![:w00t:](https://reboot.pro/public/style_emoticons/default/w00t.gif) ![:ph34r:](https://reboot.pro/public/style_emoticons/default/scared9.gif)\n\nExample:  \nPhysicalDrive6  \nFirst partition is primary and has letter K: associated to the volume inside it  \nSecond partition is Extended and contains TWO volumes.  \nFirst volume in Second (Extended) partition has letter L: associated  \nSecond volume in Second (Extended) partition has letter M: associated  \nThird partition is primary and has letter U: associated to the volume inside it\n\nFind attached what comes out using dd --list (snippet) right after having created the disk/partition and after having fiddled a bit with other disks/volumes, having unmounted and remounted the disk (in the same session, i.e. without rebooting), Harddiskvolume# change, but NT block objects remain the same:  \nK: \\\\\\\\?\\\\Device\\\\Harddisk6\\\\Partition1 \\\\\\\\?\\\\Device\\\\HarddiskVolume6  \nL: \\\\\\\\?\\\\Device\\\\Harddisk6\\\\Partition3 \\\\\\\\?\\\\Device\\\\HarddiskVolume8  \nM: \\\\\\\\?\\\\Device\\\\Harddisk6\\\\Partition4 \\\\\\\\?\\\\Device\\\\HarddiskVolume9  \nU: \\\\\\\\?\\\\Device\\\\Harddisk6\\\\Partition2 \\\\\\\\?\\\\Device\\\\HarddiskVolume7  \n\nBecome:  \nK: \\\\\\\\?\\\\Device\\\\Harddisk6\\\\Partition1 \\\\\\\\?\\\\Device\\\\HarddiskVolume24  \nL: \\\\\\\\?\\\\Device\\\\Harddisk6\\\\Partition3 \\\\\\\\?\\\\Device\\\\HarddiskVolume26  \nM: \\\\\\\\?\\\\Device\\\\Harddisk6\\\\Partition4 \\\\\\\\?\\\\Device\\\\HarddiskVolume27  \nU: \\\\\\\\?\\\\Device\\\\Harddisk6\\\\Partition2 \\\\\\\\?\\\\Device\\\\HarddiskVolume25  \n\n**BUT** IF I remove the third partition, unmount and remount I get:  \nK: \\\\\\\\?\\\\Device\\\\Harddisk6\\\\Partition1 \\\\\\\\?\\\\Device\\\\HarddiskVolume28  \nL: \\\\\\\\?\\\\Device\\\\Harddisk6\\\\Partition2 \\\\\\\\?\\\\Device\\\\HarddiskVolume29  \nM: \\\\\\\\?\\\\Device\\\\Harddisk6\\\\Partition3 \\\\\\\\?\\\\Device\\\\HarddiskVolume30  \n\nAre you starting to see a pattern? ![:unsure:](https://reboot.pro/public/style_emoticons/default/unsure.png)  \n\n![:duff:](https://reboot.pro/public/style_emoticons/default/duff.gif)  \nWonko  \n\n#### Attached Files {#attach_wrap}\n\n* [![Attached File](http://reboot.pro/public/style_extra/mime_types/zip.gif)](http://reboot.pro/index.php?s\u003dfbf7fa11bd4f978129df2a0786582390\u0026app\u003dcore\u0026module\u003dattach\u0026section\u003dattach\u0026attach_id\u003d15278 \"Download attachment\") [**myddlist_1.zip**](http://reboot.pro/index.php?s\u003dfbf7fa11bd4f978129df2a0786582390\u0026app\u003dcore\u0026module\u003dattach\u0026section\u003dattach\u0026attach_id\u003d15278 \"Download attachment\") **705bytes** 396 downloads\n\n"
    },
    {
      "id": "189703",
      "timestamp": "2015-01-06T14:47:42+00:00",
      "author": "Peter80",
      "content": "\u003e Peter80, please report.\n\nThis is the output:\n\n```\nE:\\Desktop\u003eZShowDrives.bat\n\nDisk #0, Partition #0 --\u003e \\Disk0\\Partition1 --\u003e \\Disk0\\Partition1\\Volume1  C:\nDisk #0, Partition #2 --\u003e \\Disk0\\Partition3 --\u003e \\Disk0\\Partition3\\Volume1  D:\nDisk #0, Partition #2 --\u003e \\Disk0\\Partition3 --\u003e \\Disk0\\Partition3\\Volume2  E:\nDisk #0, Partition #1 --\u003e \\Disk0\\Partition2 --\u003e \\Disk0\\Partition2\\Volume1  G:\n```\n\n\u003cbr /\u003e\n\n"
    },
    {
      "id": "189705",
      "timestamp": "2015-01-06T15:52:50+00:00",
      "author": "Wonko the Sane",
      "content": "\u003e This is the output:\n\u003e\n... which is - as said before - an \"invented\" notation, as useful to get the right path for Truecrypt (which was the original question) as a bicycle is to a fish, particularly when it is snowing:\n\n![fish-on-a-bicycle-o.gif](http://stream1.gifsoup.com/view7/2885522/fish-on-a-bicycle-o.gif)\n\n![:duff:](https://reboot.pro/public/style_emoticons/default/duff.gif)\n\nWonko\n\n"
    },
    {
      "id": "189707",
      "timestamp": "2015-01-06T16:16:50+00:00",
      "author": "Zharif",
      "content": "Wonko,\n\nyour first answer reliefs me.\n\nI went through your provided links and at first glance I think I understood the usage of terms\n\n(common problem is to keep the correct terminology in mind if you don\u0027t use it often).\n\nAbout your second answer:\n\nI didn\u0027t try to invent a new syntax.\n\nMy simple intent was to find a method to track somehow that a partition which appears more than once in the output must? be an extended one.\n\nBut you\u0027re completely right - my spelling method implies a common syntax, which is certainly wrong.\n\nI should have used a short, additional info string - nothing else.\n\nFurthermore, and in accordance to your links I should have used the term of \"logical drive\" rather than \"Volume\".\n\nWill remove this in the next version of the script.\n\nAbout your question:\n\nI see that inside one logon session the HarddiskVolume Nr. is reserved/stored somehow whenever you mount a logical drive.\n\nDismounting it does not discard the stored HarddiskVolume Nr.\n\nMoreover, whenever you remount a logical drive the next free available Nr. in ascending order will be used/assigned?\n\nIt\u0027s some kind of up-counting.?\n\nWhat is the value of this notation \"\\\\\\\\?\\\\Device\\\\HarddiskVolume24\" as used in dd?\n\nBy (up-)counting the HarddiskVolume\\\u003cn\\\u003e no useful info about the partition is provided, although the other two lines link to the type and the assigned driveletter (e.g. \"fixed media\" and \"Mounted on \\\\\\\\.\\\\k:\").\n\nWith the feel of a scholar, I suppose that this notation \"Disk #0, Partition #0 \\| (\\\\Disk0\\\\Partition1)\" is much more useful to retrieve the logical drive(s) (mounted) associated with the corresponding partition(s) that refer(s) to the corresponding harddisk(s).\n\nAnd - thanks much for your patience so far.\n\n"
    },
    {
      "id": "189710",
      "timestamp": "2015-01-06T17:47:12+00:00",
      "author": "Wonko the Sane",
      "content": "Yep, it\u0027s tricky business ![:(](https://reboot.pro/public/style_emoticons/default/sad.png).\n\nA further hint.\n\nThe Disk #0, Partition #0 kind of syntax is \"objective\" and simply respects the physical position of the partition entries in the MBR of each disk.\n\nAll the other notations are somehow \"volatile\" or \"subjective\", in the sense that when a Windows NT system is booted (or a device is added to it or the partitioning/formatting of the device is changed) disks are \"scanned\" (by the mount manager or \\*whatever\\*) and a number of \"links\" are created, the actual number of the volume that has drive letter L:\\\\ in my above last example changes because the \"situation\" of the device changed.\n\nWindows NT \"senses\" that a new device is connected and scans it.\n\nIt looks first thing for primary partitions, hence \"normally\" the\n\nK: \\\\\\\\?\\\\Device\\\\Harddisk6\\\\Partition1\n\nwill always be true (first primary)\n\nand if there is a second primary, it gets #2:  \nU: \\\\\\\\?\\\\Device\\\\Harddisk6\\\\Partition2\n\nand consequently the volumes inside extended get #3 and #4:\n\nL: \\\\\\\\?\\\\Device\\\\Harddisk6\\\\Partition3  \nM: \\\\\\\\?\\\\Device\\\\Harddisk6\\\\Partition4\n\nIf I remove the second primary and remount I get:\n\nK: \\\\\\\\?\\\\Device\\\\Harddisk6\\\\Partition1  \nL: \\\\\\\\?\\\\Device\\\\Harddisk6\\\\Partition2  \nM: \\\\\\\\?\\\\Device\\\\Harddisk6\\\\Partition3\n\nand when I recreate the second primary I get obviously:\n\nK: \\\\\\\\?\\\\Device\\\\Harddisk6\\\\Partition1  \nL: \\\\\\\\?\\\\Device\\\\Harddisk6\\\\Partition2  \nM: \\\\\\\\?\\\\Device\\\\Harddisk6\\\\Partition3\n\nU: \\\\\\\\?\\\\Device\\\\Harddisk6\\\\Partition4\n\nBUT if I unmount and remount the device I get back obviously:\n\nK: \\\\\\\\?\\\\Device\\\\Harddisk6\\\\Partition1\n\nU: \\\\\\\\?\\\\Device\\\\Harddisk6\\\\Partition2\n\nL: \\\\\\\\?\\\\Device\\\\Harddisk6\\\\Partition3  \nM: \\\\\\\\?\\\\Device\\\\Harddisk6\\\\Partition4\n\nSee also how drive letters are automatically assigned (which is slightly different between DOS and NT, to further make things more difficult):\n\n[http://www.msfn.org/...n-why/?p\u003d581082](http://www.msfn.org/board/topic/85729-drive-letters-shifted-when-i-add-a-2nd-hd-w1-logical-partition-why/?p\u003d581082 \"External link\")\n\nAnd drive letters are \"kept\" and assigned/reassigned (for \"known\" volumes) using yet another approach (Disk Signature + Offset) see:\n\n[http://www.911cd.net...showtopic\u003d19663](http://www.911cd.net/forums//index.php?showtopic\u003d19663 \"External link\")\n\nAnd we have not even slightly touched Dynamic disks ![:w00t:](https://reboot.pro/public/style_emoticons/default/w00t.gif) ![:ph34r:](https://reboot.pro/public/style_emoticons/default/scared9.gif) or the stupid GPT scheme, as a matter of fact the GPT has only 1 (one) **smart** ![:thumbsup:](https://reboot.pro/public/style_emoticons/default/thumbsup.gif) feature, all partitions are primary so partition\u003dvolume\u003ddrive BUT (isn\u0027t there always a but?) the complication with known and unknown GUID\u0027s and permissions on them ![:frusty:](https://reboot.pro/public/style_emoticons/default/frusty.gif) creates a whole bunch of new possible issues.\n\n![:duff:](https://reboot.pro/public/style_emoticons/default/duff.gif)\n\nWonko\n\n"
    },
    {
      "id": "189721",
      "timestamp": "2015-01-07T16:22:56+00:00",
      "author": "cdob",
      "content": "\u003e I wonder:  \n\u003e does DeviceID\u003dDisk #D, Partition #P+1 matches \\\\Device\\\\HarddiskD\\\\PartitionP ?\n\n@Peter80  \nTry: cscript.exe ShowPartition.vbs  \n\n#### Attached Files {#attach_wrap}\n\n* [![Attached File](http://reboot.pro/public/style_extra/mime_types/txt.gif)](http://reboot.pro/index.php?s\u003dfbf7fa11bd4f978129df2a0786582390\u0026app\u003dcore\u0026module\u003dattach\u0026section\u003dattach\u0026attach_id\u003d15279 \"Download attachment\") [**ShowPartition.txt**](http://reboot.pro/index.php?s\u003dfbf7fa11bd4f978129df2a0786582390\u0026app\u003dcore\u0026module\u003dattach\u0026section\u003dattach\u0026attach_id\u003d15279 \"Download attachment\") **1.39KB** 509 downloads\n\n"
    },
    {
      "id": "189722",
      "timestamp": "2015-01-07T17:04:55+00:00",
      "author": "Peter80",
      "content": "\u003e @Peter80  \n\u003e Try: cscript.exe ShowPartition.vbs\n\nThis is the output:\n\n```\nE:\\Desktop\u003ecscript ShowPartition.vbs\nMicrosoft (R) Windows Script Host Version 5.8\nCopyright (C) Microsoft Corporation. All rights reserved.\n\nHitachi HTS542516K9SA00 ATA Device (\\\\.\\PHYSICALDRIVE0)\n\\Device\\Harddisk0\\Partition1    Disk #0, Partition #0    C:\n\\Device\\Harddisk0\\Partition2    Disk #0, Partition #1    G:\n\\Device\\Harddisk0\\Partition3    Disk #0, Partition #2    D: E:\n```\n\n\u003cbr /\u003e\n\n"
    },
    {
      "id": "189724",
      "timestamp": "2015-01-07T18:33:48+00:00",
      "author": "cdob",
      "content": "\u003e This is the output:  \n\u003e \\\\Device\\\\Harddisk0\\\\Partition3 Disk #0, Partition #2 D: E:\nThanks for the report. It\u0027s a broken idea and supports primary partitions only.  \nDelete the script.  \nI don\u0027t know a reliable solution within OS default files.  \nA third party tool is recommended still.   \n"
    },
    {
      "id": "189725",
      "timestamp": "2015-01-07T21:34:49+00:00",
      "author": "Zharif",
      "content": "Post edited:\n\ncdob,\n\n\u003e \u003cbr /\u003e\n\u003e\n\u003e ...It\u0027s a broken idea and supports primary partitions only.\n\nNo, it doesn\u0027t.\n\nAs mine (which is working I think), it indeed supports e.g. extended partitions.\n\nIt\u0027s simply a question WHERE you put the string variables inside the for each loops.\n\nRemember, the created objects are collections of disks, partitions and logicaldisks found by the wmi.\n\nBut because of the \"assoc\" thing it does not go through all items of the next collection (as in nested for lopps via cmd),\n\ninstead it finds/accesses the associated item directly.\n\nIt\u0027s something like this:\n\n- create collection of all drives\n\n- for the first item found in this this collection (first drive found)\u003d(for each..)\n\n- create a collection of all associated partitions refering to this drive\n\n- for the first item found in this collection (first partition found...) \u003d (nested for each statement)\n\n- create a collection of all associated logical disk refereing to this partition\n\n- for the first item found in this collection (first logical disk found) \u003d (nested for each statement)\n\n- do some action (e.g. print)\n\n- goto next logical drive\n\n- got to next partition\n\n- go to the next drive found\n\nI just came from work, my spare time is really limited, but new scripts will follow.\n\nI\u0027m very sure that it is possible to create a reliable script (in regard to wmi - and all of its issues which were previously metioned by Wonko).\n\nWonko,\n\nI made some tests (at work with WinXP home PCs :-) ), but I\u0027m unsure about the results.\n\nI wanna be dressed up a little bit before talking to you. I hope you\u0027re still willing to teach me.\n\nYou won an interested \"student\".\n\n"
    },
    {
      "id": "189727",
      "timestamp": "2015-01-07T23:37:06+00:00",
      "author": "cdob",
      "content": "\u003e It\u0027s simply a question WHERE you put the string variables inside the for each loops.  \n\u003e Remember, the created objects are collections of disks, partitions and logicaldisks found by the wmi.\nThe question is: how to translate given numbers to \\\\Device\\\\HarddiskD\\\\PartitionP layout?  \n\n[http://colinux.wikia.com/wiki/FAQ](http://colinux.wikia.com/wiki/FAQ \"External link\")  \n\u003e Note: if you only have 4 partitions on a drive, it is possible that they are all primary partitions, although this usually only happens if you do it on purpose. In that case, all 4 partitions would have the same number on Linux and Windows.  \n\u003e\n\u003e Note: it seems that the partition numbers reported by the windows diskpart.exe utility (C:\\\\Windows\\\\system32\\\\diskpart.exe) are not consistent with the partition numbers used by the operating system itself, under circumstances of extended partitions or out-of-order partition table entries.  \n\u003e\n\u003e sdb1 \u003d\\\u003e \\\\Harddisk1\\\\Partition1  \n\u003e sdb2 \u003d\\\u003e \\\\Harddisk1\\\\Partition2  \n\u003e sdb3 \u003d\\\u003e extended PT is skipped  \n\u003e sdb4 \u003d\\\u003e not existing PT is skipped  \n\u003e sdb5 \u003d\\\u003e \\\\Harddisk1\\\\Partition3 !!!!!!!!!!!!!  \n\u003e sdb6 \u003d\\\u003e \\\\Harddisk1\\\\Partition4 !!!!!!!!!!!!!  \n\u003e sdb7 \u003d\\\u003e \\\\Harddisk1\\\\Partition5 !!!!!!!!!!!!!\n\nAnother example?  \n[http://msmania.wordp.../get-wmiobject/](http://msmania.wordpress.com/tag/get-wmiobject/ \"External link\")   \n"
    },
    {
      "id": "189728",
      "timestamp": "2015-01-07T23:39:01+00:00",
      "author": "Zharif",
      "content": "This is a commandline script, originally written by Wonko in post 48.\n\nAs reported by Peter80, his script overwrites variables if an extended partition with at least TWO or more logical drives is present. This, because it stores the found partition DeviceID as variable name.\n\nI rewrote it a little bit but all credits go to Wonko.\n\nThis script needs a little bit more of code, but should store and output all logical drives of an extended partition (if mounted).\n\nI tried to document all steps at best of my knowledge, so please read and test.\n\nReports are welcome and important.  \n\n#### Attached Files {#attach_wrap}\n\n* [![Attached File](http://reboot.pro/public/style_extra/mime_types/txt.gif)](http://reboot.pro/index.php?s\u003dfbf7fa11bd4f978129df2a0786582390\u0026app\u003dcore\u0026module\u003dattach\u0026section\u003dattach\u0026attach_id\u003d15282 \"Download attachment\") [**ZDrivesOR.txt**](http://reboot.pro/index.php?s\u003dfbf7fa11bd4f978129df2a0786582390\u0026app\u003dcore\u0026module\u003dattach\u0026section\u003dattach\u0026attach_id\u003d15282 \"Download attachment\") **1.79KB** 790 downloads\n\n"
    },
    {
      "id": "189729",
      "timestamp": "2015-01-08T00:26:45+00:00",
      "author": "Zharif",
      "content": "\u003e The question is: how to translate given numbers to \\\\Device\\\\HarddiskD\\\\PartitionP layout?\n\u003e\nI hope I got your problem.\n\nJust created my new vbs script (similar to yours).\n\nI think it covers your question by the added info string.\n\nJust to give info about my hardware/disk layout:\n\nI do have three \"internal\" harddrives connected at my PC.\n\n- a SSD drive with 128GB, one primary partition, boot partition: one LogicalDrive: Letter C:\n\n- a GPT Disk with two primary partitions, logical drives each: D: and E:\n\n- a second GPT Disk with two primary partitions, logical drives each: F: and G:\n\n- a bunch of 4 Card Readers, mounted as J: K: L: M:\n\n- two optical drives, a blue ray reader (I:) and a CD/DVD burner (H:)\n\nFurthermore, I connected an USB3 drive and deleted all partitions. Then disconnect. Then reboot OS. Then reboot.\n\nWithout booting Win8.1 I created 3 partitions via bootable partition software:\n\n- 1st: Primary partition, logical drive N:\n\n- 2nd: an extended partition with two logical drives: O: P:\n\n- 3rd: a primary partition, logical drive Q:\n\nThen boot into Win8.1\n\nBy running my script (output sorted by driveletter) I get this output:\n\nE:\\\\Zharif\\\\Tools\\\\Scripting\\\\VBS\\\u003ecscript /nologo zshowdrives.vbs  \n\nC: Disk #0, Partition #0 --\\\u003e \\\\Disk0\\\\Partition1 LogicalDrv.1 of Part.1  \nD: Disk #1, Partition #0 --\\\u003e \\\\Disk1\\\\Partition1 LogicalDrv.1 of Part.1  \nE: Disk #1, Partition #1 --\\\u003e \\\\Disk1\\\\Partition2 LogicalDrv.1 of Part.2  \nF: Disk #2, Partition #0 --\\\u003e \\\\Disk2\\\\Partition1 LogicalDrv.1 of Part.1  \nG: Disk #2, Partition #1 --\\\u003e \\\\Disk2\\\\Partition2 LogicalDrv.1 of Part.2  \nN: Disk #7, Partition #0 --\\\u003e \\\\Disk7\\\\Partition1 LogicalDrv.1 of Part.1  \nO: Disk #7, Partition #1 --\\\u003e \\\\Disk7\\\\Partition2 LogicalDrv.1 of Part.2  \nP: Disk #7, Partition #1 --\\\u003e \\\\Disk7\\\\Partition2 LogicalDrv.2 of Part.2  \nQ: Disk #7, Partition #2 --\\\u003e \\\\Disk7\\\\Partition3 LogicalDrv.1 of Part.3\n\nI would say, this seems to be convenient and gives info about extended partitions that contain more than one logical drives. But as always, it needs further testing. And as so often, I do not know exactly if I\u0027ve overseen something.\n\nLook at my code - did I get your question?  \n\n#### Attached Files {#attach_wrap}\n\n* [![Attached File](http://reboot.pro/public/style_extra/mime_types/txt.gif)](http://reboot.pro/index.php?s\u003dfbf7fa11bd4f978129df2a0786582390\u0026app\u003dcore\u0026module\u003dattach\u0026section\u003dattach\u0026attach_id\u003d15283 \"Download attachment\") [**ZShowDrives.txt**](http://reboot.pro/index.php?s\u003dfbf7fa11bd4f978129df2a0786582390\u0026app\u003dcore\u0026module\u003dattach\u0026section\u003dattach\u0026attach_id\u003d15283 \"Download attachment\") **2.91KB** 451 downloads\n\n"
    },
    {
      "id": "189731",
      "timestamp": "2015-01-08T12:23:38+00:00",
      "author": "ambralivio",
      "content": "\u003e But as always, it needs further testing. And as so often, I do not know exactly if I\u0027ve overseen something.\n\n@ Zharif,\n\nI checked your script applied to my case :\n\n- First MBR disk - Primary partition (D:), Extended partition (E:), other 2 primary partitions (F: and G:)\n\n- Second MBR disk - Primary partition, boot (C:), extended partition with 4 logicals (I:, J:, K: and L:)\n\nand it does work, giving the following output :\n\nC: Disk #1, Partition #1 --\\\u003e \\\\Disk1\\\\Partition2 LogicalDrv.1 of Part.2  \nD: Disk #0, Partition #0 --\\\u003e \\\\Disk0\\\\Partition1 LogicalDrv.1 of Part.1  \nE: Disk #0, Partition #3 --\\\u003e \\\\Disk0\\\\Partition4 LogicalDrv.1 of Part.4  \nF: Disk #0, Partition #1 --\\\u003e \\\\Disk0\\\\Partition2 LogicalDrv.1 of Part.2  \nG: Disk #0, Partition #2 --\\\u003e \\\\Disk0\\\\Partition3 LogicalDrv.1 of Part.3  \nI: Disk #1, Partition #2 --\\\u003e \\\\Disk1\\\\Partition3 LogicalDrv.1 of Part.3  \nJ: Disk #1, Partition #2 --\\\u003e \\\\Disk1\\\\Partition3 LogicalDrv.2 of Part.3  \nK: Disk #1, Partition #2 --\\\u003e \\\\Disk1\\\\Partition3 LogicalDrv.3 of Part.3  \nL: Disk #1, Partition #2 --\\\u003e \\\\Disk1\\\\Partition3 LogicalDrv.4 of Part.3\n\nBut I have a question for you, that is : \\\u003c\\\u003cLoking at the Disk #1, the missing partition #0 (in the list) is due to the fact that it is really unmounted (as it is just the Reserved Partition - generally hidden ?\n\nambralivio\n\n"
    },
    {
      "id": "189736",
      "timestamp": "2015-01-08T14:39:36+00:00",
      "author": "Wonko the Sane",
      "content": "The point is still that through WMI the best that you can get is a guess (educated, but still a *guess* ) and nothing more.  \nFacts (till now seemingly ignored ![:w00t:](https://reboot.pro/public/style_emoticons/default/w00t.gif) ![:ph34r:](https://reboot.pro/public/style_emoticons/default/scared9.gif)):  \na.the Truecrypt wants a specific type of link  \nb.the specific type of link is the ++**\\\\Device\\\\Hard**++ disk***m*** \\\\Partition***n*** kind  \nc.the link is to a volume, i.e. something in the form of a GUID \\*like\\* \\\\Volume{dcb73171-341c-11e3-b06c-001fc6bb76ce}\\\\  \nd.the link is determined by 4 (four) factors\n\n* the PhysicalDrive where the volume resides (which is easy as the ***m*** in \\\\Device\\\\Harddisk***m*** \\\\Partition***n*** is the same as in the notation \\\\\\\\.\\\\Physicaldrive***m*** and in the notation Disk# ***m*** , Partition***x***)\n* the nature of the actual volume (i.e. primary partition vs. logical volume)\n* the order in which the volumes are listed in the MBR and/or EPBR chain\n* ***AND/OR*** the actual order the partitions/volumes were created or deleted within the session\n\nd.1 is not an issue, d.2 and d.3 can be recreated by parsing the MBR and EPBR chain (something that seemingly the posted .vbs does not do) **BUT** there is **NO WAY** on earth that d.4 can be reproduced, so, even if point d.3 will be satisfied by a next release of the .vbs, it will ONLY apply to disks that were NOT modified by creating or removing volumes partitions and reconnected during a same session.  \n\n\u003cbr /\u003e\n\n@Ambralivio  \nTry the following modified batch (from the one already posted on #15 that makes use of dd --list, slightly modified to take into account volumes without a drive letter, removing removable drives and allow for more Harddiskvolumes):  \n\n\u003cbr /\u003e\n\n```\n@ECHO OFF\n@ECHO OFF\nSETLOCAL ENABLEEXTENSIONS ENABLEDELAYEDEXPANSION\n::Links from \\HardDiskM\\PartitionN to drive letters\n::myddlist2.cmd by jaclaz\n::makes use of dd.exe for windows by John Newbigin\n\nSET IsVolume\u003d0\nSET IsNTBlock\u003d0\nFOR /F \"tokens\u003d*\" %%A IN (\u0027dd --list 2^\u003e^\u00261\u0027) DO (\nSET ThisLine\u003d%%A\nSET ThisIncipit\u003d!ThisLine:~0,5!\nIF \"\\\\.\\V\"\u003d\u003d\"!ThisLine:~0,5!\" SET IsVolume\u003d1\u0026SET Thisvolume\u003d%%A\nIF !IsVolume!\u003d\u003d1 IF \"!ThisLine:~0,7!\"\u003d\u003d\"link to\" CALL :volume %%A\nIF !IsVolume!\u003d\u003d1 IF \"!ThisLine:~0,7!\"\u003d\u003d\"Mounted\" CALL :volume %%A\nIF !IsVolume!\u003d\u003d1 IF \"!ThisLine:~0,7!\"\u003d\u003d\"Not mou\" CALL :volume %%A \\\\.N/A\nIF \"NT Block\"\u003d\u003d\"!ThisLine:~0,8!\" SET IsVolume\u003d0\u0026 SET IsNTBlock\u003d1\nIF \"\\\\?\\Device\\H\"\u003d\u003d\"!ThisLine:~0,12!\" SET IsVolume\u003d0\u0026 SET IsNTBlock\u003d1\u0026SET ThisdeviceH\u003d%%A\nIF !IsNTBlock!\u003d\u003d1 IF \"!ThisLine:~0,7!\"\u003d\u003d\"link to\" CALL :deviceH \u003d%%A\n)\nFOR /F \"tokens\u003d2,4 delims\u003d\u003d?\" %%A IN (\u0027SET \\\\?\\D\u0027) DO (\nFOR /F \"tokens\u003d2,3,5 delims\u003d\u003d.\" %%C IN (\u0027SET \\\\.\\V^|FIND \"%%B\u003d\" ^|FIND /V \"DP(\"\u0027) DO (\nREM ECHO %%E %%A\nECHO %%E %%A %%C\n)\n)\nGOTO :EOF\n\n:volume\nSET %Thisvolume%\u003d!%Thisvolume%!\u003d%3\nGOTO :EOF\n\n:deviceH\nSET %ThisdeviceH%\u003d!%ThisdeviceH%!%3\nGOTO :EOF\n```\n\n@Zharif  \nthis is the output of the latest .vbs you posted:  \n\u003e C:\\\\appoggio\\\\TestVista\\\u003ecscript ZShowDrives3.vbs  \n\u003e Microsoft ® Windows Script Host Versione 5.6  \n\u003e Copyright © Microsoft Corporation 1996-2001. Tutti i diritti riservati.  \n\u003e\n\u003e \u003cbr /\u003e\n\u003e\n\u003e C: Disk #0, Partition #0 --\\\u003e \\\\Disk0\\\\Partition1 LogicalDrv.1 of Part.1  \n\u003e D: Disk #1, Partition #0 --\\\u003e \\\\Disk1\\\\Partition1 LogicalDrv.1 of Part.1  \n\u003e K: Disk #6, Partition #0 --\\\u003e \\\\Disk6\\\\Partition1 LogicalDrv.1 of Part.1  \n\u003e L: Disk #6, Partition #2 --\\\u003e \\\\Disk6\\\\Partition3 LogicalDrv.1 of Part.3  \n\u003e N: Disk #6, Partition #1 --\\\u003e \\\\Disk6\\\\Partition2 LogicalDrv.1 of Part.2\n\nand this is the output of the posted batch (right):  \n\u003e \\\\c: \\\\Device\\\\Harddisk0\\\\Partition1 \\\\Volume{83092730-6bfc-11df-b90c-806d6172696f}\\\\  \n\u003e \\\\d: \\\\Device\\\\Harddisk1\\\\Partition1 \\\\Volume{b0b284c4-8a33-11dd-8781-806d6172696f}\\\\  \n\u003e \\\\k: \\\\Device\\\\Harddisk6\\\\Partition1 \\\\Volume{9504b6d8-9348-11e4-b093-001fc6bb76ce}\\\\  \n\u003e \\\\l: \\\\Device\\\\Harddisk6\\\\Partition2 \\\\Volume{9504b715-9348-11e4-b093-001fc6bb76ce}\\\\  \n\u003e N/A \\\\Device\\\\Harddisk6\\\\Partition3 \\\\Volume{9504b6d9-9348-11e4-b093-001fc6bb76ce}\\\\  \n\u003e \\\\n: \\\\Device\\\\Harddisk6\\\\Partition4 \\\\Volume{9504b6da-9348-11e4-b093-001fc6bb76ce}\\\\\n\n![:duff:](https://reboot.pro/public/style_emoticons/default/duff.gif)  \nWonko\n\n"
    },
    {
      "id": "189740",
      "timestamp": "2015-01-08T17:19:04+00:00",
      "author": "ambralivio",
      "content": "\u003e @Ambralivio  \n\u003e Try the following modified batch (from the one already posted on #15 that makes use of dd --list, slightly modified to take into account volumes without a drive letter, removing removable drives and allow for more Harddiskvolumes):\n\nThanks Wonko, I\u0027ll try it.\n\nIn the meantime, I honestly confess to have lost what is the final target of this discussion.\n\nambralivio\n\n"
    },
    {
      "id": "189741",
      "timestamp": "2015-01-08T17:34:10+00:00",
      "author": "cdob",
      "content": "\u003e **BUT** there is **NO WAY** on earth that d.4 can be reproduced, so, even if point d.3 will be satisfied by a next release of the .vbs, it will ONLY apply to disks that were NOT modified by creating or removing volumes partitions and reconnected during a same session.\n\nA example to show this behaviour:  \n\nDisk 2: one primary partition, and two logical  \n\nZShowDrives.vbs  \n\u003e F: Disk #2, Partition #0 --\\\u003e \\\\Disk2\\\\Partition1 LogicalDrv.1 of Part.1  \n\u003e H: Disk #2, Partition #1 --\\\u003e \\\\Disk2\\\\Partition2 LogicalDrv.1 of Part.2  \n\u003e I: Disk #2, Partition #1 --\\\u003e \\\\Disk2\\\\Partition2 LogicalDrv.2 of Part.2\nTruecrypt  \n\u003e Harddisk 2:  \n\u003e \\\\Device\\\\HardDisk2\\\\Partition1 F:  \n\u003e \\\\Device\\\\HardDisk2\\\\Partition2 H:  \n\u003e \\\\Device\\\\HardDisk2\\\\Partition3 I:\nI: Partition number is equal  \n\n\u003cbr /\u003e\n\nLogical Partition H: deleted  \n\nZShowDrives.vbs  \n\u003e F: Disk #2, Partition #0 --\\\u003e \\\\Disk2\\\\Partition1 LogicalDrv.1 of Part.1  \n\u003e I: Disk #2, Partition #1 --\\\u003e \\\\Disk2\\\\Partition2 LogicalDrv.1 of Part.2\nTruecrypt  \n\u003e Harddisk 2:  \n\u003e \\\\Device\\\\HardDisk2\\\\Partition1 F:  \n\u003e \\\\Device\\\\HardDisk2\\\\Partition3 I:\nThe I: number is different  \n\n\u003e Try the following modified batch\n\u003e \\\\f: \\\\Device\\\\Harddisk2\\\\Partition1 \\\\Volume{f02fbcb6-96ae-11e4-95a3-005056c00008}\\\\  \n\u003e \\\\i: \\\\Device\\\\Harddisk2\\\\Partition3 \\\\Volume{f02fbcb8-96ae-11e4-95a3-005056c00008}\\\\\nYes, the batch does works correctly.  \n\n\u003cbr /\u003e\n\nThe disk 2 disconnected and reconnected:  \n\u003e \\\\f: \\\\Device\\\\Harddisk2\\\\Partition1 \\\\Volume{f02fbcb6-96ae-11e4-95a3-005056c00008}\\\\  \n\u003e \\\\i: \\\\Device\\\\Harddisk2\\\\Partition2 \\\\Volume{f02fbcb8-96ae-11e4-95a3-005056c00008}\\\\\nTruecrypt  \n\u003e Harddisk 2:  \n\u003e \\\\Device\\\\HardDisk2\\\\Partition1 F:  \n\u003e \\\\Device\\\\HardDisk2\\\\Partition2 I:\n\n"
    },
    {
      "id": "189742",
      "timestamp": "2015-01-08T18:25:34+00:00",
      "author": "Zharif",
      "content": "\u003e Logical Partition H: deleted  \n\u003e\n\u003e ZShowDrives.vbs\n\u003e \u003e F: Disk #2, Partition #0 --\\\u003e \\\\Disk2\\\\Partition1 LogicalDrv.1 of Part.1  \n\u003e \u003e I: Disk #2, Partition #1 --\\\u003e \\\\Disk2\\\\Partition2 LogicalDrv.1 of Part.2\n\u003e\n\u003e Truecrypt\n\u003e \u003e Harddisk 2:  \n\u003e \u003e \\\\Device\\\\HardDisk2\\\\Partition1 F:  \n\u003e \u003e \\\\Device\\\\HardDisk2\\\\Partition3 I:\n\u003e\n\u003e The I: number is different\n\u003e\ncdob, I don\u0027t understand what you\u0027re saying here.\n\nFor me, both outputs looks similar.\n\nZShowDrives (WMI) took care about, that H: and I: are two logical drives of ONE extended Partition. The WMI seems to have some kind of intelligence NOT to state that there\u0027re three partitions, but only two. Anyway, it displays each logical drive of ONE container partition but with the same partitionNr. This has some kind of logic for me.\n\nAccording to the most interesting articles Wonko linked me to in his previous post, this provides conformity to common notations (correct me if I\u0027m wrong). As many logical drives you create inside this container, they will always have the same partitionNr.\n\nProblems seem to occur if you unmount one logical drive here. In fact, WMI does not give false results. By dismounting H:, it looses the state of a volume (requires an assigned driveletter) and ZShowDrives shows the remaining logcial drives that still have the same partitionNr. For what I understood, this is no wrong behaviour regarding the WMI-terms.\n\nMoreover, it could be argued, that true crypt gives an unreliable output. Counting up the partitions inside the container (partition2 and 3), might/will imply that there\u0027re three primary partitions on a disk, which in fact is not the truth.\n\nEdit: added\n\nOn the other hand, the mentioned WMI behaviour makes it different to get the real sequence of logical drives inside a container if one of it has been dismounted. But notation \"Disk #2, Partition #1\" still remains correct.\n\nAnyway, for me \"\\\\Device\\\\HardDisk2\\\\Partition3 I:\" (spoken in true crypt notation) remains the same as\n\nI: Disk #2, Partition #1 --\\\u003e \\\\Disk2\\\\Partition2 LogicalDrv.1 of Part.2 (spoken in WMI notation).\n\n"
    },
    {
      "id": "189746",
      "timestamp": "2015-01-09T10:57:49+00:00",
      "author": "Zharif",
      "content": "@Wonko,\n\nI think I understand.\n\nIn regard to amralivio\u0027s latest post, I second his impression of loosing the initial target of this thread.\n\nMaybe a new one should be opened? Following you latest post we shouldn\u0027t. At least we\u0027re at a point\n\nyou stated very early in this thread (post 24).\n\nBut I feel like a fighting pitbull here (although intelligence of their behaviour is questionable). I couldn\u0027t resist to search for a possible command to get the Device\\\\Harddisk\\\u003cn\\\u003e syntax.\n\nPlease have a look on what I found (works with XP and Win8.1):\n\nCommand1: WMIC.EXE Path Win32_PerfFormattedData_PerfDisk_LogicalDisk Get Name /Format:LIST\n\nCommand2: WMIC.EXE Path Win32_OSRecoveryConfiguration Get Name /Format:LIST\n\nCommand3: WMIC.EXE Path Win32_OperatingSystem Get SystemDevice /Format:List\n\nThe first one is most interesting.\n\nIt displays the Device\\\\HarddiskNr for unmounted partitions. Whenever you remount, the assigned driveletter is displayed. The HarddiskNr is the same as for dd --list (cross-checked this).\n\nIt seems, that you can get the HarddiskNr of unmounted partitions as well as for the boot partition (commands 2+3).\n\n- we now have the Harddisk1 for the boot partition\n\n- we now have the Harddisk\\\u003cn\\\u003e for all unmounted partitions\n\n- Concerning the article you linked me to (how windows 2000 assings, reserves and stores driveletters),\n\nmay it be possible to calculate the harddiskNr. of the remaining partitions?\n\nPlease note, this is just an initial idea - nothing else.\n\nPlease teach me if you think it is a silly one.\n\n\u003cbr /\u003e\n\n"
    },
    {
      "id": "189747",
      "timestamp": "2015-01-09T12:27:34+00:00",
      "author": "ambralivio",
      "content": "\u003e @Ambralivio\n\u003e\n\u003e Try the following modified batch (from the one already posted on #15 that makes use of dd --list, slightly modified to take into account volumes without a drive letter, removing removable drives and allow for more Harddiskvolumes):\n\nWonko, as promised, this is the output in my case (please refers to configuration as in post #63) :\n\n\\\\d: \\\\Device\\\\Harddisk0\\\\Partition1 \\\\Volume{d51a936c-de08-11e1-8b7f-001966048b24}\\\\  \n\\\\f: \\\\Device\\\\Harddisk0\\\\Partition2 \\\\Volume{0e33fb78-f4d3-11df-8b21-806e6f6e6963}\\\\  \n\\\\g: \\\\Device\\\\Harddisk0\\\\Partition3 \\\\Volume{0e33fb79-f4d3-11df-8b21-806e6f6e6963}\\\\  \n\\\\e: \\\\Device\\\\Harddisk0\\\\Partition4 \\\\Volume{4a60cc21-de22-11e1-a51c-001966048b24}\\\\  \nN/A \\\\Device\\\\Harddisk1\\\\Partition1 \\\\Volume{0e33fb7a-f4d3-11df-8b21-806e6f6e6963}\\\\  \n\\\\c: \\\\Device\\\\Harddisk1\\\\Partition2 \\\\Volume{1facf149-690e-11e4-91bf-806e6f6e6963}\\\\  \n\\\\j: \\\\Device\\\\Harddisk1\\\\Partition3 \\\\Volume{605b9ca2-690f-11e4-a423-806e6f6e6963}\\\\  \n\\\\i: \\\\Device\\\\Harddisk1\\\\Partition4 \\\\Volume{605b9ca5-690f-11e4-a423-806e6f6e6963}\\\\  \n\\\\k: \\\\Device\\\\Harddisk1\\\\Partition5 \\\\Volume{2b4b5b9b-caa3-11e2-9be1-001966048b24}\\\\  \n\\\\l: \\\\Device\\\\Harddisk1\\\\Partition6 \\\\Volume{2b4b5ba5-caa3-11e2-9be1-001966048b24}\\\\  \nIt seems to work, meaning that now we have :  \n1 - all the hard-disk \\\u0026 the partitions listed (even those unmounted, i.e. that named \"N/A\", which in my case, is the reserved partition in Win 7)  \n2 - the relevant UUID for each volume is also extracted  \nso, it seems that all the necessary information are finally captured (even if, as i said,, I am now a bit lost about what we are searching for !!!).  \nEven though, maybe, a bit OT, I seem there\u0027s only 1 point missing (necessary for the target? ![:confused1:](https://reboot.pro/public/style_emoticons/default/confused1.gif)) : from the output of your cmd it is not clear what the extended partition are and the related sub-partitions !  \nRegarding the truecrypt volume case, I am not able to say nothing, since I do not use that tool at all, and I am not greatly sorry regarding to the last mysterious \"sequence of events\" related to that tool.  \nambralivio\n\n"
    }
  ]
}