{
  "id": "22578",
  "title": "Booting WinPE from hard disk and motherboard failure",
  "isPinned": false,
  "isFirstTopic": false,
  "isLocked": false,
  "tags": [],
  "forumNotes": [
    {
      "id": "220049",
      "timestamp": "2021-12-08T17:08:22+00:00",
      "author": "Vortex",
      "content": "Hello,\n\nI am experiencing a very strange and painful case. I have a batch file adding Win10XPE to the boot menu of Windows 10. The purpose is to boot from a .wim file extracted from Win10XPE after restarting the computer. Generally, this method works fine but after restart , some computers failed - the motherboards went broken. This happened three times. The .wim file cannot harm the hardware but I suspect it\u0027s the updated BCD store damaging the computers. Anyone who experienced such a weird case?\n\nAll the failed systems are UEFI and secure boot is enabled.\n\nThe batch file :\n\n\u003cbr /\u003e\n\n```\nbcdedit /export C:\\Bcdbackup.bin\n \nbcdedit /create {ramdiskoptions} /d \"Win10XPE-64bit\"\n \nbcdedit /set {ramdiskoptions} ramdisksdidevice partition\u003dC:\n \nbcdedit /set {ramdiskoptions} ramdisksdipath \\winpe\\boot\\boot.sdi\n \nFOR /F \"tokens\u003d3\" %%a in (\u0027bcdedit -create /d \"Win10XPE-64bit\" /application OSLOADER\u0027) do SET GUID\u003d%%a\n \necho %GUID% \u003e C:\\Win10PE-GUID.txt\n \necho bcdedit /delete %GUID% \u003e C:\\DelWin10PE.bat\n \nbcdedit /set %GUID% device ramdisk\u003d[C:]\\winpe\\sources\\boot.wim,{ramdiskoptions}\n \nbcdedit /set %GUID% path \\windows\\system32\\winload.efi\n \nbcdedit /set %GUID% osdevice ramdisk\u003d[C:]\\winpe\\sources\\boot.wim,{ramdiskoptions}\n \nbcdedit /set %GUID% systemroot \\windows\n \nbcdedit /set %GUID% winpe yes\n \nbcdedit /set %GUID% detecthal yes\n \nREM bcdedit /displayorder %GUID% /addlast\n \nbcdedit /bootsequence %GUID%\n```\n\n\u003cbr /\u003e\n\n"
    },
    {
      "id": "220080",
      "timestamp": "2021-12-10T08:04:27+00:00",
      "author": "alacran",
      "content": "At first seen it seem your Batch file should not be the cause of the problem, only comment I have is the following.\n\nTo be more precise for a PE.wim or a boot.wim file, the BCD entries target are:\n\nOn the Boot\\\\BCD the bootfile target is: \\\\windows\\\\system32\\\\**boot** \\\\winload.exe for MBR/CSM booting.  \nOn the EFI\\\\Microsoft\\\\Boot\\\\BCD the bootfile target is: \\\\windows\\\\system32\\\\**boot**\\\\winload.efi for UEFI booting\n\nIn the future better use [UEFI_MULTI](http://reboot.pro/index.php?showtopic\u003d22254 \"\") program, made by our forum fellow **wimb**.\n\nJust run it from a Win10x64 OS or PE, follow the instructions, (on the very bottom part of its small window), and it will make automatically all entries required to boot a PE or a VHD file from a internal or external drive, valid for MBR/CSM and UEFI.\n\nalacran\n\n"
    },
    {
      "id": "220089",
      "timestamp": "2021-12-10T18:25:39+00:00",
      "author": "Vortex",
      "content": "Hi alacran,\n\nI am working on UEFI systems. Comparing the same file found in different locations :  \n\n```\nC:\\\u003efc C:\\Windows\\System32\\Boot\\winload.efi C:\\Windows\\System32\\winload.efi\nComparing files C:\\WINDOWS\\SYSTEM32\\BOOT\\winload.efi and \\WINDOWS\\SYSTEM32\\WINLOAD.EFI\nFC: no differences encountered\n```\n\nThe result of the test above in the WinPE environment is the same. The batch file is harmless. What I suspect is some Windows updates disturbing the BCD records as the duty of the batch file is only to update the BCD file :\n\n```\n\"\\Efi\\Microsoft\\Boot\\BCD\"\n```\n\nA member of the Microsoft forum reported to use the same method to boot WinPE from RAM. I experienced similar symptoms before the motherboard failure :\n\n\u003e Upon restarting, when the system boots I hear the fans start but then they stop following a few seconds of silence.  \n\u003e The system then starts again with the fans at full speed it sounds like but nothing is displayed on the monitor.  \n\u003e I then have to power it off 1 or 2 times to let the normal boot procedure kick in so I can get back into Windows.\n\u003e\n[https://docs.microso...e-from-ram.html](https://docs.microsoft.com/en-us/answers/questions/563319/setup-bcd-to-boot-pe-from-ram.html \"External link\")\n\nThe same start and stop sequence followed by silence indicating the motherboard going kaput.\n\nBooting from a USB stick or from LAN does not pose any problem. Both of them are good to boot Win10XPE.\n\nHere is another source mentioning about similar BCD handling method :\n\n[https://docs.microso...265131(v\u003dws.10)](https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-7/hh265131(v\u003dws.10) \"External link\")\n\nMy intention is to switch to UEFI grub4dos, this will require the disablement of secure boot. In my tests, I had good results using this tool.\n\n"
    },
    {
      "id": "220090",
      "timestamp": "2021-12-10T18:45:15+00:00",
      "author": "Wonko the Sane",
      "content": "Vortexx, it may or may not be relevant, but you have no way to know.\n\nIf your batch uses:\n\nbcdedit /set %GUID% path \\\\windows\\\\system32\\\\winload.efi\n\nbut (according to Alacran who has some experience in the specific matter) it should use:\n\nbcdedit /set %GUID% path \\\\windows\\\\system32\\\\boot\\\\winload.efi\n\nIt is not by *fc*-ing the two files and finding them identical you are going to prove or disprove anything.\n\nFor all we know the contents of the BCD hive that the path parameter of BCEdit accesses could be read by anything during the boot process and checked \\*like\\*\n\n\"if before winload.efi there is \\\\Boot\\\\ then proceed, otherwise throw a fit\"\n\nor you could put winload.efi into D:\\\\myEFI\\\\ and have it still work correctly, we simply don\u0027t know.\n\n![:duff:](http://reboot.pro/public/style_emoticons/default/duff.gif)\n\nWonko\n\n"
    },
    {
      "id": "220091",
      "timestamp": "2021-12-10T18:56:25+00:00",
      "author": "Vortex",
      "content": "Hi Wonko,  \nIt\u0027s Microsoft mentioning about the path of the .efi file :  \n\n```\nbcdedit -store S:\\EFI\\Microsoft\\Boot\\BCD -set {Default} path \\windows\\system32\\winload.efi\n```\n\n[https://docs.microso...265131(v\u003dws.10)](https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-7/hh265131(v\u003dws.10) \"External link\")  \nI inserted the statement \"boot\" into my batch file, it boots successfully WinPE on my old computer ( old BIOS and not UEFI )  \nI cannot afford the loss of another motheboard so probably better to switch to UEFI grub4dos. It\u0027s a an expensive experiment at least for me. I can tell that with or without the word \"boot\" in the path , the Windows loader can find the .wim file to load.\n\n"
    },
    {
      "id": "220092",
      "timestamp": "2021-12-10T20:26:20+00:00",
      "author": "noel",
      "content": "Hi vortex,  \nin the first link you gave, i see :  \n\"What does the .sdi do and what is it for?\"\n\nYour batch works and modifies bcd on many computers and they start correctly. Ok\n\nBut your script don\u0027t describe the added files .\n\nAs i said iin the \"other site\" where you posted, please describe the added files and especially the directory containing boot.sdi.\n\nIt is possible that this boot.sdi file was missing on the failed 3 ( did you check it before boot ? )\n\nNoel\n\n"
    },
    {
      "id": "220093",
      "timestamp": "2021-12-10T20:57:07+00:00",
      "author": "Vortex",
      "content": "Salut Noel,\n\nAbout boot.sdi :\n\n[https://docs.microso...771845(v\u003dws.10)](https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2008-R2-and-2008/cc771845(v\u003dws.10) \"External link\")\n\nHere is the list of the files extracted from the .iso file with 7-Zip :\n\n\u003cbr /\u003e\n\n```\nC:\\\u003edir /b /s C:\\winpe\n \nC:\\winpe\\boot\nC:\\winpe\\sources\nC:\\winpe\\boot\\bcd\nC:\\winpe\\boot\\bcd.LOG\nC:\\winpe\\boot\\bcd.LOG1\nC:\\winpe\\boot\\bcd.LOG2\nC:\\winpe\\boot\\boot.sdi\nC:\\winpe\\boot\\bootsect.exe\nC:\\winpe\\boot\\en-US\nC:\\winpe\\boot\\etfsboot.com\nC:\\winpe\\boot\\Fonts\nC:\\winpe\\boot\\memtest.exe\nC:\\winpe\\boot\\en-US\\bootmgr.exe.mui\nC:\\winpe\\boot\\en-US\\bootsect.exe.mui\nC:\\winpe\\boot\\en-US\\memtest.exe.mui\nC:\\winpe\\boot\\Fonts\\chs_boot.ttf\nC:\\winpe\\boot\\Fonts\\cht_boot.ttf\nC:\\winpe\\boot\\Fonts\\jpn_boot.ttf\nC:\\winpe\\boot\\Fonts\\kor_boot.ttf\nC:\\winpe\\boot\\Fonts\\malgunn_boot.ttf\nC:\\winpe\\boot\\Fonts\\malgun_boot.ttf\nC:\\winpe\\boot\\Fonts\\meiryon_boot.ttf\nC:\\winpe\\boot\\Fonts\\meiryo_boot.ttf\nC:\\winpe\\boot\\Fonts\\msjhn_boot.ttf\nC:\\winpe\\boot\\Fonts\\msjh_boot.ttf\nC:\\winpe\\boot\\Fonts\\msyhn_boot.ttf\nC:\\winpe\\boot\\Fonts\\msyh_boot.ttf\nC:\\winpe\\boot\\Fonts\\segmono_boot.ttf\nC:\\winpe\\boot\\Fonts\\segoen_slboot.ttf\nC:\\winpe\\boot\\Fonts\\segoe_slboot.ttf\nC:\\winpe\\boot\\Fonts\\wgl4_boot.ttf\nC:\\winpe\\sources\\boot.wim\n```\n\n\u003cbr /\u003e\n\n"
    },
    {
      "id": "220094",
      "timestamp": "2021-12-10T23:10:09+00:00",
      "author": "alacran",
      "content": "\u003e Hi alacran,\n\u003e\n\u003e I am working on UEFI systems. Comparing the same file found in different locations :  \n\u003e\n\u003e ```\n\u003e C:\\\u003efc C:\\Windows\\System32\\Boot\\winload.efi C:\\Windows\\System32\\winload.efi\n\u003e Comparing files C:\\WINDOWS\\SYSTEM32\\BOOT\\winload.efi and \\WINDOWS\\SYSTEM32\\WINLOAD.EFI\n\u003e FC: no differences encountered\n\u003e ```\n\nI also made that comparative long time ago and I can assure you even the SHA1 of the two files is the same, but I also found during my experiments on this topic [Install Win10XPE_x64 Flat or Compact Mode on VHD](http://reboot.pro/index.php?showtopic\u003d22376\u0026hl\u003d \"\") , that not always work the same (if using the usual path to boot a full OS, the PC may boot from a PE or not, and don\u0027t ask me why, as I don\u0027t know the per sure the answer, my theory is it depends of internal code in the Bios), unfortunatelly I didn\u0027t mentioned this findings in detail in that topic, just made a strong recommendation to use the right path, as it will work fine always.\n\nJust going by the book, extract from a Win10XPE_x64.iso both bcd files (yes usually on WinPE they never use capital letters for them, maybe as a way just to diferenciate from the standard BCD), now run [BootIce](http://reboot.pro/index.php?app\u003ddownloads\u0026showfile\u003d592 \"\") and open them and you will see the paths I mentioned are exactly the same.\n\nBut yes, as I said at first seen the path should not be the cause of a MB failure.\n\nLet\u0027s analyze the info you have, in order to find a possible cause:\n\nWhat have in common the MBs that failed:\n\nSame brand\n\nSame model\n\nSame Bios Builder\n\nBuilded same year (then Bios are builded in accordance with certain UEFI version)\n\netc.\n\nThe UEFI specs allow, and even going further promote that the OEM include certain mini programs specifically designed to run during the very first stages of UEFI boot to realize certain tasks supposedly mainly to improve security/safety/speed of booting process, if one of those UEFI programs went too far and is over protecting the BCD(s) to not allow/block the boot of unauthorized/wrong code if detected, this may be the also cause of the failures, so IMHO the Bios code with or without some additional UEFI program is the biggest suspect in this crime investigation, if possible as an extra precaution it is better always disable Secure Boot before working on the boot process or installing a OS (as an extra safety precaution, just in case), Or better (as I always do) just leave it disabled forever, as it is only good to protect MS pocket, forcing all people/companies that make drivers and programs to pay them to get the certification. It doesn\u0027t help to prevent any malware, all malware just laugh about it.\n\nBut only you know all the full info, and only you can put all pieces togheter, please keep us informed, as this info seems very important for all us here, experimenting very frecuently booting every kind of things.\n\nAnd let me tell you why I recommend you to always use UEFI_BOOT, it is very safe because it DOES NOT use any of those paths to boot a WinPE boot.wim, it just let the Bios + the internal code into the OS boot process to handle the path to the target file. Basically it saids use this boot.sdi, find following X.wim file and boot from it. Please see attached pictures.\n\n**NOTE:** BootIce is an old program written before Win10, I have found it does not work fine to create 10 PE entries, (my theory is it laks the GUID code for them), but no problem with any OS, or OS into a VHD or older PE(s), anyway it is very useful to edit 10 PE entries once they exists.  \n\nHope this info was of any help.\n\nalacran  \n\n#### Attached Thumbnails {#attach_wrap}\n\n* [![Booting a PE.png](http://reboot.pro/uploads/monthly_12_2021/post-26560-0-21338500-1639188368_thumb.png)](http://reboot.pro/uploads/monthly_12_2021/post-26560-0-21338500-1639188368.png \"Booting a PE.png - Size: 1.39MB\"){#ipb-attach-url-18407-0-30754600-1676066377}\n* [![Booting a PE-2.png](http://reboot.pro/uploads/monthly_12_2021/post-26560-0-62974800-1639188380_thumb.png)](http://reboot.pro/uploads/monthly_12_2021/post-26560-0-62974800-1639188380.png \"Booting a PE-2.png - Size: 1.34MB\"){#ipb-attach-url-18408-0-30763700-1676066377}\n\n"
    },
    {
      "id": "220095",
      "timestamp": "2021-12-11T01:30:06+00:00",
      "author": "alacran",
      "content": "\u003e Salut Noel,\n\u003e\n\u003e About boot.sdi :\n\u003e\n\u003e [https://docs.microso...771845(v\u003dws.10)](https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2008-R2-and-2008/cc771845(v\u003dws.10) \"External link\")\n\u003e\n\u003e Here is the list of the files extracted from the .iso file with 7-Zip :\n\u003e\n\u003e ```\n\u003e C:\\\u003edir /b /s C:\\winpe\n\u003e  \n\u003e C:\\winpe\\boot\n\u003e C:\\winpe\\sources\n\u003e C:\\winpe\\boot\\bcd\n\u003e C:\\winpe\\boot\\bcd.LOG\n\u003e C:\\winpe\\boot\\bcd.LOG1\n\u003e C:\\winpe\\boot\\bcd.LOG2\n\u003e C:\\winpe\\boot\\boot.sdi\n\u003e C:\\winpe\\boot\\bootsect.exe\n\u003e C:\\winpe\\boot\\en-US\n\u003e C:\\winpe\\boot\\etfsboot.com\n\u003e C:\\winpe\\boot\\Fonts\n\u003e C:\\winpe\\boot\\memtest.exe\n\u003e C:\\winpe\\boot\\en-US\\bootmgr.exe.mui\n\u003e C:\\winpe\\boot\\en-US\\bootsect.exe.mui\n\u003e C:\\winpe\\boot\\en-US\\memtest.exe.mui\n\u003e C:\\winpe\\boot\\Fonts\\chs_boot.ttf\n\u003e C:\\winpe\\boot\\Fonts\\cht_boot.ttf\n\u003e C:\\winpe\\boot\\Fonts\\jpn_boot.ttf\n\u003e C:\\winpe\\boot\\Fonts\\kor_boot.ttf\n\u003e C:\\winpe\\boot\\Fonts\\malgunn_boot.ttf\n\u003e C:\\winpe\\boot\\Fonts\\malgun_boot.ttf\n\u003e C:\\winpe\\boot\\Fonts\\meiryon_boot.ttf\n\u003e C:\\winpe\\boot\\Fonts\\meiryo_boot.ttf\n\u003e C:\\winpe\\boot\\Fonts\\msjhn_boot.ttf\n\u003e C:\\winpe\\boot\\Fonts\\msjh_boot.ttf\n\u003e C:\\winpe\\boot\\Fonts\\msyhn_boot.ttf\n\u003e C:\\winpe\\boot\\Fonts\\msyh_boot.ttf\n\u003e C:\\winpe\\boot\\Fonts\\segmono_boot.ttf\n\u003e C:\\winpe\\boot\\Fonts\\segoen_slboot.ttf\n\u003e C:\\winpe\\boot\\Fonts\\segoe_slboot.ttf\n\u003e C:\\winpe\\boot\\Fonts\\wgl4_boot.ttf\n\u003e C:\\winpe\\sources\\boot.wim\n\u003e ```\n\nWhat a waste of space my friend, to boot a PE from a internal or external drive you only need boot.sdi + boot.wim files, all other required files and folders are already in your EFI partition some in the root and some into EFI folder, in your case of UEFI booting, and same apply in case of MBR/CSM booting but here the folder name is Boot, and usually the boot.sdi file is already into the folder too.\n\nOf course it is a good practice to rename the boot.wim file, and obviously fully required if you have more than one.\n\nalacran\n\n"
    },
    {
      "id": "220098",
      "timestamp": "2021-12-11T09:56:57+00:00",
      "author": "Vortex",
      "content": "Hi alacran,\n\nThanks for your help. I should mention in my first posting in this thread, I am performing remote installations \\\\ maintenance of laptops\\\\desktops located in a remote office. I added TightVNC to my WinPE build to access the computers in the remote branch. Loggining in to Windows, it\u0027s sufficient to run the batch updating the BCD records to boot Win10XPE after restarting the computers. You can imagine the consequences of another motherboard failing, the time for the replacement of the failed part and me losing credits after such incidents. Luckly, two of the computers are under warranty. One of them returned back and the other one visiting the repair shop waiting for the hardware replacement. I can even install and backup Windows over a VPN connection with the procedure I described above.\n\nThe problem is that my chances to request assistance from the remote office is modest and I need to rely on a simple method - keep things simple as much as possible - to do all the job. This is why I prefer a batch file.\n\nTwo of the failing computers are identical, same brand, same model number etc.\n\nIt\u0027s true that only boot.sdi in the boot folder does the job but this folder occupies only 17.1 Mb, a tiny fraction of the hard drive, not a serious waste of space as you might think.\n\nExtracting the BCD file from the wim file, BootIce reflects the complete path you mentioned, it\u0027s \\\\windows\\\\system32\\\\boot. We agree that the path pointing boot.sdi should not be the cause of all the trouble.\n\nI never used UEFI_BOOT. Does it touch the BCD record of the computer? I think that UEFI grub4dos will be safer as it does not have to manipulate the settings of Windows, no any modification of BCD etc.\n\nI am also doing the sysprep operation to distrubute the same Windows setup ( .wim archive including the preinstalled applications ) on identical computer models. I am not a novice in the area of building and using WinPEs, I even used BartPE long years ago.\n\nAbout your paragraph regarding UEFI, all is true as the high-tech companies are the sole winners. UEFI, BCD etc all of those inventions are unnecessarly complicated, the purpose to make more $$$. What about the simplicity of the original UNIX regarding every entitiy as files? Also, every setting going into simple text files.\n\nI will try to focus on the experiences with UEFI grub4dos.\n\n"
    },
    {
      "id": "220099",
      "timestamp": "2021-12-11T10:19:03+00:00",
      "author": "cdob",
      "content": "\u003e the motherboards went broken.\n\u003e\nAll the failed systems are UEFI and secure boot is enabled.  \nThat\u0027s strange. No, I haven\u0027t seen this.  \nCan you clarify: the motherboards went broken?  \nIs there any boot sign at all? Can you go to UEFI settings and load system defaults?  \nWhich motherboards, and which UEFI version went broken?  \nBcdedit writes UEFI boot settings to NVRAM too.  \nNo bcdedit dosn\u0027t write directly, bcdedit asks the UEFI to store boot entry in NVRAM.  \nThe NVRAM storage is limited.  \nIt there are a lot of entries already, there could be a error adding another boot entry.  \nMaybe there is another error.  \nA UEFI reset / removing the CMOS battery may help.\n\n"
    },
    {
      "id": "220100",
      "timestamp": "2021-12-11T10:42:34+00:00",
      "author": "Vortex",
      "content": "Hi cdob,\n\nIn two cases, the authorized repair shop reported the failure of the motherboards. You hit the power button and no any response, no any chance to enter the BIOS or boot the system. Well, the third case didn\u0027t require the assessment of any repair shop, it was easy to guess the failure of the motherboard.\n\n\u003e No bcdedit dosn\u0027t write directly, bcdedit asks the UEFI to store boot entry in NVRAM.\n\u003e\nIt\u0027s the BCD file in the first partition of the computer, the BCD found in the FAT32 partition managed by bcdedit :\n\n```\n\\Efi\\Microsoft\\Boot\\BCD\n```\n\n\u003cbr /\u003e\n\n"
    },
    {
      "id": "220101",
      "timestamp": "2021-12-11T10:58:57+00:00",
      "author": "wimb",
      "content": "**@Vortex**\n\nWhat is the Source of your WinPE and How was it made ?\n\nCould it be that the drivers in your WinPE are causing your motherboard failure ?\n\n"
    },
    {
      "id": "220102",
      "timestamp": "2021-12-11T11:13:39+00:00",
      "author": "Vortex",
      "content": "Hi wimb,\n\nIt\u0027s Win10XPE.iso built from Windows 10 64-bit version 2020 H1. The drivers cannot be the reason of the trouble, the failed computer cannot even boot WinPE.\n\n"
    },
    {
      "id": "220107",
      "timestamp": "2021-12-12T06:22:44+00:00",
      "author": "wimb",
      "content": "\u003e It\u0027s Win10XPE.iso built from Windows 10 64-bit version 2020 H1. The drivers cannot be the reason of the trouble, the failed computer cannot even boot WinPE.\n\nOK\n\nIs ChrisR on GitHub your [Source to make Win10XPE](https://github.com/ChrisRfr/Win10XPE \"External link\") Or do you use another Source ?\n\nWhat is your Win10XPE Build Core Configuration 1 Or 2 ?\n\n1. Run All Programs from RAM - means everything OS + Programs is contained in single WIM file\n\n2. Programs are outside WIM file in Programs Folder Searched for on Drive having Tagfile CDUsb.y\n\n"
    },
    {
      "id": "220108",
      "timestamp": "2021-12-12T08:49:55+00:00",
      "author": "Wonko the Sane",
      "content": "As always I may be wrong, but yours would be among the few, very rare cases where a software can kill hardware, the so-called \"killer poke\"\n\n[https://en.wikipedia...iki/Killer_poke](https://en.wikipedia.org/wiki/Killer_poke \"External link\")\n\nbut usually (like in 99.99% of cases) the result is not really a permanent damage to the hardware, but rather this (or that) type of \"bricking\", i.e. for some reasons software/data embedded in the hardware, i.e. firmware (like the BIOS, or UEFI or the adaptive data on hard disk controllers, etc.) becomes corrupted and prevents the hardware from working.\n\nAs cdob said, with the (stupid) NVRAM it could be a matter of filling it to the brim (and there must be some error in the firmware that doesn\u0027t provide for overwriting old entries or doesn\u0027t protect for writing past the end of available space or doesn\u0027t update correctly some index structure, etc.), this is the only thing that sounds plausible as other (possible in theory) kinds of firmware corruption can only be triggered by very specific code (nothing that can happen in a \"normal\" OS booting, and from what you report you are using a rather common setup for your PE booting, and you are using the \"official\" BCDedit, nothing out of usual).\n\nDepending on the specific motherboard it could be possible (non-destructively) to inspect the contents of the BIOS/UEFI firmware and/or re-flash its contents to factory default.\n\nONLY as an example the procedure is used on some Lenovo Thinkpads by BIOS modders:\n\n[https://www.thinkwik...8xx30_and_up.29](https://www.thinkwiki.org/wiki/Custom_BIOS#Hardware_Flashing_.28xx30_and_up.29 \"External link\")\n\n[https://www.bios-mod...\u003d74575#pid74575](https://www.bios-mods.com/forum/Thread-REQUEST-Lenovo-IdeaPad-S405-Whitelist-Removal?pid\u003d74575#pid74575 \"External link\")\n\n[https://www.chucknem...o-x230-coreboot](https://www.chucknemeth.com/laptop/lenovo-x230/flash-lenovo-x230-coreboot \"External link\")\n\nI don\u0027t think that any ordinary (even if \"authorized\") assistance shop would do this kind of checks/repairs, they most probably apply power, see that it doesn\u0027t boot and emit the sentence \"motherboard is dead\".\n\n![:duff:](http://reboot.pro/public/style_emoticons/default/duff.gif)\n\nWonko\n\n"
    },
    {
      "id": "220110",
      "timestamp": "2021-12-12T13:11:33+00:00",
      "author": "Vortex",
      "content": "Hi Wonko,\n\nThe repair shop probaly does not spend much efforts for further diagnosis, that\u0027s true. Simply, they will replace the faulty part.\n\nThe worst in my case is that the failed computer cannot be powered on so there is not much things to do at this stage. Two different computer brands demonstrated this failure.\n\n"
    },
    {
      "id": "220111",
      "timestamp": "2021-12-12T13:45:38+00:00",
      "author": "Vortex",
      "content": "Hi wimb,\n\nThe source link is ChrisR\u0027s GitHub account :\n\n[https://github.com/ChrisRfr/Win10XPE](https://github.com/ChrisRfr/Win10XPE \"External link\")\n\nMy Win10XPE Build Core Configuration is option 1 placing all the applications to RAM.\n\n"
    },
    {
      "id": "220112",
      "timestamp": "2021-12-12T13:50:25+00:00",
      "author": "wimb",
      "content": "\u003e The source link is ChrisR\u0027s GitHub account :\n\u003e\n\u003e [https://github.com/ChrisRfr/Win10XPE](https://github.com/ChrisRfr/Win10XPE \"External link\")\n\u003e\n\u003e My Win10XPE Build Core Configuration is option 1 placing all the applications to RAM.\n\nThanks for the Info.\n\nI use the same and can always use boot.wim for booting 10XPE from RAMDISK without damaging the motherboard.\n\nI think it remains very strange that you experienced so many times booting 10XPE is causing motherboard failure.\n\n"
    },
    {
      "id": "220113",
      "timestamp": "2021-12-12T15:20:20+00:00",
      "author": "Wonko the Sane",
      "content": "\u003e Hi Wonko,\n\u003e\n\u003e The repair shop probaly does not spend much efforts for further diagnosis, that\u0027s true. Simply, they will replace the faulty part.\n\u003e\n\u003e The worst in my case is that the failed computer cannot be powered on so there is not much things to do at this stage. Two different computer brands demonstrated this failure.\n\nYep, once upon a time, there was the CIH virus:\n\n[https://en.wikipedia...computer_virus)](https://en.wikipedia.org/wiki/CIH_(computer_virus) \"External link\")\n\nAnecdotally, besides the (all in all relatively simple) fat data recovery, at the time I saved quite a few (desktop) boards, if I recall correctly some 8-10 of them (for friends, after self-declared specialized technical assistance laboratories had told them that data was lost and motherboard was dead) by either hot-swapping the BIOS chip, or in a couple cases, replacing it with a chip taken from a \"really dead\" motherboard.\n\n![:duff:](http://reboot.pro/public/style_emoticons/default/duff.gif)\n\nWonko\n\n"
    },
    {
      "id": "220114",
      "timestamp": "2021-12-12T15:35:50+00:00",
      "author": "cdob",
      "content": "\u003e The repair shop probaly does not spend much efforts for further diagnosis, that\u0027s true. Simply, they will replace the faulty part.\n\n.  \nA very strange behaviour, I doubt a general hardware failure still.\n\nGiven a Laptop, the first idea is to remove and attach the internal battery.\n\n.  \nThere are manufacturer emergency approaches, e.g. a emergency pin hole reset button  \n[https://support.leno...er-bios-update/](https://support.lenovo.com/ec/en/solutions/ht510479-device-does-not-restart-after-bios-update/ \"External link\")  \n\nOr Reset the Embedded Controller and Reset the CMOS  \n[https://support.hp.c...2413-2337994-16](https://support.hp.com/in-en/document/ish_3932413-2337994-16 \"External link\")  \n\n"
    },
    {
      "id": "220115",
      "timestamp": "2021-12-12T16:17:33+00:00",
      "author": "Vortex",
      "content": "Hi wimb,\n\nBooting the wim file or the iso file is not dangerous. Using a USB stick or Erwan\u0027s TinyPXE Server with iPxe does not create any problem. The worst scenarios happens if you use bcdedit to modify the BCD store.\n\n"
    },
    {
      "id": "220122",
      "timestamp": "2021-12-13T23:29:59+00:00",
      "author": "alacran",
      "content": "Can you give us the info of failed MBs?\n\nBrand, model, UEFI Bios version and buider. etc.\n\nalacran\n\n"
    },
    {
      "id": "220136",
      "timestamp": "2021-12-15T07:12:09+00:00",
      "author": "alacran",
      "content": "**JFYI**\n\n**Vortex** shared with me by PM the models of the 3 laptop that fail (it seems to me he doesn\u0027t want to make public this info), so only thing I can do is respect his decision:\n\n2 of them are same model of a well known OEM brand.\n\n1 is a model of a OEM brand unknown for me untill I read his message. (I wasn\u0027t able to get more info about it in this case).\n\nFor the first two I found they have A LOT of **Security management** (as they call it) features, in UEFI Bios or as additional UEFI programs + many more as usual software programs.\n\nFrom the full list, of course some of this items work only after the OS is running, but some of them run before the OS is loaded as some are integrated into the UEFI Bios or are UEFI programs, and only thing needed to block the PC is one of them detects an unautorized access to the PC (or as in this case a change in pre-set BCD), to block further boot process.\n\n**So to me there is no dubt the issue is caused by UEFI Bios settings + additional UEFI programs.**\n\n**Many of this **Security management (**features) seem to me as a damn exaggeration from the OEM.**\n\nHope our fellow **Vortex** changes his mind, and share with all in the forum the OEM models of the laptops that faill. Because I really think it is very important to make this info public to avoid more people have same problem.\n\nalacran\n\n"
    },
    {
      "id": "220151",
      "timestamp": "2021-12-15T18:45:28+00:00",
      "author": "Vortex",
      "content": "Hi alacran,\n\nI don\u0027t know if I am allowed to mention about the brands and models, what\u0027s the forum\u0027s rule concerning this case?\n\nToday, one of those computers ( the lesser-known brand ) returned back to my office. Surprisingly, the computer had no any problems and it worked. It passed all my WinPE booting tests including UEFI grub4dos and my batch file above. I asked my colleague if he plugged the power supply and his reply was affirmative so no drain of battery. Mysteriously, it refused to operate in the remote office.\n\n"
    },
    {
      "id": "220049",
      "timestamp": "2021-12-08T17:08:22+00:00",
      "author": "Vortex",
      "content": "Hello,\n\nI am experiencing a very strange and painful case. I have a batch file adding Win10XPE to the boot menu of Windows 10. The purpose is to boot from a .wim file extracted from Win10XPE after restarting the computer. Generally, this method works fine but after restart , some computers failed - the motherboards went broken. This happened three times. The .wim file cannot harm the hardware but I suspect it\u0027s the updated BCD store damaging the computers. Anyone who experienced such a weird case?\n\nAll the failed systems are UEFI and secure boot is enabled.\n\nThe batch file :\n\n\u003cbr /\u003e\n\n```\nbcdedit /export C:\\Bcdbackup.bin\n \nbcdedit /create {ramdiskoptions} /d \"Win10XPE-64bit\"\n \nbcdedit /set {ramdiskoptions} ramdisksdidevice partition\u003dC:\n \nbcdedit /set {ramdiskoptions} ramdisksdipath \\winpe\\boot\\boot.sdi\n \nFOR /F \"tokens\u003d3\" %%a in (\u0027bcdedit -create /d \"Win10XPE-64bit\" /application OSLOADER\u0027) do SET GUID\u003d%%a\n \necho %GUID% \u003e C:\\Win10PE-GUID.txt\n \necho bcdedit /delete %GUID% \u003e C:\\DelWin10PE.bat\n \nbcdedit /set %GUID% device ramdisk\u003d[C:]\\winpe\\sources\\boot.wim,{ramdiskoptions}\n \nbcdedit /set %GUID% path \\windows\\system32\\winload.efi\n \nbcdedit /set %GUID% osdevice ramdisk\u003d[C:]\\winpe\\sources\\boot.wim,{ramdiskoptions}\n \nbcdedit /set %GUID% systemroot \\windows\n \nbcdedit /set %GUID% winpe yes\n \nbcdedit /set %GUID% detecthal yes\n \nREM bcdedit /displayorder %GUID% /addlast\n \nbcdedit /bootsequence %GUID%\n```\n\n\u003cbr /\u003e\n\n"
    },
    {
      "id": "220080",
      "timestamp": "2021-12-10T08:04:27+00:00",
      "author": "alacran",
      "content": "At first seen it seem your Batch file should not be the cause of the problem, only comment I have is the following.\n\nTo be more precise for a PE.wim or a boot.wim file, the BCD entries target are:\n\nOn the Boot\\\\BCD the bootfile target is: \\\\windows\\\\system32\\\\**boot** \\\\winload.exe for MBR/CSM booting.  \nOn the EFI\\\\Microsoft\\\\Boot\\\\BCD the bootfile target is: \\\\windows\\\\system32\\\\**boot**\\\\winload.efi for UEFI booting\n\nIn the future better use [UEFI_MULTI](http://reboot.pro/index.php?showtopic\u003d22254 \"\") program, made by our forum fellow **wimb**.\n\nJust run it from a Win10x64 OS or PE, follow the instructions, (on the very bottom part of its small window), and it will make automatically all entries required to boot a PE or a VHD file from a internal or external drive, valid for MBR/CSM and UEFI.\n\nalacran\n\n"
    },
    {
      "id": "220089",
      "timestamp": "2021-12-10T18:25:39+00:00",
      "author": "Vortex",
      "content": "Hi alacran,\n\nI am working on UEFI systems. Comparing the same file found in different locations :  \n\n```\nC:\\\u003efc C:\\Windows\\System32\\Boot\\winload.efi C:\\Windows\\System32\\winload.efi\nComparing files C:\\WINDOWS\\SYSTEM32\\BOOT\\winload.efi and \\WINDOWS\\SYSTEM32\\WINLOAD.EFI\nFC: no differences encountered\n```\n\nThe result of the test above in the WinPE environment is the same. The batch file is harmless. What I suspect is some Windows updates disturbing the BCD records as the duty of the batch file is only to update the BCD file :\n\n```\n\"\\Efi\\Microsoft\\Boot\\BCD\"\n```\n\nA member of the Microsoft forum reported to use the same method to boot WinPE from RAM. I experienced similar symptoms before the motherboard failure :\n\n\u003e Upon restarting, when the system boots I hear the fans start but then they stop following a few seconds of silence.  \n\u003e The system then starts again with the fans at full speed it sounds like but nothing is displayed on the monitor.  \n\u003e I then have to power it off 1 or 2 times to let the normal boot procedure kick in so I can get back into Windows.\n\u003e\n[https://docs.microso...e-from-ram.html](https://docs.microsoft.com/en-us/answers/questions/563319/setup-bcd-to-boot-pe-from-ram.html \"External link\")\n\nThe same start and stop sequence followed by silence indicating the motherboard going kaput.\n\nBooting from a USB stick or from LAN does not pose any problem. Both of them are good to boot Win10XPE.\n\nHere is another source mentioning about similar BCD handling method :\n\n[https://docs.microso...265131(v\u003dws.10)](https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-7/hh265131(v\u003dws.10) \"External link\")\n\nMy intention is to switch to UEFI grub4dos, this will require the disablement of secure boot. In my tests, I had good results using this tool.\n\n"
    },
    {
      "id": "220090",
      "timestamp": "2021-12-10T18:45:15+00:00",
      "author": "Wonko the Sane",
      "content": "Vortexx, it may or may not be relevant, but you have no way to know.\n\nIf your batch uses:\n\nbcdedit /set %GUID% path \\\\windows\\\\system32\\\\winload.efi\n\nbut (according to Alacran who has some experience in the specific matter) it should use:\n\nbcdedit /set %GUID% path \\\\windows\\\\system32\\\\boot\\\\winload.efi\n\nIt is not by *fc*-ing the two files and finding them identical you are going to prove or disprove anything.\n\nFor all we know the contents of the BCD hive that the path parameter of BCEdit accesses could be read by anything during the boot process and checked \\*like\\*\n\n\"if before winload.efi there is \\\\Boot\\\\ then proceed, otherwise throw a fit\"\n\nor you could put winload.efi into D:\\\\myEFI\\\\ and have it still work correctly, we simply don\u0027t know.\n\n![:duff:](http://reboot.pro/public/style_emoticons/default/duff.gif)\n\nWonko\n\n"
    },
    {
      "id": "220091",
      "timestamp": "2021-12-10T18:56:25+00:00",
      "author": "Vortex",
      "content": "Hi Wonko,  \nIt\u0027s Microsoft mentioning about the path of the .efi file :  \n\n```\nbcdedit -store S:\\EFI\\Microsoft\\Boot\\BCD -set {Default} path \\windows\\system32\\winload.efi\n```\n\n[https://docs.microso...265131(v\u003dws.10)](https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-7/hh265131(v\u003dws.10) \"External link\")  \nI inserted the statement \"boot\" into my batch file, it boots successfully WinPE on my old computer ( old BIOS and not UEFI )  \nI cannot afford the loss of another motheboard so probably better to switch to UEFI grub4dos. It\u0027s a an expensive experiment at least for me. I can tell that with or without the word \"boot\" in the path , the Windows loader can find the .wim file to load.\n\n"
    },
    {
      "id": "220092",
      "timestamp": "2021-12-10T20:26:20+00:00",
      "author": "noel",
      "content": "Hi vortex,  \nin the first link you gave, i see :  \n\"What does the .sdi do and what is it for?\"\n\nYour batch works and modifies bcd on many computers and they start correctly. Ok\n\nBut your script don\u0027t describe the added files .\n\nAs i said iin the \"other site\" where you posted, please describe the added files and especially the directory containing boot.sdi.\n\nIt is possible that this boot.sdi file was missing on the failed 3 ( did you check it before boot ? )\n\nNoel\n\n"
    },
    {
      "id": "220093",
      "timestamp": "2021-12-10T20:57:07+00:00",
      "author": "Vortex",
      "content": "Salut Noel,\n\nAbout boot.sdi :\n\n[https://docs.microso...771845(v\u003dws.10)](https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2008-R2-and-2008/cc771845(v\u003dws.10) \"External link\")\n\nHere is the list of the files extracted from the .iso file with 7-Zip :\n\n\u003cbr /\u003e\n\n```\nC:\\\u003edir /b /s C:\\winpe\n \nC:\\winpe\\boot\nC:\\winpe\\sources\nC:\\winpe\\boot\\bcd\nC:\\winpe\\boot\\bcd.LOG\nC:\\winpe\\boot\\bcd.LOG1\nC:\\winpe\\boot\\bcd.LOG2\nC:\\winpe\\boot\\boot.sdi\nC:\\winpe\\boot\\bootsect.exe\nC:\\winpe\\boot\\en-US\nC:\\winpe\\boot\\etfsboot.com\nC:\\winpe\\boot\\Fonts\nC:\\winpe\\boot\\memtest.exe\nC:\\winpe\\boot\\en-US\\bootmgr.exe.mui\nC:\\winpe\\boot\\en-US\\bootsect.exe.mui\nC:\\winpe\\boot\\en-US\\memtest.exe.mui\nC:\\winpe\\boot\\Fonts\\chs_boot.ttf\nC:\\winpe\\boot\\Fonts\\cht_boot.ttf\nC:\\winpe\\boot\\Fonts\\jpn_boot.ttf\nC:\\winpe\\boot\\Fonts\\kor_boot.ttf\nC:\\winpe\\boot\\Fonts\\malgunn_boot.ttf\nC:\\winpe\\boot\\Fonts\\malgun_boot.ttf\nC:\\winpe\\boot\\Fonts\\meiryon_boot.ttf\nC:\\winpe\\boot\\Fonts\\meiryo_boot.ttf\nC:\\winpe\\boot\\Fonts\\msjhn_boot.ttf\nC:\\winpe\\boot\\Fonts\\msjh_boot.ttf\nC:\\winpe\\boot\\Fonts\\msyhn_boot.ttf\nC:\\winpe\\boot\\Fonts\\msyh_boot.ttf\nC:\\winpe\\boot\\Fonts\\segmono_boot.ttf\nC:\\winpe\\boot\\Fonts\\segoen_slboot.ttf\nC:\\winpe\\boot\\Fonts\\segoe_slboot.ttf\nC:\\winpe\\boot\\Fonts\\wgl4_boot.ttf\nC:\\winpe\\sources\\boot.wim\n```\n\n\u003cbr /\u003e\n\n"
    },
    {
      "id": "220094",
      "timestamp": "2021-12-10T23:10:09+00:00",
      "author": "alacran",
      "content": "\u003e Hi alacran,\n\u003e\n\u003e I am working on UEFI systems. Comparing the same file found in different locations :  \n\u003e\n\u003e ```\n\u003e C:\\\u003efc C:\\Windows\\System32\\Boot\\winload.efi C:\\Windows\\System32\\winload.efi\n\u003e Comparing files C:\\WINDOWS\\SYSTEM32\\BOOT\\winload.efi and \\WINDOWS\\SYSTEM32\\WINLOAD.EFI\n\u003e FC: no differences encountered\n\u003e ```\n\nI also made that comparative long time ago and I can assure you even the SHA1 of the two files is the same, but I also found during my experiments on this topic [Install Win10XPE_x64 Flat or Compact Mode on VHD](http://reboot.pro/index.php?showtopic\u003d22376\u0026hl\u003d \"\") , that not always work the same (if using the usual path to boot a full OS, the PC may boot from a PE or not, and don\u0027t ask me why, as I don\u0027t know the per sure the answer, my theory is it depends of internal code in the Bios), unfortunatelly I didn\u0027t mentioned this findings in detail in that topic, just made a strong recommendation to use the right path, as it will work fine always.\n\nJust going by the book, extract from a Win10XPE_x64.iso both bcd files (yes usually on WinPE they never use capital letters for them, maybe as a way just to diferenciate from the standard BCD), now run [BootIce](http://reboot.pro/index.php?app\u003ddownloads\u0026showfile\u003d592 \"\") and open them and you will see the paths I mentioned are exactly the same.\n\nBut yes, as I said at first seen the path should not be the cause of a MB failure.\n\nLet\u0027s analyze the info you have, in order to find a possible cause:\n\nWhat have in common the MBs that failed:\n\nSame brand\n\nSame model\n\nSame Bios Builder\n\nBuilded same year (then Bios are builded in accordance with certain UEFI version)\n\netc.\n\nThe UEFI specs allow, and even going further promote that the OEM include certain mini programs specifically designed to run during the very first stages of UEFI boot to realize certain tasks supposedly mainly to improve security/safety/speed of booting process, if one of those UEFI programs went too far and is over protecting the BCD(s) to not allow/block the boot of unauthorized/wrong code if detected, this may be the also cause of the failures, so IMHO the Bios code with or without some additional UEFI program is the biggest suspect in this crime investigation, if possible as an extra precaution it is better always disable Secure Boot before working on the boot process or installing a OS (as an extra safety precaution, just in case), Or better (as I always do) just leave it disabled forever, as it is only good to protect MS pocket, forcing all people/companies that make drivers and programs to pay them to get the certification. It doesn\u0027t help to prevent any malware, all malware just laugh about it.\n\nBut only you know all the full info, and only you can put all pieces togheter, please keep us informed, as this info seems very important for all us here, experimenting very frecuently booting every kind of things.\n\nAnd let me tell you why I recommend you to always use UEFI_BOOT, it is very safe because it DOES NOT use any of those paths to boot a WinPE boot.wim, it just let the Bios + the internal code into the OS boot process to handle the path to the target file. Basically it saids use this boot.sdi, find following X.wim file and boot from it. Please see attached pictures.\n\n**NOTE:** BootIce is an old program written before Win10, I have found it does not work fine to create 10 PE entries, (my theory is it laks the GUID code for them), but no problem with any OS, or OS into a VHD or older PE(s), anyway it is very useful to edit 10 PE entries once they exists.  \n\nHope this info was of any help.\n\nalacran  \n\n#### Attached Thumbnails {#attach_wrap}\n\n* [![Booting a PE.png](http://reboot.pro/uploads/monthly_12_2021/post-26560-0-21338500-1639188368_thumb.png)](http://reboot.pro/uploads/monthly_12_2021/post-26560-0-21338500-1639188368.png \"Booting a PE.png - Size: 1.39MB\"){#ipb-attach-url-18407-0-56494700-1676066377}\n* [![Booting a PE-2.png](http://reboot.pro/uploads/monthly_12_2021/post-26560-0-62974800-1639188380_thumb.png)](http://reboot.pro/uploads/monthly_12_2021/post-26560-0-62974800-1639188380.png \"Booting a PE-2.png - Size: 1.34MB\"){#ipb-attach-url-18408-0-56503300-1676066377}\n\n"
    },
    {
      "id": "220095",
      "timestamp": "2021-12-11T01:30:06+00:00",
      "author": "alacran",
      "content": "\u003e Salut Noel,\n\u003e\n\u003e About boot.sdi :\n\u003e\n\u003e [https://docs.microso...771845(v\u003dws.10)](https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2008-R2-and-2008/cc771845(v\u003dws.10) \"External link\")\n\u003e\n\u003e Here is the list of the files extracted from the .iso file with 7-Zip :\n\u003e\n\u003e ```\n\u003e C:\\\u003edir /b /s C:\\winpe\n\u003e  \n\u003e C:\\winpe\\boot\n\u003e C:\\winpe\\sources\n\u003e C:\\winpe\\boot\\bcd\n\u003e C:\\winpe\\boot\\bcd.LOG\n\u003e C:\\winpe\\boot\\bcd.LOG1\n\u003e C:\\winpe\\boot\\bcd.LOG2\n\u003e C:\\winpe\\boot\\boot.sdi\n\u003e C:\\winpe\\boot\\bootsect.exe\n\u003e C:\\winpe\\boot\\en-US\n\u003e C:\\winpe\\boot\\etfsboot.com\n\u003e C:\\winpe\\boot\\Fonts\n\u003e C:\\winpe\\boot\\memtest.exe\n\u003e C:\\winpe\\boot\\en-US\\bootmgr.exe.mui\n\u003e C:\\winpe\\boot\\en-US\\bootsect.exe.mui\n\u003e C:\\winpe\\boot\\en-US\\memtest.exe.mui\n\u003e C:\\winpe\\boot\\Fonts\\chs_boot.ttf\n\u003e C:\\winpe\\boot\\Fonts\\cht_boot.ttf\n\u003e C:\\winpe\\boot\\Fonts\\jpn_boot.ttf\n\u003e C:\\winpe\\boot\\Fonts\\kor_boot.ttf\n\u003e C:\\winpe\\boot\\Fonts\\malgunn_boot.ttf\n\u003e C:\\winpe\\boot\\Fonts\\malgun_boot.ttf\n\u003e C:\\winpe\\boot\\Fonts\\meiryon_boot.ttf\n\u003e C:\\winpe\\boot\\Fonts\\meiryo_boot.ttf\n\u003e C:\\winpe\\boot\\Fonts\\msjhn_boot.ttf\n\u003e C:\\winpe\\boot\\Fonts\\msjh_boot.ttf\n\u003e C:\\winpe\\boot\\Fonts\\msyhn_boot.ttf\n\u003e C:\\winpe\\boot\\Fonts\\msyh_boot.ttf\n\u003e C:\\winpe\\boot\\Fonts\\segmono_boot.ttf\n\u003e C:\\winpe\\boot\\Fonts\\segoen_slboot.ttf\n\u003e C:\\winpe\\boot\\Fonts\\segoe_slboot.ttf\n\u003e C:\\winpe\\boot\\Fonts\\wgl4_boot.ttf\n\u003e C:\\winpe\\sources\\boot.wim\n\u003e ```\n\nWhat a waste of space my friend, to boot a PE from a internal or external drive you only need boot.sdi + boot.wim files, all other required files and folders are already in your EFI partition some in the root and some into EFI folder, in your case of UEFI booting, and same apply in case of MBR/CSM booting but here the folder name is Boot, and usually the boot.sdi file is already into the folder too.\n\nOf course it is a good practice to rename the boot.wim file, and obviously fully required if you have more than one.\n\nalacran\n\n"
    },
    {
      "id": "220098",
      "timestamp": "2021-12-11T09:56:57+00:00",
      "author": "Vortex",
      "content": "Hi alacran,\n\nThanks for your help. I should mention in my first posting in this thread, I am performing remote installations \\\\ maintenance of laptops\\\\desktops located in a remote office. I added TightVNC to my WinPE build to access the computers in the remote branch. Loggining in to Windows, it\u0027s sufficient to run the batch updating the BCD records to boot Win10XPE after restarting the computers. You can imagine the consequences of another motherboard failing, the time for the replacement of the failed part and me losing credits after such incidents. Luckly, two of the computers are under warranty. One of them returned back and the other one visiting the repair shop waiting for the hardware replacement. I can even install and backup Windows over a VPN connection with the procedure I described above.\n\nThe problem is that my chances to request assistance from the remote office is modest and I need to rely on a simple method - keep things simple as much as possible - to do all the job. This is why I prefer a batch file.\n\nTwo of the failing computers are identical, same brand, same model number etc.\n\nIt\u0027s true that only boot.sdi in the boot folder does the job but this folder occupies only 17.1 Mb, a tiny fraction of the hard drive, not a serious waste of space as you might think.\n\nExtracting the BCD file from the wim file, BootIce reflects the complete path you mentioned, it\u0027s \\\\windows\\\\system32\\\\boot. We agree that the path pointing boot.sdi should not be the cause of all the trouble.\n\nI never used UEFI_BOOT. Does it touch the BCD record of the computer? I think that UEFI grub4dos will be safer as it does not have to manipulate the settings of Windows, no any modification of BCD etc.\n\nI am also doing the sysprep operation to distrubute the same Windows setup ( .wim archive including the preinstalled applications ) on identical computer models. I am not a novice in the area of building and using WinPEs, I even used BartPE long years ago.\n\nAbout your paragraph regarding UEFI, all is true as the high-tech companies are the sole winners. UEFI, BCD etc all of those inventions are unnecessarly complicated, the purpose to make more $$$. What about the simplicity of the original UNIX regarding every entitiy as files? Also, every setting going into simple text files.\n\nI will try to focus on the experiences with UEFI grub4dos.\n\n"
    },
    {
      "id": "220099",
      "timestamp": "2021-12-11T10:19:03+00:00",
      "author": "cdob",
      "content": "\u003e the motherboards went broken.\n\u003e\nAll the failed systems are UEFI and secure boot is enabled.  \nThat\u0027s strange. No, I haven\u0027t seen this.  \nCan you clarify: the motherboards went broken?  \nIs there any boot sign at all? Can you go to UEFI settings and load system defaults?  \nWhich motherboards, and which UEFI version went broken?  \nBcdedit writes UEFI boot settings to NVRAM too.  \nNo bcdedit dosn\u0027t write directly, bcdedit asks the UEFI to store boot entry in NVRAM.  \nThe NVRAM storage is limited.  \nIt there are a lot of entries already, there could be a error adding another boot entry.  \nMaybe there is another error.  \nA UEFI reset / removing the CMOS battery may help.\n\n"
    },
    {
      "id": "220100",
      "timestamp": "2021-12-11T10:42:34+00:00",
      "author": "Vortex",
      "content": "Hi cdob,\n\nIn two cases, the authorized repair shop reported the failure of the motherboards. You hit the power button and no any response, no any chance to enter the BIOS or boot the system. Well, the third case didn\u0027t require the assessment of any repair shop, it was easy to guess the failure of the motherboard.\n\n\u003e No bcdedit dosn\u0027t write directly, bcdedit asks the UEFI to store boot entry in NVRAM.\n\u003e\nIt\u0027s the BCD file in the first partition of the computer, the BCD found in the FAT32 partition managed by bcdedit :\n\n```\n\\Efi\\Microsoft\\Boot\\BCD\n```\n\n\u003cbr /\u003e\n\n"
    },
    {
      "id": "220101",
      "timestamp": "2021-12-11T10:58:57+00:00",
      "author": "wimb",
      "content": "**@Vortex**\n\nWhat is the Source of your WinPE and How was it made ?\n\nCould it be that the drivers in your WinPE are causing your motherboard failure ?\n\n"
    },
    {
      "id": "220102",
      "timestamp": "2021-12-11T11:13:39+00:00",
      "author": "Vortex",
      "content": "Hi wimb,\n\nIt\u0027s Win10XPE.iso built from Windows 10 64-bit version 2020 H1. The drivers cannot be the reason of the trouble, the failed computer cannot even boot WinPE.\n\n"
    },
    {
      "id": "220107",
      "timestamp": "2021-12-12T06:22:44+00:00",
      "author": "wimb",
      "content": "\u003e It\u0027s Win10XPE.iso built from Windows 10 64-bit version 2020 H1. The drivers cannot be the reason of the trouble, the failed computer cannot even boot WinPE.\n\nOK\n\nIs ChrisR on GitHub your [Source to make Win10XPE](https://github.com/ChrisRfr/Win10XPE \"External link\") Or do you use another Source ?\n\nWhat is your Win10XPE Build Core Configuration 1 Or 2 ?\n\n1. Run All Programs from RAM - means everything OS + Programs is contained in single WIM file\n\n2. Programs are outside WIM file in Programs Folder Searched for on Drive having Tagfile CDUsb.y\n\n"
    },
    {
      "id": "220108",
      "timestamp": "2021-12-12T08:49:55+00:00",
      "author": "Wonko the Sane",
      "content": "As always I may be wrong, but yours would be among the few, very rare cases where a software can kill hardware, the so-called \"killer poke\"\n\n[https://en.wikipedia...iki/Killer_poke](https://en.wikipedia.org/wiki/Killer_poke \"External link\")\n\nbut usually (like in 99.99% of cases) the result is not really a permanent damage to the hardware, but rather this (or that) type of \"bricking\", i.e. for some reasons software/data embedded in the hardware, i.e. firmware (like the BIOS, or UEFI or the adaptive data on hard disk controllers, etc.) becomes corrupted and prevents the hardware from working.\n\nAs cdob said, with the (stupid) NVRAM it could be a matter of filling it to the brim (and there must be some error in the firmware that doesn\u0027t provide for overwriting old entries or doesn\u0027t protect for writing past the end of available space or doesn\u0027t update correctly some index structure, etc.), this is the only thing that sounds plausible as other (possible in theory) kinds of firmware corruption can only be triggered by very specific code (nothing that can happen in a \"normal\" OS booting, and from what you report you are using a rather common setup for your PE booting, and you are using the \"official\" BCDedit, nothing out of usual).\n\nDepending on the specific motherboard it could be possible (non-destructively) to inspect the contents of the BIOS/UEFI firmware and/or re-flash its contents to factory default.\n\nONLY as an example the procedure is used on some Lenovo Thinkpads by BIOS modders:\n\n[https://www.thinkwik...8xx30_and_up.29](https://www.thinkwiki.org/wiki/Custom_BIOS#Hardware_Flashing_.28xx30_and_up.29 \"External link\")\n\n[https://www.bios-mod...\u003d74575#pid74575](https://www.bios-mods.com/forum/Thread-REQUEST-Lenovo-IdeaPad-S405-Whitelist-Removal?pid\u003d74575#pid74575 \"External link\")\n\n[https://www.chucknem...o-x230-coreboot](https://www.chucknemeth.com/laptop/lenovo-x230/flash-lenovo-x230-coreboot \"External link\")\n\nI don\u0027t think that any ordinary (even if \"authorized\") assistance shop would do this kind of checks/repairs, they most probably apply power, see that it doesn\u0027t boot and emit the sentence \"motherboard is dead\".\n\n![:duff:](http://reboot.pro/public/style_emoticons/default/duff.gif)\n\nWonko\n\n"
    },
    {
      "id": "220110",
      "timestamp": "2021-12-12T13:11:33+00:00",
      "author": "Vortex",
      "content": "Hi Wonko,\n\nThe repair shop probaly does not spend much efforts for further diagnosis, that\u0027s true. Simply, they will replace the faulty part.\n\nThe worst in my case is that the failed computer cannot be powered on so there is not much things to do at this stage. Two different computer brands demonstrated this failure.\n\n"
    },
    {
      "id": "220111",
      "timestamp": "2021-12-12T13:45:38+00:00",
      "author": "Vortex",
      "content": "Hi wimb,\n\nThe source link is ChrisR\u0027s GitHub account :\n\n[https://github.com/ChrisRfr/Win10XPE](https://github.com/ChrisRfr/Win10XPE \"External link\")\n\nMy Win10XPE Build Core Configuration is option 1 placing all the applications to RAM.\n\n"
    },
    {
      "id": "220112",
      "timestamp": "2021-12-12T13:50:25+00:00",
      "author": "wimb",
      "content": "\u003e The source link is ChrisR\u0027s GitHub account :\n\u003e\n\u003e [https://github.com/ChrisRfr/Win10XPE](https://github.com/ChrisRfr/Win10XPE \"External link\")\n\u003e\n\u003e My Win10XPE Build Core Configuration is option 1 placing all the applications to RAM.\n\nThanks for the Info.\n\nI use the same and can always use boot.wim for booting 10XPE from RAMDISK without damaging the motherboard.\n\nI think it remains very strange that you experienced so many times booting 10XPE is causing motherboard failure.\n\n"
    },
    {
      "id": "220113",
      "timestamp": "2021-12-12T15:20:20+00:00",
      "author": "Wonko the Sane",
      "content": "\u003e Hi Wonko,\n\u003e\n\u003e The repair shop probaly does not spend much efforts for further diagnosis, that\u0027s true. Simply, they will replace the faulty part.\n\u003e\n\u003e The worst in my case is that the failed computer cannot be powered on so there is not much things to do at this stage. Two different computer brands demonstrated this failure.\n\nYep, once upon a time, there was the CIH virus:\n\n[https://en.wikipedia...computer_virus)](https://en.wikipedia.org/wiki/CIH_(computer_virus) \"External link\")\n\nAnecdotally, besides the (all in all relatively simple) fat data recovery, at the time I saved quite a few (desktop) boards, if I recall correctly some 8-10 of them (for friends, after self-declared specialized technical assistance laboratories had told them that data was lost and motherboard was dead) by either hot-swapping the BIOS chip, or in a couple cases, replacing it with a chip taken from a \"really dead\" motherboard.\n\n![:duff:](http://reboot.pro/public/style_emoticons/default/duff.gif)\n\nWonko\n\n"
    },
    {
      "id": "220114",
      "timestamp": "2021-12-12T15:35:50+00:00",
      "author": "cdob",
      "content": "\u003e The repair shop probaly does not spend much efforts for further diagnosis, that\u0027s true. Simply, they will replace the faulty part.\n\n.  \nA very strange behaviour, I doubt a general hardware failure still.\n\nGiven a Laptop, the first idea is to remove and attach the internal battery.\n\n.  \nThere are manufacturer emergency approaches, e.g. a emergency pin hole reset button  \n[https://support.leno...er-bios-update/](https://support.lenovo.com/ec/en/solutions/ht510479-device-does-not-restart-after-bios-update/ \"External link\")  \n\nOr Reset the Embedded Controller and Reset the CMOS  \n[https://support.hp.c...2413-2337994-16](https://support.hp.com/in-en/document/ish_3932413-2337994-16 \"External link\")  \n\n"
    },
    {
      "id": "220115",
      "timestamp": "2021-12-12T16:17:33+00:00",
      "author": "Vortex",
      "content": "Hi wimb,\n\nBooting the wim file or the iso file is not dangerous. Using a USB stick or Erwan\u0027s TinyPXE Server with iPxe does not create any problem. The worst scenarios happens if you use bcdedit to modify the BCD store.\n\n"
    },
    {
      "id": "220122",
      "timestamp": "2021-12-13T23:29:59+00:00",
      "author": "alacran",
      "content": "Can you give us the info of failed MBs?\n\nBrand, model, UEFI Bios version and buider. etc.\n\nalacran\n\n"
    },
    {
      "id": "220136",
      "timestamp": "2021-12-15T07:12:09+00:00",
      "author": "alacran",
      "content": "**JFYI**\n\n**Vortex** shared with me by PM the models of the 3 laptop that fail (it seems to me he doesn\u0027t want to make public this info), so only thing I can do is respect his decision:\n\n2 of them are same model of a well known OEM brand.\n\n1 is a model of a OEM brand unknown for me untill I read his message. (I wasn\u0027t able to get more info about it in this case).\n\nFor the first two I found they have A LOT of **Security management** (as they call it) features, in UEFI Bios or as additional UEFI programs + many more as usual software programs.\n\nFrom the full list, of course some of this items work only after the OS is running, but some of them run before the OS is loaded as some are integrated into the UEFI Bios or are UEFI programs, and only thing needed to block the PC is one of them detects an unautorized access to the PC (or as in this case a change in pre-set BCD), to block further boot process.\n\n**So to me there is no dubt the issue is caused by UEFI Bios settings + additional UEFI programs.**\n\n**Many of this **Security management (**features) seem to me as a damn exaggeration from the OEM.**\n\nHope our fellow **Vortex** changes his mind, and share with all in the forum the OEM models of the laptops that faill. Because I really think it is very important to make this info public to avoid more people have same problem.\n\nalacran\n\n"
    },
    {
      "id": "220151",
      "timestamp": "2021-12-15T18:45:28+00:00",
      "author": "Vortex",
      "content": "Hi alacran,\n\nI don\u0027t know if I am allowed to mention about the brands and models, what\u0027s the forum\u0027s rule concerning this case?\n\nToday, one of those computers ( the lesser-known brand ) returned back to my office. Surprisingly, the computer had no any problems and it worked. It passed all my WinPE booting tests including UEFI grub4dos and my batch file above. I asked my colleague if he plugged the power supply and his reply was affirmative so no drain of battery. Mysteriously, it refused to operate in the remote office.\n\n"
    },
    {
      "id": "220153",
      "timestamp": "2021-12-15T19:28:58+00:00",
      "author": "alacran",
      "content": "\u003e I don\u0027t know if I am allowed to mention about the brands and models, what\u0027s the forum\u0027s rule concerning this case?\n\nI don\u0027t see any problem if you share the brands and models, in fact you are an old member of the forum, and not an spammer.\n\nAnd I have no doubt it\u0027s important for all members and readers to know this info, to help avoid this catastrophic failures, if dealing with those models.\n\nalacran\n\n"
    },
    {
      "id": "220155",
      "timestamp": "2021-12-15T20:20:35+00:00",
      "author": "Vortex",
      "content": "Hello,\n\n2 computers : HP Zbook Power G8  \n1 computer : I-Life ZED Air CX5 came back to life without any hardware replacement \\\\ repair.\n\n"
    },
    {
      "id": "220157",
      "timestamp": "2021-12-15T21:52:14+00:00",
      "author": "alacran",
      "content": "Thanks, this allows me to share here the info I found about the desktops mentioned.\n\nAbout the **I-Life ZED Air CX5** that came back to life without any hardware replacement\\\\repair, the issue could be related to any other malfunction of the MB, and not directly related to your batch file editing the BCD, as it is working perfectly fine now, IAW this [post](http://reboot.pro/index.php?showtopic\u003d22578#entry220151 \"\").\n\nNext is a quote of the private message I send to **Vortex** related to the HP desktops info I found:\n\n\u003e **HP Zbook Power G8**   \n\u003e\n\u003e From: [https://www8.hp.com/...e\u003d4AA7-9954ENUC](https://www8.hp.com/h20195/v2/GetDocument.aspx?docname\u003d4AA7-9954ENUC \"External link\")  \n\u003e\n\u003e **Security management:**   \n\u003e\n\u003e [Absolute persistence module](https://www.absolute.com/partners/device-manufacturers/hp/ \"External link\"); [HP Device Access Manager](https://www.shouldiremoveit.com/Device-Access-Manager-for-HP-ProtectTools-9553-program.aspx \"External link\"); [HP Power On Authentication](https://media.flixcar.com/f360cdn/HP-510209750-4aa4-9416enw.pdf \"External link\"); HP Security Manager; Integrated smart card reader; Master Boot Record security; [Pre-boot authentication](https://en.wikipedia.org/wiki/Pre-boot_authentication \"External link\"); HP Sure Click; Windows Defender; HP Secure Erase; HP Manageability Integration Kit; HP Sure Sense; HP Secure Platform; HP Sure Recover Gen3; HP BIOSphere Gen6; [HP Sure Start Gen6; HP Sure Run Gen3](https://www8.hp.com/h20195/v2/getpdf.aspx/4AA7-6645ENW.pdf \"External link\"); [HP Tamper Lock](http://h10032.www1.hp.com/ctg/Manual/c07055601.pdf \"External link\"); Nano Security Lock Slot; HP Client Security Suite Gen7; Trusted Platform Module TPM 2.0; 0; Windows Secured Core.\n\u003e\n\u003e This is the full list, of course some of this items work only after the OS is running, but some of them (with links) run before the OS is loaded and some are integrated into the UEFI Bios, and only thing needed to block the PC is one of them detects an unautorized access to the PC (or as in this case a change in pre-set BCD), to block further boot process.\n\u003e\n\u003e **So to me there is no dubt the issue is caused by UEFI Bios settings + additional UEFI programs.**\n\u003e\n\u003e Maybe after a careful reading of UEFI Bios guide (if exists), you can dissable the undesired features, but I highly doubt it, as usually there is not any HP UEFI Bios guide to read.\n\u003e\n\u003e **Many of this features seem to me as a damn exaggeration.**\n\u003e\n\u003e But I can\u0027t investigate further as I don\u0027t have one of those PCs. You will have to do it yourself.\n\u003e\n\u003e alacran\n\nIn the previous quote I added some links to some features that seemed suspicious to me, as a possible cause of the MB blocking, but this **does not** mean these are the only potential causes of the issue.\n\nSo I strongly recommend in case of HP PCs, better analyze carefully all the **Security management** features, added by the OEM, before intent to make any modifications to the boot files/folders, (including editing so common things as the BCD), to avoid any potential malfunction or blocking of the MB.\n\nalacran\n\n"
    },
    {
      "id": "220158",
      "timestamp": "2021-12-15T22:38:40+00:00",
      "author": "cdob",
      "content": "\u003e Today, one of those computers ( the lesser-known brand ) returned back to my office. Surprisingly, the computer had no any problems\n\n-  \nWell, the computer was off/no external power supply for a couple of days.  \nThis may be the difference.  \n\nI see, the motherboard failure arise at another location, another town, another users, average end users,\n\nI\u0027ve no idea about real issue:\n\nbroken motherboard, replace hardware\n\nclear CMOS (basic motherboard settings)\n\npress power button a long time, power down by hardware and restart  \n\nLet\u0027s assume the simple case:  \nDo this users know basic rescue? Press and hold the power button for 10 - 30 seconds?  \nShut down the machine thoroughly and restart.  \nMaybe there is no real issue, just a minor clitch.\n\nAnother idea: boot.wim at drive c: and bitlocker  \nSorry, I wonder currently only, no question, no suggestion so far. It\u0027s a idea only.\n\n"
    },
    {
      "id": "220178",
      "timestamp": "2021-12-16T18:37:24+00:00",
      "author": "Vortex",
      "content": "Hi cdob,\n\nIt\u0027s not about the intervention of other people. It was me, the last user who faced the motherboard failure after the attempt to boot to WinPE.\n\n\u003e press power button a long time, power down by hardware and restart\n\u003e\nI am afraid that should be the last resort as today\u0027s hardware is more fragil if you consider that the latest laptops are shipped with NVME m2 drives.\n\nBitlocker was turned off.\n\n"
    },
    {
      "id": "220179",
      "timestamp": "2021-12-16T18:58:41+00:00",
      "author": "Vortex",
      "content": "Hi alacran,\n\nThe meeting of iLife and HP at the same failure after the WinPE experiment is a very strange coincidence. This is life as you can have million type of coincedences.\n\nThe adventures in the twilight zone continued today. The latest HP notebook returned back from maintenance. The report indicated the motherboard replacement. I tried again the batch file and everything went smoothly, Win10XPE booting successfully. The same hardware , the OS intact with the same securiy software. Later, I installed Windows 2021 H1 to get rid of the extra software bundled with the computer. I was able to update the BCD record with my batch file and boot to WinPE.\n\n\u003e So I strongly recommend in case of HP PCs, better analyze carefully all the **Security management** features, added by the OEM, before intent to make any modifications to the boot files/folders, (including editing so common things as the BCD), to avoid any potential malfunction or blocking of the MB.\n\u003e\nExactly. I agree with you.\n\nI copied the UEFI grub4dos loader to the FAT32 partition and renamed it to bootmgfw.efi ( the original Windows EFI boot manager renamed to bootmgfw10.efi ) I had no problem to boot to Windows. Tomorrow, I will try to boot the iso file :\n\nmenu.lst :\n\n\u003cbr /\u003e\n\n```\ncolor blue/green yellow/red white/magenta white/magenta\ntimeout 30\ndefault /default\n \ntitle Windows 10\n \nchainloader /EFI/Microsoft/Boot/bootmgfw10.efi\n \ntitle Win10XPE\n \nfind --set-root /Win10XPE_x64.iso\nmap --mem /Win10XPE_x64.iso (0xff)\nchainloader (0xff)\n```\n\n\u003cbr /\u003e\n\n"
    },
    {
      "id": "220183",
      "timestamp": "2021-12-17T12:26:04+00:00",
      "author": "Wonko the Sane",
      "content": "Gibbs\u0027 Rule #39  \nThere is no such thing as a coincidence.  \n[https://ncis.fandom....s/Gibbs\u0027s_Rules](https://ncis.fandom.com/wiki/Leroy_Jethro_Gibbs/Gibbs%27s_Rules \"External link\")  \n\nWhat happened to you (actually to your laptops) is more likely defined as \"Act of God\":  \n\n\u003e When a passenger check-in desk at Terminal Two, Heathrow Airport, shot up through the roof engulfed in a ball of orange flame, the usual people tried to claim responsibility. First the IRA, then the PLO and the Gas Board. Even British Nuclear Fuels rushed out a statement to the effect that the situation was completely under control, that it was a one in a million chance, that there was hardly any radioactive leakage at all and that the site of the explosion would make a nice location for a day out with the kids and a picnic, before finally having to admit that it wasn\u0027t actually anything to do with them at all.  \n\u003e\n\u003e No rational cause could be found for the explosion - it was simply designated an act of God. But, thinks Dirk Gently, which God? And why? What God would be hanging around Terminal Two of Heathrow Airport trying to catch the 15:37 to Oslo?\n\n![:duff:](http://reboot.pro/public/style_emoticons/default/duff.gif)  \nWonko   \n"
    },
    {
      "id": "220188",
      "timestamp": "2021-12-17T22:44:09+00:00",
      "author": "alacran",
      "content": "\u003e Hi alacran,\n\u003e\n\u003e **1 -** I tried again the batch file and everything went smoothly, Win10XPE booting successfully. The same hardware , the OS intact with the same securiy software.\n\u003e\n\u003e **2 -**I copied the UEFI grub4dos loader to the FAT32 partition and renamed it to bootmgfw.efi ( the original Windows EFI boot manager renamed to bootmgfw10.efi ) I had no problem to boot to Windows. Tomorrow, I will try to boot the iso file :\n\u003e\n\u003e menu.lst :\n\u003e\n\u003e ```\n\u003e color blue/green yellow/red white/magenta white/magenta\n\u003e timeout 30\n\u003e default /default\n\u003e  \n\u003e title Windows 10\n\u003e  \n\u003e chainloader /EFI/Microsoft/Boot/bootmgfw10.efi\n\u003e  \n\u003e title Win10XPE\n\u003e  \n\u003e find --set-root /Win10XPE_x64.iso\n\u003e map --mem /Win10XPE_x64.iso (0xff)\n\u003e chainloader (0xff)\n\u003e ```\n\n**I\u0027m glad it\u0027s working as you want now, but following some questions and comments to clarify some things.**\n\nRelated to the blue numbers added in the quote of your post:\n\n****1 -**About this case (The same hardware , the OS intact with the same security software):**\n\n1. Did you make any changes in Bios? as disabling Secure Boot in this case?\n2. Is it possible somebody modified Bios settings before your first failed attempt?\n3. Is it possible Bios or **Security management** (UEFI programs) incorporated in Bios of new MB, where updated or pre-set different by the OEM or the repair facility?\n\n****2 -**It also works fine booting using UEFI grub4dos loader:**\n\n**But you are omiting to boot this way Secure Boot has to be disabled,** because it is well known the **UEFI grub4dos loader** **DOES NOT** work if SB is enabled.\n\nAnd I\u0027m 99 % sure, (in this case, just by disabling SB), this also disabled all other **Security management** things added by the OEM, (unless you disabled manually also some other items in the Bios before disabling SB, and also omitted to mention it).\n\n**So it seems in this case this is the key difference from your first intent, and now there is not something unexpected as SB is disabled.**\n\nRemember my comment on post [No. 8](http://reboot.pro/index.php?showtopic\u003d22578#entry220094 \"\"):\n\u003e\n\u003e ...if possible as an extra precaution it is better always disable Secure Boot before working on the boot process or installing a OS (as an extra safety precaution, just in case), Or better (as I always do) just leave it disabled forever, ...\n\nalacran\n\n"
    },
    {
      "id": "220213",
      "timestamp": "2021-12-19T09:57:18+00:00",
      "author": "Vortex",
      "content": "Hi alacran,\n\nI didn\u0027t modify the BIOS. Secure boot was already disabled before the motherboard issue.  \nBefore the first failed attempt, no body touched the BIOS settings.  \nI don\u0027t think that the repair facility changes any settings, simply they changed the mother board.  \nUEFI grub4dos loads the .iso file without any problem. I am not omitting the status of secure boot ( disabled )  \nIt\u0027s always on my mind.  \nSomething interesting, before the motherboard failed, the boot menu was presented as GUI display, blue screen with white text.  \nAfter the repair, the boot menu appears as console window text, white characters on black screen.\n\n"
    },
    {
      "id": "220215",
      "timestamp": "2021-12-19T11:27:26+00:00",
      "author": "alacran",
      "content": "\u003e Hi alacran,\n\u003e\n\u003e I didn\u0027t modify the BIOS. Secure boot was already disabled before the motherboard issue.  \n\u003e Before the first failed attempt, no body touched the BIOS settings.  \n\u003e I don\u0027t think that the repair facility changes any settings, simply they changed the mother board.  \n\u003e UEFI grub4dos loads the .iso file without any problem. I am not omitting the status of secure boot ( disabled )  \n\u003e It\u0027s always on my mind.  \n\u003e Something interesting, before the motherboard failed, the boot menu was presented as GUI display, blue screen with white text.  \n\u003e After the repair, the boot menu appears as console window text, white characters on black screen.\n\u003e\nSorry to disagree with you, but:\n\nHP very clearly says this model is freely updatable to Win11. In order to let OEMs say certain product is Win 11 updatable they have to comply with certain rules, one of them is their products have Secure Boot enabled and also that the PC has the TPM: [Trusted Platform Module](https://docs.microsoft.com/en-us/windows/security/information-protection/tpm/trusted-platform-module-overview \"External link\") (TPM) version 2.0 already installed into the MB.\n\nPreviously (when failed) it was booting in the usual GUI mode, now it is booting in text mode (boot menu policy \u003d legacy), please see attached picture, this change is made editing the BCD, this means the settings are not exactly the same as when the MB failed, so they were changed very possibly on the certified maintenance shop, including disable SB, and it also seems to me it is highly probable in first failed intent, SB was enabled (as it is usual), and you just involuntarily forgot to check it, and you are assuming you verified it.\n\nI didn\u0027t mean you intentionally omitted in your previous post SB is currently disabled, I only mean you did not make any comment about its current status.\n\nChanging the boot menu to legacy (boot menu policy \u003d legacy), has an aditional advantage, it allows to boot directly to the option selected by the user, in GUI mode to boot anything different to the default Win OS installed, the PC is forced to make an extra new reboot and then it finaly boots from that option.\n\nBut anyway I\u0027m glad it is working fine now the way you want/need.\n\nalacran  \n\n#### Attached Thumbnails {#attach_wrap}\n\n* [![Legacy-boot.png](http://reboot.pro/uploads/monthly_12_2021/post-26560-0-34628200-1639913201_thumb.png)](http://reboot.pro/uploads/monthly_12_2021/post-26560-0-34628200-1639913201.png \"Legacy-boot.png - Size: 69.44KB\"){#ipb-attach-url-18429-0-82767000-1676066377}\n\n"
    },
    {
      "id": "220238",
      "timestamp": "2021-12-19T18:29:39+00:00",
      "author": "Vortex",
      "content": "Hi alacran,\n\nThe secure boot feature was disabled before the motherboard failure. Let me explain. I installed all the required software on the HP laptop, sysprepped the operating system and then selected the boot from LAN in the BIOS settings, plus disabled secure boot ( SB ) . The reason to disable SB was to use Erwan\u0027s Tiny PXE Server supported by iPxe. Before the sysprep operation, I kept all the default \\\\ bundled software of HP.\n\nReceiving the laptop from the repair shop, I can confirm that the state of SB remained intact, it was disabled.\n\nI will investigate the case of the legacy boot menu policy, thanks for the info.\n\n"
    },
    {
      "id": "220241",
      "timestamp": "2021-12-19T21:21:48+00:00",
      "author": "alacran",
      "content": "Ok, that confirms SB was in fact and beyond any doubt disabled on your first intent when the MB failed, but at the same time will require an additional quest to find the cause of the issue, because this confirmed info also proves having SB disabled in that failed MBs was not enought to avoid the issue.\n\nThen IMHO remaining possible culprid(s) is one (or more) of the extra **Security management** bundled programs.\n\nAbout:\n\u003e\n\u003e I will investigate the case of the legacy boot menu policy, thanks for the info.\n\nIf you are thinking in ask the repair shop about this, also ask them if they also made any other additional change on Bios, like disabling some of the extra Security management, because you would like to congratulate them if they did it, as it fixed the cause of failure, (maybe asking this way you can get desired info).\n\nIf they didn\u0027t disable some of those additional programs, then both MB(s) are maybe from the same batch with this defect (or improper default setting in Bios), that now is fixed by the OEM in new batches.\n\nAnd I think after this there is no more that can be done to try to solve this mystery.\n\nalacran\n\n"
    },
    {
      "id": "220255",
      "timestamp": "2021-12-22T19:28:34+00:00",
      "author": "Vortex",
      "content": "Hi alacran,\n\nToday, I had the opportunity to contact the call center of the authorized repair service. They told me that they could turn on the secure boot option if necessary. This does not apply to my case as the secure boot feature was not activated after the first repair.\n\n"
    }
  ]
}