{
  "id": "2013",
  "title": "Booting a USB HDD to Win98 DOS for Wipe\u0026Ghost",
  "isPinned": false,
  "isFirstTopic": false,
  "isLocked": false,
  "tags": [],
  "forumNotes": [
    {
      "id": "12733",
      "timestamp": "2007-04-23T21:03:10+00:00",
      "author": "stevenhicks",
      "content": "Hey all, i\u0027m new here, but i\u0027ve done some searching and I can\u0027t seem to find any help. I\u0027m sure i\u0027m just missing something, but i\u0027m not sure what.  \n\nI\u0027m trying to create a bootable USB Hard Drive that I can use to wipe the local fixed disks and then install one of three ghost images stored on that USB HD. This is an automated process started by a config.sys menu that I created which lets you pick the specific image you need to install on that system. The script then boots, wipes all hard drives and installs that image without stopping or taking input from the user. I used the HP format utility to copy system files from a win98 bootdisk to make the USBHD bootable.  \n\n\\[EDIT\\]Minor detail! As you can imagine 3 full system images weighs in at 9.5 gigs, so most of the strategies of booting with 512Mb flash drives are out because I can\u0027t format in FAT(16) which seems to be a requirement of some of these programs.  \n\nThe problems i ran into with this were: I have to wipe ALL hard drives in the system and since the USB HD was showing up as C: and a hard drive, it tries and succeeds in wiping itself ![:cheers:](http://reboot.pro/public/style_emoticons/default/cheers.gif)   \nAlso, Ghost wants to copy the image to C: and make that the booting drive, but since I\u0027m running Ghost from C: AND trying to copy the image to C:, it blows up.  \n\nSo, now my questions. I\u0027ve been thinking that if i could get the USB HD to boot up as any other letter than C:, i could at least get ghost to work properly. I could specify in the Wiping program to only wipe the primary Hard Drive, which isnt optimal, but those two together could solve my problems.  \n\nWhat would be optimal is to not only boot as something other than C: but to also make the USB HD look like a removable disk or a floppy so that the wiping program doesnt pay any attention to it (but would also wipe any secondary HDs in the system)  \n\nSo, my question to you all is, is this possible? By the way, i tried out WinBuilder today to see if that would help and i think the file is corrupted. I get blank (white) pages in every pane of the application (Scripts, Web, etc) The tutorial screenshots don\u0027t look anything like what i\u0027m seeing. ![:cheers:](http://reboot.pro/public/style_emoticons/default/cheers.gif)   \n"
    },
    {
      "id": "12735",
      "timestamp": "2007-04-23T21:59:17+00:00",
      "author": "MedEvil",
      "content": "\u003e Hey all, i\u0027m new here, but i\u0027ve done some searching and I can\u0027t seem to find any help. I\u0027m sure i\u0027m just missing something, but i\u0027m not sure what.  \n\u003e\n\u003e I\u0027m trying to create a bootable USB Hard Drive that I can use to wipe the local fixed disks and then install one of three ghost images stored on that USB HD. This is an automated process started by a config.sys menu that I created which lets you pick the specific image you need to install on that system. The script then boots, wipes all hard drives and installs that image without stopping or taking input from the user. I used the HP format utility to copy system files from a win98 bootdisk to make the USBHD bootable.  \n\u003e\n\u003e \\[EDIT\\]Minor detail! As you can imagine 3 full system images weighs in at 9.5 gigs, so most of the strategies of booting with 512Mb flash drives are out because I can\u0027t format in FAT(16) which seems to be a requirement of some of these programs.  \n\u003e\n\u003e The problems i ran into with this were: I have to wipe ALL hard drives in the system and since the USB HD was showing up as C: and a hard drive, it tries and succeeds in wiping itself ![:cheers:](http://reboot.pro/public/style_emoticons/default/cheers.gif)   \n\u003e Also, Ghost wants to copy the image to C: and make that the booting drive, but since I\u0027m running Ghost from C: AND trying to copy the image to C:, it blows up.  \n\u003e\n\u003e So, now my questions. I\u0027ve been thinking that if i could get the USB HD to boot up as any other letter than C:, i could at least get ghost to work properly. I could specify in the Wiping program to only wipe the primary Hard Drive, which isnt optimal, but those two together could solve my problems.  \n\u003e\n\u003e What would be optimal is to not only boot as something other than C: but to also make the USB HD look like a removable disk or a floppy so that the wiping program doesnt pay any attention to it (but would also wipe any secondary HDs in the system)  \n\u003e\n\u003e So, my question to you all is, is this possible? By the way, i tried out WinBuilder today to see if that would help and i think the file is corrupted. I get blank (white) pages in every pane of the application (Scripts, Web, etc) The tutorial screenshots don\u0027t look anything like what i\u0027m seeing. ![:cheers:](http://reboot.pro/public/style_emoticons/default/cheers.gif)\nNo, there\u0027s no way i know of, to tell Win98 or DOS what drive letter to use. (Why don\u0027t you tell your wiping program to start with drive letter D instead of C?)  \nBut you can do so with WinPe, it\u0027s by default drive letter X.   \n"
    },
    {
      "id": "12749",
      "timestamp": "2007-04-24T09:12:33+00:00",
      "author": "was_jaclaz",
      "content": "Let\u0027s clear up some \"misconceptions\". ![:cheers:](http://reboot.pro/public/style_emoticons/default/cheers.gif)  \n1) FAT16 is NOT actually a requisite of a program or another, but rather a requisite of **SOME** BIOSes that won\u0027t boot from USB with FAT32 or NTFS, if your motherboard(s) support booting from FAT32 or NTFS, that isn\u0027t a problem, on the other hand, NOTHING prevents from multipartitioning the stick, with a small FAT16 partition active as first one.  \nUNLIKE NT based systems, DOS manages a multipartitioned USB \"removable\" device just like a normal HD.  \n\n2) the problem with DOS/Win9x is that the OS needs to be booted from First Active Partition of First hard disk. The OS later assigns letter C: to that partition.  \nIt should be possible to workaround in three ways:  \na) by using grub4dos to map the hd partition to a floppy, something along the lines of:  \n\n```\nEmulates HD partition C\u0026#58; as floppy drive A\u0026#58; and boot win98 from A\u0026#58;\n\n\n\n\t\tmap --read-only \u0026#40;hd0,0\u0026#41;+1 \u0026#40;fd0\u0026#41;\n\n\t\tmap --hook\n\n\t\tchainloader \u0026#40;fd0\u0026#41;+1\n\n\t\trootnoverify \u0026#40;fd0\u0026#41;\n\n\t\tmap --floppies\u003d1\n\n\t\tboot\n```\n\n![:cheers:](http://reboot.pro/public/style_emoticons/default/cheers.gif) by using grub4dos with map --mem or hmload to create a RAMdisk at boot, copy to it the files and boot from it  \n(use grub4dos 0.4.2) here:  \n[http://grub4dos.jot.com/WikiHome](http://grub4dos.jot.com/WikiHome \"External link\")  \n[http://grub4dos.jot....r_dos-0.4.2.zip](http://grub4dos.jot.com/WikiHome/grub_for_dos-0.4.2.zip \"External link\")  \n**IF** it doesn\u0027t work, do try LATEST \"nightbuild\", currently:  \n[http://grub4dos.jot....-2007-04-21.zip](http://grub4dos.jot.com/WikiHome/grub4dos-...-2007-04-21.zip \"External link\")  \n\nc) by using Letter Assigner:  \n[http://www.v72735.f2s.com/LetAssig/](http://www.v72735.f2s.com/LetAssig/ \"External link\")  \nPlease find here an example on how this can be used:  \n[http://www.geocities...eedatarecovery/](http://www.geocities.com/freedatarecovery/ \"External link\")  \n\nIt mostly depends on how GHOST sees drives, I am not really familiar with it, but I guess that it accesses them at a lower level than DOS does, so I cannot say if changing letters will be useful, most probably you will have to combine at least two of the above hints.  \n\nI am quite sure, however, that GHOST has commands to selectively wipe drives and partitions, so maybe you are using a \"too drastical\" set of commands.  \nCan you post your config.sys or whatever batch file you are using, maybe it is possible to \"improve\" it.  \n\njaclaz   \n"
    },
    {
      "id": "12764",
      "timestamp": "2007-04-24T13:47:39+00:00",
      "author": "stevenhicks",
      "content": "Wow! Thanks for the help people. I appreciate the clarifications. I\u0027ll spend the morning sorting through the above posts, but i\u0027ll post my autoexec and config to show you what i\u0027m doing. The suggestion of making Grub show my HD as a floppy sounds very promising. Again, thanks for the assistance. ![:cheers:](http://reboot.pro/public/style_emoticons/default/cheers.gif)   \n\nConfig.sys  \n\\[codebox\\] \\[MENU\\] menuitem\u003dWIPE,Wipe Drive menuitem\u003dDESKTOP,Install Desktop Image menuitem\u003dLAPTOP1,Install Single Core Laptop Image menuitem\u003dLAPTOP2,Install Dual Core Laptop Image menuitem\u003dWIPEDESK,Wipe and install Desktop Image menuitem\u003dWIPELAP1,Wipe and install Single Core Laptop Image menuitem\u003dWIPELAP2,Wipe and install dual core laptop image menuitem\u003dQUIT,Quit menudefault\u003dQUIT menucolor\u003d15,1 \\[COMMON\\] \\[WIPE\\] \\[DESKTOP\\] \\[LAPTOP1\\] \\[LAPTOP2\\] \\[WIPEDESK\\] \\[WIPELAP1\\] \\[WIPELAP2\\] \\[QUIT\\]\\[/codebox\\] And the Autoexec \\[codebox\\] @ECHO OFF CTMOUSE.EXE if %CONFIG%\u003d\u003dWIPEDESK goto WIPE if %CONFIG%\u003d\u003dWIPELAP1 goto WIPE if %CONFIG%\u003d\u003dWIPELAP2 goto WIPE goto %CONFIG% :WIPE bcwipepd wSILENT -d\\* -p3 if %CONFIG%\u003d\u003dWIPEDESK goto DESKTOP if %CONFIG%\u003d\u003dWIPELAP1 goto LAPTOP1 if %CONFIG%\u003d\u003dWIPELAP2 goto LAPTOP2  \ngoto END  \n\n:DESKTOP  \nghost -clone,mode\u003dload,src\u003ddesktop.gho,dst\u003d0 -sure  \ngoto END  \n\n:LAPTOP1  \nghost -clone,mode\u003dload,src\u003dlaptop.gho,dst\u003d0 -sure  \ngoto END  \n\n:LAPTOP2  \nghost -clone,mode\u003dload,src\u003ddclaptop.gho,dst\u003d0 -sure  \ngoto END  \n\n:QUIT  \ngoto END  \n\n:END\\[/codebox\\]   \n"
    },
    {
      "id": "13160",
      "timestamp": "2007-05-01T19:24:12+00:00",
      "author": "stevenhicks",
      "content": "Ok i must be doing something wrong here. I took the code that jaclaz provided and put it in a file called media.lst but every time i run grub either in config.sys or straight from the command line like...  \n\ninstall\u003dc:\\\\grub\\\\grub.exe --config-file\u003d\"#@c:\\\\grub\\\\menu.lst\"  \n\n...I get a blank screen with a cursor blinking in the top left and nothing happens. I searched for that on the forum but i have yet to find a doc that really explains what each switch is. \\*Not complaining\\* I just am trying to explain the cause of my ignorance ![:confused1:](http://reboot.pro/public/style_emoticons/default/confused1.gif)   \n\nAnyway, some insight would be appreciated.   \n"
    },
    {
      "id": "13190",
      "timestamp": "2007-05-02T08:43:06+00:00",
      "author": "was_jaclaz",
      "content": "Well, you might want to start a step by step approach.  \n1) make a DOS boot disk and copy to it grub.exe and a menu.lst  \n2) once booted from it, simply type grub \\[ENTER\\]   \n3) grub ~~will~~ should start  \n4) press c, you will enter command mode  \n5) input command lines one by one, pressing \\[ENTER\\] at the end of it each time  \n6) in most cases grub4dos will return a message (either of success or failure)  \n7) once you have given all needed commands input   \n\n```\nboot\n```\n\nand \\[ENTER\\]  \n\nThis way you have more control on each command and it\u0027s results.  \n\nAnyway, hoping that   \n\u003e I took the code that jaclaz provided and put it in a file called **media** .lst  \n\u003e ....  \n\u003e install\u003dc:\\\\grub\\\\grub.exe --config-file\u003d\"#@c:\\\\grub\\\\**menu**.lst\"\nis just a typo ![:confused1:](http://reboot.pro/public/style_emoticons/default/confused1.gif)  \nthe \"snippet\" I posted misses a fundamental pre-requisite, a **title** .  \nA proper \"full\" menu.lst appears something like:  \n\u003e # This is a basic menu.lst file for GRUB4DOS, in the version for ezG4DOS.  \n\u003e # You can make changes to it.  \n\u003e\n\u003e # Following lines load a splashimage and set text foreground/background colour  \n\u003e # splashimage /GRUB4DOS/ezG4DOS.xpm.gz  \n\u003e foreground \u003d 69ed4e  \n\u003e background \u003d 337326  \n\u003e\n\u003e # Following line is the choice for colours when background image is NOT SET  \n\u003e # (see above) they are commented out as a splashimage is SET   \n\u003e # color black/cyan yellow/cyan  \n\u003e\n\u003e # Following is the timeout for the default choice  \n\u003e # By not pressing any key during the timeout, the default will be chosen  \n\u003e timeout 10  \n\u003e # Following is the menu item that will default  \n\u003e default 0  \n\u003e\n\u003e # This reflects the \"normal\" behaviour of a PC  \n\u003e # i.e. booting the first partition of first harddisk  \n\u003e # By setting it as default with timeout 10 seconds (see above)  \n\u003e # We try to replicate somehow the \"Press any key to boot from CD...\" message  \n\u003e # of Microsoft Install CDs, this way if no key is pressed, as an example for   \n\u003e # unattended installs, the system will boot \"normally\" even if CD is inserted  \n\u003e # of course if the \"any\" you press is \\[ENTER\\] system will boot from this entry  \n\u003e title Boot Hard Disk MBR on (hd0,0)  \n\u003e chainloader (hd0,0)+1  \n\u003e rootnoverify (hd0)  \n\u003e\n\u003e title Win98 Boot  \n\u003e find --set-root /grldr  \n\u003e kernel /memdisk.gz  \n\u003e initrd /win98.ima  \n\u003e\n\u003e \u003cbr /\u003e\n\u003e\n\u003e title Win98.ima  \n\u003e find --set-root /win98.ima  \n\u003e map --mem /win98.ima (fd0)  \n\u003e map --hook  \n\u003e root (fd0)  \n\u003e chainloader (fd0)+1  \n\u003e\n\u003e \u003cbr /\u003e\n\u003e\n\u003e title Win98.ima  \n\u003e find --set-root /win98.ima  \n\u003e map --mem /win98.ima (fd0)  \n\u003e map --hook  \n\u003e root (fd0)  \n\u003e chainloader (fd0)/IO.SYS  \n\u003e\n\u003e **title exchange HD with floppy**   \n\u003e map --read-only (hd0,0)+1 (fd0)  \n\u003e map --hook  \n\u003e chainloader (fd0)+1  \n\u003e rootnoverify (fd0)  \n\u003e map --floppies\u003d1\n\nLines beginning with # are just comments.  \n\nThe command \"boot\" is implied and executed as last command of an entry in menu.lst even if not present.  \n\nThere is no \"real\" help file and docimentation about the commands, you can refer to the more general GRUB docs, but as most Linux man pages, it describes single commands and gives no examples of the sequence in which commands are executed.  \n\nThe readme.txt that comes inside grub4dos gives some examples, but your best bet to find some more ones is to search on the 911CD forum for posts by me (jaclaz) and diddy with keyword \"grub4dos\".  \n\njaclaz   \n"
    },
    {
      "id": "13335",
      "timestamp": "2007-05-03T20:40:13+00:00",
      "author": "stevenhicks",
      "content": "jaclaz, thanks for the further clarification. I actually did get grub to work after following your idea to simplify.  \n\nA few things though. First that script only mirrors a hard drive onto A:. I can still go to C: and see and delete the files, which not only removes them from view on A: but actually deletes them from the drive. Did I do something wrong? I did \"hide\" (hd0,0) which kept my bootable usb drive from showing up as C:, but wouldn\u0027t that keep my local fixed disk from becoming C:?  \n\nAlso, if i run grub, do what i need to do and shut down, it appears to corrupt my command.com or my bootfiles. If i need to use the drive again, i get \"Bad or missing command interpreter\" or something to that effect. I dont see a \"shutdown\" command for grub...   \n"
    }
  ]
}