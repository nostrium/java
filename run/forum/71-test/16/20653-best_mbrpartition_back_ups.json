{
  "id": "20653",
  "title": "best mbr/partition back ups?",
  "isPinned": false,
  "isFirstTopic": false,
  "isLocked": false,
  "tags": [],
  "forumNotes": [
    {
      "id": "194406",
      "timestamp": "2015-08-07T13:30:43+00:00",
      "author": "Zoso",
      "content": "hi all,  \n\nI want to add a logical partition with Xpx64 at the end of a 1.5TB USB HDD. has 11 partitions on it now that I spent alot of time to make work because most of the partitions Ive made bootable using PTEdit and adjusting offsets to boot from logical.  \n\nbefore I make any changes to the partition structure I want to make sure I have a solid back-up strategy first since Ive lost work like this in the past by adding to it. one time I had a similar setup and when attempting this same thing (adding a single logical partition at the end) somehow all the partitions in the extended area disappeared!  \n\n\u003cbr /\u003e\n\nwhat tools do I need to use to be able to recover from this if it happens again?  \n\nthanks   \n"
    },
    {
      "id": "194407",
      "timestamp": "2015-08-07T13:53:14+00:00",
      "author": "Zoso",
      "content": "my main concern is if a normal backup of mbr will save a hybridized patririon layout? (one Ive edited sector info in order to boot XP variants from logical partitions)  \n\nIve been using mbrwhisky but sometimes it returns strange format type info that does not match what diskmananger displays and I have never tried to restore an mbr with a backup from mbrwiz so I just want to be sure as possible I have a solid back up before I mess with a layout that I spent weeks to perfect.  \n\nthanks   \n"
    },
    {
      "id": "194410",
      "timestamp": "2015-08-07T14:33:56+00:00",
      "author": "Wonko the Sane",
      "content": "Logical partitions do not exist.\n\nA partition is either Primary or Extended.\n\nA logical volume can be created inside the Extended Partition.\n\nThe MBR lists ONLY 4 Primary partitions or 3 Primary partitions and an Extended one.\n\nWhat (the heck) is a hybridized partition \"layout\" according to you?\n\nThe term hybrid is nowadays used for \"hybrid\" MBR/GPT MBR\u0027s or for hybrid .iso\u0027s, i.e. iso\u0027s that are the same time a CD/DVD image and a hard disk image.\n\nCorrecting the \"sectors before\" happens in the bootsector (or PBR or VBR) and has nothing to do with partition \"layout\", you are simply replacing a relative offset (from the last EMBR/EPBR) with an absolute offset (from the actual MBR or LBA0).\n\nIn a nutshell:\n\n* If you have only Primary partitions, backing up the MBR is enough.\n* If you have one Extended partition you need to backup both the MBR and each and every EMBR/EPBR in the Extended Partition chain.\n\nThe former is easy (and \\*any\\* tool will do nicely), the latter is (or can be) complex.\n\nTry what you can get with secinspect.exe/SI.bat:\n\n[http://thestarman.pc...sRefs.htm#SIbat](http://thestarman.pcministry.com/asm/mbr/BootToolsRefs.htm#SIbat \"External link\")\n\n![:duff:](http://reboot.pro/public/style_emoticons/default/duff.gif)\n\nWonko\n\n"
    },
    {
      "id": "194412",
      "timestamp": "2015-08-07T15:15:06+00:00",
      "author": "Zoso",
      "content": "hi Wonko,  \n\nit seems that you and from the info in the linkage youve posted, suggest that I can back up everything only in a text file as a reference and then to restore I would need to do it manually again with PTedit, is this correct?  \n\nalso, this part \"so we assume Microsoft included this dire warning only to let you know that you could be overwriting critical information on the same disk you are reading from?\" makes me not want to try it. could the same data be re-aquired by running PTEdit and just writting down all the results so that I can re-enter later if needed and would that work?  \n\nthanks   \n"
    },
    {
      "id": "194413",
      "timestamp": "2015-08-07T15:47:07+00:00",
      "author": "Wonko the Sane",
      "content": "Yes and no.\n\nAs said backing up the MBR is easy.\n\nTo backup the whole chain of EPBR/EMBR\u0027s needs some \"intelligent parsing\" and since there are a lot of assumptions (some right some wrong) in the zillion programs that can be used to partition (or re-partition) hard disks on different or on same Operating System, often conflicting between them on how a disk is actually partitioned it is possible that the parsing of the info is incorrect.\n\nMore than that, while it is easy enough to compare two MBR\u0027s (let\u0027s say current vs. backed up) comparing a whole chain with another one is more complex, as each EPBR/EMBR contains two \"partition like\" entries:\n\n1) pointing to the actual volume\n\n2) pointing to next EMBR/EPBR\n\nLet\u0027s see if I can explain the issue:\n\nMBR:\n\n#0 or (hd0,0) Primary partition at offset 63 with extent of 100000 sectors\n\n#1 or (hd0,1) Extended partition at offset 100063 with extents 200000 sectors\n\nOutside the MBR:\n\nFirst EMBR/EPBR at offset 100063 and contains two entries:\n\n#4 or (hd0,4) Logical volume at offset 100126 with extents 50000 sectors\n\nSecond EMBR/EPBR at offset 150126 containing two entries:\n\n#5 or (hd0,5) Logical volume at offset 150189 with extents 50000 sectors\n\nThird EMBR/EPBR at offset 200189 containing two entries:\n\n#6 or (hd0,6) Logical volume at offset 200252 with extents 50000 sectors\n\nFourth EMBR/EPBR at offset 250252 containing two entries:\n\n#7 or (hd0,7) Logical volume at offset 250315 with extents 49748 sectors\n\nBlank entry as the chain is interrupted\n\nMaybe you can now appreciate the \"telescopic nature\" of the contents of an Extended Partition, the above represents a \"normal\" partitioning scheme (in the sense of \"sequentially created\"), but if you delete (say) the (hd0,5) and (hd0,6) the partitioning editing software will change the second entry in the First EMBR/EPBR to point to the Fourth EMBR/EPBR (which obviously becomes the Second one).\n\nWhen you re-use the extents previously occupied by the deleted volumes, a new \"Third\" EMBR/EPBR will be introduced and - depending on the procedure/program used it may be linked to by the \"Second\" (ex \"Fourth\") or by the \"First\" (and then the new \"Third\" will become the \"Second\" and the \"Second\" (ex -\"Fourth\") will become \"Third\".\n\nIf you are confused by the above, don\u0027t worry, it\u0027s pretty much normal as it ***is*** confusing, you\u0027ll probably need some time to digest the concepts, that I hope to have anyway somehow helped in clearing.\n\n![:duff:](http://reboot.pro/public/style_emoticons/default/duff.gif)\n\nWonko\n\n"
    },
    {
      "id": "194415",
      "timestamp": "2015-08-07T16:11:18+00:00",
      "author": "Zoso",
      "content": "I can see it more clearly than before anyway..  \n\nI recall having set up a HDD with several EMBR/EPBR edited to boot OSs from extended logical partitions as I decribed earlier and one time I decided to change an OS in the middle of the \"chain\" of EMBR/EPBRs.  \n\nI simply used diskmanager to delete a partition so I could recreate it fresh again but what I did not expect is it wipped out several others when I only deleted one!  \n\nI think a better plan for now is to delete only the OS files and folders inside another existing partition that is now less desirable than the one I wanted to add at the end and then copy the files/folders of the new one to that old one without modifying any MBR/EMBR/EPBR data.  \n\nI just dont want to screw up the largest HDD I have. not only the data (its all backed up) but more importantly, it took lots of time to make it all work.   \n\n\u003cbr /\u003e\n\nthanks   \n"
    },
    {
      "id": "194434",
      "timestamp": "2015-08-08T08:32:59+00:00",
      "author": "Wonko the Sane",
      "content": "\u003e I recall having set up a HDD with several EMBR/EPBR edited to boot OSs from extended logical partitions as I decribed earlier and one time I decided to change an OS in the middle of the \"chain\" of EMBR/EPBRs.  \n\nAnd **AGAIN**those were modified PBR\u0027s (or VBR\u0027s or bootsectors or partition/volume boot records), namely ONLY the \"Sectors Before\" or \"Hidden Sectors\" field in them, NOT ANYTHING in the EMBR/EPBR chain:\n\n[http://www.goodells.net/multiboot/](http://www.goodells.net/multiboot/ \"External link\")\n\n[http://www.goodells....ot/ptable.shtml](http://www.goodells.net/multiboot/ptable.shtml \"External link\")\n\n![:duff:](http://reboot.pro/public/style_emoticons/default/duff.gif)\n\nWonko\n\n"
    },
    {
      "id": "194448",
      "timestamp": "2015-08-08T13:07:52+00:00",
      "author": "karyonix",
      "content": "\u003e I simply used diskmanager to delete a partition so I could recreate it fresh again but what I did not expect is it wipped out several others when I only deleted one!\nOne disk manager that has this bug is Windows XP disk management.  \nWhenever it changes anything in MBR, it will also delete partitions that do not end on cylinder boundary.  \nIt will do this even if you just tell it to change active partition.  \nPartitions created by Windows XP are not affected.  \n\nPartitions created by Windows Vista and later (which ignore disk geometry) are susceptible to this bug.  \nIt is super bad bug.  \nIf you use Windows XP, be very careful.  \nIt is possible to create partitions that have 1MB alignment in Windows Vista+ and also be compatible with Windows XP.  \nMake sure all partitions end on (multiple of 16065 MB) (when cylinder is 255\\*63 sector).  \nExample  \nFirst primary partition start:(1 MB) size:((multiple of 16065)-1 MB)  \nMore primary partition start:(multiple of 16065 MB) size:(multiple of 16065 MB)  \nExtended partition start:(multiple of 16065 MB) size:(multiple of 16065 MB)  \nLogical volume start:((multiple of 16065)+1 MB) size:((multiple of 16065)-1 MB)  \nWith this layout, it will be tolerant to Windows XP disk management.  \nIt is better not to use Windows XP disk management.   \n"
    },
    {
      "id": "194449",
      "timestamp": "2015-08-08T13:15:31+00:00",
      "author": "Wonko the Sane",
      "content": "Yep :smile:.\n\nBut any number of third party tools may have similar (though hopefully not as destructive as this) issues, one needs to be ***very careful*** in what tool he/she uses and learn what it actually does.\n\nJust for the record the XP DIsk Manager issue is described here:\n\n[http://reboot.pro/to...itioning-issue/](http://reboot.pro/topic/9897-vistawin7-versus-xp-partitioning-issue/ \"\")\n\n[http://www.dcr.net/\\~...gPartitions.htm](http://www.dcr.net/~w-clayton/Vista/DisappearingPartitions/DisappearingPartitions.htm \"External link\")\n\nPlease note how Primary partitions are **NOT** affected by this bug, only Extended Partitions (actually what \"vanish\" are the Logical Volumes inside Extended).\n\n![:duff:](http://reboot.pro/public/style_emoticons/default/duff.gif)\n\nWonko\n\n"
    },
    {
      "id": "194458",
      "timestamp": "2015-08-08T15:23:47+00:00",
      "author": "Zoso",
      "content": "hi karyonix,  \n\nthat certainly explains it! and I recall loosing all logical partitions once while simply changing the active partition too. you have saved me from making a potentially huge mistake!  \n\nIve lots more to learn about this but thanks so much for pointing this out.  \n\nwithout having read the links yet that Wonko has provided on the subject, it this problem simply due to the 63 vs 2048 sector difference between XP and later OS\u0027s?  \n\nfrom here onward I will not touch important HDD layouts without learning more about them and testing everything on less important HDDs including any related 3rd party tools.   \n\nthanks again!   \n"
    },
    {
      "id": "194461",
      "timestamp": "2015-08-08T16:46:23+00:00",
      "author": "Wonko the Sane",
      "content": "\u003e without having read the links yet that Wonko has provided on the subject, it this problem simply due to the 63 vs 2048 sector difference between XP and later OS\u0027s?\n\nYes and no.\n\nMeaning that is mainly due to the 63 vs. \\*any other number\\* of sector alignment.\n\nAnd even the 63 is *most probably* not really-really 63 but rather 63 only on disks/devices exposing a disk CHS geometry of m/n/63.\n\nNon-63 sectors per head disks devices are not in any way common, but they do exist (as an example CF cards).\n\n![:duff:](http://reboot.pro/public/style_emoticons/default/duff.gif)\n\nWonko\n\n"
    }
  ]
}