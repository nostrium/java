{
  "id": "13060",
  "title": "MARV\u0027s service to Boot from USB",
  "isPinned": false,
  "isFirstTopic": false,
  "isLocked": false,
  "tags": [],
  "forumNotes": [
    {
      "id": "114016",
      "timestamp": "2010-11-17T02:06:37+00:00",
      "author": "Holmes.Sherlock",
      "content": "While trying to follow the guide @ [http://www.911cd.net...showtopic\u003d22473](http://www.911cd.net/forums//index.php?showtopic\u003d22473 \"External link\") , I\u0027m facing difficulty in following \\\u0026 understanding the first step itself. It says,  \n\n\u003e Start installing on the USB drive and break after first reboot. Then boot working OS and connect your USB drive there.\n\nI don\u0027t have a physical machine to test the instructions on. So, I gave a try to VMWare by mounting the USB drive as a PHYSICALDISK. But unfortunately Windows setup couldn\u0027t find any HD attached to the system. Is there any means to get it work on VMWare or other virtualization platform?  \n\nAlso can anybody explain to me what does the second part of step-I mean?  \n\n\u003e If you use Vista/2008 you might get error message (system cannot be installed on USB hdd blabla). Easiest way is to connect your USB hdd to your PC over sata/ide, start installation, and after first reboot, place it to your external USB case again (continue step 2, and continue installation from USB drive!!!).\n\n"
    },
    {
      "id": "114024",
      "timestamp": "2010-11-17T04:58:20+00:00",
      "author": "amalux",
      "content": "If OS allows, begin installation directly to USB drive and at first re-boot stop. Switch to normal running OS and apply patch to external (USB) drive (the one with partial install) from there.  \n\nIf you get error attempting to install directly to external USB drive, remove from case and temporarily connect as internal drive (SATA or IDE connection) and begin install from there. At first re-boot, stop and re-connect as external USB to continue ...   \n"
    },
    {
      "id": "114027",
      "timestamp": "2010-11-17T05:25:42+00:00",
      "author": "Holmes.Sherlock",
      "content": "\u003e If OS allows, begin installation directly to USB drive ..........\n\nThat doesn\u0027t answer my question. I want to perform the initial part of the installation in VMWare by mounting the pen drive as PHYSICALDISK. Can I do that?  \n\n\u003e If you get error attempting to install directly to external USB drive.......\n\nI\u0027m **NOT** using an SATA/IDE HD encased in external USB covering. I\u0027m using it an ADATA PEN drive / Thumb drive / USB drive of size 4 GB   \n"
    },
    {
      "id": "114041",
      "timestamp": "2010-11-17T10:55:57+00:00",
      "author": "Wonko the Sane",
      "content": "The use off Marv\u0027s tutorial assumes that you are familiar with Dietmar\u0027s approach, AND, like ANY Tutorial is made for a given setup/hardware.  \n\nAs always :wink:, you ***say*** that you try following a given tutorial ***BUT*** you start by introducing a variation/change to it.  \n\nIf you do not have the EXACT, SAME setup/hardware that the Tutorial is made for, it is VERY likely that you will NEVER be able to follow it.  \n\nTry using Qemu Manager instead of VMware.  \n\nAs said a number of times by now, Qemu (and Qemu Manager) is a tad slower than other VM\u0027s but is \"nearer\" to real hardware when it comes to these kinds of tests, expecially becausde it uses \"standard\" drivers instead of the \"special ones\" other machines need.  \n\nThe easiest is to make a copy of the USB stick, install to the image in the VM.  \nAdd Marv\u0027s service.  \nImage back to the USB stick.  \n\n![:hi:](http://reboot.pro/public/style_emoticons/default/hi.gif)  \nWonko   \n"
    },
    {
      "id": "114059",
      "timestamp": "2010-11-17T14:50:40+00:00",
      "author": "amalux",
      "content": "\u003e That doesn\u0027t answer my question...\nThe question I answered was:  \n\n\u003e Also can anybody explain to me what does the second part of step-I mean?\nYou\u0027re welcome ![:hi:](http://reboot.pro/public/style_emoticons/default/hi.gif)   \n"
    },
    {
      "id": "114101",
      "timestamp": "2010-11-18T07:08:12+00:00",
      "author": "Holmes.Sherlock",
      "content": "\u003e The question I answered was:\n\nSorry **Amalux,** I misunderstood.   \n"
    },
    {
      "id": "114126",
      "timestamp": "2010-11-18T15:42:53+00:00",
      "author": "amalux",
      "content": "\u003e Sorry **Amalux,**I misunderstood.\nThat\u0027s cool ![:hi:](http://reboot.pro/public/style_emoticons/default/hi.gif)   \n\nI wish I could help with you\u0027re other question but I\u0027ve had similar issues, I don\u0027t believe it\u0027s possible to set this up in VMWare (or qEmu for that matter), especially with a thumb drive. The *closest* I\u0027ve come to what you want is using hard drive imaging tools to backup a working install (Win7 x86/64 on internal drive), restore that backup to external USB (ufd/hdd) and patch it with [PWBoot](http://www.boot-land.net/forums/index.php?showtopic\u003d6851 \"External link\"). This has worked well for me on the limited number of machines I\u0027ve tested but others have reported mixed results. I know it\u0027s not what you asked but just offering an alternative approach. Unfortunately, this only works with Vista/Win7 and 4GB is a bit small for full install, I\u0027ve never tried it on less than 8GB.  \n\nBtw, what do you mean by *\"I don\u0027t have a physical machine to test the instructions on.\"* , I guess you don\u0027t have machine that boots from USB?? or don\u0027t have machine with working installation of XP (or better)?? or??   \n"
    },
    {
      "id": "114136",
      "timestamp": "2010-11-18T20:26:26+00:00",
      "author": "tstaddon",
      "content": "I have configured a VMWare with blank OS, and the CD drive uses an ISO that gives me a small blue-ish graphical menu with the option to boot from USB. It then boots from pen drive, external HDD...   \n\nI\u0027m not at my work PC right now, but can dig out the exact config and post it here. Worked with VMWare 5 and 6, just updated to the latest release and it still works.   \n"
    },
    {
      "id": "114141",
      "timestamp": "2010-11-18T21:51:50+00:00",
      "author": "amalux",
      "content": "\u003e I have configured a VMWare with blank OS, and the CD drive uses an ISO that gives me a small blue-ish graphical menu with the option to boot from USB. It then boots from pen drive, external HDD...\nBooting from an ISO mounted at CD/DVD device is easy; booting from prepared UFD/USB is easy. What needs to happen here is different, VMWare needs to \u0027see\u0027 a physical UFD/USB drive and install OS there; what happens for me is VMWare only sees the virtual hard drive at setup, even though USB is attached and shown as active in VM interface. If you have setup that gets past this road block, please share and be precise so we can reproduce conditions.  \n\nOnce OS is installed (at least till first re-boot) in VM (or qEmu), the drive needs to be recognized in real OS for patching and continued install.   \n"
    },
    {
      "id": "114146",
      "timestamp": "2010-11-18T22:20:49+00:00",
      "author": "Wonko the Sane",
      "content": "JFYI:  \n[http://www.boot-land...?showtopic\u003d9688](http://www.boot-land.net/forums/index.php?showtopic\u003d9688 \"External link\")  \n[http://www.boot-land...?showtopic\u003d8042](http://www.boot-land.net/forums/index.php?showtopic\u003d8042 \"External link\")  \n\nUnless very recently Qemu/Qemu Manager has added \"pass-through\" USB support for Mass Storage devices :wink:, you cannot TEST an actual USB booting, you can use Qemu to prepare the stick, but the actual testing needs to be done on real hardware.  \n\n![:hi:](http://reboot.pro/public/style_emoticons/default/hi.gif)  \nWonko   \n"
    },
    {
      "id": "114164",
      "timestamp": "2010-11-19T03:10:52+00:00",
      "author": "Holmes.Sherlock",
      "content": "\u003e Btw, what do you mean by *\"I don\u0027t have a physical machine to test the instructions on.\"....*\n\nI meant to say that I don\u0027t have a machine which I can use to perform such experiments. The laptop I\u0027m using is for office purpose \\\u0026 can\u0027t afford it to be unbootable ![:hi:](http://reboot.pro/public/style_emoticons/default/hi.gif)   \n"
    },
    {
      "id": "114165",
      "timestamp": "2010-11-19T03:15:09+00:00",
      "author": "Holmes.Sherlock",
      "content": "\u003e I have configured a VMWare with blank OS, and the CD drive uses an ISO that gives me a small blue-ish graphical ...........\n\nWhat ISO? Which boot-manager?   \n"
    },
    {
      "id": "114166",
      "timestamp": "2010-11-19T04:32:01+00:00",
      "author": "Holmes.Sherlock",
      "content": "After a lot of trouble, I finally managed to get a physical machine. According to the instruction, I plugged in a pen drive there, broke after text mode setup had completed, installed **marv** \u0027s service \\\u0026 carried on second part of the installation. Everything worked fine. But, as expected, XP dropped NTLDR, NTDETECT.COM, boot.ini in the first primary partition of internal HD. The internal Win 7 install ceased to boot. I copied the above files to the root of USB \\\u0026 performed a startup repair of Win 7. It revived. I forgot to mention that I formatted the USB stick by FAT(16). I peeped into the MBR \\\u0026 VBR code with a hex editor. It looked like normal XP boot-code. The only partition of the USB stick is marked \u0027active\u0027 (That I saw from \u0027Disk Management\u0027). When I boot the USB, it shows that \"Disk error, Press any key to restart\". I found this string in the VBR of the USB stick. It means that at least MBR code is recognising the active partition \\\u0026 passing control to appropriate VBR. What am I missing out? Can u plz explain?   \n"
    },
    {
      "id": "114168",
      "timestamp": "2010-11-19T04:41:56+00:00",
      "author": "skyide",
      "content": "\u003e Unless very recently Qemu/Qemu Manager has added \"pass-through\" USB support for Mass Storage devices , you cannot TEST an actual USB booting, you can use Qemu to prepare the stick, but the actual testing needs to be done on real hardware\n\nActually, there is a tool that will do just that :wink:  \n\n*The developers of MobaLiveCD have created an extremely useful and simple tool to test a bootable USB drive within Windows without restarting your computer.\nIt uses the Qemu engine to boot a Virtual Machine from a Physical Drive.This tool is also useful for people whose motherboards do not support booting from your USB drive.\nAll you have to do is\n1. Download MobaLiveUSB from here: [http://mobalivecd.mo...LiveUSB_0.1.exe](http://mobalivecd.mobatek.net/MobaLiveUSB_0.1.exe \"External link\")\n2. Copy the EXE file to somewhere in your USB flash drive\n3. Run MobaLiveUSB from your USB flash drive.\nThats it.Your USB drive will now boot in a Qemu Virtual Machine*   \n\nSource: [http://agnipulse.com...-your-computer/](http://agnipulse.com/2009/07/test-bootable-usb-drive-without-restarting-your-computer/ \"External link\")  \n\n![:hi:](http://reboot.pro/public/style_emoticons/default/hi.gif)   \n"
    },
    {
      "id": "114169",
      "timestamp": "2010-11-19T04:48:45+00:00",
      "author": "Holmes.Sherlock",
      "content": "\u003e *Download MobaLiveUSB from here:*\n\n**Wonko** has already given links to respective threads.   \n"
    },
    {
      "id": "114170",
      "timestamp": "2010-11-19T04:53:07+00:00",
      "author": "skyide",
      "content": "My bad ![:hi:](http://reboot.pro/public/style_emoticons/default/hi.gif)   \n"
    },
    {
      "id": "114340",
      "timestamp": "2010-11-20T18:15:03+00:00",
      "author": "Holmes.Sherlock",
      "content": "The following are my queries pertaining to **marv** \u0027s method:  \n\n1) I succeeded in building a bootable UFD using **marv** \u0027s method. As reported, system32\\\\config\\\\system is not editable as soon as text mode setup completes. That\u0027s why, I need to use **cdob** \u0027s **usb_xp_init.cmd** . But, the script failed to backup the hive. I tried twice, but the result was the same.  \n\n![Posted Image](http://img841.imageshack.us/img841/4630/marvcdob.jpg)  \nThe reason was %date% returns the date in the format \u0027**Sat 11/20/2010** \u0027. **cdob** \u0027s code for copying the registry was  \n\n```\ncopy \u0026#34;%XP_system32%\\config\\system\u0026#34; \u0026#34;%XP_system32%\\config\\system_%date%.sav\u0026#34;\n```\n\n\u003cbr /\u003e\n\nIt appends the date with the prefix \u0027system_\u0027. But, as it contains embedded \u0027slash\u0027(/) character which is not permitted as a part of filename, the following error was returned : \u0027The system cannot find the file specified\u0027. This was my analysis. Is my interpretation correct?  \n\n2) **cdob** explained the fact of not being able to write to system registry as   \n\n\u003e ........ the system registry uses system permission..........\n\nWhere is the permission information stored? I found that the registry was not \u0027read-only\u0027.  \n\n3) The USB XP is booting successfully on the same machine on which it was built bu fails on other platforms. Do I need some HAL related or other adjustments to boot it on other machine?   \n"
    },
    {
      "id": "114343",
      "timestamp": "2010-11-20T18:28:09+00:00",
      "author": "Wonko the Sane",
      "content": "#1 ***maybe*** :wink:, simply change the / to _ underscore in the batch, like :  \n\n```\nset mydate\u003d%date\u0026#58;/\u003d_%\n\ncopy \u0026#34;%XP_system32%\\config\\system\u0026#34; \u0026#34;%XP_system32%\\config\\system_%mydate%.sav\u0026#34;\n```\n\nBetter, READ:  \n[http://www.robvander.../datetiment.php](http://www.robvanderwoude.com/datetiment.php \"External link\")  \n\n#2 ***WHERE*** **cdob** said that?  \nNEVER post a snippet/one liner out of context without a link to the \"whole\" thing, if you want anyone else to be able to understand.  \nAre you working on NTFS or FAT filesystem?  \nHave you ever studied - even lightly - NTFS?  \n[http://www.windowsec...ermissions.html](http://www.windowsecurity.com/articles/Understanding-Windows-NTFS-Permissions.html \"External link\")  \n\nJFYI ![:hi:](http://reboot.pro/public/style_emoticons/default/hi.gif):  \n[http://www.grubletra...app\u003dPowerPrompt](http://www.grubletrang.com/Software.aspx?app\u003dPowerPrompt \"External link\")  \n....from time to time I do like giving boxes of matches to kids, to see what happens... ![:hi:](http://reboot.pro/public/style_emoticons/default/hi.gif)  \n\n#3 Oww, comeon :wink:, a good 1/10 of XP on USB device related questions are about HOW DIFFICULT is to make it really portable.  \nStart reading and studying:  \n[http://www.911cd.net...hp?showforum\u003d43](http://www.911cd.net/forums//index.php?showforum\u003d43 \"External link\")  \n[http://www.boot-land...?...ic\u003d9830\\\u0026hl\u003d](http://www.boot-land.net/forums/index.php?showtopic\u003d9830\u0026hl\u003d \"External link\")  \n\n:wink:  \nWonko   \n"
    },
    {
      "id": "114364",
      "timestamp": "2010-11-21T02:17:46+00:00",
      "author": "Holmes.Sherlock",
      "content": "\u003e #1 ***maybe*** :wink: , simply change the / to _ underscore in the batch, like :\n\nHat\u0027s of to u, **Batch Guru**   \n\n\u003e Are you working on NTFS or FAT filesystem?\n\nI\u0027m working on **FAT 16** , but the link talks about NTFS ![:hi:](http://reboot.pro/public/style_emoticons/default/hi.gif)   \n\n\u003cbr /\u003e\n\n\u003e ....from time to time I do like giving boxes of matches to kids, to see what happens... ![:hi:](http://reboot.pro/public/style_emoticons/default/hi.gif)\n\nNot a matchbox, a bomb indeed :wink:   \n"
    }
  ]
}