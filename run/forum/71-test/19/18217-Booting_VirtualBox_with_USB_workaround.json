{
  "id": "18217",
  "title": "Booting VirtualBox with USB workaround",
  "isPinned": false,
  "isFirstTopic": false,
  "isLocked": false,
  "tags": [],
  "forumNotes": [
    {
      "id": "168410",
      "timestamp": "2013-02-26T01:12:25+00:00",
      "author": "eblip",
      "content": "To start off, I know that VirtualBox doesn\u0027t have built in USB boot support, but there are a number of workarounds. Despite my best efforts all the workarounds I\u0027ve found online have failed in some fashion or another.\n\nI\u0027m attempting to use USB to install Windows 7 onto a VM. I think the issue might be in the way this thumb drive was prepped. It was made with RMPrepUSB and it works perfectly from a normal BIOS boot in physical machines.\n\nIf all my Windows installers on this USB were in ISO that would be no problem, but two of them required dumping the ISO contents onto the USB root since they didn\u0027t support emulation. The Win 7 AIO installer I plan to use is one of these.\n\nThings tried:\n\nVirtualBox raw disk emulation (The most recommended method from what I can tell). I set my USB to be viewed as a raw disk using:\n\nVBoxManage internalcommands createrawvmdk -filename \"%USERPROFILE%\"\\\\.VirtualBox\\\\usb.vmdk -rawdisk \\\\\\\\.\\\\PhysicalDrive3\n\nUsing this I can load the USB and boot into Grub, select my Windows 7 installer. The pre-installer loads fine, but during the \"Starting Windows\" portion my RAM usage spikes and crashes the VM. I tried a few different things, including using Host I/O caching, but always the same RAM spike and VM crash.\n\nNext I tried:\n\nPlop boot. I was optimistic but after trying it I realized loading a 4GB image and doing install at 1.0 speed would have taken hours if not days. Just the in installer setup would have taken hours (Still looking for something similar that could provide 2.0 support).\n\nThen I tried:\n\nMaking an ISO of the entire thumb drive following instructions here:\n\n[http://www.rmprepusb...makegrub4dosiso](http://www.rmprepusb.com/tutorials/makegrub4dosiso \"External link\")\n\nI tried using both available tools mkisofs.exe \\\u0026 OSCDIMG.exe with the same results. The ISO image is created and trying to boot will load grub, but grub can\u0027t find menu.lst. I tried adjusting caps on menu.lst but it didn\u0027t seem to matter.\n\nRight now I\u0027m thinking something like Plop boot with USB 2.0 support would be ideal, but I haven\u0027t had any luck finding one. Honestly though, getting any of above methods to work would be fine by me, but I\u0027m out of ideas. I\u0027m hoping someone will notice something silly I overlooked. Any help at all would be great, even if they\u0027re extreme or inconvenience solutions.\n\n\u003cbr /\u003e\n\n"
    },
    {
      "id": "168418",
      "timestamp": "2013-02-26T08:18:33+00:00",
      "author": "Blackcrack",
      "content": "i ask they people of VBox if they are not include the USB-Support as Boot possibility in the VM.  \n\nthey told it\u0027s want be a interesting thing maybe in the future.. it is now a jear ago, maybe can ask they in the are too in the VBOX-Forum ?\n\nbest regards\n\nBlacky\n\n"
    },
    {
      "id": "168425",
      "timestamp": "2013-02-26T11:26:36+00:00",
      "author": "steve6375",
      "content": "Not quite clear what you are trying to achieve - USB flash boot using Win 7 ISO, USB HDD boot, DVD boot???\n\nWhat method did you use to prepare the USB drive? If using Tut 43 (ISO from Flash drive) then it won\u0027t work on an emulator/VM as the drive appears as a fixed drive not a removable drive.\n\n"
    },
    {
      "id": "168427",
      "timestamp": "2013-02-26T11:41:42+00:00",
      "author": "Blackcrack",
      "content": "Steve you be offtopic, there it is speak about Virtualbox and Booting in USB\n\nand I said that I had ask because of the already in Virtualbox forum.\n\nand to the 2nd I have not to use your methods .. it\u0027s give others too.. why do you insist on it..\n\ni dont like f... tutorials, i want a programm who do this what i want..\n\nI do not like the song : \"four corners you have to go\"\n\nif give one easy way..\n\nand if you so mighty, why do you not create a programm who create via Virtualbox-programm on usb\n\na vhd, you programm can insert on the usb a grub4dos, use Virtualbox to install a Win7 and prepar\n\nthe vhd for the next boot via grub4dos . For have a easy program for create a virtualbox+vhd+grub4dos+usb\n\n**Edited by Blackcrack, 26 February 2013 - 11:50 AM.**\n"
    },
    {
      "id": "168428",
      "timestamp": "2013-02-26T11:43:28+00:00",
      "author": "eblip",
      "content": "\u003e Not quite clear what you are trying to achieve - USB flash boot using Win 7 ISO, USB HDD boot, DVD boot???\n\u003e\n\u003e What method did you use to prepare the USB drive? If using Tut 43 (ISO from Flash drive) then it won\u0027t work on an emulator/VM as the drive appears as a fixed drive not a removable drive.\n\nI have a USB drive, prepped with RMprepUSB using Grub4Dos, that has several windows/linux installers on it, all of which will boot fine on a physical machine. Some of the installers are intact ISO\u0027s, but two of installers are unpacked ISOs placed right on the root of the USB. Presently, the only Win 7 installer I have is on this USB drive, but VirtualBox won\u0027t boot from USB and the installer I need is not an intact ISO. I\u0027m trying to find anyway that I can get Win 7 installed on VirtualBox.\n\n"
    },
    {
      "id": "168429",
      "timestamp": "2013-02-26T11:45:22+00:00",
      "author": "steve6375",
      "content": "Why not map the ISO file as a CD in VB and boot from it?\n\nWhy can\u0027t you boot from a USb drive from VBox? Just set the port as a device see [http://www.rmprepusb...r-vmware-server](http://www.rmprepusb.com/tutorials/how-to-boot-from-usb-under-vmware-server \"External link\")\n\n"
    },
    {
      "id": "168430",
      "timestamp": "2013-02-26T11:47:52+00:00",
      "author": "eblip",
      "content": "\u003e i ask they people of VBox if they are not include the USB-Support as Boot possibility in the VM.  \n\u003e\n\u003e they told it\u0027s want be a interesting thing maybe in the future.. it is now a jear ago, maybe can ask they in the are too in the VBOX-Forum ?\n\u003e\n\u003e best regards\n\u003e\n\u003e Blacky\n\n\u003cbr /\u003e\n\nThey\u0027re probably nice people and all, but any time I found anyone mentioning booting USB on VirtualBox, the questioners were not treated very kindly. (I have a feeling it\u0027s a sensative subject). The questioners were more or less told \"VirtualBox does not support USB booting\" and it doesn\u0027t seem they want to promote people using such workarounds as I\u0027ve outlined above. That is just my guess though.\n\n"
    },
    {
      "id": "168431",
      "timestamp": "2013-02-26T11:51:51+00:00",
      "author": "eblip",
      "content": "\u003e Why not map the ISO file as a CD in VB and boot from it?\n\nI tried, both using a Windows host and an Ubuntu host. In Windows, VirtualBox will boot the USB, menu.lst will come up, I can select my Windows 7 entry and everything seems to be fine. The pre-install loads fine (The long white bar at the bottom). It\u0027s when I get to the \"Starting Windows\" screen that my host RAM spikes about 1GB per second and in 8 seconds VirtualBox crashes with an error about VERR_ACCESS_DENIED. This happens no matter how much RAM I give to the guest system.\n\nIn Ubuntu, Virtualbox won\u0027t even find the MBR, menu.lst never comes up.\n\n"
    },
    {
      "id": "168432",
      "timestamp": "2013-02-26T12:08:23+00:00",
      "author": "Blackcrack",
      "content": "imho, should be it possible to boot on usb, but i think they don\u0027t want it..\n\nlike i know, all it is possible in code today, but if they not like to do.. :\\\\\n\nit want be the best possibility to have a running system on USB2/3 maybe\n\ncrypted for a possibility to quick disconnect / take away .. or for using a qemu-usb-boot-programm\n\nwho i have anywhere see here.. for have a Virtual environment for let start the usb-stick over the desktop (edit: MobaLiveUSB_0.2.exe )..\n\nthat\u0027s all if can create a normal installed Winnt System on usb like i can do with Openmandriva before 5 jears..\n\nWith all Linux can does, but not with the WinNT and this it is fucked me on..\n\nand why the hack it is not /never create this prossible for WinXP or 7 !\n\na Normal install on usbstick..\n\nNot install via vhd or something bullshit.. nope.. real install on usb-stick. (and dont come now with a f\\*\\*\\* tuturial!!)\n\nbest regards\n\nBlacky\n\n**Edited by Blackcrack, 26 February 2013 - 12:58 PM.**\n"
    },
    {
      "id": "168433",
      "timestamp": "2013-02-26T12:18:05+00:00",
      "author": "steve6375",
      "content": "Is the Win7 64-bit or special in any way? Did you try an plain MS Win7 32-bit ISO extracted to a USB drive?\n\nHow about creating a virtual HDD, mounting the HDD, copying the USB stick to the virtual HDD, dismounting it, then boot from it via VBox?\n\n"
    },
    {
      "id": "168436",
      "timestamp": "2013-02-26T13:00:22+00:00",
      "author": "Blackcrack",
      "content": "steve, try to use Virtualbox, make a new virtualmashin.. create a new virtualdisk, there be possibility to create 4 or more diffrent virtualharddisk .. one of them be vhd.. this can you start with vbox and make a install..\n\nthe rest it\u0027s self explain ..\n\nyou can use/let work the virtualharddisk-creator for you ..\n\n```\nALLUSERSPROFILE\u003dC:\\ProgramData\nAPPDATA\u003dC:\\Users\\blackcrack\\AppData\\Roaming\nCommonProgramFiles\u003dC:\\Program Files (x86)\\Common Files\nCommonProgramFiles(x86)\u003dC:\\Program Files (x86)\\Common Files\nCommonProgramW6432\u003dC:\\Program Files\\Common Files\nCOMPUTERNAME\u003dBLACKYSGATE2\nComSpec\u003dC:\\Windows\\system32\\cmd.exe\nFP_NO_HOST_CHECK\u003dNO\nHOMEDRIVE\u003dC:\nHOMEPATH\u003d\\Users\\blackcrack\nLOCALAPPDATA\u003dC:\\Users\\blackcrack\\AppData\\Local\nLOGONSERVER\u003d\\\\BLACKYSGATE2\nNUMBER_OF_PROCESSORS\u003d4\nOS\u003dWindows_NT\nPath\u003dC:\\Program Files (x86)\\PC Connectivity Solution\\;C:\\Program Files (x86)\\NVIDIA Corporation\\PhysX\\Common;C:\\Windows\\\nsystem32;C:\\Windows;C:\\Windows\\System32\\Wbem;C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\;C:\\Users\\blackcrack\\AppData\\Loc\nal\\Bandizip\\7z;C:\\Program Files (x86)\\Common Files\\Isshou\nPATHEXT\u003d.COM;.EXE;.BAT;.CMD;.VBS;.VBE;.JS;.JSE;.WSF;.WSH;.MSC\nPROCESSOR_ARCHITECTURE\u003dx86\nPROCESSOR_ARCHITEW6432\u003dAMD64\nPROCESSOR_IDENTIFIER\u003dAMD64 Family 21 Model 1 Stepping 2, AuthenticAMD\nPROCESSOR_LEVEL\u003d21\nPROCESSOR_REVISION\u003d0102\nProgramData\u003dC:\\ProgramData\nProgramFiles\u003dC:\\Program Files (x86)\nProgramFiles(x86)\u003dC:\\Program Files (x86)\nProgramW6432\u003dC:\\Program Files\nPROMPT\u003d$P$G\nPSModulePath\u003dC:\\Windows\\system32\\WindowsPowerShell\\v1.0\\Modules\\\nPUBLIC\u003dC:\\Users\\Public\nSESSIONNAME\u003dConsole\nSystemDrive\u003dC:\nSystemRoot\u003dC:\\Windows\nTEMP\u003dC:\\Users\\BLACKC~1\\AppData\\Local\\Temp\nTMP\u003dC:\\Users\\BLACKC~1\\AppData\\Local\\Temp\nUSERDOMAIN\u003dblackysgate2\nUSERNAME\u003dblackcrack\nUSERPROFILE\u003dC:\\Users\\blackcrack\nVBOX_INSTALL_PATH\u003dC:\\Program Files\\Oracle\\VirtualBox\\\nwindir\u003dC:\\Windows\nwindows_tracing_flags\u003d3\n__COMPAT_LAYER\u003dElevateCreateProcess\nC:\\\u003e\n```\n\nVBOX_INSTALL_PATH\u003dC:\\\\Program Files\\\\Oracle\\\\VirtualBox\\\\\n\nby installed Virtualbox can you use\n\nthe variable VBOX_INSTALL_PATH for vboxtools via cmdline\n\nand the W7 32 bit should run anywere .. and maybe can you try to use [WinVBlock_Install.zip](http://www.general-files.com/download/gs5dd3ba62hfi0/WinVBlock_Install.zip.html \"External link\")on WinXP to have a driver on Winxp for virtualharddisk..\n\n**Edited by Blackcrack, 26 February 2013 - 01:07 PM.**\n"
    },
    {
      "id": "168471",
      "timestamp": "2013-02-27T03:01:02+00:00",
      "author": "eblip",
      "content": "\u003e Is the Win7 64-bit or special in any way? Did you try an plain MS Win7 32-bit ISO extracted to a USB drive?\n\u003e\n\u003e How about creating a virtual HDD, mounting the HDD, copying the USB stick to the virtual HDD, dismounting it, then boot from it via VBox?\n\nI tried this after I got off work today and it worked! Only hiccup I encountered was the that the installed OS ended up putting the MBR on the VHD as well as setting it to active. At first I couldn\u0027t get the installed OS to boot without the VHD being attached but once I swapped the active disk in diskmgmt then ran a startup repair from ERD the freshly installed OS was able to boot.\n\nA laborious process having to wait for the 20GB VHD creation, then a 20GB transfer, OS install, then the MBR troubleshooting but in the end it accomplished what I needed. I want to thank you; I never would have thought to gone the virtual HDD route and it was easier than I expected.\n\n"
    },
    {
      "id": "173071",
      "timestamp": "2013-06-03T04:36:55+00:00",
      "author": "DavidB",
      "content": "Hi.  \n\nI use VirtualBox a lot to test the Grub4Dos scripts.\n\nI have Windows XP SP3 x86 and I start VirtualBox with administrative rights.\n\n\u003cbr /\u003e\n\nThis method worked for me (found it on another site some time ago and then here): \"VBoxManage internalcommands createrawvmdk -filename \"%USERPROFILE%\"\\\\.VirtualBox\\\\usb.vmdk -rawdisk \\\\\\\\.\\\\PhysicalDrive1\"  \nI even can run Linux from the USB drive...  \n\nHowever there is another problem: any changes made to the USB drive in the virtual machine are not visible in the host OS.  \nFor example when Grub4dos is writing in \"default\" file, I can\u0027t see the new number for the menu entry in that file.  \nI tried setting usb.vmdk to writethrough, no change.  \nI tried plop boot iso, it hangs.  \nBefore starting the virtual machine I use a tool called sync.exe to force flushing the Windows RAM buffer to USB drive. tried using it also after the virtual machine is closed, no effect.  \n\n2 workarounds:  \n1. I remove and reattach the USB drive. Not good when you test a lot because the USB port will be (physically) damaged very fast.  \n2. I use \"chkdsk boot_partition_letter_on_USB_drive: /x\". But the problem is that it\u0027s very slow.  \n\nIs there a better workaround...?  \n\nThank you.\n\n"
    },
    {
      "id": "173077",
      "timestamp": "2013-06-03T13:55:13+00:00",
      "author": "DavidB",
      "content": "Well, I found a solution: using mountvol command to dismount USB drive\u0027s volume(s) before starting the VM and to mount them again after closing the VM.  \nAll can be done in a batch file so it will be very easy to use...\n\n"
    },
    {
      "id": "173079",
      "timestamp": "2013-06-03T15:29:45+00:00",
      "author": "steve6375",
      "content": "How do you get writes to work at all in VirtualBox?\n\nIf I use echo sdsd \\\u003e /fred.txt\n\ncat /fred.txt\n\nin VirtualBox, it just lists the original contents?\n\nP.S. Just found that if I change the vmdk type to \u0027Multi-attach\u0027 then writes do work!\n\n"
    },
    {
      "id": "173097",
      "timestamp": "2013-06-04T07:51:17+00:00",
      "author": "DavidB",
      "content": "\u003e How do you get writes to work at all in VirtualBox?\n\u003e\n\u003e If I use echo sdsd \\\u003e /fred.txt\n\u003e\n\u003e cat /fred.txt\n\u003e\n\u003e in VirtualBox, it just lists the original contents?\n\nNo, it will always list sdsd, which is normal (because the \"read\" command is inside the VM and it will access all the writes made by the VM).\n\n\u003e P.S. Just found that if I change the vmdk type to \u0027Multi-attach\u0027 then writes do work!\n\nMulti-attach is strange, it\u0027s creating a snapshot for the USB drive on my computer. Which is not good, because it will contain all the changes made in VM instead of writing them to the USB drive. That snapshot is for the other VM\u0027s (that\u0027s why it\u0027s \"multi\").\n\nAnyway I tested and on my computer the real OS still doesn\u0027t see any change made in VM...\n\nCurrently I\u0027m working on a Delphi program that will be better than using mountvol...\n\nIt\u0027s already working when you provide the volume letters(s) for the USB drive but my gold is to \"translate\" HardDisk1 to volume letter(s). Maybe even to read directly from usb.vmdk and \"translate\" HardDisk\\[n\\] to volume letter(s). This way it will be very \"flexible\"...\n\nOk, back to work...\n\n"
    },
    {
      "id": "173098",
      "timestamp": "2013-06-04T08:09:32+00:00",
      "author": "Wonko the Sane",
      "content": "Well, just for the record, using a \\\\\\\\.\\\\PhysicalDrive is NOT \\*exactly\\* like \"using a USB device\", see:\n\n[http://reboot.pro/to...-drive-in-qemu/](http://reboot.pro/topic/9688-test-your-bootable-usb-flash-drive-in-qemu/ \"\")\n\n@DavidB\n\nMaybe useful, maybe not ![:unsure:](http://reboot.pro/public/style_emoticons/default/unsure.png):\n\n[http://reboot.pro/to...st-and-ddlistw/](http://reboot.pro/topic/8219-ddlist-and-ddlistw/ \"\")\n\nIn the tradition of ~~boot-land~~reboot.pro the posted code has been botched, just in case I am attaching here a .zip.\n\n![:cheers:](http://reboot.pro/public/style_emoticons/default/cheers.gif)\n\nWonko  \n\n#### Attached Files {#attach_wrap}\n\n* [![Attached File](http://reboot.pro/public/style_extra/mime_types/zip.gif)](http://reboot.pro/index.php?s\u003deaeec371cfd5065f51a89d99794ab201\u0026app\u003dcore\u0026module\u003dattach\u0026section\u003dattach\u0026attach_id\u003d14277 \"Download attachment\") [**ddlistbatch.zip**](http://reboot.pro/index.php?s\u003deaeec371cfd5065f51a89d99794ab201\u0026app\u003dcore\u0026module\u003dattach\u0026section\u003dattach\u0026attach_id\u003d14277 \"Download attachment\") **181.44KB** 1056 downloads\n\n"
    },
    {
      "id": "173127",
      "timestamp": "2013-06-04T20:00:08+00:00",
      "author": "DavidB",
      "content": "\u003e Well, just for the record, using a \\\\\\\\.\\\\PhysicalDrive is NOT \\*exactly\\* like \"using a USB device\", see:\n\u003e\n\u003e [http://reboot.pro/to...-drive-in-qemu/](http://reboot.pro/topic/9688-test-your-bootable-usb-flash-drive-in-qemu/ \"\")\n\nI agree, but for some tests is good. Especially for testing grub4dos scripts - VirtualBox helped me to save a lot of time...\n\n\u003e @DavidB\n\u003e\n\u003e Maybe useful, maybe not ![:unsure:](http://reboot.pro/public/style_emoticons/default/unsure.png):\n\u003e\n\u003e [http://reboot.pro/to...st-and-ddlistw/](http://reboot.pro/topic/8219-ddlist-and-ddlistw/ \"\")\n\u003e\n\u003e In the tradition of ~~boot-land~~reboot.pro the posted code has been botched, just in case I am attaching here a .zip.\n\u003e\n\u003e ![:cheers:](http://reboot.pro/public/style_emoticons/default/cheers.gif)\n\u003e\n\u003e Wonko\n\nThank you.\n\n"
    },
    {
      "id": "173128",
      "timestamp": "2013-06-04T20:25:19+00:00",
      "author": "DavidB",
      "content": "Well, here is the program...  \nWhat it does: it triggers system data flush on the USB drive, it waits some time, it dismounts the mounted volumes, starts VirtualBox and it mount them back after it closes.  \nIt can be configured in settings.ini file:  \n\n```\nVM_UUID\u003d5056175c-6ee4-41ab-91c6-0b4150b18045\nUSB_drive_number\u003d1\nWait_time_to_flush_system_data\u003d500\n\n```\n\nVM_UUID is the UUID of the virtual machine used to \"boot\" from USB. You can find it by making a shortcut of the VM (not VB) on the desktop and looking at its properties (\"Target\" field).  \nUSB_drive_number is the disk number that you used in usb.vmdk (found in Disk Management). It can be set from 1 to 9. The default value is 1.  \nWait_time_to_flush_system_data is the amount of time (ms) the program will wait after triggering the flush and before dismounting the volume. It can be set from 1 to 10 000. The default value is 500.  \n\nVirtualBox has to be installed, if it\u0027s the portable version it will not know where it\u0027s located...  \n\nIt\u0027s only the first version, so it can be improved...  \nI tested it on my computer and it works fine but I can\u0027t be sure that it will work on any computer.\n\nLater edit: attached files removed, you can find a better version on the next page of the thread...\n\n"
    },
    {
      "id": "173129",
      "timestamp": "2013-06-04T21:06:54+00:00",
      "author": "steve6375",
      "content": "~~Is the UUID the same as shown in VM Manager? If not how do I create a shortcut (Oracle VM VirtualBox)?~~\n\nOK - didn\u0027t spot the Machine - Create shortcut on Desktop entry!\n\nShould the disk type be normal?\n\n"
    },
    {
      "id": "173131",
      "timestamp": "2013-06-04T21:20:55+00:00",
      "author": "DavidB",
      "content": "It\u0027s not the UUID of the usb.vmdk.\n\nIn VirtualBox\u0027s interface right click on the name of the VM and choose \"Create shortcut to desktop\".\n\nAnd, yes, it should be normal.\n\n"
    },
    {
      "id": "173132",
      "timestamp": "2013-06-04T21:37:55+00:00",
      "author": "steve6375",
      "content": "OK - just figured it out - I didn\u0027t see the \u0027create shortcut\u0027 menu option!\n\nAnyway - I tested in on my 7 64-bit laptop and it worked great! Writes take affect within the VM and I can see the changed files after the VM closes ![:clap:](http://reboot.pro/public/style_emoticons/default/clap.gif)\n\n"
    },
    {
      "id": "173133",
      "timestamp": "2013-06-04T21:45:54+00:00",
      "author": "steve6375",
      "content": "Would be great if I could pick a VM if I have more than one USB drive connected (multiple entries in settings.ini, maybe add a Name entry for each Section too)? ![:dubbio:](http://reboot.pro/public/style_emoticons/default/dubbio.gif)\n\n"
    },
    {
      "id": "173134",
      "timestamp": "2013-06-04T21:50:40+00:00",
      "author": "DavidB",
      "content": "\u003e OK - just figured it out - I didn\u0027t see the \u0027create shortcut\u0027 menu option!\n\u003e\n\u003e Anyway - I tested in on my 7 64-bit laptop and it worked great! Writes take affect within the VM and I can see the changed files after the VM closes ![:clap:](http://reboot.pro/public/style_emoticons/default/clap.gif)\n\n:smile: I\u0027m glad you like my program...\n\n\u003e Would be great if I could pick a VM if I have more than one USB drive connected (multiple entries in settings.ini, maybe add a Name entry for each Section too)? ![:dubbio:](http://reboot.pro/public/style_emoticons/default/dubbio.gif)\n\nSure, why not...\n\nLE: until I will modify the program, for now you can copy the exe and the ini in other folder(s) and use them for other VMs.\n\n"
    },
    {
      "id": "173135",
      "timestamp": "2013-06-04T22:13:41+00:00",
      "author": "steve6375",
      "content": "Is there a way to do a similar thing with QEMU? It would be great to add this into my RMPrepUSB - QEMU option??\n\n"
    },
    {
      "id": "168410",
      "timestamp": "2013-02-26T01:12:25+00:00",
      "author": "eblip",
      "content": "To start off, I know that VirtualBox doesn\u0027t have built in USB boot support, but there are a number of workarounds. Despite my best efforts all the workarounds I\u0027ve found online have failed in some fashion or another.\n\nI\u0027m attempting to use USB to install Windows 7 onto a VM. I think the issue might be in the way this thumb drive was prepped. It was made with RMPrepUSB and it works perfectly from a normal BIOS boot in physical machines.\n\nIf all my Windows installers on this USB were in ISO that would be no problem, but two of them required dumping the ISO contents onto the USB root since they didn\u0027t support emulation. The Win 7 AIO installer I plan to use is one of these.\n\nThings tried:\n\nVirtualBox raw disk emulation (The most recommended method from what I can tell). I set my USB to be viewed as a raw disk using:\n\nVBoxManage internalcommands createrawvmdk -filename \"%USERPROFILE%\"\\\\.VirtualBox\\\\usb.vmdk -rawdisk \\\\\\\\.\\\\PhysicalDrive3\n\nUsing this I can load the USB and boot into Grub, select my Windows 7 installer. The pre-installer loads fine, but during the \"Starting Windows\" portion my RAM usage spikes and crashes the VM. I tried a few different things, including using Host I/O caching, but always the same RAM spike and VM crash.\n\nNext I tried:\n\nPlop boot. I was optimistic but after trying it I realized loading a 4GB image and doing install at 1.0 speed would have taken hours if not days. Just the in installer setup would have taken hours (Still looking for something similar that could provide 2.0 support).\n\nThen I tried:\n\nMaking an ISO of the entire thumb drive following instructions here:\n\n[http://www.rmprepusb...makegrub4dosiso](http://www.rmprepusb.com/tutorials/makegrub4dosiso \"External link\")\n\nI tried using both available tools mkisofs.exe \\\u0026 OSCDIMG.exe with the same results. The ISO image is created and trying to boot will load grub, but grub can\u0027t find menu.lst. I tried adjusting caps on menu.lst but it didn\u0027t seem to matter.\n\nRight now I\u0027m thinking something like Plop boot with USB 2.0 support would be ideal, but I haven\u0027t had any luck finding one. Honestly though, getting any of above methods to work would be fine by me, but I\u0027m out of ideas. I\u0027m hoping someone will notice something silly I overlooked. Any help at all would be great, even if they\u0027re extreme or inconvenience solutions.\n\n\u003cbr /\u003e\n\n"
    },
    {
      "id": "168418",
      "timestamp": "2013-02-26T08:18:33+00:00",
      "author": "Blackcrack",
      "content": "i ask they people of VBox if they are not include the USB-Support as Boot possibility in the VM.  \n\nthey told it\u0027s want be a interesting thing maybe in the future.. it is now a jear ago, maybe can ask they in the are too in the VBOX-Forum ?\n\nbest regards\n\nBlacky\n\n"
    },
    {
      "id": "168425",
      "timestamp": "2013-02-26T11:26:36+00:00",
      "author": "steve6375",
      "content": "Not quite clear what you are trying to achieve - USB flash boot using Win 7 ISO, USB HDD boot, DVD boot???\n\nWhat method did you use to prepare the USB drive? If using Tut 43 (ISO from Flash drive) then it won\u0027t work on an emulator/VM as the drive appears as a fixed drive not a removable drive.\n\n"
    },
    {
      "id": "168427",
      "timestamp": "2013-02-26T11:41:42+00:00",
      "author": "Blackcrack",
      "content": "Steve you be offtopic, there it is speak about Virtualbox and Booting in USB\n\nand I said that I had ask because of the already in Virtualbox forum.\n\nand to the 2nd I have not to use your methods .. it\u0027s give others too.. why do you insist on it..\n\ni dont like f... tutorials, i want a programm who do this what i want..\n\nI do not like the song : \"four corners you have to go\"\n\nif give one easy way..\n\nand if you so mighty, why do you not create a programm who create via Virtualbox-programm on usb\n\na vhd, you programm can insert on the usb a grub4dos, use Virtualbox to install a Win7 and prepar\n\nthe vhd for the next boot via grub4dos . For have a easy program for create a virtualbox+vhd+grub4dos+usb\n\n**Edited by Blackcrack, 26 February 2013 - 11:50 AM.**\n"
    },
    {
      "id": "168428",
      "timestamp": "2013-02-26T11:43:28+00:00",
      "author": "eblip",
      "content": "\u003e Not quite clear what you are trying to achieve - USB flash boot using Win 7 ISO, USB HDD boot, DVD boot???\n\u003e\n\u003e What method did you use to prepare the USB drive? If using Tut 43 (ISO from Flash drive) then it won\u0027t work on an emulator/VM as the drive appears as a fixed drive not a removable drive.\n\nI have a USB drive, prepped with RMprepUSB using Grub4Dos, that has several windows/linux installers on it, all of which will boot fine on a physical machine. Some of the installers are intact ISO\u0027s, but two of installers are unpacked ISOs placed right on the root of the USB. Presently, the only Win 7 installer I have is on this USB drive, but VirtualBox won\u0027t boot from USB and the installer I need is not an intact ISO. I\u0027m trying to find anyway that I can get Win 7 installed on VirtualBox.\n\n"
    },
    {
      "id": "168429",
      "timestamp": "2013-02-26T11:45:22+00:00",
      "author": "steve6375",
      "content": "Why not map the ISO file as a CD in VB and boot from it?\n\nWhy can\u0027t you boot from a USb drive from VBox? Just set the port as a device see [http://www.rmprepusb...r-vmware-server](http://www.rmprepusb.com/tutorials/how-to-boot-from-usb-under-vmware-server \"External link\")\n\n"
    },
    {
      "id": "168430",
      "timestamp": "2013-02-26T11:47:52+00:00",
      "author": "eblip",
      "content": "\u003e i ask they people of VBox if they are not include the USB-Support as Boot possibility in the VM.  \n\u003e\n\u003e they told it\u0027s want be a interesting thing maybe in the future.. it is now a jear ago, maybe can ask they in the are too in the VBOX-Forum ?\n\u003e\n\u003e best regards\n\u003e\n\u003e Blacky\n\n\u003cbr /\u003e\n\nThey\u0027re probably nice people and all, but any time I found anyone mentioning booting USB on VirtualBox, the questioners were not treated very kindly. (I have a feeling it\u0027s a sensative subject). The questioners were more or less told \"VirtualBox does not support USB booting\" and it doesn\u0027t seem they want to promote people using such workarounds as I\u0027ve outlined above. That is just my guess though.\n\n"
    },
    {
      "id": "168431",
      "timestamp": "2013-02-26T11:51:51+00:00",
      "author": "eblip",
      "content": "\u003e Why not map the ISO file as a CD in VB and boot from it?\n\nI tried, both using a Windows host and an Ubuntu host. In Windows, VirtualBox will boot the USB, menu.lst will come up, I can select my Windows 7 entry and everything seems to be fine. The pre-install loads fine (The long white bar at the bottom). It\u0027s when I get to the \"Starting Windows\" screen that my host RAM spikes about 1GB per second and in 8 seconds VirtualBox crashes with an error about VERR_ACCESS_DENIED. This happens no matter how much RAM I give to the guest system.\n\nIn Ubuntu, Virtualbox won\u0027t even find the MBR, menu.lst never comes up.\n\n"
    },
    {
      "id": "168432",
      "timestamp": "2013-02-26T12:08:23+00:00",
      "author": "Blackcrack",
      "content": "imho, should be it possible to boot on usb, but i think they don\u0027t want it..\n\nlike i know, all it is possible in code today, but if they not like to do.. :\\\\\n\nit want be the best possibility to have a running system on USB2/3 maybe\n\ncrypted for a possibility to quick disconnect / take away .. or for using a qemu-usb-boot-programm\n\nwho i have anywhere see here.. for have a Virtual environment for let start the usb-stick over the desktop (edit: MobaLiveUSB_0.2.exe )..\n\nthat\u0027s all if can create a normal installed Winnt System on usb like i can do with Openmandriva before 5 jears..\n\nWith all Linux can does, but not with the WinNT and this it is fucked me on..\n\nand why the hack it is not /never create this prossible for WinXP or 7 !\n\na Normal install on usbstick..\n\nNot install via vhd or something bullshit.. nope.. real install on usb-stick. (and dont come now with a f\\*\\*\\* tuturial!!)\n\nbest regards\n\nBlacky\n\n**Edited by Blackcrack, 26 February 2013 - 12:58 PM.**\n"
    },
    {
      "id": "168433",
      "timestamp": "2013-02-26T12:18:05+00:00",
      "author": "steve6375",
      "content": "Is the Win7 64-bit or special in any way? Did you try an plain MS Win7 32-bit ISO extracted to a USB drive?\n\nHow about creating a virtual HDD, mounting the HDD, copying the USB stick to the virtual HDD, dismounting it, then boot from it via VBox?\n\n"
    },
    {
      "id": "168436",
      "timestamp": "2013-02-26T13:00:22+00:00",
      "author": "Blackcrack",
      "content": "steve, try to use Virtualbox, make a new virtualmashin.. create a new virtualdisk, there be possibility to create 4 or more diffrent virtualharddisk .. one of them be vhd.. this can you start with vbox and make a install..\n\nthe rest it\u0027s self explain ..\n\nyou can use/let work the virtualharddisk-creator for you ..\n\n```\nALLUSERSPROFILE\u003dC:\\ProgramData\nAPPDATA\u003dC:\\Users\\blackcrack\\AppData\\Roaming\nCommonProgramFiles\u003dC:\\Program Files (x86)\\Common Files\nCommonProgramFiles(x86)\u003dC:\\Program Files (x86)\\Common Files\nCommonProgramW6432\u003dC:\\Program Files\\Common Files\nCOMPUTERNAME\u003dBLACKYSGATE2\nComSpec\u003dC:\\Windows\\system32\\cmd.exe\nFP_NO_HOST_CHECK\u003dNO\nHOMEDRIVE\u003dC:\nHOMEPATH\u003d\\Users\\blackcrack\nLOCALAPPDATA\u003dC:\\Users\\blackcrack\\AppData\\Local\nLOGONSERVER\u003d\\\\BLACKYSGATE2\nNUMBER_OF_PROCESSORS\u003d4\nOS\u003dWindows_NT\nPath\u003dC:\\Program Files (x86)\\PC Connectivity Solution\\;C:\\Program Files (x86)\\NVIDIA Corporation\\PhysX\\Common;C:\\Windows\\\nsystem32;C:\\Windows;C:\\Windows\\System32\\Wbem;C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\;C:\\Users\\blackcrack\\AppData\\Loc\nal\\Bandizip\\7z;C:\\Program Files (x86)\\Common Files\\Isshou\nPATHEXT\u003d.COM;.EXE;.BAT;.CMD;.VBS;.VBE;.JS;.JSE;.WSF;.WSH;.MSC\nPROCESSOR_ARCHITECTURE\u003dx86\nPROCESSOR_ARCHITEW6432\u003dAMD64\nPROCESSOR_IDENTIFIER\u003dAMD64 Family 21 Model 1 Stepping 2, AuthenticAMD\nPROCESSOR_LEVEL\u003d21\nPROCESSOR_REVISION\u003d0102\nProgramData\u003dC:\\ProgramData\nProgramFiles\u003dC:\\Program Files (x86)\nProgramFiles(x86)\u003dC:\\Program Files (x86)\nProgramW6432\u003dC:\\Program Files\nPROMPT\u003d$P$G\nPSModulePath\u003dC:\\Windows\\system32\\WindowsPowerShell\\v1.0\\Modules\\\nPUBLIC\u003dC:\\Users\\Public\nSESSIONNAME\u003dConsole\nSystemDrive\u003dC:\nSystemRoot\u003dC:\\Windows\nTEMP\u003dC:\\Users\\BLACKC~1\\AppData\\Local\\Temp\nTMP\u003dC:\\Users\\BLACKC~1\\AppData\\Local\\Temp\nUSERDOMAIN\u003dblackysgate2\nUSERNAME\u003dblackcrack\nUSERPROFILE\u003dC:\\Users\\blackcrack\nVBOX_INSTALL_PATH\u003dC:\\Program Files\\Oracle\\VirtualBox\\\nwindir\u003dC:\\Windows\nwindows_tracing_flags\u003d3\n__COMPAT_LAYER\u003dElevateCreateProcess\nC:\\\u003e\n```\n\nVBOX_INSTALL_PATH\u003dC:\\\\Program Files\\\\Oracle\\\\VirtualBox\\\\\n\nby installed Virtualbox can you use\n\nthe variable VBOX_INSTALL_PATH for vboxtools via cmdline\n\nand the W7 32 bit should run anywere .. and maybe can you try to use [WinVBlock_Install.zip](http://www.general-files.com/download/gs5dd3ba62hfi0/WinVBlock_Install.zip.html \"External link\")on WinXP to have a driver on Winxp for virtualharddisk..\n\n**Edited by Blackcrack, 26 February 2013 - 01:07 PM.**\n"
    },
    {
      "id": "168471",
      "timestamp": "2013-02-27T03:01:02+00:00",
      "author": "eblip",
      "content": "\u003e Is the Win7 64-bit or special in any way? Did you try an plain MS Win7 32-bit ISO extracted to a USB drive?\n\u003e\n\u003e How about creating a virtual HDD, mounting the HDD, copying the USB stick to the virtual HDD, dismounting it, then boot from it via VBox?\n\nI tried this after I got off work today and it worked! Only hiccup I encountered was the that the installed OS ended up putting the MBR on the VHD as well as setting it to active. At first I couldn\u0027t get the installed OS to boot without the VHD being attached but once I swapped the active disk in diskmgmt then ran a startup repair from ERD the freshly installed OS was able to boot.\n\nA laborious process having to wait for the 20GB VHD creation, then a 20GB transfer, OS install, then the MBR troubleshooting but in the end it accomplished what I needed. I want to thank you; I never would have thought to gone the virtual HDD route and it was easier than I expected.\n\n"
    },
    {
      "id": "173071",
      "timestamp": "2013-06-03T04:36:55+00:00",
      "author": "DavidB",
      "content": "Hi.  \n\nI use VirtualBox a lot to test the Grub4Dos scripts.\n\nI have Windows XP SP3 x86 and I start VirtualBox with administrative rights.\n\n\u003cbr /\u003e\n\nThis method worked for me (found it on another site some time ago and then here): \"VBoxManage internalcommands createrawvmdk -filename \"%USERPROFILE%\"\\\\.VirtualBox\\\\usb.vmdk -rawdisk \\\\\\\\.\\\\PhysicalDrive1\"  \nI even can run Linux from the USB drive...  \n\nHowever there is another problem: any changes made to the USB drive in the virtual machine are not visible in the host OS.  \nFor example when Grub4dos is writing in \"default\" file, I can\u0027t see the new number for the menu entry in that file.  \nI tried setting usb.vmdk to writethrough, no change.  \nI tried plop boot iso, it hangs.  \nBefore starting the virtual machine I use a tool called sync.exe to force flushing the Windows RAM buffer to USB drive. tried using it also after the virtual machine is closed, no effect.  \n\n2 workarounds:  \n1. I remove and reattach the USB drive. Not good when you test a lot because the USB port will be (physically) damaged very fast.  \n2. I use \"chkdsk boot_partition_letter_on_USB_drive: /x\". But the problem is that it\u0027s very slow.  \n\nIs there a better workaround...?  \n\nThank you.\n\n"
    },
    {
      "id": "173077",
      "timestamp": "2013-06-03T13:55:13+00:00",
      "author": "DavidB",
      "content": "Well, I found a solution: using mountvol command to dismount USB drive\u0027s volume(s) before starting the VM and to mount them again after closing the VM.  \nAll can be done in a batch file so it will be very easy to use...\n\n"
    },
    {
      "id": "173079",
      "timestamp": "2013-06-03T15:29:45+00:00",
      "author": "steve6375",
      "content": "How do you get writes to work at all in VirtualBox?\n\nIf I use echo sdsd \\\u003e /fred.txt\n\ncat /fred.txt\n\nin VirtualBox, it just lists the original contents?\n\nP.S. Just found that if I change the vmdk type to \u0027Multi-attach\u0027 then writes do work!\n\n"
    },
    {
      "id": "173097",
      "timestamp": "2013-06-04T07:51:17+00:00",
      "author": "DavidB",
      "content": "\u003e How do you get writes to work at all in VirtualBox?\n\u003e\n\u003e If I use echo sdsd \\\u003e /fred.txt\n\u003e\n\u003e cat /fred.txt\n\u003e\n\u003e in VirtualBox, it just lists the original contents?\n\nNo, it will always list sdsd, which is normal (because the \"read\" command is inside the VM and it will access all the writes made by the VM).\n\n\u003e P.S. Just found that if I change the vmdk type to \u0027Multi-attach\u0027 then writes do work!\n\nMulti-attach is strange, it\u0027s creating a snapshot for the USB drive on my computer. Which is not good, because it will contain all the changes made in VM instead of writing them to the USB drive. That snapshot is for the other VM\u0027s (that\u0027s why it\u0027s \"multi\").\n\nAnyway I tested and on my computer the real OS still doesn\u0027t see any change made in VM...\n\nCurrently I\u0027m working on a Delphi program that will be better than using mountvol...\n\nIt\u0027s already working when you provide the volume letters(s) for the USB drive but my gold is to \"translate\" HardDisk1 to volume letter(s). Maybe even to read directly from usb.vmdk and \"translate\" HardDisk\\[n\\] to volume letter(s). This way it will be very \"flexible\"...\n\nOk, back to work...\n\n"
    },
    {
      "id": "173098",
      "timestamp": "2013-06-04T08:09:32+00:00",
      "author": "Wonko the Sane",
      "content": "Well, just for the record, using a \\\\\\\\.\\\\PhysicalDrive is NOT \\*exactly\\* like \"using a USB device\", see:\n\n[http://reboot.pro/to...-drive-in-qemu/](http://reboot.pro/topic/9688-test-your-bootable-usb-flash-drive-in-qemu/ \"\")\n\n@DavidB\n\nMaybe useful, maybe not ![:unsure:](http://reboot.pro/public/style_emoticons/default/unsure.png):\n\n[http://reboot.pro/to...st-and-ddlistw/](http://reboot.pro/topic/8219-ddlist-and-ddlistw/ \"\")\n\nIn the tradition of ~~boot-land~~reboot.pro the posted code has been botched, just in case I am attaching here a .zip.\n\n![:cheers:](http://reboot.pro/public/style_emoticons/default/cheers.gif)\n\nWonko  \n\n#### Attached Files {#attach_wrap}\n\n* [![Attached File](http://reboot.pro/public/style_extra/mime_types/zip.gif)](http://reboot.pro/index.php?s\u003d30cf373919b722b2e0eddf517dc6370f\u0026app\u003dcore\u0026module\u003dattach\u0026section\u003dattach\u0026attach_id\u003d14277 \"Download attachment\") [**ddlistbatch.zip**](http://reboot.pro/index.php?s\u003d30cf373919b722b2e0eddf517dc6370f\u0026app\u003dcore\u0026module\u003dattach\u0026section\u003dattach\u0026attach_id\u003d14277 \"Download attachment\") **181.44KB** 1056 downloads\n\n"
    },
    {
      "id": "173127",
      "timestamp": "2013-06-04T20:00:08+00:00",
      "author": "DavidB",
      "content": "\u003e Well, just for the record, using a \\\\\\\\.\\\\PhysicalDrive is NOT \\*exactly\\* like \"using a USB device\", see:\n\u003e\n\u003e [http://reboot.pro/to...-drive-in-qemu/](http://reboot.pro/topic/9688-test-your-bootable-usb-flash-drive-in-qemu/ \"\")\n\nI agree, but for some tests is good. Especially for testing grub4dos scripts - VirtualBox helped me to save a lot of time...\n\n\u003e @DavidB\n\u003e\n\u003e Maybe useful, maybe not ![:unsure:](http://reboot.pro/public/style_emoticons/default/unsure.png):\n\u003e\n\u003e [http://reboot.pro/to...st-and-ddlistw/](http://reboot.pro/topic/8219-ddlist-and-ddlistw/ \"\")\n\u003e\n\u003e In the tradition of ~~boot-land~~reboot.pro the posted code has been botched, just in case I am attaching here a .zip.\n\u003e\n\u003e ![:cheers:](http://reboot.pro/public/style_emoticons/default/cheers.gif)\n\u003e\n\u003e Wonko\n\nThank you.\n\n"
    },
    {
      "id": "173128",
      "timestamp": "2013-06-04T20:25:19+00:00",
      "author": "DavidB",
      "content": "Well, here is the program...  \nWhat it does: it triggers system data flush on the USB drive, it waits some time, it dismounts the mounted volumes, starts VirtualBox and it mount them back after it closes.  \nIt can be configured in settings.ini file:  \n\n```\nVM_UUID\u003d5056175c-6ee4-41ab-91c6-0b4150b18045\nUSB_drive_number\u003d1\nWait_time_to_flush_system_data\u003d500\n\n```\n\nVM_UUID is the UUID of the virtual machine used to \"boot\" from USB. You can find it by making a shortcut of the VM (not VB) on the desktop and looking at its properties (\"Target\" field).  \nUSB_drive_number is the disk number that you used in usb.vmdk (found in Disk Management). It can be set from 1 to 9. The default value is 1.  \nWait_time_to_flush_system_data is the amount of time (ms) the program will wait after triggering the flush and before dismounting the volume. It can be set from 1 to 10 000. The default value is 500.  \n\nVirtualBox has to be installed, if it\u0027s the portable version it will not know where it\u0027s located...  \n\nIt\u0027s only the first version, so it can be improved...  \nI tested it on my computer and it works fine but I can\u0027t be sure that it will work on any computer.\n\nLater edit: attached files removed, you can find a better version on the next page of the thread...\n\n"
    },
    {
      "id": "173129",
      "timestamp": "2013-06-04T21:06:54+00:00",
      "author": "steve6375",
      "content": "~~Is the UUID the same as shown in VM Manager? If not how do I create a shortcut (Oracle VM VirtualBox)?~~\n\nOK - didn\u0027t spot the Machine - Create shortcut on Desktop entry!\n\nShould the disk type be normal?\n\n"
    },
    {
      "id": "173131",
      "timestamp": "2013-06-04T21:20:55+00:00",
      "author": "DavidB",
      "content": "It\u0027s not the UUID of the usb.vmdk.\n\nIn VirtualBox\u0027s interface right click on the name of the VM and choose \"Create shortcut to desktop\".\n\nAnd, yes, it should be normal.\n\n"
    },
    {
      "id": "173132",
      "timestamp": "2013-06-04T21:37:55+00:00",
      "author": "steve6375",
      "content": "OK - just figured it out - I didn\u0027t see the \u0027create shortcut\u0027 menu option!\n\nAnyway - I tested in on my 7 64-bit laptop and it worked great! Writes take affect within the VM and I can see the changed files after the VM closes ![:clap:](http://reboot.pro/public/style_emoticons/default/clap.gif)\n\n"
    },
    {
      "id": "173133",
      "timestamp": "2013-06-04T21:45:54+00:00",
      "author": "steve6375",
      "content": "Would be great if I could pick a VM if I have more than one USB drive connected (multiple entries in settings.ini, maybe add a Name entry for each Section too)? ![:dubbio:](http://reboot.pro/public/style_emoticons/default/dubbio.gif)\n\n"
    },
    {
      "id": "173134",
      "timestamp": "2013-06-04T21:50:40+00:00",
      "author": "DavidB",
      "content": "\u003e OK - just figured it out - I didn\u0027t see the \u0027create shortcut\u0027 menu option!\n\u003e\n\u003e Anyway - I tested in on my 7 64-bit laptop and it worked great! Writes take affect within the VM and I can see the changed files after the VM closes ![:clap:](http://reboot.pro/public/style_emoticons/default/clap.gif)\n\n:smile: I\u0027m glad you like my program...\n\n\u003e Would be great if I could pick a VM if I have more than one USB drive connected (multiple entries in settings.ini, maybe add a Name entry for each Section too)? ![:dubbio:](http://reboot.pro/public/style_emoticons/default/dubbio.gif)\n\nSure, why not...\n\nLE: until I will modify the program, for now you can copy the exe and the ini in other folder(s) and use them for other VMs.\n\n"
    },
    {
      "id": "173135",
      "timestamp": "2013-06-04T22:13:41+00:00",
      "author": "steve6375",
      "content": "Is there a way to do a similar thing with QEMU? It would be great to add this into my RMPrepUSB - QEMU option??\n\n"
    },
    {
      "id": "173136",
      "timestamp": "2013-06-04T22:21:51+00:00",
      "author": "DavidB",
      "content": "\u003e Is there a way to do a similar thing with QEMU?\n\nI think it will work with QEMU too but I will test to be sure.\n\n\u003e It would be great to add this into my RMPrepUSB - QEMU option??\n\nYes, of course :smile:\n\n"
    },
    {
      "id": "173141",
      "timestamp": "2013-06-05T06:36:20+00:00",
      "author": "DavidB",
      "content": "I tested with QEMU and it works.  \nHowever changes on USB drive are remembered and shown only if the \"snapshot\u003doff\" parameter is used. Btw, I had the same problem in VirtualBox...  \n\nIf you still intend to implement this in your program you have 2 choices:  \n1. you can adapt the sources from Delphi to the programming language you use (probably Visual Basic).  \n2. You can use the exe attached to this post.  \nIts configuration is made only with command line parameters:  \n\\[USB_drive_number\\] \\[WaitTime\\] \\[QEMUexe\\] \\[QEMU_parameters\\]  \nLet me know if you have problems with it or if you need some modifications to be done...\n\n"
    },
    {
      "id": "173142",
      "timestamp": "2013-06-05T08:35:18+00:00",
      "author": "steve6375",
      "content": "Hi David\n\nThat .exe just drops perfectly into my rmprepusb startfromusb.cmd batch file and seems to work just great! ![:clap:](http://reboot.pro/public/style_emoticons/default/clap.gif)\n\nJust one problem - how do I stop the console window from appearing on the desktop?\n\nI tried start /MIN and start /B but neither seem to work??\n\n"
    },
    {
      "id": "173143",
      "timestamp": "2013-06-05T08:51:03+00:00",
      "author": "DavidB",
      "content": "Solved it, I just had to use SW_MINIMIZE instead of SW_SHOW.  \nI updated the attached files in my previous post. BTW, I could use SW_HIDE and it will not just be minimized, it will be hidden. But I think that it\u0027s wise to be just minimized, in case that something goes wrong with QEMU...\n\n"
    },
    {
      "id": "173144",
      "timestamp": "2013-06-05T09:02:05+00:00",
      "author": "steve6375",
      "content": "Great! I will make a Beta release of RMPrepUSB using this if that is OK with you - I have been trying to get USB writes to work for ages but never found an easy solution!\n\nThis means the grub4dos default command and dd writes, etc. will all work under QEMU and be permanent - brilliant! ![:good:](http://reboot.pro/public/style_emoticons/default/good.gif)\n\n"
    },
    {
      "id": "173145",
      "timestamp": "2013-06-05T09:17:07+00:00",
      "author": "DavidB",
      "content": "You don\u0027t have to ask me, you can use the source code and the exe whatever you like :smile:\n\nI just have one recommendation: test it on many computers and with different USB drives and different versions of Windows, to be sure there are no problems...\n\nJust now I am working at a way to detect if my program is started normal/minimized/maximized, so it can start VirtualBox and QEMU in the same way...\n\n"
    },
    {
      "id": "173146",
      "timestamp": "2013-06-05T10:06:14+00:00",
      "author": "DavidB",
      "content": "It\u0027s done.\n\nNow the modification from shortcut properties and also \"start min/max\" are both detected and transmitted to VirtualBox/QEMU window. In QEMU it\u0027s the console window that will receive this and not the VM window.\n\n"
    },
    {
      "id": "173149",
      "timestamp": "2013-06-05T10:33:38+00:00",
      "author": "steve6375",
      "content": "Thanks!\n\nI tested the QEMU previous version on Win 7 64-bit and XP and it seems OK so far. In fact, a large grub4dos USB flash drive which previously took 39 seconds to display the menu when booting under QEMU in snapshot mode (it had lots if iftitle menu items!), now takes 36 seconds with start_VM - so it seems slightly faster on drive access too...\n\n"
    },
    {
      "id": "173186",
      "timestamp": "2013-06-06T20:49:50+00:00",
      "author": "DavidB",
      "content": "I also made a version with GUI.  \nA few screenshots:\n\n\u003cbr /\u003e\n\n[](http://www.imagebam.com/image/84d561258798907 \"External link\")[![Clipboard01.png](http://reboot.pro/uploads/monthly_06_2013/post-61891-0-65062000-1370551596_thumb.png)](http://reboot.pro/uploads/monthly_06_2013/post-61891-0-65062000-1370551596.png \"Clipboard01.png - Size: 10.19KB\"){#ipb-attach-url-14292-0-01487300-1676066418}\n\n[![Clipboard02.png](http://reboot.pro/uploads/monthly_06_2013/post-61891-0-10728700-1370551625_thumb.png)](http://reboot.pro/uploads/monthly_06_2013/post-61891-0-10728700-1370551625.png \"Clipboard02.png - Size: 18.96KB\"){#ipb-attach-url-14293-0-01499600-1676066418}\n\n[![Clipboard03.png](http://reboot.pro/uploads/monthly_06_2013/post-61891-0-63398100-1370551634_thumb.png)](http://reboot.pro/uploads/monthly_06_2013/post-61891-0-63398100-1370551634.png \"Clipboard03.png - Size: 18.2KB\"){#ipb-attach-url-14294-0-01508600-1676066418}\n\nLE: links to the files removed, better versions in my next post.\n\n"
    },
    {
      "id": "173193",
      "timestamp": "2013-06-07T05:25:37+00:00",
      "author": "Blackcrack",
      "content": "cool !! just only a Pulldownmenus to select the USB-Sticks and the Exe-parameters by selecting the exe File :smile:\n\nfor primitives users too and it\u0027s finish for the Mass Marked :wink: And the VBox-Peoples say ever, we don\u0027t need them..\n\nwe mus write a new Bios for them .. blabla.. it\u0027s not for us . Hey DavidB if i would be in Faze Book became\n\nyou a big fad \"like it\" DavidB, WELL DONE \\*thumps up\\*! only lil changes :smile:\n\nWith this possible can install Moondrake and Openmandriva too !\n\nbest regards\n\nBlacky\n\n(Manndrake and Openmandriva be a Brunch from Mandriva Community Linux, Jean Manuel Croset gave the Linux back to the Community you can find dem in #Moondrake \\\u0026 #Openmandriva / \\*-cooker on Freenode )\n\n**Edited by Blackcrack, 07 June 2013 - 05:31 AM.**\n"
    },
    {
      "id": "173205",
      "timestamp": "2013-06-07T14:04:53+00:00",
      "author": "DavidB",
      "content": "You\u0027re welcome.  \n\nI have made some improvements:  \n1. The list of VMs and their parameters is now stored in Unicode format (UTF16). It\u0027s not compatible with the format of the previous version but now, with the other 2 improvements, it\u0027s not so hard to rebuild it ![:D](http://reboot.pro/public/style_emoticons/default/biggrin.png)  \n2. You can choose directly the USB drive number with a popup menu.  \n3. When adding a VM entry from VirtualBox you can choose which VM should be added and its (UU)ID will be inserted automatically.\n\n"
    },
    {
      "id": "173208",
      "timestamp": "2013-06-07T16:37:33+00:00",
      "author": "Blackcrack",
      "content": "i have test it out, taked a \"TestXP-Install\"-vmashin select the usb-stick (the Drivenummer is very helpful,\n\ndan you maybe add it behind the Drive-entrys Drive %drive% :\\\\ to be show \"Drive E:\\\\ \" on the Gui to known to be drives :smile:\n\nand the User can chose the \"Drive E:\\\\\" :smile: more better as \"1\" or \"2\" by the way, it\u0027S maby better if you let hidden System drive C :wink:\n\nthe Virtualbox start but use not the USB-Drive, maby it is very helpful if you let pop open an cmd-window\n\nala log-window and let show what have done for copy and past there to know what\u0027s the problem why\n\nnot choose the uuid from the USB btw the uuid from \"e\" by me the vbox, have 4 Drives, sata x4 2cdroms 2harddisk\n\nso it it is the usb-stick with 16Gig e:\n\nbest regards\n\nBlacky\n\n"
    },
    {
      "id": "173209",
      "timestamp": "2013-06-07T17:08:41+00:00",
      "author": "DavidB",
      "content": "Actually, the \u0027A\u0027..\u0027Z\u0027 letters that we see in a file manager in Windows are not really \"drives\" but \"volumes\". A drive can have more than one volume. For example my internal HDD has C and D.  \nThe virtual machines use physical drives (0, 1, 2, ...) not those letters, that\u0027s why is necessary to show them like that in the popup menu. But, since each corresponding volume(s) are shown, it\u0027s easy to choose.  \n\nIn this thread at some point it says that you have to create a special HDD file called usb.vmdk and to add it to the VirtualBox machine. This way you could access and even boot the USB drive in the virtual machine.  \nThis program dismounts (a sort of \"half eject\") the USB drive before the VM startup and remounts it after it closes. This way it prevents data corruption and the changes made inside the VM (adding/erasing files/folders) are visible after.\n\n"
    },
    {
      "id": "173210",
      "timestamp": "2013-06-07T17:16:44+00:00",
      "author": "steve6375",
      "content": "If I run Start_VM.exe for Oracle VBox from a fresh boot (win 7 -64-bit) then it fails to run VBox.\n\nIf I run VM Virtual Box Manager and then run Start_VM.exe it works. If I then close VBox Manager and run Start_VM.exe it still works.\n\nIs there a way to make Start_VM.exe work from a fresh boot so I don\u0027t have to run VBox Manager or am I doing something wrong?\n\n"
    },
    {
      "id": "173212",
      "timestamp": "2013-06-07T17:49:29+00:00",
      "author": "DavidB",
      "content": "It\u0027s showing the message \"Unable to launch VirtualBox !\"? That\u0027s strange...  \nOn my computer doesn\u0027t do that but I have Windows XP...  \nCould you please create a shortcut to that VirtualBox VM on the desktop and try to start it after a fresh boot? Maybe even try more than once to be sure...\n\n"
    },
    {
      "id": "173213",
      "timestamp": "2013-06-07T17:53:35+00:00",
      "author": "Wonko the Sane",
      "content": "\u003e Actually, the \u0027A\u0027..\u0027Z\u0027 letters that we see in a file manager in Windows are not really \"drives\" but \"volumes\".\n\nYes. :smile:\n\n\u003e A drive can have more than one volume. For example my internal HDD has C and D.\n\nOh noes, still the same issue. ![:frusty:](http://reboot.pro/public/style_emoticons/default/frusty.gif)\n\nA hard **disk**drive can have more than one volume.\n\nA hard **disk** *like* device or image can have more than one volume.\n\nA H**D**D is a Hard **Disk** Drive.\n\n\u003e The virtual machines use physical drives (0, 1, 2, ...) not those letters, that\u0027s why is necessary to show them like that in the popup menu. But, since each corresponding volume(s) are shown, it\u0027s easy to choose.\n\nYes, yes, yes! ![:thumbsup:](http://reboot.pro/public/style_emoticons/default/thumbsup.gif)\n\nQuick reminder :wink::\n\nA **volume** gets a **drive** letter or is mounted to a **drive** letter -\\\u003e common terminology **volume** \u003d **drive**\n\nA **volume** (the thing that gets a **drive** letter) is accessed as \\\\\\\\.\\\\**Logical**Drive\n\nA hard **disk** drive (the actual device, or \"whole thing\") is a **disk** (and contains **volumes** or drives) and is accessed as \\\\\\\\.\\\\**Physical**Drive -\\\u003e common ++**(wrong) misunderstanding**++ **drive** \u003d hard **disk** drive\n\nA hard **disk** drive ++**contains**++ **volume** s that can be primary partitions (and get a drive letter if not hidden) or logical **volume** s inside extended (and they also get a drive letter if not hidden).\n\nFirst hard **disk** drive is in grub4dos (hd0)\n\nFirst primary partition (**volume** or **drive** or however the thing that gets a **drive** letter) on first hard disk is in grub4dos (**hd0,0**).\n\nFirst **volume** (or **drive** or however the thing that gets a **drive** letter)inside extended partition is in grub4dos (**hd0,4**).\n\nMore examples:\n\nIMDISK does NOT deal with disks (but with **volume** s or **drive** s or \\\\\\\\.\\\\**Logical**Drives).\n\nVDK (Virtual disk driver) deals mainly with **disk**s or \\\\\\\\.\\\\**Physycal**Drives\n\nA .vhd is an image of a **disk** (whole thing).\n\nThe \\*whatever\\* that you can partition (and has a MBR as first sector) is a **disk**(whole thing) or \\\\\\\\.\\\\**Physical**Drive\n\nYou cannot use \"drive\" by itself as it may be understood ++both++ ![:ph34r:](http://reboot.pro/public/style_emoticons/default/scared9.gif) as **volume** or \\\\\\\\.\\\\**Logical**Drive (more common) or as hard **disk** drive or \\\\\\\\.\\\\**Physical**Drive.\n\nYou have to leave it to the good MS guys to mix the terms (and shake them well) ![:whistling:](http://reboot.pro/public/style_emoticons/default/happy22.gif).\n\n![:cheers:](http://reboot.pro/public/style_emoticons/default/cheers.gif)\n\nWonko\n\n"
    },
    {
      "id": "173215",
      "timestamp": "2013-06-07T18:37:19+00:00",
      "author": "steve6375",
      "content": "\u003e It\u0027s showing the message \"Unable to launch VirtualBox !\"? That\u0027s strange...  \n\u003e On my computer doesn\u0027t do that but I have Windows XP...  \n\u003e Could you please create a shortcut to that VirtualBox VM on the desktop and try to start it after a fresh boot? Maybe even try more than once to be sure...\n\nSame issue if run from VM shorcut:\n\n\u003e Failed to open a session for the virtual machine USB Boot.\n\u003e\n\u003e The object functionality is limited.\n\u003e\n\u003e Result Code: E_ACCESSDENIED (0x80070005)  \n\u003e Component: Machine  \n\u003e Interface: IMachine {22781af3-1c96-4126-9edf-67a020e0e858}\n\n"
    },
    {
      "id": "173216",
      "timestamp": "2013-06-07T18:58:43+00:00",
      "author": "DavidB",
      "content": "That seems to be a VirtualBox bug...\n\nIt resembles with this one: [https://www.virtualb...rg/ticket/11143](https://www.virtualbox.org/ticket/11143 \"External link\")\n\nYou can try what it says there (start the exe as an administrator) and/or you can try a complete reinstallation...\n\nLE: another solution is to make a batch file that will start and close VM Virtual Box Manager at Windows startup...\n\nOr you can try to find which exe/dll specifically needs and is started by the VM Virtual Box Manager...\n\n"
    },
    {
      "id": "173225",
      "timestamp": "2013-06-08T07:27:45+00:00",
      "author": "DavidB",
      "content": "I have made some small improvements on all the versions.  \n\n#### Attached Files {#attach_wrap}\n\n* [![Attached File](http://reboot.pro/public/style_extra/mime_types/zip.gif)](http://reboot.pro/index.php?s\u003d06ae6a1294de3eccae6fde61b54dab87\u0026app\u003dcore\u0026module\u003dattach\u0026section\u003dattach\u0026attach_id\u003d14303 \"Download attachment\") [**QEMU Starter exe.zip**](http://reboot.pro/index.php?s\u003d06ae6a1294de3eccae6fde61b54dab87\u0026app\u003dcore\u0026module\u003dattach\u0026section\u003dattach\u0026attach_id\u003d14303 \"Download attachment\") **213.77KB** 605 downloads\n* [![Attached File](http://reboot.pro/public/style_extra/mime_types/zip.gif)](http://reboot.pro/index.php?s\u003d06ae6a1294de3eccae6fde61b54dab87\u0026app\u003dcore\u0026module\u003dattach\u0026section\u003dattach\u0026attach_id\u003d14304 \"Download attachment\") [**QEMU Starter for Steve exe.zip**](http://reboot.pro/index.php?s\u003d06ae6a1294de3eccae6fde61b54dab87\u0026app\u003dcore\u0026module\u003dattach\u0026section\u003dattach\u0026attach_id\u003d14304 \"Download attachment\") **213.73KB** 536 downloads\n* [![Attached File](http://reboot.pro/public/style_extra/mime_types/zip.gif)](http://reboot.pro/index.php?s\u003d06ae6a1294de3eccae6fde61b54dab87\u0026app\u003dcore\u0026module\u003dattach\u0026section\u003dattach\u0026attach_id\u003d14305 \"Download attachment\") [**QEMU Starter for Steve sources.zip**](http://reboot.pro/index.php?s\u003d06ae6a1294de3eccae6fde61b54dab87\u0026app\u003dcore\u0026module\u003dattach\u0026section\u003dattach\u0026attach_id\u003d14305 \"Download attachment\") **3.86KB** 536 downloads\n* [![Attached File](http://reboot.pro/public/style_extra/mime_types/zip.gif)](http://reboot.pro/index.php?s\u003d06ae6a1294de3eccae6fde61b54dab87\u0026app\u003dcore\u0026module\u003dattach\u0026section\u003dattach\u0026attach_id\u003d14306 \"Download attachment\") [**QEMU Starter sources.zip**](http://reboot.pro/index.php?s\u003d06ae6a1294de3eccae6fde61b54dab87\u0026app\u003dcore\u0026module\u003dattach\u0026section\u003dattach\u0026attach_id\u003d14306 \"Download attachment\") **3.85KB** 580 downloads\n* [![Attached File](http://reboot.pro/public/style_extra/mime_types/zip.gif)](http://reboot.pro/index.php?s\u003d06ae6a1294de3eccae6fde61b54dab87\u0026app\u003dcore\u0026module\u003dattach\u0026section\u003dattach\u0026attach_id\u003d14309 \"Download attachment\") [**VirtualBox starter exe.zip**](http://reboot.pro/index.php?s\u003d06ae6a1294de3eccae6fde61b54dab87\u0026app\u003dcore\u0026module\u003dattach\u0026section\u003dattach\u0026attach_id\u003d14309 \"Download attachment\") **275.07KB** 663 downloads\n* [![Attached File](http://reboot.pro/public/style_extra/mime_types/zip.gif)](http://reboot.pro/index.php?s\u003d06ae6a1294de3eccae6fde61b54dab87\u0026app\u003dcore\u0026module\u003dattach\u0026section\u003dattach\u0026attach_id\u003d14310 \"Download attachment\") [**VirtualBox starter sources.zip**](http://reboot.pro/index.php?s\u003d06ae6a1294de3eccae6fde61b54dab87\u0026app\u003dcore\u0026module\u003dattach\u0026section\u003dattach\u0026attach_id\u003d14310 \"Download attachment\") **63.22KB** 615 downloads\n\n"
    },
    {
      "id": "173266",
      "timestamp": "2013-06-09T05:24:29+00:00",
      "author": "DavidB",
      "content": "Sorry for the triple posting...  \n\nI installed Windows 7 x86 in VirtualBox (since I have Windows XP x86 installed in the real computer I can\u0027t install 7 x64). Inside it I installed VirtualBox (!) and tried the VM starter (both versions).  \nAfter every fresh boot it started ok the VM...  \nI don\u0027t like Windows 7 and especially x64 version but, one of these days, I will try to install it on the real computer. Maybe this way I could find an workaround for that bug...  \n\nAnother thing.  \nI just had a \"crazy\" idea: since with VBoxManage.exe you can do pretty much everything (create/modify/start/delete VM) and with Qemu you can configure it 100% with command line parameters, maybe I could design an interface where the user can create or modify a VM and set its devices/parameters (including creating and adding usb.vmdk).  \nThis way it will be easier for the user to boot from a USB drive... Maybe too easy ![:D](http://reboot.pro/public/style_emoticons/default/biggrin.png)  \nAnyway I\u0027m interested to hear your thoughts about this...\n\n"
    },
    {
      "id": "173267",
      "timestamp": "2013-06-09T05:51:48+00:00",
      "author": "Blackcrack",
      "content": "Hi,\n\nnaa, np for me, i become you writings vuia Mail and have there for an own mail-folder on my TB :smile:\n\na good Suggestion, maybe \"QuickVBox\" an newer Qemu.Configurater want in anyway good for the newer Versions\n\nof qemu, the other are all stopped, never in developement and how ever an Dual-Head for 2 diffrent\n\nEmulationsprogramms want be good anyway :smile: But make me one favor make it as\n\n1. Open Source (\u003dfor enable to any can help) 2. Build up a Forum for it(\u003dFor any can tell an Bug and suggestions)\n\nand create there a download section for it (\u003dto be this Forum / Place your\u0027 Headquarter :smile: )\n\nIn you Forum can you have a possible to support by self some VBox-Programms and Qemu Programms,\n\nmaybe as point of contact for QEmu \\\u0026 VBox Hobby Programmer and around if it.\n\nSome Forum/Page i think it\u0027s not exist an\n\n\" Happy Emulations Hobby Programmer Portal\"\n\n(this is the Point of Contact for all Emulations-Programmer\")\n\nand there with can you add at all under one Roof,\n\nfree and Open Source and one Link to Reboot.pro as Syster-Board :smile:\n\nis this not an Suggestion for you ? And maybe at all who don\u0027t know were they can go\n\nto become a real help in Qemu and the Programmer who can announce they active\n\nPrograms for Qemu and VBox :smile: In WinNT and Linux\n\n(btw, i get at moment a helping hand on #Moondrake and #Openmandriva ,\n\nthe back given Mandrake to the Community from Jean Manuel Croset :smile: )\n\nSo can you Build up a Portal for all the Peoples who use VBox and Qemu\n\nand other VM\u0027s \"The Virtual Mashin\u0027s Portal\" or easy \"The VM Portal\"\n\nbut take a look for to be at all Free or open Source :wink:\n\nbest regards\n\nBlacky\n\n\u003e Sorry for the triple posting...  \n\u003e\n\u003e I installed Windows 7 x86 in VirtualBox (since I have Windows XP x86 installed in the real computer I can\u0027t install 7 x64). Inside it I installed VirtualBox (!) and tried the VM starter (both versions).  \n\u003e After every fresh boot it started ok the VM...  \n\u003e I don\u0027t like Windows 7 and especially x64 version but, one of these days, I will try to install it on the real computer. Maybe this way I could find a workaround for that bug...  \n\u003e\n\u003e Another thing.  \n\u003e I just had a \"crazy\" idea: since with VBoxManage.exe you can do pretty much everything (create/modify/start/delete VM) and with Qemu you can configure it 100% with command line parameters, maybe I could design an interface where the user can create or modify a VM and set its devices/parameters (including creating and adding usb.vmdk).  \n\u003e This way it will be easier for the user to boot from a USB drive... Maybe too easy ![:D](http://reboot.pro/public/style_emoticons/default/biggrin.png)  \n\u003e Anyway I\u0027m interested to hear your thoughts about this...\n\n"
    },
    {
      "id": "173312",
      "timestamp": "2013-06-10T08:29:05+00:00",
      "author": "DavidB",
      "content": "Ok, thanks.  \n\nMeantime I have made some other small improvements to the GUI version:  \n1. In the VMs list drag\u0027n\u0027drop can be used to rearrange entries;  \n2. Since VirtualBox is using both \u0027\\\\\u0027 and \u0027/\u0027 in storing path of VMs (in \"VirtualBox.xml\"), I had to implement both of them in my code.  \nAnd, yes, I know that both are normal to be used but it\u0027s a little odd because in both cases the VMs are on a Windows system.  \n3. Before starting the VM is checking the USB drive(s). If it/they doesn\u0027t/don\u0027t seem accessible it warns the user.  \n4. When it saves the VMs list on HDD it creates a backup of the previous list first.  \n5. Some other small bugfixes.\n\n"
    },
    {
      "id": "173361",
      "timestamp": "2013-06-11T17:43:48+00:00",
      "author": "DavidB",
      "content": "I have made some improvements to the interface of the GUI version:  \n\n[![Clipboard01.png](http://reboot.pro/uploads/monthly_06_2013/post-61891-0-14807600-1370972518_thumb.png)](http://reboot.pro/uploads/monthly_06_2013/post-61891-0-14807600-1370972518.png \"Clipboard01.png - Size: 11.15KB\"){#ipb-attach-url-14316-0-01548200-1676066418}\n\n[![Clipboard02.png](http://reboot.pro/uploads/monthly_06_2013/post-61891-0-85327000-1370972544_thumb.png)](http://reboot.pro/uploads/monthly_06_2013/post-61891-0-85327000-1370972544.png \"Clipboard02.png - Size: 20.63KB\"){#ipb-attach-url-14317-0-01555200-1676066418}\n\n[![Clipboard03.png](http://reboot.pro/uploads/monthly_06_2013/post-61891-0-61599800-1370972558_thumb.png)](http://reboot.pro/uploads/monthly_06_2013/post-61891-0-61599800-1370972558.png \"Clipboard03.png - Size: 20.37KB\"){#ipb-attach-url-14318-0-01562300-1676066418}\n\n"
    },
    {
      "id": "173363",
      "timestamp": "2013-06-11T17:49:22+00:00",
      "author": "Blackcrack",
      "content": "whant maybe good if you named you packs per version or date for decide between the packs /versions :smile:\n\nlooks realy nice, a very nice Gui and a realy well working Systemedit :smile:\n\ni have select a usb with 16 Gig but take it not as C: in vbox :\\\\\n\nbut i think it\u0027s the bug who you was speak about..\n\non Exe-parameters an \\[edit\\] button who automatical check the VMtype and open an spezialy\n\nParameters-editor for the VM\u0027s to create by click and select the parameters and by \\[Okey\\] button include in the exe-parameters text frame from\n\nEXE parameters\\[________________\\]\\[Edit\\]\n\nbest regards\n\nBlacky\n\n**Edited by Blackcrack, 11 June 2013 - 06:44 PM.**\n"
    },
    {
      "id": "173400",
      "timestamp": "2013-06-12T01:49:26+00:00",
      "author": "DavidB",
      "content": "\u003e whant maybe good if you named you packs per version or date for decide between the packs /versions :smile:\n\nThe exe version (in FileInfo) was changed every time lately but you\u0027re right, I will add information about version number to my posts...\n\n\u003e looks realy nice, a very nice Gui and a realy well working Systemedit :smile:\n\nThanks.\n\n\u003e i have select a usb with 16 Gig but take it not as C: in vbox :\\\\\n\u003e\n\u003e but i think it\u0027s the bug who you was speak about..\n\nSorry, but the automatic creation of usb.vmdk and adding it to the VM is not yet implemented. I know that you want a program that will do all and, in a way, that\u0027s my goal too, but the thing is, looks like we\u0027re the only ones interested in doing this... And since it\u0027s not so easy modifying my program to do it, right now I\u0027m not so sure it\u0027s worth the work...\n\n\u003e on Exe-parameters an \\[edit\\] button who automatical check the VMtype and open an spezialy\n\u003e\n\u003e Parameters-editor for the VM\u0027s to create by click and select the parameters and by \\[Okey\\] button include in the exe-parameters text frame from\n\u003e\n\u003e EXE parameters\\[________________\\]\\[Edit\\]\n\nThat\u0027s not so easy to implement too... There isn\u0027t a file from where you can read these parameters so my program will have to read the configuration of the VM and translate each of its characteristics into an exe parameter. Which is very hard work...\n\nBut, if you already created the VM in VirtualBox, you don\u0027t need to input any exe parameter, just add the VM ID and it will work fine...\n\n"
    },
    {
      "id": "173467",
      "timestamp": "2013-06-12T16:10:38+00:00",
      "author": "DavidB",
      "content": "I made some changes to the way a VirtualBox VM is started.  \nThere are now 3 independent ways to start it: exe parameters, VM ID and VM Path. Default is VM ID. In the previous version there were only the first 2 and they were not 100% independent.  \n\n[![Clipboard01.png](http://reboot.pro/uploads/monthly_06_2013/post-61891-0-43040700-1371052987_thumb.png)](http://reboot.pro/uploads/monthly_06_2013/post-61891-0-43040700-1371052987.png \"Clipboard01.png - Size: 21.49KB\"){#ipb-attach-url-14321-0-31997000-1676066418} [![Clipboard02.png](http://reboot.pro/uploads/monthly_06_2013/post-61891-0-11976300-1371052998_thumb.png)](http://reboot.pro/uploads/monthly_06_2013/post-61891-0-11976300-1371052998.png \"Clipboard02.png - Size: 21.83KB\"){#ipb-attach-url-14322-0-32009100-1676066418} [![Clipboard03.png](http://reboot.pro/uploads/monthly_06_2013/post-61891-0-93258200-1371053002_thumb.png)](http://reboot.pro/uploads/monthly_06_2013/post-61891-0-93258200-1371053002.png \"Clipboard03.png - Size: 21.51KB\"){#ipb-attach-url-14323-0-32017200-1676066418}\n\n\u003cbr /\u003e\n\nOn Qemu, since it uses only exe parameters, the other 2 are hidden.  \n\n[![Clipboard04.png](http://reboot.pro/uploads/monthly_06_2013/post-61891-0-04565100-1371053004_thumb.png)](http://reboot.pro/uploads/monthly_06_2013/post-61891-0-04565100-1371053004.png \"Clipboard04.png - Size: 18.78KB\"){#ipb-attach-url-14324-0-32024300-1676066418}\n\nIn the next few days I won\u0027t be able to work much on this program because I won\u0027t have a computer. A close friend of mine has a damaged video card in his computer and I will borrow mine to him until I could find a second hand one. He can\u0027t afford a new one and he needs a working computer (for good reasons).  \nHopefully I will find one fast ![:D](http://reboot.pro/public/style_emoticons/default/biggrin.png)\n\n"
    },
    {
      "id": "173482",
      "timestamp": "2013-06-12T21:42:11+00:00",
      "author": "Wonko the Sane",
      "content": "\u003e A close friend of mine has a damaged video card in his computer and I will borrow mine to him until I could find a second hand one.\n\nIt seems like - strangely enough - Norwegian is more similar to Latin languages than to English. ![:w00t:](http://reboot.pro/public/style_emoticons/default/w00t.gif)\n\nThe same verb is used, active or passive? ![:unsure:](http://reboot.pro/public/style_emoticons/default/unsure.png)\n\n[https://translate.go... borrow to lend](https://translate.google.com/?hl\u003den\u0026tab\u003dwT#en/no/to%20borrow%0Ato%20lend \"External link\")\n\n[https://translate.go...n/å låne å låne](https://translate.google.com/?hl\u003den\u0026tab\u003dwT#no/en/%C3%A5%20l%C3%A5ne%0A%C3%A5%20l%C3%A5ne \"External link\")\n\nIt is this way in Italian, and latin languages.\n\nIn English there are two different verbs, to lend (as in \"I will lend mine to him\") and to borrow (as in \"He will borrow mine\" or He will borrow it from me\").\n\nGood luck in your search for the fast affordable PC :smile:.\n\n![:cheers:](http://reboot.pro/public/style_emoticons/default/cheers.gif)\n\nWonko\n\n"
    },
    {
      "id": "173491",
      "timestamp": "2013-06-13T01:44:49+00:00",
      "author": "DavidB",
      "content": "Actually I\u0027m not 100% Norwegian, I was just born in Norway and sometimes I live there.  \nBut I don\u0027t know what\u0027s so important about this...\n\n"
    },
    {
      "id": "173501",
      "timestamp": "2013-06-13T08:56:31+00:00",
      "author": "Wonko the Sane",
      "content": "\u003e But I don\u0027t know what\u0027s so important about this...\n\nNothing important, I was just curious about the language.\n\n![:cheers:](http://reboot.pro/public/style_emoticons/default/cheers.gif)\n\nWonko\n\n"
    },
    {
      "id": "173514",
      "timestamp": "2013-06-13T12:38:05+00:00",
      "author": "DavidB",
      "content": "Lucky me, looks like the damaged video card still works but only in 800x600 resolution and 4 bit color depth. With anything higher the monitor goes to standby.  \nEven so I have some weird colored lines on my screen.  \nWell, for reading/writing in forums and for some programming 16 colors will suffice ![:D](http://reboot.pro/public/style_emoticons/default/biggrin.png)\n\n"
    },
    {
      "id": "173545",
      "timestamp": "2013-06-14T05:44:46+00:00",
      "author": "DavidB",
      "content": "Few improvements:  \n- only one instance of the application can be started now (to prevent sharing problems);  \n- the main window will be shown now in the middle of the screen;  \n- \"Run\" has 2 extra values: \"Hidden\" for Qemu (to hide Qemu log window) and Fullscreen for VirtualBox;  \n- when adding a new Qemu VM it sets \"-L . -name \"USB Boot Test\" -boot c -m 512\" as the default exe parameters;  \n- when starting a Qemu VM, the first USB drive (and the second if it\u0027s set) are automatically added to the Qemu exe command line. I\u0027m thinking on a good way to do this with usb.vmdk also. But it\u0027s not so easy ![:frusty:](http://reboot.pro/public/style_emoticons/default/frusty.gif)   \n\nI\u0027m interested in your opinion: should I modify the code to identify the USB drive by its serial number (to avoid the problems when other drives are connected/disconnected before it\u0027s connected) or I should just use the current code (the number)?  \nEach approach has its pros and cons...\n\n"
    },
    {
      "id": "173548",
      "timestamp": "2013-06-14T08:30:09+00:00",
      "author": "Wonko the Sane",
      "content": "\u003e I\u0027m interested in your opinion: should I modify the code to identify the USB drive by its serial number (to avoid the problems when other drives are connected/disconnected before it\u0027s connected) or I should just use the current code (the number)?  \n\u003e Each approach has its pros and cons...\n\nDo you mean the *device serial number* or the Disk Signature or the Volume Serial?\n\n(I often happen to remove device serial number from USB sticks)\n\n![:cheers:](http://reboot.pro/public/style_emoticons/default/cheers.gif)\n\nWonko\n\n"
    },
    {
      "id": "173551",
      "timestamp": "2013-06-14T09:32:43+00:00",
      "author": "DavidB",
      "content": "\u003e Do you mean the *device serial number* or the Disk Signature or the Volume Serial?\n\u003e\n\u003e (I often happen to remove device serial number from USB sticks)\n\u003e\n\u003e ![:cheers:](http://reboot.pro/public/style_emoticons/default/cheers.gif)\n\u003e\n\u003e Wonko\n\nI mean the device serial number.  \nIf you remove it from its physical surface that\u0027s no problem, my program will not ask you to type it. It will automatically take it from its chip when you will select the device from the popup menu.\n\n"
    },
    {
      "id": "173552",
      "timestamp": "2013-06-14T09:45:30+00:00",
      "author": "Wonko the Sane",
      "content": "\u003e I mean the device serial number.  \n\u003e If you remove it from its physical surface that\u0027s no problem, my program will not ask you to type it. It will automatically take it from its chip when you will select the device from the popup menu.\n\nPhysical surface? ![:w00t:](http://reboot.pro/public/style_emoticons/default/w00t.gif)  \nI am talking of the \"unique\" serial that is attributed to the stick with it\u0027s Mass Production Tool.\n\n\u003cbr /\u003e\n\nThe number that (say) Chipgenius or Chipeasy reads, like:  \n\u003e Logical drive : R:\\\\ Capacity: 0.1G  \n\u003e Device ID : VID \u003d 8644 PID \u003d 800B  \n\u003e **Device SN :** **00000000000197E0**  \n\u003e Device version : 1.00  \n\u003e\n\u003e Device vendor : Jaclaz  \n\u003e Device model : USB Flash Disk  \n\u003e Protocol : USB2.0  \n\u003e Max power : 500mA  \n\u003e\n\u003e Partition type : FAT32 Device active : OK  \n\u003e Aligned state : Misaligned  \n\u003e\n\u003e Controller : (unknown)  \n\u003e Controller model: DM8261  \n\u003e Flash Vendor : SanDisk, Type: TLC, Page: 8K  \n\u003e Flash ID : 45D798B2  \n\u003e Score : 12 (Normal Score \\\u003e\u003d 30)  \n\u003e\n\u003e Tools : [http://www.upan.cc/tools/mass/dm/](http://www.upan.cc/tools/mass/dm/ \"External link\")  \n\u003e OS Version : Microsoft Windows XP Professional Service Pack 3  \n\u003e Update Status : The current version is the latest version!\n\nIn the above example, I left it, but I have more than one stick where I removed that info.\n\n![:cheers:](http://reboot.pro/public/style_emoticons/default/cheers.gif)\n\nWonko\n\n"
    },
    {
      "id": "173554",
      "timestamp": "2013-06-14T10:14:47+00:00",
      "author": "DavidB",
      "content": "Ok, I think that you\u0027re talking about the same thing as I was.  \nYes, that\u0027s the SN.  \n\nJust curious, why do you remove it...? ![:D](http://reboot.pro/public/style_emoticons/default/biggrin.png)  \nDo you reset it to 0 or do you write another unique SN?  \nAnyway, I could use also other characteristics, like Capacity (total not volume), VID, PID, Controller model, Flash Vendor, Flash ID ad so on.  \nIt will not be 100% unique but maybe it will be enough to find it in your computer, even if you have other ones connected...  \n\nOk, I\u0027m going out now to buy a video card... The colors that I\u0027m seeing on screen are making me kill somebody ![:D](http://reboot.pro/public/style_emoticons/default/biggrin.png) Just kidding... Maybe... ![:D](http://reboot.pro/public/style_emoticons/default/biggrin.png)\n\n"
    },
    {
      "id": "173555",
      "timestamp": "2013-06-14T11:04:06+00:00",
      "author": "Wonko the Sane",
      "content": "I happen to do things just to annoy someone else ![:smiling9:](http://reboot.pro/public/style_emoticons/default/smiling9.gif) (not really-really ![:hypocrite:](http://reboot.pro/public/style_emoticons/default/hypocrite.gif) , only to prove a point if needed :wink:).\n\nI happened a few years ago to come across an app (BTW actually and IMHO useless and worthless) that recorded (besides and outside the Registry) the serials (and some other data) of any USB stick connected to the machine.\n\nIt was a \"corporation\" and the IT guy thought that it was \"1337\" to deploy that to all the PC\u0027s, and tried to \"sell\" this idea as a security enhancement/auditing fail-proof method ![:w00t:](http://reboot.pro/public/style_emoticons/default/w00t.gif), so I made quite a few sticks with Serial 9341963742831649 to see how long it would have taken him to find about it.\n\nThen took the habit when re-configuring a stick (I tend to \"flip the Removable bit\" on my sticks) to set it\u0027s serial to all 00\u0027s.\n\nWhy dont\u0027 you use the Disk Signature like anyone else? ![:unsure:](http://reboot.pro/public/style_emoticons/default/unsure.png)\n\n(I presume we are talking anyway of partitioned devices)\n\nThe good thing is that the Disk Signature:\n\n1. must be present for a NT system to identify the \\\\\\\\.\\\\PhysicalDrive\n2. it must be \"unique\" on the system (and if there is a collision it is automatically fixed, if I recall correctly)\n\n![:cheers:](http://reboot.pro/public/style_emoticons/default/cheers.gif)\n\nWonko\n\n\u003cbr /\u003e\n\n"
    },
    {
      "id": "173558",
      "timestamp": "2013-06-14T12:42:27+00:00",
      "author": "DavidB",
      "content": "Solved the video card problem, I bought an old GeForce 6200 FX with only 12 Euro.  \nI don\u0027t want to kill others anymore... Well, maybe with an exception ![:whistling:](http://reboot.pro/public/style_emoticons/default/happy22.gif)   \n\nDisk Signature could be the solution. Thank you for the idea.  \nNow I\u0027m curious if there are others who will like it too...\n\n"
    },
    {
      "id": "173567",
      "timestamp": "2013-06-14T16:15:23+00:00",
      "author": "DavidB",
      "content": "I found a good way to retrieve the disk signature using Delphi code and I intend to implement it.\n\nBut if anyone wants the drive number implementation instead, speak now.\n\nLike the priest says \"If anyone objects to this marriage, let them speak now or forever hold their peace..\" ![:D](http://reboot.pro/public/style_emoticons/default/biggrin.png)\n\n"
    },
    {
      "id": "173568",
      "timestamp": "2013-06-14T16:22:40+00:00",
      "author": "steve6375",
      "content": "if the idea is to uniquely identify a device, why not use disk sig+USB serial no+drive capacity?\n\n"
    },
    {
      "id": "173576",
      "timestamp": "2013-06-14T17:33:44+00:00",
      "author": "DavidB",
      "content": "Yes, it will raise the \"uniqueness\" from, let\u0027s say, 99% to 99.9%.\n\nThe only downside is that the program will be a little more slower and a little more unstable.\n\nBut I think that\u0027s not such a big problem.\n\n"
    },
    {
      "id": "173617",
      "timestamp": "2013-06-15T07:03:47+00:00",
      "author": "DavidB",
      "content": "It seems like there is a problem retrieving the disk signature on GPT disks. I can\u0027t find any good and documented API function for this.  \nWith MBR disks there are no problems. Currently the USB disks with MBR are far many than those with GPT but in the future this could change...\n\n"
    },
    {
      "id": "173627",
      "timestamp": "2013-06-15T09:37:36+00:00",
      "author": "Wonko the Sane",
      "content": "Cannot you just get 4 bytes with direct disk access to first sector of the device? ![:unsure:](http://reboot.pro/public/style_emoticons/default/unsure.png)\n\nI am not familiar with GPT style partitioning, but the signature should be in the same place, the first sector is anyway a \"protective MBR\", the function should be exactly the same:\n\n[http://msdn.microsof...7(v\u003dvs.85).aspx](http://msdn.microsoft.com/en-us/library/windows/hardware/ff552637(v\u003dvs.85).aspx \"External link\")\n\n[http://msdn.microsof...7(v\u003dvs.85).aspx](http://msdn.microsoft.com/en-us/library/windows/hardware/ff561447(v\u003dvs.85).aspx \"External link\")\n\nI mean, a non-GPT aware NT based system has anyway to \"identify\" the disk using Disk Signature, so when you connect such a disk to a 2K (and possibly also XP) it must write to it a Disk Signature. ![:unsure:](http://reboot.pro/public/style_emoticons/default/unsure.png) the issue might be a a GPT disk that was only mounted on newish Windows NT versions. ![:dubbio:](http://reboot.pro/public/style_emoticons/default/dubbio.gif)\n\nYep, logic above confirmed :smile::\n\n[http://thestarman.pc...asm/mbr/GPT.htm](http://thestarman.pcministry.com/asm/mbr/GPT.htm \"External link\")\n\nBut if you use the \"standard code\" you can have Disk Signature on MBR disks and \"DiskId\" on GPT ones.\n\nAnd as well if you use direct disk access you can get the 4 bytes on sector 0 offset 440 or the 16 bytes on sector 1 offset 56.\n\n![:cheers:](http://reboot.pro/public/style_emoticons/default/cheers.gif)\n\nWonko\n\n"
    },
    {
      "id": "173628",
      "timestamp": "2013-06-15T10:08:55+00:00",
      "author": "DavidB",
      "content": "\u003e Cannot you just get 4 bytes with direct disk access to first sector of the device? ![:unsure:](http://reboot.pro/public/style_emoticons/default/unsure.png)\n\nDisk signature for MBR yes, I\u0027m already using this to take it from MBR:  \n\n```\nconst\n  // Max number of drives assuming primary/secondary, master/slave topology\n  MAX_IDE_DRIVES \u003d 16;\nvar\n   i: Integer;\n   RawMBR: array[0..511] of Byte;\n   btsIO: DWORD;\n   hDevice: THandle;\n   s: string;\nbegin\n   s :\u003d \u0027\u0027;\n   for i :\u003d 0 to MAX_IDE_DRIVES - 1 do\n   begin\n      hDevice :\u003d CreateFile(PChar(\u0027\\\\.\\PHYSICALDRIVE\u0027 + IntToStr(i)), GENERIC_READ,\n         FILE_SHARE_READ or FILE_SHARE_WRITE, nil, OPEN_EXISTING, 0, 0);\n      if hDevice \u003c\u003e INVALID_HANDLE_VALUE then\n      begin\n         SetFilePointer(hDevice, 0, nil, FILE_BEGIN);\n         ReadFile(hDevice, RawMBR[0], 512, btsIO, nil);\n         CloseHandle(hDevice);\n         s :\u003d s + \u0027Disk \u0027 + IntToStr(i) + \u0027 \u003d \u0027 + IntToHex(RawMBR[443], 2) + \u0027 \u0027 +\n            IntToHex(RawMBR[442], 2) + \u0027 \u0027 + IntToHex(RawMBR[441], 1) +\n            \u0027 \u0027 + IntToHex(RawMBR[440], 2) + #13#10;\n      end;\n   end;\n   ShowMessage(s);\nend;\n```\n\nHowever the disk signature for a GPT disk is a GUID, not just a 4 bytes ID. And I\u0027m not sure about the location...\n\n\u003e I am not familiar with GPT style partitioning, but the signature should be in the same place, the first sector is anyway a \"protective MBR\", the function should be exactly the same:\n\u003e\n\u003e [http://msdn.microsof...f552637(v\u003dvs.85](http://msdn.microsoft.com/en-us/library/windows/hardware/ff552637(v\u003dvs.85 \"External link\")).aspx\n\u003e\n\u003e [http://msdn.microsof...f561447(v\u003dvs.85](http://msdn.microsoft.com/en-us/library/windows/hardware/ff561447(v\u003dvs.85 \"External link\")).aspx\n\nYes, I know this function, seems good, for the past 2 days I\u0027m trying to make it work in Delphi and couldn\u0027t find a way because I can\u0027t find any documentation about setting it in Delphi.\n\n\u003e I mean, a non-GPT aware NT based system has anyway to \"identify\" the disk using Disk Signature, so when you connect such a disk to a 2K (and possibly also XP) it must write to it a Disk Signature. ![:unsure:](http://reboot.pro/public/style_emoticons/default/unsure.png) the issue might be a a GPT disk that was only mounted on newish Windows NT versions. ![:dubbio:](http://reboot.pro/public/style_emoticons/default/dubbio.gif)\n\u003e\n\u003e Yep, logic above confirmed :smile::\n\u003e\n\u003e [http://thestarman.pc...asm/mbr/GPT.htm](http://thestarman.pcministry.com/asm/mbr/GPT.htm \"External link\")\n\u003e\n\u003e But if you use the \"standard code\" you can have Disk Signature on MBR disks and \"DiskId\" on GPT ones.\n\u003e\n\u003e And as well if you use direct disk access you can get the 4 bytes on sector 0 offset 440 or the 16 bytes on sector 1 offset 56.\n\u003e\n\u003e ![:cheers:](http://reboot.pro/public/style_emoticons/default/cheers.gif)\n\u003e\n\u003e Wonko\n\nThanks for the tip, I will modify the code to see if I can get the GUID from the GPT disks (from that location).\n\n"
    },
    {
      "id": "173633",
      "timestamp": "2013-06-15T12:51:14+00:00",
      "author": "DavidB",
      "content": "I have a working code for both:\n\n```\n\nconst\n   // Max number of drives assuming primary/secondary, master/slave topology\n   MAX_IDE_DRIVES \u003d 16;\nvar\n   i: Integer;\n   DiskType: Byte;\n   RawMBR: array[0..511] of Byte;\n   btsIO: DWORD;\n   hDevice: THandle;\n   s: string;\nbegin\n   s :\u003d \u0027\u0027;\n   for i :\u003d 0 to MAX_IDE_DRIVES - 1 do\n   begin\n      hDevice :\u003d CreateFile(PChar(\u0027\\\\.\\PHYSICALDRIVE\u0027 + IntToStr(i)), GENERIC_READ,\n         FILE_SHARE_READ or FILE_SHARE_WRITE, nil, OPEN_EXISTING, 0, 0);\n      if hDevice \u003c\u003e INVALID_HANDLE_VALUE then\n      begin\n         SetFilePointer(hDevice, 512, nil, FILE_BEGIN); //sector 1 for GPT\n         ReadFile(hDevice, RawMBR[0], 512, btsIO, nil);\n         if (IntToHex(RawMBR[0], 2) + IntToHex(RawMBR[1], 2) +\n            IntToHex(RawMBR[2], 2) + IntToHex(RawMBR[3], 2) +\n            IntToHex(RawMBR[4], 2) + IntToHex(RawMBR[5], 2) +\n            IntToHex(RawMBR[6], 2) + IntToHex(RawMBR[7], 2)) \u003d\n            \u00274546492050415254\u0027 then //EFI PART\n            DiskType :\u003d 1 //GPT\n         else\n         begin\n            DiskType :\u003d 0; //MBR\n            SetFilePointer(hDevice, 0, nil, FILE_BEGIN); //sector 0 for MBR\n            ReadFile(hDevice, RawMBR[0], 512, btsIO, nil);\n         end;\n         CloseHandle(hDevice);\n         if DiskType \u003d 0 then\n            s :\u003d s + \u0027Disk \u0027 + IntToStr(i) + \u0027 \u003d \u0027 + IntToHex(RawMBR[443], 2) + \u0027 \u0027 +\n               IntToHex(RawMBR[442], 2) + \u0027 \u0027 + IntToHex(RawMBR[441], 2) +\n               \u0027 \u0027 + IntToHex(RawMBR[440], 2) + #13#10\n         else\n            s :\u003d s + \u0027Disk \u0027 + IntToStr(i) + \u0027 \u003d \u0027 + IntToHex(RawMBR[59], 2) +\n               \u0027 \u0027 + IntToHex(RawMBR[58], 2) + \u0027 \u0027 + IntToHex(RawMBR[57], 2) +\n               \u0027 \u0027 + IntToHex(RawMBR[56], 2) + \u0027 - \u0027 + IntToHex(RawMBR[61], 2) +\n               \u0027 \u0027 + IntToHex(RawMBR[60], 2) + \u0027 - \u0027 + IntToHex(RawMBR[63], 2) +\n               \u0027 \u0027 + IntToHex(RawMBR[62], 2) + \u0027 - \u0027 + IntToHex(RawMBR[64], 2) +\n               \u0027 \u0027 + IntToHex(RawMBR[65], 2) + \u0027 - \u0027 + IntToHex(RawMBR[66], 2) +\n               \u0027 \u0027 + IntToHex(RawMBR[67], 2) + \u0027 \u0027 + IntToHex(RawMBR[68], 2) +\n               \u0027 \u0027 + IntToHex(RawMBR[69], 2) + \u0027 \u0027 + IntToHex(RawMBR[70], 2) +\n               \u0027 \u0027 + IntToHex(RawMBR[71], 2) +\n               #13#10;\n      end;\n   end;\n   ShowMessage(s);\nend;\n```\n\nOk, now to implement this in the rest of the code ![:hammer:](http://reboot.pro/public/style_emoticons/default/hammer.gif)\n\n"
    },
    {
      "id": "173650",
      "timestamp": "2013-06-15T17:41:06+00:00",
      "author": "DavidB",
      "content": "For now I implemented only with disk signature. It performed great in tests. But if, in the future, there will be duplicates problems, I will implement also with serial number and capacity.  \nWith Qemu is adapting perfectly to any change in physical disks order.  \nWith VirtualBox only half because the automatic change of usb.vmdk is not yet implemented.  \nBut I\u0027m thinking of doing this in the next few days...  \n\nBtw, should I detach usb.vmdk, rebuild it and attach it again (kind of slow but less potential problems) or should I just change the number of the \\\\\\\\.\\\\PhysicalDrive inside the file (faster but rare problems may appear)?\n\n"
    },
    {
      "id": "173749",
      "timestamp": "2013-06-18T11:47:06+00:00",
      "author": "DavidB",
      "content": "In the past few days I\u0027ve worked hard to implement the automatic modification of the vmdk HDD file(s) (pointing to the USB drive(s)).  \n\nWhat I\u0027ve done so far:  \n- when the vmdk file is already attached to the VM it modifies its content: drive capacity, drive number and the number of cylinders. Btw, a curious thing about the number of cylinders: it seems that the maximum number (generated by the vboxmanage) is 16383 (although the VM doesn\u0027t show error if you increase it manually). And since it always uses 16 heads and 63 sectors it means that the maximum (geometric) size is 7.8745 GB.  \n- when it doesn\u0027t find the vmdk file attached, it creates one for that USB drive and attach it to a fixed port number (0).  \n\nWhat I have to implement more:  \n- the attach of the vmdk file to the first free/available port (so it shouldn\u0027t overwrite any other already attached drives);  \n- the removal of the vmdk for the second USB drive when it\u0027s removed also from the VMS entry.  \n\nIt\u0027s gonna take some time to implement these too...  \nWell, back to work ![:D](http://reboot.pro/public/style_emoticons/default/biggrin.png)\n\n"
    },
    {
      "id": "173793",
      "timestamp": "2013-06-19T12:59:00+00:00",
      "author": "DavidB",
      "content": "It\u0027s all implemented now...  \n\nHere it is (1.0 Beta 1 version):\n\nLE: link removed, you can find a better version in the next posts.\n\n"
    },
    {
      "id": "173804",
      "timestamp": "2013-06-19T15:04:13+00:00",
      "author": "steve6375",
      "content": "Not quite sure how to use your GUI... How is one meant to set up the initial VM for VBox before selecting it in your app?\n\nI had a few problems.\n\nFirst - is it possible to copy the existing vbox rather than add drives and change an existing one - i.e. user selects existing vbox but you write a copy and temporarily change it and boot to that?\n\nOne of my vm\u0027s has a USB.vmdk+hdd1+hdd2 as storage, when I used your app and added first USB drive, it added USB1 to the other 3 drives and then wouldn\u0027t boot due to IDE drive config issues. The addition also meant that the VM that previously worked fine in VM Manager now doesn\u0027t (until I delete the extra added drive).\n\nSo I presume I need to create a VM without a USB vmdk already attached.\n\nThe First USB drive list is listing drives F and H, but F is my internal SSD HDD not a USB drive.\n\nOne of my VMs (\"USB2 Boot\") had a snapshot. The list of .vboxes in your app seemed to be not listing that one, but another vbox (called \u0027test iso\u0027) seemed to have the ID number of the \"USB2 Boot\" VM and it booted to the USB2 Boot VM when I ran \u0027test iso\u0027 from your app. Once I deleted the snapshot, your app listed the USB2 Boot VM.\n\nMight be best if you gave unique names to the .vmdk\u0027s you create, just in case they clash with existing ones - e.g. VMStart_USB1.vmdk?\n\nHTH\n\nSteve\n\n"
    },
    {
      "id": "173816",
      "timestamp": "2013-06-19T16:11:58+00:00",
      "author": "DavidB",
      "content": "\u003e Not quite sure how to use your GUI... How is one meant to set up the initial VM for VBox before selecting it in your app?\n\nI haven\u0027t implemented complete creation and/or control of the VirtualBox VM.  \nYou just have to create a machine with default settings or use one that is already built. Most will work ok with my application and I will improve it when someone will show me a commonly used VM that doesn\u0027t work. Just send me the VM files and/or the VB configuration file(s) and I will try to solve the problem.\n\n\u003e I had a few problems.\n\u003e\n\u003e First - is it possible to copy the existing vbox rather than add drives and change an existing one - i.e. user selects existing vbox but you write a copy and temporarily change it and boot to that?\n\nTo make a copy of the VM is not such a bad idea but unfortunately not always practical because:  \n- it had to be physically copied elsewhere each time but when it has big files it will take too long time;  \n- I wouldn\u0027t call VirtualBox a bug free application so each time you will use the internal commands to copy the VM elsewhere, register it and so on, this will increase the chances that something would go wrong.  \n- it will take slightly more resources from the host computer;  \n- like I said, my application doesn\u0027t have complete control of the VM, I implemented as much control as it was needed to add/modify/delete the vmdk file(s), the rest requires user interaction with the VM (in the VirtualBox interface); some users will not like finding a duplicate of the VM.\n\n\u003e One of my vm\u0027s has a USB.vmdk+hdd1+hdd2 as storage, when I used your app and added first USB drive, it added USB1 to the other 3 drives and then wouldn\u0027t boot due to IDE drive config issues. The addition also meant that the VM that previously worked fine in VM Manager now doesn\u0027t (until I delete the extra added drive).\n\u003e\n\u003e So I presume I need to create a VM without a USB vmdk already attached.\n\nStrange, it should of worked even with a vmdk previously attached. Could you please send me the this vmdk and the vbox file so I can try to duplicate the issue...? Maybe even some data about the USB drive (capacity).\n\n\u003e The First USB drive list is listing drives F and H, but F is my internal SSD HDD not a USB drive.\n\nYes it\u0027s listing internal drives also because I haven\u0027t implemented a code that would differentiate USB drives from internal HDD\u0027s. Reason: not all the USB drives are seen as \"removable\" by the OS and not all the internal ones are seen as \"fixed\"; sometimes even the users \"flip\" the \"removable\" bit. Let me tell you something amusing: when I first installed Windows XP on my internal SATA WD, it was seen as \"removable\" but my external WD HDD was seen as not \"removable\". I fixed with my internal HDD but I let the external one to be seen as internal.  \nSo I will have to make a code that it will search in specific computer ports which it is not so easy, especially when you try to make it 100% reliable...  \nPerhaps in the future, will see...\n\n\u003e One of my VMs (\"USB2 Boot\") had a snapshot. The list of .vboxes in your app seemed to be not listing that one, but another vbox (called \u0027test iso\u0027) seemed to have the ID number of the \"USB2 Boot\" VM and it booted to the USB2 Boot VM when I ran \u0027test iso\u0027 from your app. Once I deleted the snapshot, your app listed the USB2 Boot VM.\n\nHmm, seems like a bug. Could you please recreate the problem and send me the vbox file and \"c:\\\\Documents and Settings\\\\Username\\\\.VirtualBox\\\\VirtualBox.xml\" (this is a Windows XP path, some of the folders in the \"tree\" are virtual in 7/8).\n\n\u003e Might be best if you gave unique names to the .vmdk\u0027s you create, just in case they clash with existing ones - e.g. VMStart_USB1.vmdk?\n\u003e\n\u003e HTH\n\u003e\n\u003e Steve\n\nMy application uses usb0..usb99. It checks before creating another vmdk and uses another number in that range. So the probability of a clash is very little.  \nBut I will use \"VMSusb0..99\".  \n\nThank you for the ideas.\n\nLater edit: using VMS to atart a VM with snapshot is generally not such a good idea anyway. The main gold of VMS is to make writes on USB drive visible; the snapshot is making the VM write into a file on HDD.\n\n"
    },
    {
      "id": "173822",
      "timestamp": "2013-06-19T17:21:40+00:00",
      "author": "DavidB",
      "content": "Two more things:  \n1. Are you using the latest VirtualBox version (4.2.12)?  \n2. I\u0027ve seen that some programs (WinSetupFromUSB and probably your program too) use WMI to get data about USB drives. It\u0027s good but the problem is that is restricted to Windows (WMI \u003d Windows Management Interface). Other OS\u0027s have very poor WMI implementation. For example I tried to use WinSetupFromUSB in wine (Linux), it\u0027s not even showing the interface before crashing.  \nI\u0027m trying to find ways that can be used in any OS so I can port my application (instead of rewriting the entire code). But that\u0027s not so easy...\n\n"
    },
    {
      "id": "173829",
      "timestamp": "2013-06-19T18:52:59+00:00",
      "author": "steve6375",
      "content": "\u003e Two more things:  \n\u003e 1. Are you using the latest VirtualBox version (4.2.12)?  \n\u003e 2. I\u0027ve seen that some programs (WinSetupFromUSB and probably your program too) use WMI to get data about USB drives. It\u0027s good but the problem is that is restricted to Windows (WMI \u003d Windows Management Interface). Other OS\u0027s have very poor WMI implementation. For example I tried to use WinSetupFromUSB in wine (Linux), it\u0027s not even showing the interface before crashing.  \n\u003e I\u0027m trying to find ways that can be used in any OS so I can port my application (instead of rewriting the entire code). But that\u0027s not so easy...\n\nYes, 4.2.12\n\nNo, I don\u0027t use WMI. RMPrepUSB does work under WINE (mostly), but some explorer functions don\u0027t work properly.\n\n"
    },
    {
      "id": "173841",
      "timestamp": "2013-06-19T21:54:59+00:00",
      "author": "DavidB",
      "content": "\u003e Btw, should I detach usb.vmdk, rebuild it and attach it again (kind of slow but less potential problems) or should I just change the number of the \\\\\\\\.\\\\PhysicalDrive inside the file (faster but rare problems may appear)?\n\n\u003e One of my vm\u0027s has a USB.vmdk+hdd1+hdd2 as storage, when I used your app and added first USB drive, it added USB1 to the other 3 drives and then wouldn\u0027t boot due to IDE drive config issues. The addition also meant that the VM that previously worked fine in VM Manager now doesn\u0027t (until I delete the extra added drive).\n\nI think it was one of those \"rare problems\"; VMS couldn\u0027t read or write from/to the vmdk and tried to create a new one. Since both they were for the same drive it\u0027s obvious why VB didn\u0027t work.\n\nThe reason why it couldn\u0027t read or write - I can\u0027t tell without looking in the file and without knowing the security permissions to read/write in the file. If it\u0027s a reading bug in my code the file would help me fix it...\n\nAnyway I modified VMS to try to detach and erase the first vmdk before adding the second.\n\n"
    },
    {
      "id": "173845",
      "timestamp": "2013-06-20T01:31:31+00:00",
      "author": "DavidB",
      "content": "\u003e The First USB drive list is listing drives F and H, but F is my internal SSD HDD not a USB drive.\n\nAnyway I was thinking - why restricting the user\u0027s choice to only USB drives... Maybe some day he will need to add an internal FDD/HDD/SDD to the VM in the same way...  \nWhat do you think...?  \n\nAnother thing: maybe we can find a way to improve the vmdk file by changing its internal parameters. For example \"cylinders\": I wonder what it will change in the VM (Grub4Dos) if we\u0027ll use the real number not 16383. Or we can try to find a correlation between bios\\* in vmdk and the geometric parameters of the real drive so Grub4Dos would correctly access the entire drive...\n\n"
    },
    {
      "id": "173851",
      "timestamp": "2013-06-20T08:53:49+00:00",
      "author": "steve6375",
      "content": "In my case, I have the swap file on the 2nd internal HDD, dismounting that would not be a good idea!\n\nTo what problem are you referring in grub4dos exactly?\n\n"
    },
    {
      "id": "173853",
      "timestamp": "2013-06-20T09:25:23+00:00",
      "author": "DavidB",
      "content": "\u003e In my case, I have the swap file on the 2nd internal HDD, dismounting that would not be a good idea!\n\nRight ![:D](http://reboot.pro/public/style_emoticons/default/biggrin.png), but perhaps some other users will not have the swap file there and they will want to add it to the VM entry.  \nVMS already eliminates the system drive from the list but how can you verify that, for some reason, it\u0027s dangerous to dismount other internal drives..?  \nYou can\u0027t; but that\u0027s no reason not to let the user choose. After all, he should know that he added a swap file on that drive.  \nWorst case scenario: the user doesn\u0027t know there is a swap file there, adds the drive to the VM entry, it is dismounted, the OS locks or reboots, the user (hopefully will not blame my application ![:D](http://reboot.pro/public/style_emoticons/default/biggrin.png) and) learns that it\u0027s dangerous to use that drive. ![:rolleyes:](http://reboot.pro/public/style_emoticons/default/rolleyes.gif)   \nBut this will not happen so often...\n\n\u003e To what problem are you referring in grub4dos exactly?\n\nThe one from 137 GB detection, when it\u0027s tested in VirtualBox (we concluded that it was from that \"bioscylinders\u003d1024\")...  \nBut I could be wrong...\n\n"
    },
    {
      "id": "173854",
      "timestamp": "2013-06-20T09:48:39+00:00",
      "author": "steve6375",
      "content": "I have no issues accessing at least up to 900GB on my 2TB USB drive with either QEMU or VBox?\n\nP.S. The VM in VBOX that I use has one USB.vmdk+2 vritual HDDs. When I changed over the USB drive from a flash drive to my 2TB USB HDD and re-ran the same VM using your VMStarter app, it complained about the drive being the wrong ID so I cancelled it. This seems to have removed all the attached storage from the VM and when I tried to add the USB.vmdk back in VBox manager did not like it and I had to re-create and re-attach a new vmdk.\n\nI didn\u0027t quite understand why you need to check IDs, etc. I just create a USB.vmdk for my largest USb drive (2TB) and then I can use any device up to 2TB as my USB device as long as it is physical device 2. Why can\u0027t your app just determine what the physical device number is and the size of the device and then change the vmdk paramters accordingly?\n\n"
    },
    {
      "id": "173856",
      "timestamp": "2013-06-20T10:48:37+00:00",
      "author": "DavidB",
      "content": "\u003e I have no issues accessing at least up to 900GB on my 2TB USB drive with either QEMU or VBox?\n\nOk, if there no issue then it\u0027s fine ![:D](http://reboot.pro/public/style_emoticons/default/biggrin.png)\n\u003e P.S. The VM in VBOX that I use has one USB.vmdk+2 vritual HDDs. When I changed over the USB drive from a flash drive to my 2TB USB HDD and re-ran the same VM using your VMStarter app, it complained about the drive being the wrong ID so I cancelled it. This seems to have removed all the attached storage from the VM and when I tried to add the USB.vmdk back in VBox manager did not like it and I had to re-create and re-attach a new vmdk.\n\u003e\n\u003e I didn\u0027t quite understand why you need to check IDs, etc. I just create a USB.vmdk for my largest USb drive (2TB) and then I can use any device up to 2TB as my USB device as long as it is physical device 2. Why can\u0027t your app just determine what the physical device number is and the size of the device and then change the vmdk paramters accordingly?\n\nWhy do I need to check the drive IDs: because, like I said a few days ago, there can be other drives added/removed that will change its drive number. The capacity is not so good to differentiate one drive from another, ID is.  \nBut you don\u0027t need to change the USB drive ID every time you want to boot with another USB drive. Just simply create another VM entry and set it for the other USB drive.  \n\nFor example I have 2 drives. My VM entries look like this:  \n\nVirtualBox test with flash  \nVirtualBox Test with HDD  \nQemu test with flash  \nQemu test with HDD  \n\nFor the 2 VB ones I used the same VM.  \nThis way all I have to do is select and click on Start... ![:D](http://reboot.pro/public/style_emoticons/default/biggrin.png)  \nBut don\u0027t use the Beta 1 version for this, wait Beta 2.  \n\nIn a previous post I said that the problem is already somehow solved (in Beta 2), but, to be 100% solved I need to know why VMS couldn\u0027t use your usb.vmdk file. So I need this file and perhaps the vbox file as well.  \nIf you can\u0027t send them to me all I can implement is the automatic remove of the usb.vmdk. After that it will create another vmdk in an known format and modify it every time you start another VM entry (with different USB drive).\n\n"
    },
    {
      "id": "173859",
      "timestamp": "2013-06-20T11:32:03+00:00",
      "author": "steve6375",
      "content": "I still don\u0027t understand about this drive number ID thing?\n\nI have about 20+ different USB drives and I use them all with the same VM - I certainly don\u0027t want to create a VM for each of them! Especially as I have the same virtual HDDs attached to all of them.\n\nI don\u0027t use a different vmdk for all of my USB drives. I just use one vmdk and one VM.\n\nThe only thing is that I have to make sure that when I connect a USB drive, it is connected as PhysicalDevice2 (as 0 and 1 and my internal HDDs). My vmdk is called USBPort2.vmdk and was made using the 2TB USB drive. I can plug **any**USB drive into my system and any of them will work with the same .vbox VM which has the USBPort2.vmdk storage attached.\n\nSo the only thing needed is to select the Physical Device number in the existing vmdk\n\nThis line in the vmdk seems to describe the size in sectors and drive number\n\n```\n# Extent description\nRW 3906963456 FLAT \"\\\\.\\PhysicalDrive2\" 0\n```\n\nSo I would just want to select a VM and select a USB drive (or two).\n\nVM 18687c05-e790-4f1c-846b-dfcf686da801\n\nDrive H: Lexar Jumpdrive\n\nYour app would then look at the .vbox file, find the attached devices section, find the one which refers to the vmdk(s), change the vmdk to point to the correct PhysicalDevice number for the selected device (and poss. change size entry) and then run the VM.\n\nSo to launch from your app, I would select a VM and select a drive and click Start.\n\nI am afraid I cannot send you the vmdk and vbox that I had the problems with as these have had to be deleted and re-created and I had to delete the snapshot and VBox Manager seems to object to me creating a snapshot now!\n\n"
    },
    {
      "id": "173861",
      "timestamp": "2013-06-20T11:56:16+00:00",
      "author": "DavidB",
      "content": "It seems that you don\u0027t understand that the problem was created by that usb.vmdk (with an unkown format) and not by the \"ID check\"...\n\nThe Beta 1 version ALREADY knows how to modify the vmdk file (like I said a few hours ago), it didn\u0027t know how to modify that usb.vmdk because it had that unusual format.\n\nTHAT WAS THE PROBLEM.\n\nAND I haven\u0027t said to create 20 VM\u0027s in VirtualBox, I said to create multiple VM entries in my application and use only one VM from VirtualBox! Which is (very) different.\n\n"
    },
    {
      "id": "173862",
      "timestamp": "2013-06-20T11:58:51+00:00",
      "author": "DavidB",
      "content": "1.0 Beta 2 version:  \n\nChanges:  \n\nBugFix: name of the VM entry was loaded from the configuration file only if it was minimun 2 chars long. Now it can be 1 as well.  \nImprovement/BugFix: it detaches and tries to remove the vmdk files which can\u0027t be read and/or write (before adding another).  \nImprovement: in Add/Edit window, the user can directly see and choose from drives+volume(s) list. The drive ID was removed from interface because usually there is no need to be manually inputed/edited but it was kept internally and in the configuration file.\n\n"
    },
    {
      "id": "173863",
      "timestamp": "2013-06-20T12:15:11+00:00",
      "author": "DavidB",
      "content": "ALL you have to do know is to plugin a USB drive, create a VM entry in my program for it, unplug it, plug in other USB drive, create a VM entry for it in my program using the same VM from VirtualBox (or a different one if you want, but it is not necessary) and so on.  \nThis way, you could have those USB drives in ANY COMBINATION on your computer, VMS will know to boot from the one that you want.  \nFor example, on my computer, if I plug in the flash first and the HDD second, or the HDD first and the flash second, it will still now how to start each one when I start \"VirtualBox test with flash\" and \"VirtualBox test with HDD\".\n\n"
    },
    {
      "id": "173864",
      "timestamp": "2013-06-20T12:27:07+00:00",
      "author": "steve6375",
      "content": "\u003e ALL you have to do know is to plugin a USB drive, create a VM entry in my program for it, unplug it, plug in other USB drive, create a VM entry for it in my program using the same VM from VirtualBox (or a different one if you want, but it is not necessary) and so on.  \n\u003e This way, you could have those USB drives in ANY COMBINATION on your computer, VMS will know to boot from the one that you want.  \n\u003e For example, on my computer, if I plug in the flash first and the HDD second, or the HDD first and the flash second, it will still now how to start each one when I start \"VirtualBox test with flash\" and \"VirtualBox test with HDD\".\n\nSo if I plug in another different flash drive, I have to create another entry in your app? If I have 20 USB drives (which I do) then I need to create 20 entries? I often switch between USB drives and install and test colleagues USB drives too.\n\nI would rather have an interface that is just:\n\nEmulator \u003d QEMU/VBox\n\nVM \u003d testVM\n\nAttach Boot USB 1 \u003d Physical Drive 2 H: Lexar Jumpdrive 32GB\n\nAttach Boot USB 2 \u003d Physical Drive 3 J: WD Passport 2TB\n\nI then pick a VM, pick a USB drive (or 2) and click Start. There can be a \u0027Settings\u0027 tab to set exe paths, wait time, window size and CPU priority.\n\n"
    },
    {
      "id": "173865",
      "timestamp": "2013-06-20T12:44:49+00:00",
      "author": "steve6375",
      "content": "I made the vmdk using the attached cmd script.\n\n#### Attached Files {#attach_wrap}\n\n* [![Attached File](http://reboot.pro/public/style_extra/mime_types/zip.gif)](http://reboot.pro/index.php?s\u003d8f30301fa4921a2f4dadf062433bb156\u0026app\u003dcore\u0026module\u003dattach\u0026section\u003dattach\u0026attach_id\u003d14348 \"Download attachment\") [**makeUSBvmdk.zip**](http://reboot.pro/index.php?s\u003d8f30301fa4921a2f4dadf062433bb156\u0026app\u003dcore\u0026module\u003dattach\u0026section\u003dattach\u0026attach_id\u003d14348 \"Download attachment\") **773bytes** 475 downloads\n\n"
    },
    {
      "id": "173866",
      "timestamp": "2013-06-20T13:00:26+00:00",
      "author": "DavidB",
      "content": "\u003e So if I plug in another different flash drive, I have to create another entry in your app? If I have 20 USB drives (which I do) then I need to create 20 entries? I often switch between USB drives and install and test colleagues USB drives too.\n\nI understand.  \nBut the good thing is you have to create that VM entry in VMS only ONCE for that USB drive. And it\u0027s VERY EASY to create or modify, you just have to get use to it a little.  \nIf you plug in that drive any time later it can be booted in VB by scrolling to that VM entry (if you used a suggestive name) in VMS and click on start.  \n\nYour case it\u0027s a special case. Not everyone has/uses so many USB drives. As you probably already know a programmer has to design his program to be useful for the majority of the users. Unfortunately this way he will lose the \"special cases\" ![:(](http://reboot.pro/public/style_emoticons/default/sad.png)  \nI will think on a way to make you happy too ![:D](http://reboot.pro/public/style_emoticons/default/biggrin.png) but you realize that it\u0027s not so easy for me.  \n\u003e I would rather have an interface that is just:\n\u003e\n\u003e Emulator \u003d QEMU/VBox\n\u003e\n\u003e VM \u003d testVM\n\u003e\n\u003e Attach Boot USB 1 \u003d Physical Drive 2 H: Lexar Jumpdrive 32GB\n\u003e\n\u003e Attach Boot USB 2 \u003d Physical Drive 3 J: WD Passport 2TB\n\u003e\n\u003e I then pick a VM, pick a USB drive (or 2) and click Start. There can be a \u0027Settings\u0027 tab to set exe paths, wait time, window size and CPU priority.\n\nThis way you will still have to change the USB drive in settings each time you use a new USB drive (or 2). But, if you\u0027re ok with this, what\u0027s stopping you to create a single \"universal\" VM entry in VMS and editing only the drive(s) (each time you use another Usb drive)? It\u0027s not much to modify and you can get use to it fast...\n\n"
    },
    {
      "id": "173867",
      "timestamp": "2013-06-20T13:26:51+00:00",
      "author": "steve6375",
      "content": "I actually use your original non-GUI VMBox app all the time. I just have to make sure that PhysicalDevice 2 is the USB I want to boot to. Sometimes this means manually dismounting and unplugging any USB drives already connected and then plugging in the USB drive I want to boot to so it is Device 2.\n\nMaybe I will write an app or cmd script which will just allow me to select any USB drive connected to my system and change the PhysicalDevice entry in the vmdk file before calling your app...\n\n"
    },
    {
      "id": "173872",
      "timestamp": "2013-06-20T15:15:18+00:00",
      "author": "DavidB",
      "content": "I\u0027m glad that the non-GUI version helps you but still you have to work to place them in the right order...  \n\nWhat do you think of this, is it a little better? Look in Add/Edit \\\u003e 1st/2nd Drive...\n\nLE: link removed, you can find a better version in the next posts.\n\n"
    },
    {
      "id": "173880",
      "timestamp": "2013-06-20T18:21:31+00:00",
      "author": "steve6375",
      "content": "Thanks for the change, it is now much more useful, however I am sorry but there is a problem with it.\n\n1. Make new VM with 1 virtual HDD\n2. Use new VMStart to add one USB flash drive and **Start**- Storage order is USB, then HDD and boots from USB drive - OK.\n3. Now Quit and edit the VMStart config and change the **First drive to add** to a different USB drive and **Start**- now order is Virtual HDD and then USB vmdk and it boots from the virtual HDD.\n\n\u003cbr /\u003e\n\n"
    },
    {
      "id": "173888",
      "timestamp": "2013-06-21T05:48:40+00:00",
      "author": "DavidB",
      "content": "You don\u0027t have to be sorry. Thank you for helping in making VMS better.  \n\nStrange, on my computer doesn\u0027t do that...  \nPerhaps it\u0027s from the OS difference, who knows...  \nCould you please send me the vbox file (from all 3 steps) and the vmdk (last 2 steps)? Thank you.  \n\nNow I\u0027m working on adding the Vendor and the Product ID of the drive...\n\n"
    },
    {
      "id": "173889",
      "timestamp": "2013-06-21T06:05:18+00:00",
      "author": "DavidB",
      "content": "1.0 Beta 3 version  \n\nChanges:  \n\nImprovement: In Add/Edit entry \\\u003e\\\u003e First/Second drive it shows Vendor ID, Product ID, Size, Volume(s).\n\n[![Attached File](http://reboot.pro/public/style_extra/mime_types/zip.gif)](http://reboot.pro/index.php?s\u003d8f30301fa4921a2f4dadf062433bb156\u0026app\u003dcore\u0026module\u003dattach\u0026section\u003dattach\u0026attach_id\u003d14351 \"Download attachment\") [**Virtual machine starter Gui.zip**](http://reboot.pro/index.php?s\u003d8f30301fa4921a2f4dadf062433bb156\u0026app\u003dcore\u0026module\u003dattach\u0026section\u003dattach\u0026attach_id\u003d14351 \"Download attachment\") **410.75KB** 493 downloads\n\n"
    },
    {
      "id": "173899",
      "timestamp": "2013-06-21T15:06:12+00:00",
      "author": "DavidB",
      "content": "Ok then, let me ask you a question: when you created the VM, have you set the virtual HDD from the VM to the next \"position\" (Primary slave / Secondary master / Secondary slave on IDE or SATA \\\u003e 0)?  \nThe idea is to keep a \"place\" for the drive added by VMS, because it will boot from the first HDD in that list.  \n\nWhy haven\u0027t I asked until now? Because you said \"2. ...Storage order is USB, then HDD...\". This would of been impossible with no \"place\" before the virtual HDD.\n\n"
    },
    {
      "id": "173904",
      "timestamp": "2013-06-21T18:54:22+00:00",
      "author": "steve6375",
      "content": "Hi David,\n\nEven if I set up\n\nPrimary IDE Master \u003d (empty)\n\nPrimary IDE Slave\u003d vhdd\n\nthen after using Edit in VMS to change USB drives a few times, it all starts to go wrong and boots from the vhdd after 3 or 4 swaps.\n\nIf I use\n\nSATA \u003d vhdd\n\nThen VMS works fine.\n\n"
    },
    {
      "id": "173905",
      "timestamp": "2013-06-21T19:05:16+00:00",
      "author": "DavidB",
      "content": "Ok, thanks, I\u0027ll check what\u0027s wrong with the code for IDE...\n\n"
    },
    {
      "id": "173907",
      "timestamp": "2013-06-21T20:38:20+00:00",
      "author": "DavidB",
      "content": "Here is a debug version. If it can\u0027t access a vmdk file, it will stop and display a message so you can make a backup copy in another location and send it to me.\n\nLE: link removed, better version in the next posts.\n\n"
    },
    {
      "id": "173913",
      "timestamp": "2013-06-22T03:34:18+00:00",
      "author": "DavidB",
      "content": "Well, I installed Windows 7 x64.  \nFirst, VMS starts fine the VirtualBox VM right after Windows loads. No need to start VirtualBox.exe first.  \nSecond, in both OS\u0027s I keep trying to make VMS fail but without \"luck\" (so far)... But I will try more ![:D](http://reboot.pro/public/style_emoticons/default/biggrin.png)\n\nLE: I\u0027m working on a new way to read from the vbox file, hopefully it will solve (at least some of) the problems...\n\n"
    },
    {
      "id": "173945",
      "timestamp": "2013-06-23T08:31:10+00:00",
      "author": "DavidB",
      "content": "1.0 Beta 4 version:  \n\nChanges:  \n\nBugFix + Improvement: the code for accessing the VirtualBox files (Virtualbox.xml and the \\*.vbox) has been completely re   \n"
    },
    {
      "id": "173952",
      "timestamp": "2013-06-23T13:29:18+00:00",
      "author": "DavidB",
      "content": "Oh, a warning: don\u0027t use VMS while VirtualBox Manager is open because VirtualBox Manager doesn\u0027t \"like\" VMs settings been modified by other program (other than \"vboxmanage.exe\").\n\nBoth programs (VMS and VBM) modifies the same configuration files so a \"clash\" is normal...\n\nJust now I\u0027m implementing this warning in VMS...\n\n"
    },
    {
      "id": "173953",
      "timestamp": "2013-06-23T14:22:18+00:00",
      "author": "DavidB",
      "content": "Sorry for the nth-posting ![:D](http://reboot.pro/public/style_emoticons/default/biggrin.png)  \n\nAnd, Steve, I think this might be the source of the problems that you mentioned...  \nWhen you start a VM from VirtualBox as well, it\u0027s the same thing when you start the VBM. Plus, in both cases, it takes some time to close 100% after the window is closed, especially on a slow computer (like a laptop using a not so fresh Windows 7 x64).  \nAnd if you change the settings and restart the VM fast, it might \"clash\" with VMS.  \nWhy it doesn\u0027t happen on my computer also? Because I have a very fast computer with a fast OS so I have to be very fast (typing and clicking) as well but I usually can\u0027t (some medical problems).  \n\nI will search for a way to detect that VirtualBox is not completely closed. Until then you could try not to start a VM so fast after you closed VirtualBox Manager or a VirtualBox VM.\n\n"
    },
    {
      "id": "173954",
      "timestamp": "2013-06-23T15:28:53+00:00",
      "author": "steve6375",
      "content": "I was leaving VMManager open all the time. I was also leaving my USB vmdk as Primary Master as I thought VMS would just replace this.\n\nIf I set up a new VM as\n\nIDE Primary Master \u003d MyUSB2.vmdk\n\nIDE Primary Slave \u003d HDD VHD\n\nSATA Port 0 \u003d (unused)\n\nthen this causes problem with VMS (it just adds a Secondary Master vmdk) but still boots from my original vmdk (for USB port 2).\n\nIf I set up a new VM as\n\nIDE Primary Master \u003d (not used)  \nIDE Primary Slave \u003d HDD VHD\n\nSATA Port 0 \u003d (unused)\n\nthen all is OK.\n\nAlso all is OK if I set up a VM as\n\nIDE Primary Master \u003d (not used)\n\nIDE Primary Slave \u003d (not used)\n\nSATA Port 0 \u003d HDD VHD\n\n"
    },
    {
      "id": "173957",
      "timestamp": "2013-06-23T15:59:36+00:00",
      "author": "DavidB",
      "content": "\u003e I was leaving VMManager open all the time.\n\nI implemented the warning in VMS. It waits about 10 secondes after VB closes.  \nOh and I noticed that VBoxSVC.exe is closed a few secondes later after VirtualBox.exe is closed so this could be the cause. If yes, a simple cycle waiting for this exe to close will solve the problem for all the computers.\n\n\u003e I was also leaving my USB vmdk as Primary Master as I thought VMS would just replace this.\n\u003e\n\u003e If I set up a new VM as\n\u003e\n\u003e IDE Primary Master \u003d MyUSB2.vmdk\n\u003e\n\u003e IDE Primary Slave \u003d HDD VHD\n\u003e\n\u003e SATA Port 0 \u003d (unused)\n\u003e\n\u003e then this causes problem with VMS (it just adds a Secondary Master vmdk) but still boots from my original vmdk (for USB port 2).\n\nOk. If it does the same after at least 10..20 sec VB was closed, then it could be a different problem.  \nIt should at least detach your usb vmdk but it doesn\u0027t. A question: where is this file located, near the VBox or elsewhere (and where)?  \nDo you have UAC enabled? If yes, which setting...?  \nI\u0027m asking you again: could you please send me your vmdk file, its location, the Virtualbox.xml file + the vbox file in all 3 stages + the VM entry settings in VMS..?  \nThis will help me to reproduce the problem in my Windows 7 x64.  \n\nThank you.\n\n"
    },
    {
      "id": "173960",
      "timestamp": "2013-06-23T16:20:54+00:00",
      "author": "Blackcrack",
      "content": "4.2.14 , you know ? it\u0027s your buxfix on it ?\n\nbest regards\n\nBlacky\n\n"
    },
    {
      "id": "173965",
      "timestamp": "2013-06-23T16:52:33+00:00",
      "author": "DavidB",
      "content": "Thank you, Blackcrack.  \n\nUnfortunately, the \"10 sec delay at restart\" bug is not fixed. I reported a few other bugs in the bugtracker, they aren\u0027t fixed as well.  \nAnd regarding the bug reported by Steve, I don\u0027t think it\u0027s from VirtualBox but I guess it\u0027s wise to check... But only Steve can confirm since I can\u0027t reproduce it on my computer...\n\n"
    },
    {
      "id": "173979",
      "timestamp": "2013-06-23T23:02:10+00:00",
      "author": "DavidB",
      "content": "1.0 Beta 5 version (a long way \u0027till Beta 100 ![:D](http://reboot.pro/public/style_emoticons/default/biggrin.png) ):  \n\nChanges:  \n\nImprovement: error messages are a little better.  \nBugFix (partial from VB): warns the user that VirtualBox (manager or machine) is running and asks to be closed. After it\u0027s closed waits 10 sec to be absolutely sure that all is closed. On my computer 1..8 sec no effect, 9+ works. On slower computers perhaps more is needed. But how to find out WHEN it\u0027s really closed, that\u0027s the million dollars/euros question... ![:dubbio:](http://reboot.pro/public/style_emoticons/default/dubbio.gif)   \nBtw this will help also with another VB bug: if it\u0027s restarted fast (under 10 sec), it starts very slow (min) and finally shows an error message about some COMs...\n\nLE: link removed, you can find better version in the next posts...\n\n"
    },
    {
      "id": "173994",
      "timestamp": "2013-06-24T16:08:47+00:00",
      "author": "DavidB",
      "content": "I found a way to detect when VirtualBox closes completely. I already implemented in the code and it will be in the next Beta.  \n\nAn idea: how about a lock setting? It will lock the drive before dismount and it will unlock it after mount.  \nBy default it will be unchecked.  \nPros:  \n1. This way you can be sure that aren\u0027t open handles that are dangerous to terminate (like that swap file);  \n2. Any attempt to access those dismounted volumes in the host OS will fail (except with VMS), which is good.  \nCons:  \n1. It will refuse to lock the drive even for harmless open handles, which is annoying especially when you close and restart the VM very often.  \n2. It will add a significant delay between flushing the system data and the dismount (a few sec, sometimes even more...).  \n\nWhat do you think about that...?\n\n"
    },
    {
      "id": "173999",
      "timestamp": "2013-06-24T19:21:27+00:00",
      "author": "steve6375",
      "content": "Personally I prefer no locking for the sake of speed. People who play with VMs should know what they are doing....\n\n"
    },
    {
      "id": "174005",
      "timestamp": "2013-06-25T05:11:14+00:00",
      "author": "DavidB",
      "content": "1.0 Beta 6 version\n\nChanges:\n\nImprovement: the detection of VirtualBox sessions (manager and/or VM) is now faster and more accurate.  \nImprovement: found a way to get the exact moment Virtualbox session finishes closing. This way the user will wait only the minimun required amount of time before VMS could safely modify the VB configuration files and start the VirtualBox VM.\n\nLE: link removed , better version in the next posts.\n\n"
    },
    {
      "id": "174019",
      "timestamp": "2013-06-25T13:39:27+00:00",
      "author": "DavidB",
      "content": "I can\u0027t think of anything more to improve/fix so this could be the final version...  \nWell, until Steve will provide some day detailed informations about the error that he mentioned, so I can reproduce it on my computer also and fix it (if it\u0027s a bug in VMS, of course)...\n\n"
    },
    {
      "id": "174024",
      "timestamp": "2013-06-25T19:57:51+00:00",
      "author": "steve6375",
      "content": "Using VM Manager - Create TESTVMS VM with SATA controller and 20GB VHDD (XP)  \nClose VM Manager  \nConnect 2 USB Flash drives (+ have internal SSD)  \nRun VMS and make new entry - select 8GB USB drive as USB 1  \nClick Start in VMS - get \u0027Could not automatically add the drive to the VM\u0027 error  \nStart Oracle VManager - select TESTVMS - has only SATA VHDD attached.  \nAdd IDE controller to VM and close VM  \nRun VMS - same error  \nStart VM Manager and add in existing self-made USB2.vmdk from C:\\\\Users\\\\Administrator\\\\.VirtualBox\\\\Machines\\\\USB2 Boot  \nClose VM Manager and start VMS - same error!\n\n\u003cbr /\u003e\n\nIs new BETA 6 broken??\n\n"
    },
    {
      "id": "174028",
      "timestamp": "2013-06-26T02:57:35+00:00",
      "author": "DavidB",
      "content": "![:D](http://reboot.pro/public/style_emoticons/default/biggrin.png)  \n\nBeta 6 doesn\u0027t add the drives to the VM differently from Beta 5. The only difference between them is the code that checks VirtualBox is 100% closed (5 has 10 sec delay, 6 checks if VBoxSVC.exe is closed).  \nI guess you won\u0027t be surprised if I say that I followed your instructions to the letter but failed again to make VMS... fail.  \n\nLooks like on your computer VirtualBox closes a little differently...  \n\nFrom the VMS message you forgot to mention the most important part: what is says after \"Possible reason:\". BTW, the main gold for adding these messages was to help debug these kind of errors...  \n\nOther thing you can do to help: install Total Commander, install the [task manager plugin](http://ghisler.fileburst.com/fsplugins/procfs.zip \"External link\"), Start VirtualBox, start Total Commander, go to Network Neighborhood, enter its Task manager, search vboxsvc.exe and double click on it and post a screenshot with what shows. If you need to refresh the tasks list, you can do this with F2.  \nAlso you can estimate after how many sec VBoxSVC.exe disappears from the Windows Task manager after VirtualBox is closed.  \n\nThank you.\n\n"
    },
    {
      "id": "174047",
      "timestamp": "2013-06-26T10:37:06+00:00",
      "author": "DavidB",
      "content": "After you solve with my previous post, you could try this debug version: (LE) link removed  \nHow to use it: start VBM (just the main interface), start VMS, click on Start; it will ask if it should close the VBM; click on OK and wait; it will start the VM, close it. Now it will display a message: write the message here, please.  \nThis version adds another 3 sec delay after VBoxSVCis closed. I\u0027m curious if this will solve the problem.\n\n"
    },
    {
      "id": "174050",
      "timestamp": "2013-06-26T13:11:48+00:00",
      "author": "steve6375",
      "content": "When trying this new version on the new VM I created I get (with Vmanager closed)\n\nCould not automatically add the drive(s) to the VM in VirtualBox\n\nthen\n\nVirtualBx.exe closed in 0.000 sec\n\nVBoxSVC.exe closed in 0.000 sec\n\nThis is 100% repeatable if VManager is not running.\n\nOn another occasion after running VManager and the closing it, I got 0.407sec and 6.618 sec (same error messages).\n\nI can run an existing VM that I made in VMS earlier no problem. But the new VM that I made won;t run under VMS!\n\n"
    },
    {
      "id": "174060",
      "timestamp": "2013-06-26T14:12:40+00:00",
      "author": "DavidB",
      "content": "1. This is a debug version. It has to be started only like I described. Well, so far, you didn\u0027t.  \n2. One more time:  \n- could you please tell me what it\u0027s saying at \"possible reason:\";  \n- Other thing you can do to help: install Total Commander, install the task manager plugin, Start VirtualBox, start Total Commander, go to Network Neighborhood, enter its Task manager, search vboxsvc.exe and double click on it and post a screenshot with what shows. If you need to refresh the tasks list, you can do this with F2.  \n- you can send me the VB files in different stages like I asked a few times;  \n- you said on PM that you\u0027ll explain to me how you use those vmdks\u0027s on your computer so I can reproduce the problem, after 3 days I\u0027m still waiting.  \n\nSo far pretty much all you say it\u0027s \"VMS it\u0027s not working on my computer\". But when I\u0027m asking for your help to debug this - something different than just starting the exe - not really...  \nWell, that\u0027s 100% your choice and I have no right to judge your choice but the fact is, without your real help, I can\u0027t debug this problem...  \nI started developing this program only to help others; for me personally it\u0027s not that much useful. But if others, for various reasons, cannot help me to debug the problem(s) specific to their computers, there isn\u0027t much I can do to solve them...\n\n"
    },
    {
      "id": "174062",
      "timestamp": "2013-06-26T14:39:26+00:00",
      "author": "steve6375",
      "content": "I am not sure what you mean? I gave you the figures for starting it with VManager open\n\u003e On another occasion after running VManager and the closing it, I got 0.407sec and 6.618 sec (same error messages).\n\n~~Where should I be seeing this \u0027Possible reason\u0027 ??~~?\n\nOK sorry _ see it - it says \u0027unable to find a free port in the storage controller..\u0027\n\nThe Task Manager plug-in is 32-bit and I can\u0027t see a 64-bit one???\n\n"
    },
    {
      "id": "174063",
      "timestamp": "2013-06-26T14:59:46+00:00",
      "author": "DavidB",
      "content": "\u003e OK sorry _ see it - it says \u0027unable to find a free port in the storage controller..\u0027\n\nit says: \"unable to find a free port in the storage controller, please free one and try again.\"\n\nThat seem to be a problem with VirtualBox VM, not with VMS. It means that there isn\u0027t a free spot/place on the controller where VMS can attach the drive(s).\n\nThis also can happen, for example, if you set just a HDD on a SATA controller and the SATA controller has \"Port count\" also 1. Increase the port count \\\u003e 1.\n\nBut if you are convinced that it\u0027s VMS\u0027s problem then send me VB\u0027s files in different stages...\n\n\u003e The Task Manager plug-in is 32-bit and I can\u0027t see a 64-bit one???\n\nThe 32bit will work just fine on 64 bit.\n\n"
    },
    {
      "id": "174064",
      "timestamp": "2013-06-26T15:12:47+00:00",
      "author": "DavidB",
      "content": "Forget the debug version for now.\n\nSolve the storage controller problem in the VirtualBox VM and try again with Beta 6.\n\nIf it\u0027s still displaying an error message, just post it here (ALL OF IT)... That\u0027s why I implemented them...\n\n"
    },
    {
      "id": "174065",
      "timestamp": "2013-06-26T15:17:17+00:00",
      "author": "steve6375",
      "content": "32-bit TC plugin will not load - it says get the 64-bit version.\n\nI had my VHDD on SATA Port 0 - that was all I had in the VM and VMS refused to add in the 2nd VHD.\n\nI changed the VHDD to SATA Port 1 and now VMS works (it took SATA Port 0)!\n\nThis is weird because previously I has a test VM and that had VHDD on SATA port 0 and the VMS vmdk attached to the IDE controller with no problems (IDE - PIIX4 - use host I/O cache).\n\nWait - Now I see a Port Count field! It wasn\u0027t there before but it has suddenly appeared.\n\nI had an IDE controller in the VM and I was expecting VMS to add the vmdk into that...\n\n"
    },
    {
      "id": "174066",
      "timestamp": "2013-06-26T15:37:41+00:00",
      "author": "DavidB",
      "content": "The 32bit plugin works fine in my Windows 7 x64 (but I\u0027m using TC 32bit not 64bit!):\n\n[![Capture.png](http://reboot.pro/uploads/monthly_06_2013/post-61891-0-25318400-1372261462_thumb.png)](http://reboot.pro/uploads/monthly_06_2013/post-61891-0-25318400-1372261462.png \"Capture.png - Size: 103.24KB\"){#ipb-attach-url-14378-0-90882600-1676066418}   \n\nBut you don\u0027t have to try anymore because it seems the problem is not from VirtualBox closing...  \n\nThe SATA Controller has Port Count automatically set to the number of storage devices. You have to manually increase it to let VMS add more.  \nOn the other hand the IDE controller always has 4.  \n\nVMS doesn\u0027t add/remove controller, doesn\u0027t change its characteristics and so on. It just tries to add the drive(s) in the free ports in the FIRST controller it founds in the VM.  \n\nIn conclusion, are there any more problems with Beta 6 or it\u0027s all ok now...?\n\n"
    },
    {
      "id": "174068",
      "timestamp": "2013-06-26T15:51:57+00:00",
      "author": "steve6375",
      "content": "It works OK now, but I think you need to add a Help button to tell people what it does and how to set up a VM\n\ni.e.\n\nVM Starter\n\n\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\n\nVM Starter is a ....\n\nHow to set up your VM in VBox\n\n\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\n\nIDE controllers have 4 ports, for SATA controllers you can set the Port Count in the VM.\n\nUSB 1 and USB 2 will be added to the **first** available ports on the **first** diskcontroller it finds in the VM.\n\nTherefore ensure that you have a free port and that your Port Count is high enough to include your USB drives.\n\nIf you want the VM to boot from the USB drive, leave the first port on the first controller free for VMS to add the USB drive:\n\ne.g. leave Primary Master IDE port free if **first**controller is an IDE HDD,\n\nleave SATA Port 0 free if **first**controller is a SATA Controller.\n\nor maybe a ReadMe or PDF with pictures would help?\n\n"
    },
    {
      "id": "174070",
      "timestamp": "2013-06-26T16:17:04+00:00",
      "author": "DavidB",
      "content": "In a way you\u0027re right but: if people hate to read an error message and think about what it mean, who\u0027s gonna click and read a pdf/helpfile/readme...?  \nIn my experience I would say - very few...  \nBut I have an idea: how about saying \"free stuff if you read \u0027till end and think about what it mean\"? Like \"free pot\" or \"free drinks\" ![:D](http://reboot.pro/public/style_emoticons/default/biggrin.png)  \nJust kidding...\n\n"
    },
    {
      "id": "174072",
      "timestamp": "2013-06-26T18:59:19+00:00",
      "author": "DavidB",
      "content": "How about this message set to appear only the first time when the user is trying to set the drive in Add/Edit...?\n\n[![Clipboard01.png](http://reboot.pro/uploads/monthly_06_2013/post-61891-0-04267800-1372273131_thumb.png)](http://reboot.pro/uploads/monthly_06_2013/post-61891-0-04267800-1372273131.png \"Clipboard01.png - Size: 6.92KB\"){#ipb-attach-url-14379-0-90898300-1676066418}\n\n"
    },
    {
      "id": "174073",
      "timestamp": "2013-06-26T19:19:50+00:00",
      "author": "steve6375",
      "content": "How about adding a web address where the user can go to get the latest version and FAQ/help?\n\n"
    },
    {
      "id": "174074",
      "timestamp": "2013-06-26T19:43:12+00:00",
      "author": "DavidB",
      "content": "Again, I doubt that many will read it... For now I added this thread as a Start menu link in the installer version.  \nBut, in the future, if many will show interest for this application, I will reconsider about creating a readme/pdf/help/site.  \n\n1.0 version  \n\nInstaller: [![Attached File](http://reboot.pro/public/style_extra/mime_types/zip.gif)](http://reboot.pro/index.php?s\u003d05d45f9ebc26330806a241473d526107\u0026app\u003dcore\u0026module\u003dattach\u0026section\u003dattach\u0026attach_id\u003d14382 \"Download attachment\") [**Virtual machine starter setup.zip**](http://reboot.pro/index.php?s\u003d05d45f9ebc26330806a241473d526107\u0026app\u003dcore\u0026module\u003dattach\u0026section\u003dattach\u0026attach_id\u003d14382 \"Download attachment\") **826.96KB** 472 downloads  \n\nPortable: [![Attached File](http://reboot.pro/public/style_extra/mime_types/zip.gif)](http://reboot.pro/index.php?s\u003d05d45f9ebc26330806a241473d526107\u0026app\u003dcore\u0026module\u003dattach\u0026section\u003dattach\u0026attach_id\u003d14381 \"Download attachment\") [**Virtual machine starter portable.zip**](http://reboot.pro/index.php?s\u003d05d45f9ebc26330806a241473d526107\u0026app\u003dcore\u0026module\u003dattach\u0026section\u003dattach\u0026attach_id\u003d14381 \"Download attachment\") **449.58KB** 523 downloads  \n\nSources: [![Attached File](http://reboot.pro/public/style_extra/mime_types/zip.gif)](http://reboot.pro/index.php?s\u003d05d45f9ebc26330806a241473d526107\u0026app\u003dcore\u0026module\u003dattach\u0026section\u003dattach\u0026attach_id\u003d14380 \"Download attachment\") [**Sources.zip**](http://reboot.pro/index.php?s\u003d05d45f9ebc26330806a241473d526107\u0026app\u003dcore\u0026module\u003dattach\u0026section\u003dattach\u0026attach_id\u003d14380 \"Download attachment\") **181.78KB** 414 downloads\n\n"
    },
    {
      "id": "174092",
      "timestamp": "2013-06-27T05:14:06+00:00",
      "author": "Blackcrack",
      "content": "well done !! :smile:\n\nTank you !!\n\nedit: installing at moment XP on my\u0027 Ma\u0027s USB Stick (She\u0027s 75? how ever, crewl Computer Granny !!)\n\nmake for her an Real - XP - USB now :smile:)) funny.. -- it work\u0027s !!--\n\nhey, idea, it is possible to integrate this coe in the Virtualbox for selecting the usb-stick as Medium ?\n\nIf yes, why do you not include you ad Developer short and include this codepart for it .. :smile:\n\nLike Stephan told me, any can be Virtualbox developer and can submitting or include code..\n\nso, why not this :smile:\n\nagain, Tank you very mutch for this peace of gold :smile:\n\nFrom now on can any installing an System on USB !!\n\nGrate !! Thank you very mutch again !!\n\nbest regards\n\nBlacky\n\n**Edited by Blackcrack, 27 June 2013 - 05:54 AM.**\n"
    },
    {
      "id": "174095",
      "timestamp": "2013-06-27T05:52:01+00:00",
      "author": "DavidB",
      "content": "\u003e well done !! :smile:\n\u003e\n\u003e Tank you !!\n\u003e\n\u003e best regards\n\u003e\n\u003e Blacky\n\nThank you.\n\nYou\u0027re welcome :smile:\n\nBtw, if anyone wants to modify the source code or use parts of it in another program, feel free to do so...\n\n"
    },
    {
      "id": "174123",
      "timestamp": "2013-06-27T15:12:25+00:00",
      "author": "DavidB",
      "content": "\u003e hey, idea, it is possible to integrate this coe in the Virtualbox for selecting the usb-stick as Medium ?\n\u003e\n\u003e If yes, why do you not include you ad Developer short and include this codepart for it .. :smile:\n\u003e\n\u003e Like Stephan told me, any can be Virtualbox developer and can submitting or include code..\n\u003e\n\u003e so, why not this :smile:\n\nI don\u0027t think that would be possible, because:  \n1. VirtualBox is made in C, VMS is made in Delphi (Pascal). Too different IDE\u0027s...  \n2. For VirtualBox developers it would of been very easy to implement the USB Boot or at least to automate the generation/adding/dismount/remount of rawdisk vmdks. But it seems they don\u0027t want that; more, it seems that this subject is kind of \"touchy\" for them because their answers are not so nice lately...\n\n"
    },
    {
      "id": "174129",
      "timestamp": "2013-06-27T19:18:07+00:00",
      "author": "DavidB",
      "content": "Being so busy lately with the GUI version I neglected to implement the bugfixes and improvements in the nonGUI versions as well.  \nHere is the Qemu version for Steve (to implement in the next RMPrepUSB version):  \n\n[![Attached File](http://reboot.pro/public/style_extra/mime_types/zip.gif)](http://reboot.pro/index.php?s\u003d05d45f9ebc26330806a241473d526107\u0026app\u003dcore\u0026module\u003dattach\u0026section\u003dattach\u0026attach_id\u003d14384 \"Download attachment\") [**start Qemu VM.zip**](http://reboot.pro/index.php?s\u003d05d45f9ebc26330806a241473d526107\u0026app\u003dcore\u0026module\u003dattach\u0026section\u003dattach\u0026attach_id\u003d14384 \"Download attachment\") **203.05KB** 409 downloads\n\n[![Attached File](http://reboot.pro/public/style_extra/mime_types/zip.gif)](http://reboot.pro/index.php?s\u003d05d45f9ebc26330806a241473d526107\u0026app\u003dcore\u0026module\u003dattach\u0026section\u003dattach\u0026attach_id\u003d14385 \"Download attachment\") [**Sources.zip**](http://reboot.pro/index.php?s\u003d05d45f9ebc26330806a241473d526107\u0026app\u003dcore\u0026module\u003dattach\u0026section\u003dattach\u0026attach_id\u003d14385 \"Download attachment\") **2.44KB** 378 downloads  \n\nBtw, you don\u0027t have to keep the name \"start_VM\". You can name it whatever you want, it will still work...\n\n"
    },
    {
      "id": "174144",
      "timestamp": "2013-06-28T09:55:55+00:00",
      "author": "DavidB",
      "content": "An idea: how about choosing where in the VirtualBox\u0027s storage controllers the first/second drive will be added?  \nIn VMS Add/Edit window for each drive I will add a combobox. When you click to change the value it will popup a list with \"automatically (first available port)\" + all available ports in all VM\u0027s storage controllers.\n\n\u003cbr /\u003e\n\nDoes someone find this useful..? I\u0027m asking because it will require a lot of work to implement and I need to know that it will be used (so it will worth implementing)...\n\n"
    },
    {
      "id": "174150",
      "timestamp": "2013-06-28T13:56:20+00:00",
      "author": "steve6375",
      "content": "Personally I only want one USB drive.\n\nUnless I can have two attached and have one of them seen as a \u0027removable\u0027 drive instead of a hard disk...\n\n"
    },
    {
      "id": "174151",
      "timestamp": "2013-06-28T14:25:28+00:00",
      "author": "DavidB",
      "content": "Me too, I use only one USB drive at a time, but the question was: do you need to control WHERE the drive will be added by VMS to the virtual machine? I mean port number on SATA or master/slave/primary/secondary on IDE...\n\n"
    },
    {
      "id": "174154",
      "timestamp": "2013-06-28T14:35:56+00:00",
      "author": "steve6375",
      "content": "The only choice I would like would be **USB as 1st device** or **HDD as first device.**\n\nThen the VM would either boot from the USB or the first HDD. I don\u0027t really care what ports they are on except I would want the 1st HDD to be Primary Master if it was an IDE drive.\n\nBut I guess this is kind of tricky for you and it is no problem to make a separate VM for \u0027boot from HDD\u0027.\n\n"
    },
    {
      "id": "174157",
      "timestamp": "2013-06-28T14:48:22+00:00",
      "author": "DavidB",
      "content": "On IDE you can do this by attaching the HDD as the primary slave and setting VMS to attach the drive on primary master or on secondary master.  \nOn SATA you can set port count to 3, attach the HDD to 1 and set VMS to attach the drive to 0 or 2.\n\n"
    },
    {
      "id": "174158",
      "timestamp": "2013-06-28T14:54:49+00:00",
      "author": "DavidB",
      "content": "Sorry, mistype on HDD on SATA, corrected...\n\n"
    },
    {
      "id": "174168",
      "timestamp": "2013-06-28T18:14:46+00:00",
      "author": "DavidB",
      "content": "Kind of too soon after just releasing 1.0 final, but, you know how it\u0027s happening - often good ideas come after not before ![:D](http://reboot.pro/public/style_emoticons/default/biggrin.png)  \n\n1.1 Beta 1 version\n\n\u003cbr /\u003e\n\nImprovements:  \n\n1. Before modifying the vbox file it will make a backup in \"\\*-prev\", just like VirtualBox Manager does.  \n2. When it has to detach a vmdk it will do it only with its own files (VMSDrive\\*\\*\\*.vmdk). Previous version detached any vmdk found in VM storage controllers, but this way could of delete a \"legitimate\" vmdk manually attached by the user.  \n3. It detects and solves the GUID \"clashes\" automatically when creating another vmdk. It was a small chance anyway that a \"clash\" will occur but still...  \n4. Now it tries to add the drive(s) in all the storage controllers not just the first.  \n5. Some small improvements to the error messages.\n\nLE: link removed, you can find a better version in the next posts...\n\n"
    },
    {
      "id": "174176",
      "timestamp": "2013-06-29T00:23:27+00:00",
      "author": "steve6375",
      "content": "Hi David\n\nI seems to be having lots of problems ever since I started to configure VMs with\n\nSATA controller (empty) 1 port\n\nSCSI controller + VHDD\n\nand\n\nSATA Controller - SCSI Port 0 \u003d VMSDrive000.vmdk SCSI Port 1 \u003d VHDD\n\nFirst I got \u0027Access denied to the VMSDrive000.vmdk, but it would run OK from the VBox Manager and non-SCSI VMs would run OK from VMS.\n\nNow I cannot run any VM from VM Starter as it says that VBox is still running. If I reboot then I get the same thing, first can\u0027t run the SCSI VMs and then can run any VM using VMS.\n\nHave you tried any SCSI VHDDs or is it just me? I never had a problem before I started using SCSI VMs but that may be just a coincidence...??\n\n"
    },
    {
      "id": "174178",
      "timestamp": "2013-06-29T02:29:56+00:00",
      "author": "DavidB",
      "content": "I tried before with SCSI, I tried again now, on my computer is fine.  \n\nWhich VMS version are you using?  \nWhich application showed \"Access denied\", VMS or VB?  \nWhen VMS says that VBox is still running, what is the exact message?  \n\nIt may be possible that, started from VMS, VB is crashing trying to run that machine with SCSI and a part of it still stays in memory making VMS believe that it\u0027s still running.  \nCould you please send me the vbox file, so I can have a look and maybe even test it?\n\n"
    },
    {
      "id": "174184",
      "timestamp": "2013-06-29T08:01:48+00:00",
      "author": "steve6375",
      "content": "I have tried last 3 versions of VMS. Currently 1.1 is in use. (Portable - I just copied to exe file to the Desktop.)\n\nFiles attached.\n\nIf I do a fresh boot and run the 1st or 2nd VM (USB2test or TESTVMS) using VMS then they run OK\n\nWhen I run BOOT USB VT ON from VMS is just seems to wait a while and then return back to the VMS Starter form.\n\nIf I run VBox Manager then the machine state is \u0027Aborted\u0027.\n\nNow anything I try to run from VMS gets a \u0027Out of time waiting for VBoxSVC.exe to close...\u0027 message.\n\nIf I kill the process in Task Manager, then TSTVMS it runs OK, if I run BOOT USB VT ON from VMS - same -thing - it just returns back to the VMS form with no error message and the status in VBox Manager is \u0027Aborted\u0027.\n\ncheers\n\nSteve\n\nP.S, If I try to run the aborted VM from VBox Manager I get this VBox error message:\n\nFailed to open a session for the virtual machine USB BOOT VT ON.\n\nNo error info.\n\nResult Code: RPC_S_SERVER_UNAVAILABLE 0x800706BA (0x800706BA)  \nComponent: ProgressProxy  \nInterface: IProgress {c20238e4-3221-4d3f-8891-81ce92d9f913}\n\nP.S. I seem to have fixed the VM now by removing the SATA controller and setting the VHDD to port 1 instead of port 0  \n\n#### Attached Files {#attach_wrap}\n\n* [![Attached File](http://reboot.pro/public/style_extra/mime_types/zip.gif)](http://reboot.pro/index.php?s\u003d05d45f9ebc26330806a241473d526107\u0026app\u003dcore\u0026module\u003dattach\u0026section\u003dattach\u0026attach_id\u003d14388 \"Download attachment\") [**vmslogs.zip**](http://reboot.pro/index.php?s\u003d05d45f9ebc26330806a241473d526107\u0026app\u003dcore\u0026module\u003dattach\u0026section\u003dattach\u0026attach_id\u003d14388 \"Download attachment\") **11.01KB** 389 downloads\n\n"
    },
    {
      "id": "174186",
      "timestamp": "2013-06-29T08:17:36+00:00",
      "author": "DavidB",
      "content": "Thank you.\n\nI will try to find what is the problem.\n\nIt\u0027s strange that VBM can\u0027t start it either, which tells me that could be something wrong in the vbox file...\n\nJust now I took quite a scare... Because of a Paragon Backup\\\u0026Recovery 2012 error, all my data from D volume (including the latest VMS sources) disappeared.\n\nI was able to recover it on my USB HDD but I can\u0027t be sure that it\u0027s 100% ok.\n\nNow I\u0027m copying the data back. It will take some time...\n\n"
    },
    {
      "id": "174187",
      "timestamp": "2013-06-29T08:45:02+00:00",
      "author": "DavidB",
      "content": "Just looking in the vbox file I see that in storage controllers section (end of the file) there are 3 drives attached but only the VMS vmdk is declared in the Harddisks section (the beginning of the file).  \n\nWhich application showed \"Access denied\" in the first place, VMS or VB?\n\n"
    },
    {
      "id": "174191",
      "timestamp": "2013-06-29T09:08:28+00:00",
      "author": "steve6375",
      "content": "VMS caused no error (either from VMS or VBox) - the VMS form disappears, there is a wait of 6-10 seconds and then the VMS form re-appears - no error mesage or anything.\n\nI was getting the \u0027access denied\u0027 error from VBox (poss. VMS crashed and left the file open?).\n\n"
    },
    {
      "id": "174196",
      "timestamp": "2013-06-29T09:39:05+00:00",
      "author": "DavidB",
      "content": "More probable VB crashed because only VB triggers the close of VBoxSVC.exe after VirtualBox.exe is closed. VMS never opens or closes VBoxSVC.exe, just checks if it\u0027s closed and warns the user.\n\nAnd, btw, it\u0027s not impossible to make VMS crash but it\u0027s very improbable because I implemented n-th safeguards which localize and deal with the problem...\n\nIt could of been a \"clash\" between VB and VMS over the vbox or, more probable, over the vmdk file. If in that moment the HDD was intensively used, it may have delayed their write and VB couldn\u0027t find valid files (or access them because VMS is setting exclusive share when it writes the vmdk file) when was loaded...\n\nI\u0027m thinking of implementing a way to only flush these files on disk (not the entire volume) - maybe this will fix the problem..\n\nIf it\u0027s happening again, just stop for the moment (don\u0027t start VMS and VB anymore) and send me both vbox and vbox-prev files (to compare them).\n\n"
    },
    {
      "id": "174197",
      "timestamp": "2013-06-29T11:30:48+00:00",
      "author": "DavidB",
      "content": "1.1 Beta 2 version\n\nLE: link removed, better version in the next posts...  \n\nChanges:  \n\nBugfix: in rare circumstances it could add the vmdk to the storage controller even if the PortCount value wouldn\u0027t allowed.  \nPreventive bugfix: the vbox and the vmdk files are flushed to disk before opening the VM.\n\n"
    },
    {
      "id": "174213",
      "timestamp": "2013-06-29T18:25:54+00:00",
      "author": "steve6375",
      "content": "Just tried you new version and did this\n\n1. I have a VM set up as\n\nIDE Primary Master \u003d (none)\n\nIDE Primary Slave \u003d VHDD\n\nThen added a new entry into VMS with a USB Port 1 stick defined ---\\\u003e\\\u003e VMS puts a vmdk at the IDE Secondary Master....and booted off the VHDD!!!\n\nIs the logic broken somewhere?\n\nThanks\n\nSteve\n\n"
    },
    {
      "id": "174217",
      "timestamp": "2013-06-30T02:24:15+00:00",
      "author": "DavidB",
      "content": "Well, I tried and it doesn\u0027t do this with my vbox\u0027s...  \nMost probably there are some unusual \"leftovers\" in the vbox file which make VMS \"think\" those ports are occupied.  \nCould you please send me that file so I can check this and eventually adapt VMS to these errors..?  \nThank you.\n\n"
    },
    {
      "id": "174219",
      "timestamp": "2013-06-30T06:32:49+00:00",
      "author": "DavidB",
      "content": "In the meantime I found and implemented a way to reduce the number of writes into the vbox file ![:D](http://reboot.pro/public/style_emoticons/default/biggrin.png)  \nTrying to do the same for the vmdk file...\n\n"
    },
    {
      "id": "174220",
      "timestamp": "2013-06-30T06:47:00+00:00",
      "author": "steve6375",
      "content": "Here are the Vbox and vbox-prev files.\n\nI had a working config by manually setting the VMSDrive000.vmdk created by VMS as IDE Primary Master and the VHDD was IDE Primary Slave. (that was the only way I could get it to boot from the USB stick)\n\nI then ran VMS and it booted from the VHDD.\n\nPREV\n\nIDE Pri Master \u003d VMSDrive000.vmdk C:\\\\Users\\\\Administrator\\\\.VirtualBox\\\\Machines\\\\USB2 Boot\\\\VMSDrive000.vmdk\n\nIDE Pri Slave \u003d VHDD\n\nNOW\n\nIDE Primary Master \u003d (empty)\n\nIDE Pri Slave \u003d VHDD\n\nIDE 2nd Master \u003d VMSDrive000.vmdk at C:\\\\Users\\\\Administrator\\\\.VirtualBox\\\\Machines\\\\USB2 Boot\\\\VMSDrive000.vmdk\n\nVMS seems to have removed the VMSDrive.vmdk, created a new one with a new ID and then added it to the 2ns Master slot?  \n\n#### Attached Files {#attach_wrap}\n\n* [![Attached File](http://reboot.pro/public/style_extra/mime_types/zip.gif)](http://reboot.pro/index.php?s\u003d05d45f9ebc26330806a241473d526107\u0026app\u003dcore\u0026module\u003dattach\u0026section\u003dattach\u0026attach_id\u003d14394 \"Download attachment\") [**USB2 Boot.zip**](http://reboot.pro/index.php?s\u003d05d45f9ebc26330806a241473d526107\u0026app\u003dcore\u0026module\u003dattach\u0026section\u003dattach\u0026attach_id\u003d14394 \"Download attachment\") **5.65KB** 399 downloads\n\n"
    },
    {
      "id": "174221",
      "timestamp": "2013-06-30T08:51:17+00:00",
      "author": "DavidB",
      "content": "Thank you.\n\nWell, usually it\u0027s not a good idea to assign/move/delete the VMSDrive\\*\\*\\*.vmdk file manually.  \nBut I adapted the code to work with that.  \n\n1.1 Beta 3 version  \n\nChanges:  \n\nImprovement: it will write in the vbox file only if it\u0027s absolutely necessary. This way it will decrease the chances of a \"clash\" between VB and VMS.  \nAnd the above improvement...\n\nLE: link removed, better version in the next posts...  \n\nWorking now to reduce the number of writes in vdmk files also...\n\n"
    },
    {
      "id": "174223",
      "timestamp": "2013-06-30T09:04:17+00:00",
      "author": "steve6375",
      "content": "The problem was that even if I had\n\nIDE Primary Master - (none)\n\nIDe Primary Slave \u003d VHDD\n\nVMS still put the USB vmdk in Secondary Master ! So I HAD to put the vmdk in manually.\n\nBoth problems now seem fixed with the new version ![:1st:](http://reboot.pro/public/style_emoticons/default/1st.gif)\n\n"
    },
    {
      "id": "174227",
      "timestamp": "2013-06-30T10:13:37+00:00",
      "author": "DavidB",
      "content": "1.1 Beta 4 version  \n\nChanges:  \n\nImprovement: it will write in the VMSDrive\\*\\*\\*.vmdk file only if it\u0027s absolutely necessary. This way it will decrease the chances of a \"clash\" between VB and VMS.\n\nLE: link removed, better version in the next posts...\n\n"
    },
    {
      "id": "174235",
      "timestamp": "2013-06-30T15:39:00+00:00",
      "author": "DavidB",
      "content": "1.1 Beta 5 version  \n\nChanges:  \n\nAn important improvement: Until now, after dismount + remount, you could see the changes in files/folders (normal/usual changes).  \nNow you can see also changes in volume size, number of volumes and so on.  \nFor example, if you divide a volume into 2 in the VM, now the change is visible also on the host OS after the VM is closed...\n\nLE: link removed, better version in the next posts...\n\n"
    },
    {
      "id": "174240",
      "timestamp": "2013-06-30T18:11:56+00:00",
      "author": "DavidB",
      "content": "Sorry for so many Betas in such short time ![:D](http://reboot.pro/public/style_emoticons/default/biggrin.png)  \n\nOne last improvement: In Add/Edit \\\u003e\\\u003e First/Second drive to add:  \n- card readers without card inserted are removed;  \n- added drives without mounted volumes (unpartitioned, unknown partition type for Windows and so on); they will not be dismounted/remounted but maybe someone will just want to easily add them to the VM (using the vmdk)...\n\nLE: link removed, you can find a better vesion in the next posts...\n\n"
    },
    {
      "id": "174241",
      "timestamp": "2013-06-30T18:19:21+00:00",
      "author": "Blackcrack",
      "content": "naa, no problem, this shows to you are manny work on it and\n\nbe we honest, i be happy about this many Actualisations :smile:\n\nand this let show how fun do you have on it :smile:\n\n![:cheerleader:](http://reboot.pro/public/style_emoticons/default/cheerleader.gif) ![:good:](http://reboot.pro/public/style_emoticons/default/good.gif) Cool ! ![:good:](http://reboot.pro/public/style_emoticons/default/good.gif) ![:cheerleader:](http://reboot.pro/public/style_emoticons/default/cheerleader.gif)\n\n\u003e Sorry for so many Betas in such short time ![:D](http://reboot.pro/public/style_emoticons/default/biggrin.png)\n\n"
    },
    {
      "id": "174266",
      "timestamp": "2013-07-01T19:33:22+00:00",
      "author": "DavidB",
      "content": "Just a preview about what I\u0027m working now ![:D](http://reboot.pro/public/style_emoticons/default/biggrin.png)\n\n[![Clipboard01.png](http://reboot.pro/uploads/monthly_07_2013/post-61891-0-02130400-1372707166_thumb.png)](http://reboot.pro/uploads/monthly_07_2013/post-61891-0-02130400-1372707166.png \"Clipboard01.png - Size: 12.04KB\"){#ipb-attach-url-14400-0-31905900-1676066419}\n\n"
    },
    {
      "id": "174271",
      "timestamp": "2013-07-02T08:58:26+00:00",
      "author": "Blackcrack",
      "content": "wow, looks cool, vorallem, that one since then now sees the USB stick, that\u0027s really well !\n\n![:bounce8:](http://reboot.pro/public/style_emoticons/default/bounce8.gif) \\\u003c- The running eight cylinder - / 16 Ventil\u0027s ! (V16) + 2 Programmers \u003d V18 ![:yahoo:](http://reboot.pro/public/style_emoticons/default/yahoo.gif)\n\n![:cheerleader:](http://reboot.pro/public/style_emoticons/default/cheerleader.gif) ![:cheerleader:](http://reboot.pro/public/style_emoticons/default/cheerleader.gif) ![:cheerleader:](http://reboot.pro/public/style_emoticons/default/cheerleader.gif)\n\nbest Regards\n\nBlacky\n\nonly if noone works on You Project or nothing in the Mailinglist or something nothing, at the latest then,\n\nthen you know that you were sent into the desert ! ![:alone:](http://reboot.pro/public/style_emoticons/default/alone.gif) \\*bG\\* (cool smily, therefor i have invented this sentence \\*lol\\*)\n\n"
    },
    {
      "id": "174273",
      "timestamp": "2013-07-02T09:39:18+00:00",
      "author": "DavidB",
      "content": "1.1 Beta 7 version\n\nLE: link removed, better version in the next posts...\n\n\u003cbr /\u003e\n\nChanges:  \n\nMajor improvement to the interface: now you can set to see only what you need (Number/Name/FirstDrive/SecondDrive/VMtype) in the main interface (right mouse click on the list header).  \nThis way you won\u0027t have to edit that entry to see some of the characteristics.  \nEach column size will be remembered in the next session. If you left click on the headers it will sort the entries into ascending order (by that column).  \nImprovement: the position of the main window will be remembered in percents not pixels. This way, if you close the application, change screen resolution and start again the application, it will show the main window in the same position on the screen.  \nBugfix: in the previous version it generated a new GUID only when it was really necessary. I found such a situation and adapted the code.  \nImprovement: application settings are stored in a cfg file instead the registry.  \n\nJust a small problem: the vml files from the previous versions need to be rebuilded so the application could display properly all the info.\n\n"
    },
    {
      "id": "174274",
      "timestamp": "2013-07-02T09:48:07+00:00",
      "author": "Blackcrack",
      "content": "oh a versions reverse Jump ?\n\n\\*bg\\*\n\nbest\n\nBlacky\n\n"
    },
    {
      "id": "174275",
      "timestamp": "2013-07-02T10:28:31+00:00",
      "author": "DavidB",
      "content": "\u003e oh a versions reverse Jump ?\n\u003e\n\u003e \\*bg\\*\n\u003e\n\u003e best\n\u003e\n\u003e Blacky\n\nDon\u0027t understand..\n\nJust copy the new version over the old one, start it and edit the setting of each VM entry (click on Edit and click on OK) so VMS can rebuild that file (\\*.vml).\n\nIt\u0027s simple...\n\n"
    },
    {
      "id": "174276",
      "timestamp": "2013-07-02T10:35:33+00:00",
      "author": "Blackcrack",
      "content": "hihi :smile:\n\nit\u0027s not 1.1 Beta 7 ?\n\n\u003e 1.**0** Beta 7 version\n\u003e\n\u003e ![attachicon.gif](http://reboot.pro/public/style_images/metro/attachicon.gif)[Virtual machine starter GUI exe.zip](http://reboot.pro/index.php?app\u003dcore\u0026module\u003dattach\u0026section\u003dattach\u0026attach_rel_module\u003dpost\u0026attach_id\u003d14401 \"\")  \n\u003e\n\u003e Changes:  \n\u003e\n\u003e Major improvement to the interface: now you can set to see only what you need (Number/Name/FirstDrive/SecondDrive/VMtype) in the main interface (right mouse click on the list header).\\~\\~\\~\\~\\~\\~\\~\\~\\~\\~\\~\\~\\~\n\n"
    },
    {
      "id": "174277",
      "timestamp": "2013-07-02T10:44:46+00:00",
      "author": "DavidB",
      "content": ":smile:))\n\nSorry, fixed it.\n\nThanks.\n\n"
    },
    {
      "id": "174284",
      "timestamp": "2013-07-02T15:01:15+00:00",
      "author": "DavidB",
      "content": "I need your opinion about something.  \nIn the new version more information is shown to the user, which is good, but sometimes is maybe too much.  \nI\u0027m thinking about 2 methods to help the user read this information:  \n1. The brightness of the background color of the entries with even number is slightly decreased (example: from 100% white to a little gray);  \n2. The text from the columns \\\u003e\u003d 3 has its brightness of the color slightly increased (example: from 100% black to some black/gray);  \n\nHere are the screenshots.  \n\nBefore:\n\n[![Before.PNG](http://reboot.pro/uploads/monthly_07_2013/post-61891-0-37969900-1372777200_thumb.png)](http://reboot.pro/uploads/monthly_07_2013/post-61891-0-37969900-1372777200.png \"Before.PNG - Size: 14.03KB\"){#ipb-attach-url-14403-0-31918300-1676066419}   \n\nAfter:  \n\n[![After.PNG](http://reboot.pro/uploads/monthly_07_2013/post-61891-0-27697600-1372783995_thumb.png)](http://reboot.pro/uploads/monthly_07_2013/post-61891-0-27697600-1372783995.png \"After.PNG - Size: 14.65KB\"){#ipb-attach-url-14404-0-31927000-1676066419}\n\nWell, what do you think...?\n\n"
    },
    {
      "id": "174285",
      "timestamp": "2013-07-02T15:06:25+00:00",
      "author": "Blackcrack",
      "content": "the 2nd it\u0027s better, because, some peoples need a line to better read.. looks better.. let it in :smile:\n\n\u003cbr /\u003e\n\n"
    },
    {
      "id": "174294",
      "timestamp": "2013-07-03T06:28:21+00:00",
      "author": "DavidB",
      "content": "1.1 Beta 8 version\n\n[![Attached File](http://reboot.pro/public/style_extra/mime_types/zip.gif)](http://reboot.pro/index.php?s\u003d8c2bab00064ac2ddcec01dc4f003f1b3\u0026app\u003dcore\u0026module\u003dattach\u0026section\u003dattach\u0026attach_id\u003d14406 \"Download attachment\") [**Virtual machine starter GUI exe.zip**](http://reboot.pro/index.php?s\u003d8c2bab00064ac2ddcec01dc4f003f1b3\u0026app\u003dcore\u0026module\u003dattach\u0026section\u003dattach\u0026attach_id\u003d14406 \"Download attachment\") **467.57KB** 363 downloads  \n\nChanges:  \n\nImprovement: the brightness of text color and background color is automatically changed in entries list to help the user read the displayed information.  \nImprovement: the context menu from the entries list is a bit improved (for example it behaves differently if you click on empty area or if you click on an entry).  \nBugfix: the Add/Edit window was using the Name field to check for doubles but it didn\u0027t work when the Name column was hidden. Fixed now...  \nAnd a lot of small improvements and small bugfixes which doesn\u0027t worth mentioning (each one)...\n\n"
    },
    {
      "id": "174297",
      "timestamp": "2013-07-03T09:07:32+00:00",
      "author": "Blackcrack",
      "content": "humm.. maybe it is not bad if you create a Webpage for it :smile:  \nmy suggestion, on fav.cc as subdomain, maby it\u0027s on the bottom some lil  \nAdvices, but there be 8Gig for free ! (the advice can you remove if you let at all pages ( \"\\\u003c!--\" ) :wink:  \nSo do you have a Webpage for free for VMS ( VMS.fav.cc ) or virtualmashinstarter.fav.cc :wink:  \nor upload there in the app-center [http://reboot.pro/fi...tegory/2-tools/](http://reboot.pro/files/category/2-tools/ \"\") (ask Nuno Brito)  \nBut an own Page whant maby betrter, because, I have there USB-Storage-Drivers for WinXP  \nand maybe goodys uploading for installing on XP or other Systems on USB, for wiki can you  \ntake a easy one [https://www.dokuwiki.org/dokuwiki](https://www.dokuwiki.org/dokuwiki \"External link\") (an textbased db) and for Easy upload the files,  \nthe Ajaxplorer, on it can you edit the html-files direcktly online, ajaxplorer can work with textdb too :wink:  \nso can you create an Ajaxplorer-Contolcenter + webpages in the underfolder :wink: and dont need an  \ncpanel or ftp anymore for filemanagement \\*bg\\*  \nyou can work with htaccess :smile: / -\\\u003e /webspace and /ajaxplorer to ajaxplorer :smile: hahh.. :wink:  \n\nYou VirtualMashin Starter have a big potensial ! it can install at all on an USB !  \nAnd therefor maybe a Webpage with an Easy [http://forum.myupb.com](http://forum.myupb.com/ \"External link\")  \nPHPForum with an textdb or insert in the htaccess (/forum) the redirection to this forum :smile:  \n\nfor i can advertise the program in a Freeware Forum [http://www.essential-freebies.de](http://www.essential-freebies.de/ \"External link\") :smile:  \n\nbest regards  \nBlacky  \n\np.s. installing at moment with beta8 my winXP and try out an USB-Storage Driver, and we have the Vesa-Drivers there,  \nif usb works, so i whant add the vesa drivers for test if works :smile:   \n\n**Edited by Blackcrack, 03 July 2013 - 09:12 AM.**\n"
    },
    {
      "id": "174308",
      "timestamp": "2013-07-03T13:51:07+00:00",
      "author": "steve6375",
      "content": "Suggestion: Instead of the VM ID, could you show the VM Name?\n\nIt is difficult to know which VM has been selected when you review or edit an SVM. The ID number is pretty meaningless to humans and the VM name cannot be changed so I see no reason why you can\u0027t display the VM name instead of the big long id number? (or was there a good reason?)\n\n"
    },
    {
      "id": "174309",
      "timestamp": "2013-07-03T14:30:35+00:00",
      "author": "DavidB",
      "content": "\u003e humm.. maybe it is not bad if you create a Webpage for it :smile:  \n\u003e my suggestion, on fav.cc as subdomain, maby it\u0027s on the bottom some lil  \n\u003e Advices, but there be 8Gig for free ! (the advice can you remove if you let at all pages ( \"\\\u003c!--\" ) :wink:  \n\u003e So do you have a Webpage for free for VMS ( VMS.fav.cc ) or virtualmashinstarter.fav.cc :wink:  \n\u003e or upload there in the app-center [http://reboot.pro/fi...tegory/2-tools/](http://reboot.pro/files/category/2-tools/ \"\") (ask Nuno Brito)  \n\u003e But an own Page whant maby betrter, because, I have there USB-Storage-Drivers for WinXP  \n\u003e and maybe goodys uploading for installing on XP or other Systems on USB, for wiki can you  \n\u003e take a easy one [https://www.dokuwiki.org/dokuwiki](https://www.dokuwiki.org/dokuwiki \"External link\") (an textbased db) and for Easy upload the files,  \n\u003e the Ajaxplorer, on it can you edit the html-files direcktly online, ajaxplorer can work with textdb too :wink:  \n\u003e so can you create an Ajaxplorer-Contolcenter + webpages in the underfolder :wink: and dont need an  \n\u003e cpanel or ftp anymore for filemanagement \\*bg\\*  \n\u003e you can work with htaccess :smile: / -\\\u003e /webspace and /ajaxplorer to ajaxplorer :smile: hahh.. :wink:  \n\u003e\n\u003e You VirtualMashin Starter have a big potensial ! it can install at all on an USB !  \n\u003e And therefor maybe a Webpage with an Easy [http://forum.myupb.com](http://forum.myupb.com/ \"External link\")  \n\u003e PHPForum with an textdb or insert in the htaccess (/forum) the redirection to this forum :smile:  \n\u003e\n\u003e for i can advertise the program in a Freeware Forum [http://www.essential-freebies.de](http://www.essential-freebies.de/ \"External link\") :smile:  \n\u003e\n\u003e best regards  \n\u003e Blacky  \n\u003e\n\u003e p.s. installing at moment with beta8 my winXP and try out an USB-Storage Driver, and we have the Vesa-Drivers there,  \n\u003e if usb works, so i whant add the vesa drivers for test if works :smile:\n\nThank you, Blackcrack, for the suggestions.  \nIf, in the future, VMS will be much successful, I will seriously think about that...\n\n\u003e Suggestion: Instead of the VM ID, could you show the VM Name?\n\u003e\n\u003e It is difficult to know which VM has been selected when you review or edit an SVM. The ID number is pretty meaningless to humans and the VM name cannot be changed so I see no reason why you can\u0027t display the VM name instead of the big long id number? (or was there a good reason?)\n\nYes, the VM ID is the default choice in Add/Edit, but you can set VM Path if you want (and you can see its name there).  \nThe VM name (and path) can be changed in the VBM but the (UU)ID will be always the same (that was the reason using it as default).  \nI will think about modifying VMS so you can simply choose the name of the VM and even display it in the main window (in one of the columns)...  \nMaybe I will try the same \"trick\" I did with the drives: internally using the (UU)ID but to the user displaying the model, the manufacturer and size ![:D](http://reboot.pro/public/style_emoticons/default/biggrin.png)\n\n"
    },
    {
      "id": "174313",
      "timestamp": "2013-07-03T15:39:37+00:00",
      "author": "steve6375",
      "content": "\u003e Yes, the VM ID is the default choice in Add/Edit, but you can set VM Path if you want (and you can see its name there).\n\u003e\n\u003e The VM name (and path) can be changed in the VBM but the (UU)ID will be always the same (that was the reason using it as default).  \n\u003e I will think about modifying VMS so you can simply choose the name of the VM and even display it in the main window (in one of the columns)...  \n\u003e Maybe I will try the same \"trick\" I did with the drives: internally using the (UU)ID but to the user displaying the model, the manufacturer and size ![:D](http://reboot.pro/public/style_emoticons/default/biggrin.png)\n\nIt is quicker to just click on the \u0027tree structure\u0027 icon to see the name of the VM and then check the end few numbers in the list.\n\nPersonally, I would like to select the name of the VM and then, once selected, when I click on Edit - see the name in a box and the path in a separate \u0027info only\u0027 box (and maybe the id)?\n\nActually, thinking about it, the only reason I click on Edit is to see what VM I had assigned to the VMS name - if you showed 2 extra fields for the VM name + Type in the main list this would be very useful.\n\n1 VB VMSNAME VMNAME1 Firstdrive (2ndDrive)\n\n2 QEMU VMSNAME VMNAME2 Firstdrive (2ndDrive)\n\netc\n\nAlso when a VB VM is picked, could you auto-fill the empty VMS name field with the VB name?\n\ncheers\n\nSteve\n\n"
    },
    {
      "id": "174314",
      "timestamp": "2013-07-03T15:57:54+00:00",
      "author": "Zoso",
      "content": "the thread title is confusing me here. very recently I started using virtualbox so that I could install XP directly to a .vhd file and boot that with Grub4Dos.  \n\nmy current setup is XPx64 with latest (today actually) virtualbox and added extension pack installed and all of it is on USB HDD and booted, virtualbox works like this.  \n\nmy confusion is what is the tool for exactly? it seems from reading it is to change boot order of VB so that the selected USB is set ahead of the selected .vhd but Im not sure that it is.  \n\ncan it be used to test USB booting inside VB like if plop was working?  \n\nso far my first attempts to boot a USB before the attached .vhd in the VB VM are not working and I get \"failed to dismount\" error and then click yes to continue and then VB starts and the .vhd with xp boots inside and the selected USB I wanted to boot gets attached and is available inside the VM but not the oposite like I wanted.  \n\nI may be doing something wrong or it may be because I am already booted from a USB?  \n\nif someone can clear my confusion about what exactly the tool is for it may help. I havnt tried plop booting in VB yet so that is next.   \n"
    },
    {
      "id": "174315",
      "timestamp": "2013-07-03T16:09:39+00:00",
      "author": "steve6375",
      "content": "That\u0027s why I wanted just a few line of Help info with the app!\n\n1. The tool dismounts the USB drive and then runs the VM - this means you have**full write access** to the USB drive(s) inside the running VM session - this was not possible before!\n\n2. To boot to USB, leave a \u0027gap\u0027 for VMS to fill with the USB drive that you pick (USB1).\n\ne.g.\n\nIDE Prim Master - (empty) \\\u003c- will be filled by VMS with USB drive assignment\n\nIDE Prim Slave - VHDD\n\nor\n\nSATA Port 0 - (empty) \\\u003c- will be filled by VMS with USB drive assignment\n\nSATA Port 1 - VHDD\n\n"
    },
    {
      "id": "174318",
      "timestamp": "2013-07-03T17:39:46+00:00",
      "author": "DavidB",
      "content": "\u003e It is quicker to just click on the \u0027tree structure\u0027 icon to see the name of the VM and then check the end few numbers in the list.\n\u003e\n\u003e Personally, I would like to select the name of the VM and then, once selected, when I click on Edit - see the name in a box and the path in a separate \u0027info only\u0027 box (and maybe the id)?\n\u003e\n\u003e Actually, thinking about it, the only reason I click on Edit is to see what VM I had assigned to the VMS name - if you showed 2 extra fields for the VM name + Type in the main list this would be very useful.\n\u003e\n\u003e 1 VB VMSNAME VMNAME1 Firstdrive (2ndDrive)\n\u003e\n\u003e 2 QEMU VMSNAME VMNAME2 Firstdrive (2ndDrive)\n\u003e\n\u003e etc\n\u003e\n\u003e Also when a VB VM is picked, could you auto-fill the empty VMS name field with the VB name?\n\u003e\n\u003e cheers\n\u003e\n\u003e Steve\n\nYou\u0027re talking about this?\n\n[![Capture.PNG](http://reboot.pro/uploads/monthly_07_2013/post-61891-0-48121000-1372872568_thumb.png)](http://reboot.pro/uploads/monthly_07_2013/post-61891-0-48121000-1372872568.png \"Capture.PNG - Size: 11.22KB\"){#ipb-attach-url-14408-0-31945600-1676066419}\n\n\u003e That\u0027s why I wanted just a few line of Help info with the app!\n\nOk but a little bit of experience with VirtualBox helps more than a few lines of help in VMS because only this way the user can understand what VMS is doing/saying.\n\n\u003e the thread title is confusing me here. very recently I started using virtualbox so that I could install XP directly to a .vhd file and boot that with Grub4Dos.  \n\u003e\n\u003e my current setup is XPx64 with latest (today actually) virtualbox and added extension pack installed and all of it is on USB HDD and booted, virtualbox works like this.  \n\u003e\n\u003e my confusion is what is the tool for exactly? it seems from reading it is to change boot order of VB so that the selected USB is set ahead of the selected .vhd but Im not sure that it is.  \n\u003e\n\u003e can it be used to test USB booting inside VB like if plop was working?  \n\u003e\n\u003e so far my first attempts to boot a USB before the attached .vhd in the VB VM are not working and I get \"failed to dismount\" error and then click yes to continue and then VB starts and the .vhd with xp boots inside and the selected USB I wanted to boot gets attached and is available inside the VM but not the oposite like I wanted.  \n\u003e\n\u003e I may be doing something wrong or it may be because I am already booted from a USB?  \n\u003e\n\u003e if someone can clear my confusion about what exactly the tool is for it may help. I havnt tried plop booting in VB yet so that is next.\n\nI haven\u0027t seen many computers with XP x64...  \nYou say that VMS is showing \"failed to dismount\". Usually this happens when it doesn\u0027t have full access to that USB drive...  \nHave you started VMS with administrative privileges? Do you have some application and/or OS setting(s) that will not allow VMS full access to the drive...?\n\nIf you start cmd.exe and type \"chkdsk (drive/volume)letter: /x\" (for example \"chkdsk e: /x\", is scanning the drive or it\u0027s saying:  \nChkdsk cannot run because the volume is in use by another  \nprocess. Would you like to schedule this volume to be  \nchecked the next time the system restarts? (Y/N)\n\nLE: to be completely clear: your host OS is XP x64 and you want to boot from an USB drive in VirtualBox. The USB drive is bootable? If yes, which OS and/or boot manager do you have on it? How it was partitioned...?\n\n"
    },
    {
      "id": "174319",
      "timestamp": "2013-07-03T17:56:31+00:00",
      "author": "steve6375",
      "content": "I am also having problems with the latest version:\n\n1. Make a new VM in VBox Mangler - IDE Prim Master - empty, IDE Primary Slave VHDD 20GB\n\n2. Now run VMS and make a new machine - VMS picks USB VMSDrive000.vmdk\n\n3. Now make another VM the same as the first VM (different name)\n\n4. Now run VMS - VMS picks VMSDrive000.vmdk again\n\n5. Now try to run the VM\u0027s (either VBox or VMS) - I get an error about \u0027Cannot register the hard disk due to it already existing???\n\nCannot register the hard disk \u0027C:\\\\Users\\\\Administrator\\\\VirtualBox VMs\\\\IDE USB VT OFF1\\\\VMSDrive000.vmdk\u0027 {dc6dac33-45de-abf1-5195-296b6d5f4b03} because a hard disk \u0027C:\\\\Users\\\\Administrator\\\\VirtualBox VMs\\\\USB+SCSI VT OFF\\\\VMSDrive000.vmdk\u0027 with UUID {dc6dac33-45de-abf1-5195-296b6d5f4b03} already exists.  \nResult Code:  \nE_INVALIDARG (0x80070057)  \nComponent:  \nVirtualBox  \nInterface:  \nIVirtualBox {3b2f08eb-b810-4715-bee0-bb06b9880ad2}\n\n"
    },
    {
      "id": "174321",
      "timestamp": "2013-07-03T18:28:48+00:00",
      "author": "Zoso",
      "content": "Im also a newb with XPx64. I have chosen to use it specifically for running Virtual Machines for several reasons but the main reason is it is quicker/faster than the later M$ OSs.  \n\nI was not running with full access. now, I can run VB and VBS both separately as admin with full access rights but I dont know how to make VBS start VB with full access?   \n\nnow I have set it up as steve shows so when I figure out how to get full access to VB through VBS I think it will be working.  \n\nside note: I can boot USB with VB through plop but only on version 4.0.6 so far and not the latest version. plop hangs with the latest VB. also, I was unable to downgrade the VB extension pack from latest to the 4.0.6 and got many errors trying so I reloaded the OS and installed 4.0.6 without extension pack and it worked but @ USB1.1 speed (very slow) and I didnt try to go past the Grub4Dos menu. I will try it with the matching extension pack after I get the access issues solved with VB/VBS. then I will add the extension and try VB/VBS again then plop.  \n\nit truely does seem VB devs do not want to allow direct usb support though. now I wonder if the VB BIOS can be hacked easily as VMWares?  \n\nanyway, cool development David and Steve also (as always!) I\u0027ll post back with any input I can and BTW your GUI is very sharp David, nice work!   \n"
    },
    {
      "id": "174323",
      "timestamp": "2013-07-03T18:49:35+00:00",
      "author": "DavidB",
      "content": "\u003e I am also having problems with the latest version:\n\u003e\n\u003e 1. Make a new VM in VBox Mangler - IDE Prim Master - empty, IDE Primary Slave VHDD 20GB\n\u003e\n\u003e 2. Now run VMS and make a new machine - VMS picks USB VMSDrive000.vmdk\n\u003e\n\u003e 3. Now make another VM the same as the first VM (different name)\n\u003e\n\u003e 4. Now run VMS - VMS picks VMSDrive000.vmdk again\n\u003e\n\u003e 5. Now try to run the VM\u0027s (either VBox or VMS) - I get an error about \u0027Cannot register the hard disk due to it already existing???\n\u003e\n\u003e Cannot register the hard disk \u0027C:\\\\Users\\\\Administrator\\\\VirtualBox VMs\\\\IDE USB VT OFF1\\\\VMSDrive000.vmdk\u0027 {dc6dac33-45de-abf1-5195-296b6d5f4b03} because a hard disk \u0027C:\\\\Users\\\\Administrator\\\\VirtualBox VMs\\\\USB+SCSI VT OFF\\\\VMSDrive000.vmdk\u0027 with UUID {dc6dac33-45de-abf1-5195-296b6d5f4b03} already exists.  \n\u003e Result Code:  \n\u003e E_INVALIDARG (0x80070057)  \n\u003e Component:  \n\u003e VirtualBox  \n\u003e Interface:  \n\u003e IVirtualBox {3b2f08eb-b810-4715-bee0-bb06b9880ad2}\n\nI know this problem, I thought I solved it in Beta 7 but looks like the random GUID generator is not so \"random\"... Let me see what I can do to make it more \"random\" ![:D](http://reboot.pro/public/style_emoticons/default/biggrin.png)\n\n"
    },
    {
      "id": "174324",
      "timestamp": "2013-07-03T18:57:23+00:00",
      "author": "steve6375",
      "content": "I don\u0027t think it is anything \u0027unlucky or \u0027random\u0027\n\nI have tried about 6 times with different VMs and they all do it every time - but the key seems to be that it ONLY does it with IDE controllers...???\n\n"
    },
    {
      "id": "174325",
      "timestamp": "2013-07-03T19:01:17+00:00",
      "author": "Zoso",
      "content": "I am trying to sort out the access issues with no luck so far and I think that maybe USBoot driveguard is the culprit here. I guess I need to reload everything on internal HDD to be sure.. will let ya know.   \n"
    },
    {
      "id": "174326",
      "timestamp": "2013-07-03T19:03:56+00:00",
      "author": "DavidB",
      "content": "\u003e Im also a newb with XPx64. I have chosen to use it specifically for running Virtual Machines for several reasons but the main reason is it is quicker/faster than the later M$ OSs.  \n\u003e\n\u003e I was not running with full access. now, I can run VB and VBS both separately as admin with full access rights but I dont know how to make VBS start VB with full access?  \n\u003e\n\u003e now I have set it up as steve shows so when I figure out how to get full access to VB through VBS I think it will be working.  \n\u003e\n\u003e side note: I can boot USB with VB through plop but only on version 4.0.6 so far and not the latest version. plop hangs with the latest VB. also, I was unable to downgrade the VB extension pack from latest to the 4.0.6 and got many errors trying so I reloaded the OS and installed 4.0.6 without extension pack and it worked but @ USB1.1 speed (very slow) and I didnt try to go past the Grub4Dos menu. I will try it with the matching extension pack after I get the access issues solved with VB/VBS. then I will add the extension and try VB/VBS again then plop.  \n\u003e\n\u003e it truely does seem VB devs do not want to allow direct usb support though. now I wonder if the VB BIOS can be hacked easily as VMWares?  \n\u003e\n\u003e anyway, cool development David and Steve also (as always!) I\u0027ll post back with any input I can and BTW your GUI is very sharp David, nice work!\n\nThank you.  \n\nUsualy if you start VMS as administrator it will start the virtual machine from VB also as administrator...  \n\nIf you still have the failed dismount error, have you tried cmd + chkdsk /x (normal user and as administrator) and see if it works?\n\n"
    },
    {
      "id": "174327",
      "timestamp": "2013-07-03T19:12:04+00:00",
      "author": "DavidB",
      "content": "\u003e I don\u0027t think it is anything \u0027unlucky or \u0027random\u0027\n\u003e\n\u003e I have tried about 6 times with different VMs and they all do it every time - but the key seems to be that it ONLY does it with IDE controllers...???\n\nIt\u0027s \"random\" problem 100% sure because I got exactly the same GUID as you got. The chance to hit the same GUID is 3 \\* (10 to the power of -37) % !!\n\nAnyway I think I found a solution, at least on my computer seems fixed...\n\n"
    },
    {
      "id": "174329",
      "timestamp": "2013-07-03T19:20:29+00:00",
      "author": "DavidB",
      "content": "\u003e I think that maybe USBoot driveguard is the culprit here.\n\nIt\u0027s possible, yes...\n\n"
    },
    {
      "id": "174330",
      "timestamp": "2013-07-03T19:23:57+00:00",
      "author": "steve6375",
      "content": "Isn\u0027t a random number rather risky? Why not make a number up from the time and date (to 100th sec) - then you know it\u0027s unique?\n\n"
    },
    {
      "id": "174331",
      "timestamp": "2013-07-03T19:58:49+00:00",
      "author": "DavidB",
      "content": "The random number generator from Delphi is fine; it just needs to be reseted from time to time.  \nBut your idea getting GUID from time isn\u0027t bad either...  \n\nGUID has 256 to the power of 16 combinations \u003d 3.4 x (10 to the power of 38).  \nA computer is measuring time in ms from 1975 till today \\~ 1.19 x (10 to the power of 12) ms  \n\nBut what if Windows and/or the user resets the computer date/time? For example the automatic syncronization with an internet time server, or to fix a glitch in an OS and so on.  \nThis things are not so rare...  \n\nThe only way to 100% prevent the GUID clash is that VMS would look into ALL VB registered VM\u0027s (not just only the started one) and generate a random GUID in a loop until is different from all the others...\n\nBut this will decrease speed and it will raise the risk of a clash between VB and VMS (over the vbox files)...\n\n"
    },
    {
      "id": "174332",
      "timestamp": "2013-07-03T20:16:38+00:00",
      "author": "DavidB",
      "content": "I\u0027m curious if the fix works on your computer too.\n\nLE: link removed\n\n"
    },
    {
      "id": "174333",
      "timestamp": "2013-07-03T20:29:10+00:00",
      "author": "steve6375",
      "content": "I replaced the old version and now It does not show any predefined VMS\u0027s??? just a blank form?\n\n"
    },
    {
      "id": "174334",
      "timestamp": "2013-07-03T20:47:47+00:00",
      "author": "DavidB",
      "content": "Sorry, I sent you the exe for the installed version, not portable... On my computer I test now the installed version..\n\nThe portable: link removed , you can find a better version in the next posts\n\n"
    },
    {
      "id": "174336",
      "timestamp": "2013-07-03T21:05:20+00:00",
      "author": "steve6375",
      "content": "Seems better - thanks\n\nI still have a problem with VBoxsvc - VMS doesn\u0027t seem to be able to kill it even though VBox is not running. The service doesn\u0027t seem to automatically stop - a prompt after 10 seconds to kill it would be nice (saves me having to do it in Task Man)!\n\n"
    },
    {
      "id": "174337",
      "timestamp": "2013-07-03T21:22:34+00:00",
      "author": "DavidB",
      "content": "VMS doesn\u0027t kill VBoxSVC.exe. On my computer it closes itself.\n\nOnly after closing itself VirtualBox.exe is properly \"releasing\" the vbox file, if it\u0027s killed by VMS doesn\u0027t work... And I\u0027m not 100% sure that killing it manually helps in all situations...\n\nOn your computer, If you start VBM manually and close it manually, VBoxSVC.exe closes itself some time later or stays open forever...?\n\n"
    },
    {
      "id": "174338",
      "timestamp": "2013-07-03T21:33:08+00:00",
      "author": "DavidB",
      "content": "\u003e VMS doesn\u0027t kill VBoxSVC.exe\n\nBy this I meant it doesn\u0027t have a code for killing it.\n\nSorry, it\u0027s late and I\u0027m tired ![:(](http://reboot.pro/public/style_emoticons/default/sad.png)\n\n"
    },
    {
      "id": "174339",
      "timestamp": "2013-07-03T21:34:28+00:00",
      "author": "steve6375",
      "content": "normally the svc closes after 6 sec, but when there is a problem - like clone not working in vb, then the svc wont close and i have to end process in task man to get vms to work\n\n"
    },
    {
      "id": "174340",
      "timestamp": "2013-07-03T21:47:42+00:00",
      "author": "DavidB",
      "content": "Oh... :smile:\n\nFor a couple of min I thought the code for detecting the 100% close of VirtualBox doesn\u0027t work on your computer\n\nNightmare ![:(](http://reboot.pro/public/style_emoticons/default/sad.png)\n\nI made the code to wait 20 sec for VBoxSVC.exe to autoclose. Should I set 15 or 10? There may be problems on slower computers...\n\nAnyway, with the random GUID generator working better now, it shouldn\u0027t crash VB anymore. Well, at least not so often ![:rolleyes:](http://reboot.pro/public/style_emoticons/default/rolleyes.gif)\n\n"
    },
    {
      "id": "174341",
      "timestamp": "2013-07-03T21:50:30+00:00",
      "author": "steve6375",
      "content": "the svc never closes! i have to close it with task man\n\n"
    },
    {
      "id": "174342",
      "timestamp": "2013-07-03T21:57:21+00:00",
      "author": "DavidB",
      "content": "\u003e normally the svc closes after 6 sec, but when there is a problem - like clone not working in vb, then the svc wont close and i have to end process in task man to get vms to work\n\n\u003e the svc never closes! i have to close it with task man\n\nI don\u0027t get it...\n\nFirst you say is closing fine when there isn\u0027t a problem with the vbox, second time you say it never closes...\n\n"
    },
    {
      "id": "174343",
      "timestamp": "2013-07-03T21:59:37+00:00",
      "author": "steve6375",
      "content": "when there is a problem, l can quit vb but the service never closes\n\n"
    },
    {
      "id": "174344",
      "timestamp": "2013-07-03T22:00:38+00:00",
      "author": "DavidB",
      "content": "So, if vbox is ok, VBoxSVC.exe closes after 6 sec?\n\n"
    },
    {
      "id": "174345",
      "timestamp": "2013-07-03T22:03:09+00:00",
      "author": "steve6375",
      "content": "yes.\n\nbut if i clone a vm, the clone fails, then the svc never stops and i cant run vms\n\n"
    },
    {
      "id": "174346",
      "timestamp": "2013-07-03T22:07:01+00:00",
      "author": "steve6375",
      "content": "i use a linked clone not a full clone and this seems to be failing for around a week or two...\n\n"
    },
    {
      "id": "174347",
      "timestamp": "2013-07-03T22:08:43+00:00",
      "author": "DavidB",
      "content": "Question: the clone fails because of VB, VMS or other cause..? Which one...\n\n"
    },
    {
      "id": "174348",
      "timestamp": "2013-07-03T22:10:49+00:00",
      "author": "steve6375",
      "content": "I am not sure. Can you make an IDE VM. Run VMS to attach a vmdk. Then try a linked clone in VM? Does it work for you? I get a Failed to create snapshot message.   \n"
    },
    {
      "id": "174349",
      "timestamp": "2013-07-03T22:17:56+00:00",
      "author": "steve6375",
      "content": "Whatever the reason - if vms times-out after 10 secs - could you prompt the user to \u0027 Kill Service (Y/N)\u0027 and warn that you should not do it if any VMs are running!  \nIt would be really useful!   \n"
    },
    {
      "id": "174350",
      "timestamp": "2013-07-03T22:57:55+00:00",
      "author": "DavidB",
      "content": "It crashed on my computer too.  \nIt\u0027s because of VMS but still isn\u0027t somehow (at least not 100%).  \nLike I said a few weeks ago, using snapshots with real drives is not a good idea. If you look in the Virtual media manager, you\u0027ll see that VMSDrive000.vmdk is split into 2 snapshots.  \nI\u0027ll try to make it not crash anymore but even so it will not work fine 100%.  \nThe best way is to create a full clone or a new VM.  \n\nThe code is warning the user about vboxsvc after 20 sec. I could lower to 15 or even 10 hoping it will not cause problems on slower computers..  \n\nOk, going to bed, see you tomorrow...\n\n"
    },
    {
      "id": "174351",
      "timestamp": "2013-07-03T23:13:08+00:00",
      "author": "steve6375",
      "content": "OK - thing is all I want to do is make an **exact** copy (using same vmdk/vdd) and then change the VT to off. I don\u0027t want a snapshot made!\n\n"
    },
    {
      "id": "174357",
      "timestamp": "2013-07-04T04:48:13+00:00",
      "author": "DavidB",
      "content": "1.1 Beta 9 version:\n\nLE: link removed, you can find a better version in the next posts\n\n\u003cbr /\u003e\n\nChanges:  \n\nBugFix: a bug in the random GUID generator was fixed.  \nBugFix/Improvement: when it finds VMSDrive\\*\\*\\*.vmdk divided into one or more snapshots, it refuses to change the vbox file (since there is little chance to not break something) and shows this message:  \n\n........................  \nCould not automatically add the drive(s) to the VM in VirtualBox.  \n\nPossible reason: the content of \"VMSDrive\\*\\*\\*.vmdk\" is divided into \u0027n\u0027 snapshot(s).  \nIt is not a good idea using snapshots with real drives. But if you really want to at least do this:  \nIf you created a snapshot or linked clone this VM you should of manually detached any  \nVMSDrive\\*\\*\\*.vmdk drive from the storage controller(s) before the snapshoting/cloning operation.  \n\nAre you sure you want to continue (not recommended)...?  \n........................  \n\n\u003cbr /\u003e\n\n\u003cbr /\u003e\n\n\u003cbr /\u003e\n\nNow getting back to modifying the columns in VMS...\n\n"
    },
    {
      "id": "174380",
      "timestamp": "2013-07-04T15:55:43+00:00",
      "author": "DavidB",
      "content": "1.1 Beta 10 version:  \n\nLE: link removed, you can find better version in the next posts.\n\n\u003cbr /\u003e\n\nChanges:  \n\nImprovement: VM Name column added (visible by default), VM type column moved to the second position (hidden by default). Once again, the entries list (vml file), needs to be rebuilded to properly show the values in all columns.  \nImprovement: it waits the VBoxSVC.exe to close for 15 sec instead of 20 and then asks the user if it should be forcibly closed.  \nImprovement: you don\u0027t have to reopen Add/Edit window anymore when you insert a new drive, it will rescan when you click on the drive combobox (the \"dropdown\").  \nImprovement: setting VM ID for VB VMs in Add/Edit window removed. Now you can set VM Name (default), VM Path and exe parameters.  \nImprovement: Using now a better function to generate random GUID. Information [here](http://msdn.microsoft.com/en-us/library/ms688568(v\u003dvs.85).aspx \"External link\")\n\n"
    },
    {
      "id": "174382",
      "timestamp": "2013-07-04T16:52:17+00:00",
      "author": "steve6375",
      "content": "Really like the new form ![:clap:](http://reboot.pro/public/style_emoticons/default/clap.gif)\n\nSmall issue - if I resize the form by dragging the left side in or out, the VM Name column does not seem to expand like the other columns??\n\nSo I have a small VM Name column but the other two columns have load of space...\n\n"
    },
    {
      "id": "174385",
      "timestamp": "2013-07-04T18:38:02+00:00",
      "author": "DavidB",
      "content": "Ok, I fixed it.\n\nThanks.\n\nIt will be in the next Beta...\n\n"
    },
    {
      "id": "174395",
      "timestamp": "2013-07-05T07:51:45+00:00",
      "author": "Blackcrack",
      "content": "[http://download.virt...tualbox/4.2.16/](http://download.virtualbox.org/virtualbox/4.2.16/ \"External link\")   \n"
    },
    {
      "id": "174396",
      "timestamp": "2013-07-05T08:22:28+00:00",
      "author": "DavidB",
      "content": "Thank you.  \nSeems to work fine with VMS.  \nAlso the quick restart bug seems to be fixed. :smile:\n\n"
    },
    {
      "id": "174401",
      "timestamp": "2013-07-05T11:40:18+00:00",
      "author": "DavidB",
      "content": "I can\u0027t find any more bugs or things to improve so I guess this is the final version.  \n\n1.1 final version:  \n\n[![Attached File](http://reboot.pro/public/style_extra/mime_types/zip.gif)](http://reboot.pro/index.php?s\u003d826f7c14f189b273368cc1d56356d161\u0026app\u003dcore\u0026module\u003dattach\u0026section\u003dattach\u0026attach_id\u003d14418 \"Download attachment\") [**Virtual machine starter GUI setup.zip**](http://reboot.pro/index.php?s\u003d826f7c14f189b273368cc1d56356d161\u0026app\u003dcore\u0026module\u003dattach\u0026section\u003dattach\u0026attach_id\u003d14418 \"Download attachment\") **839.31KB** 2132 downloads\n\n[![Attached File](http://reboot.pro/public/style_extra/mime_types/zip.gif)](http://reboot.pro/index.php?s\u003d826f7c14f189b273368cc1d56356d161\u0026app\u003dcore\u0026module\u003dattach\u0026section\u003dattach\u0026attach_id\u003d14417 \"Download attachment\") [**Virtual machine starter GUI exe portable.zip**](http://reboot.pro/index.php?s\u003d826f7c14f189b273368cc1d56356d161\u0026app\u003dcore\u0026module\u003dattach\u0026section\u003dattach\u0026attach_id\u003d14417 \"Download attachment\") **471.16KB** 1802 downloads\n\n[![Attached File](http://reboot.pro/public/style_extra/mime_types/zip.gif)](http://reboot.pro/index.php?s\u003d826f7c14f189b273368cc1d56356d161\u0026app\u003dcore\u0026module\u003dattach\u0026section\u003dattach\u0026attach_id\u003d14416 \"Download attachment\") [**Virtual machine starter GUI sources.zip**](http://reboot.pro/index.php?s\u003d826f7c14f189b273368cc1d56356d161\u0026app\u003dcore\u0026module\u003dattach\u0026section\u003dattach\u0026attach_id\u003d14416 \"Download attachment\") **100.76KB** 631 downloads  \n\nChanges from Beta 10:  \n\nBugfix: a problem with the column resize was fixed.  \n+ other small bugfixes and improvements.\n\n"
    },
    {
      "id": "174419",
      "timestamp": "2013-07-05T17:49:16+00:00",
      "author": "steve6375",
      "content": "sorry posted by mistake!\n\n"
    },
    {
      "id": "174420",
      "timestamp": "2013-07-05T18:24:50+00:00",
      "author": "DavidB",
      "content": "Pfew ![:whistling:](http://reboot.pro/public/style_emoticons/default/happy22.gif)\n\nI thought you found a serious bug... ![:realmad:](http://reboot.pro/public/style_emoticons/default/realmad.gif)\n\n"
    },
    {
      "id": "174421",
      "timestamp": "2013-07-05T18:32:11+00:00",
      "author": "steve6375",
      "content": "Sorry, somehow an IDE controller seemed to have been in the VM when it wasn\u0027t supposed to be there....\n\nP.S. If a VM is closed by the user as Save Machine State when VMS runs it, instead of the USB drive that was just changed in VMS, the VM runs the saved session from the other USB drive.\n\nCould VMS check the state of a VM before running it and warn if it is in a saved state?\n\nP.S. This scenario then breaks the VM as it won\u0027r run in VBox any more and the VMSDrive000.vmdk shows as (Normal, **Inaccessible**).\n\n"
    },
    {
      "id": "174422",
      "timestamp": "2013-07-05T18:36:51+00:00",
      "author": "DavidB",
      "content": "Ok, I\u0027ll check to see if it\u0027s possible...\n\n"
    },
    {
      "id": "174423",
      "timestamp": "2013-07-05T18:44:26+00:00",
      "author": "DavidB",
      "content": "I think it\u0027s possible...\n\n1.2 Beta 1 ? ![:D](http://reboot.pro/public/style_emoticons/default/biggrin.png)\n\n7 hours for 1.1 final version, that\u0027s gotta be a record :smile:)\n\n"
    },
    {
      "id": "174426",
      "timestamp": "2013-07-05T19:23:46+00:00",
      "author": "DavidB",
      "content": "Ok, I implemented this warning:  \n\n...................  \nIt appears that this VM is in a saved state so it will not be modified, just started...  \nJust so you know, it is not a good idea to save the state of a VM with a real drive,  \nbecause it will increase the risk of corrupting the data from that drive...  \n...................  \n\nIt will still start the VM after you click on OK, but without modifying the vbox and/or the vmdk file.\n\n"
    },
    {
      "id": "174428",
      "timestamp": "2013-07-05T20:50:17+00:00",
      "author": "DavidB",
      "content": "Strange, seems like VirtualBox has a problem fullcloning a VM with a real drive attached (vmdk). Even if you don\u0027t start the VM with VMS and create + attach the vmdk manually, still crashes...  \nDoes this happen on your computer too?\n\n"
    },
    {
      "id": "174456",
      "timestamp": "2013-07-07T05:25:54+00:00",
      "author": "DavidB",
      "content": "1.2 Beta 1 version:\n\nLE: link removed, you can find a better version in the next posts.\n\n\u003cbr /\u003e\n\nChanges:  \n\nBugfix/Improvement: if the VM was previously closed in saved state it warns the user and it just starts the VM without any modification.  \nImprovement: In the warning messages about volume it also shows information about the drive containing that volume.  \nImprovement: When waiting for \"VboxSVC.exe\" to close it shows a progress window.  \nImprovement: found a way to implement a faster lock. You can set it in Add/Edit window (default off). If a volume cannot be locked, it waits 10 sec trying again every half sec. Also it shows a progress window where the user can cancel the lock.  \n\nI\u0027m thinking about adding a button/menu/key to see the VM log after closing.  \nDo you think it will help...?\n\n"
    },
    {
      "id": "174470",
      "timestamp": "2013-07-07T09:08:03+00:00",
      "author": "steve6375",
      "content": "\u003e I\u0027m thinking about adding a button/menu/key to see the VM log after closing.\n\u003e\n\u003e Do you think it will help...?\n\nNot really as I would just run VBox Manager to see what went wrong with the config anyway (and the logs are pretty hard to scan for a clue) - but a button to launch VBox Manager would be nice...\n\n"
    },
    {
      "id": "174472",
      "timestamp": "2013-07-07T09:16:44+00:00",
      "author": "DavidB",
      "content": "In a way it would be useful but it would seem a little strange that it has a button to start VBM but when you start the VM it wants it closed ![:D](http://reboot.pro/public/style_emoticons/default/biggrin.png)\n\n"
    },
    {
      "id": "174475",
      "timestamp": "2013-07-07T10:06:03+00:00",
      "author": "steve6375",
      "content": "If I use VMS to start a VM and there is a problem, I have to go into VBox Manager to see how the drives have been configured and what state the VM and the virtual disks are in.\n\nSo it is perfectly sensible to provide a button to launch VBox Manager if a VM fails to run.\n\nP.S. Ideally I would like to keep VBox manager open all the time (like the very first version...)\n\nP.P.S. I have a taskkill shortcut on my desktop now, so I can killl vboxsvc if it gets \u0027stuck\u0027.\n\n"
    },
    {
      "id": "174476",
      "timestamp": "2013-07-07T10:35:07+00:00",
      "author": "DavidB",
      "content": "\u003e If I use VMS to start a VM and there is a problem, I have to go into VBox Manager to see how the drives have been configured and what state the VM and the virtual disks are in.\n\u003e\n\u003e So it is perfectly sensible to provide a button to launch VBox Manager if a VM fails to run.\n\nYes, but normal users don\u0027t modify the VM configuration so often, only nerds like us ![:D](http://reboot.pro/public/style_emoticons/default/biggrin.png)\n\n\u003e P.S. Ideally I would like to keep VBox manager open all the time (like the very first version...)\n\nYes, but then I will have to call vboxmange.exe with parameters every time I want to know or set something in the VM. This will slow down VMS considerably + you can\u0027t do all with vboxmanage.exe...\n\n\u003e P.P.S. I have a taskkill shortcut on my desktop now, so I can killl vboxsvc if it gets \u0027stuck\u0027.\n\nI don\u0027t know if that\u0027s so needed now, since after 10 sec you can click on VMS\u0027s message button to kill it.\n\nAnd since VMS doesn\u0027t crash VBM anymore (well, on your computer, not so often like the first versions ![:rolleyes:](http://reboot.pro/public/style_emoticons/default/rolleyes.gif) ), seems like it\u0027s needed even less...\n\nOr am I wrong ? ![:dubbio:](http://reboot.pro/public/style_emoticons/default/dubbio.gif)\n\nPS: I just found a little problem in that code, fixing it now... ![:D](http://reboot.pro/public/style_emoticons/default/biggrin.png)\n\n"
    },
    {
      "id": "174479",
      "timestamp": "2013-07-07T11:31:32+00:00",
      "author": "DavidB",
      "content": "Problem fixed.  \nWhat was it: after it kills vboxsvc.exe it tests again to be sure that it\u0027s closed; but the code was made for faster computers like mine... Now it waits 2 sec testing every 200 ms. If it\u0027s closed, the cycle is interrupted and the VM is loaded. If, after 2 sec, still isn\u0027t closed, shows error message and exits...\n\n"
    },
    {
      "id": "174481",
      "timestamp": "2013-07-07T11:36:52+00:00",
      "author": "steve6375",
      "content": "As a \u0027normal user\u0027 I set up a new VM - as there are no Help instructions, I just added one VHDD using the New wizard in VBox mangler\n\nThen I used VMS and added the VM, attached my USB drive and ran it - it booted from the VHDD instead of the USB drive! (as we non-newbies knew it would). Also it has added a Primary Slave vmdk which is not where I wanted it!\n\n**Suggestion** : When clicking on **Start**, could you check to see that the first VMS USB vmdk is or can be added before any Vhdd (if any and whatever type) and warn the user if it is not going to boot from the selected \u0027First Drive\u0027 and give help like - \u0027you must leave a free drive position before any virtual hard disk or CD in order for the VM to boot from it - and maybe offer the option to abort and run VBox mangler ? Or maybe say \u0027please move the VMSDrive000.vmdk so it is before any other drive\u0027?\n\ncheers\n\nS\n\n"
    },
    {
      "id": "174484",
      "timestamp": "2013-07-07T11:54:25+00:00",
      "author": "DavidB",
      "content": "VMS is showing this message first time you select a drive:  \n\n[![Screenshot.PNG](http://reboot.pro/uploads/monthly_07_2013/post-61891-0-65225500-1373198050_thumb.png)](http://reboot.pro/uploads/monthly_07_2013/post-61891-0-65225500-1373198050.png \"Screenshot.PNG - Size: 12.79KB\"){#ipb-attach-url-14421-0-82629100-1676066419}\n\n\u003cbr /\u003e\n\nYour idea is good, in fact I thought about doing this some time ago but there is a (small) problem: even if VMS was created for booting USB drives, some will may use it to just add a drive (USB or not) to a already bootable machine and boot from the virtual HDD/CDROM. If they see this message every time it will eventually annoy them...  \nSo I have to find a way to please all the users...\n\n"
    },
    {
      "id": "174490",
      "timestamp": "2013-07-07T14:35:13+00:00",
      "author": "steve6375",
      "content": "How about if there is no VMS vmdk already in the VM (and you have requested a USB drive to be attached) then it warns you?\n\n"
    },
    {
      "id": "174492",
      "timestamp": "2013-07-07T14:52:05+00:00",
      "author": "DavidB",
      "content": "Either your last idea or your previous with some modifications: in Add/Edit I add a combobox/checkbox to set what it will do, warn the user or not. The warning message will have also a checkbox with the same function. This way the user can get rid of the message but it can reenable it if he wants...  \nThe only downside is just for me, \u0027cause I have more work to do ![:D](http://reboot.pro/public/style_emoticons/default/biggrin.png) . But that\u0027s not a big problem.\n\n"
    },
    {
      "id": "174493",
      "timestamp": "2013-07-07T14:54:10+00:00",
      "author": "steve6375",
      "content": "Sorry, you shouldn\u0027t have created such a useful app! You have only yourself to blame! ![:loleverybody:](http://reboot.pro/public/style_emoticons/default/loleverybody.gif)\n\nP.S. prefer the Start check option as the user may have changed the VM since he last ran VMS...?\n\n"
    },
    {
      "id": "174495",
      "timestamp": "2013-07-07T15:04:59+00:00",
      "author": "DavidB",
      "content": "\u003e P.S. prefer the Start check option as the user may have changed the VM since he last ran VMS...?\n\nCould work but the problem is that I have to store somewhere the configuration of the last used VM. Only this way I can be really sure that it was changed or not. Because you can\u0027t count on the date of the file or the XML date; not even the checksum can\u0027t be used because maybe the user may just loaded the VM in VBM but without modifying the configuration - but VBM could still make some changes in the file..\n\nLE: but if you want something just simple as you said it\u0027s doable:\n\n\u003e How about if there is no VMS vmdk already in the VM (and you have requested a USB drive to be attached) then it warns you?\n\n\u003cbr /\u003e\n\n"
    },
    {
      "id": "174498",
      "timestamp": "2013-07-07T16:58:02+00:00",
      "author": "DavidB",
      "content": "1.2 Beta 2 version  \n\nLE: link removed, you can find a better version in the next posts...\n\n\u003cbr /\u003e\n\nChanges:  \n\nBugfix/Improvement: the code that checks again for vboxsvc.exe after killing was adapted to work on slower computers as well.  \nImprovement: if the VM doesn\u0027t have yet the VMSDrive\\*\\*\\*.vmdk attached and it finds other HDD\u0027s in the first positions in the storage controller(s) it warns the user it won\u0027t be able to boot from the first drive.\n\n"
    },
    {
      "id": "174515",
      "timestamp": "2013-07-08T06:20:10+00:00",
      "author": "DavidB",
      "content": "I think it looks a little better this way, isn\u0027t it...?\n\n[![Main.PNG](http://reboot.pro/uploads/monthly_07_2013/post-61891-0-61655900-1373264392_thumb.png)](http://reboot.pro/uploads/monthly_07_2013/post-61891-0-61655900-1373264392.png \"Main.PNG - Size: 12.57KB\"){#ipb-attach-url-14423-0-03773100-1676066420}\n\n"
    },
    {
      "id": "174523",
      "timestamp": "2013-07-08T10:24:04+00:00",
      "author": "steve6375",
      "content": "A small niggle - if the form does not have focus, then the selected VMS entry is not highlighted. This means I have to click on the form to select it first just to see what VMS is selected, and then click Start if the right one was already selected.\n\nIf I could see what VMS was selected when the form did not have focus, I could just click on Start straight away...\n\nAlso, personally, I would love a small column for the VT-x setting of each VM, this is because I usually have two VBox VMs, one with VT-x off and an identical one with VT-x on. This is because on my system, the stage 1 text mode install of XP crashes the VM if VT-x is enabled, but it runs OK (though slower) if VT-x is off. For stage 2 GUI-Mode and XP once installed, I run the VT-x ON VM as it is faster. I suppose this case is unique to me though...\n\n"
    },
    {
      "id": "174524",
      "timestamp": "2013-07-08T10:27:18+00:00",
      "author": "Blackcrack",
      "content": "looks cool + the suggestions from Steve \u003d really cool :wink:   \n"
    },
    {
      "id": "174525",
      "timestamp": "2013-07-08T12:13:59+00:00",
      "author": "DavidB",
      "content": "\u003e A small niggle - if the form does not have focus, then the selected VMS entry is not highlighted. This means I have to click on the form to select it first just to see what VMS is selected, and then click Start if the right one was already selected.\n\u003e\n\u003e If I could see what VMS was selected when the form did not have focus, I could just click on Start straight away...\n\nYes, it does that but the problem comes partially from the window behavior in Windows and from the Win7 theme. When the window (of any application) loses focus the selection is painted with a less visible color. Unfortunately, on the default Win7 theme, it\u0027s almost the same with the color of the even numbered rows.  \nI can try to disable the default window behavior but it\u0027s not so easy and it\u0027s not recommended.  \nOr I can try to change the color of the even numbered rows so they look different from the selected row but still help the user; but if I increase the brightness they will not be distinguished from the background, if I decrease it it will start to annoy the user.\n\n\u003cbr /\u003e\n\nI will try to find a solution...\n\n\u003e Also, personally, I would love a small column for the VT-x setting of each VM, this is because I usually have two VBox VMs, one with VT-x off and an identical one with VT-x on. This is because on my system, the stage 1 text mode install of XP crashes the VM if VT-x is enabled, but it runs OK (though slower) if VT-x is off. For stage 2 GUI-Mode and XP once installed, I run the VT-x ON VM as it is faster. I suppose this case is unique to me though...\n\nA problem: this parameter does not have anything to do with adding/removing the real drives from a VM.  \nIf in the future I will decide to show and even change other VM\u0027s parameters I will definitely have to change the interface.  \nI understand that it will help you a little but an easy solution is to create an entry for each of those 2 VMs in VMS and giving them suggestive names (\"... VT-x off\", \"... VT-x on\").\n\n"
    },
    {
      "id": "174526",
      "timestamp": "2013-07-08T12:27:25+00:00",
      "author": "steve6375",
      "content": "\u003e I will try to find a solution...\n\u003e\n\u003e A problem: this parameter does not have anything to do with adding/removing the real drives from a VM.\n\u003e\n\u003e If in the future I will decide to show and even change other VM\u0027s parameters I will definitely have to change the interface.  \n\u003e I understand that it will help you a little but an easy solution is to create an entry for each of those 2 VMs in VMS and giving them suggestive names (\"... VT-x off\", \"... VT-x on\").\n\nThanks!\n\nand\n\nThat\u0027s what I do already - no problem..it\u0027s just my usage is weird!\n\n"
    },
    {
      "id": "174528",
      "timestamp": "2013-07-08T12:58:32+00:00",
      "author": "DavidB",
      "content": "I have a solution for the selection problem: when VMS loses focus it will no longer paint the background of the even numbered rows. This way even the faint color of the selection will be still visible.\n\nFocused:\n\n[![Focused.PNG](http://reboot.pro/uploads/monthly_07_2013/post-61891-0-69714800-1373288267_thumb.png)](http://reboot.pro/uploads/monthly_07_2013/post-61891-0-69714800-1373288267.png \"Focused.PNG - Size: 13.05KB\"){#ipb-attach-url-14425-0-03800600-1676066420}\n\nUnfocused:\n\n[![Unfocused.PNG](http://reboot.pro/uploads/monthly_07_2013/post-61891-0-15930700-1373288267_thumb.png)](http://reboot.pro/uploads/monthly_07_2013/post-61891-0-15930700-1373288267.png \"Unfocused.PNG - Size: 12.04KB\"){#ipb-attach-url-14424-0-03786200-1676066420}\n\nIs it ok...?\n\n"
    },
    {
      "id": "174530",
      "timestamp": "2013-07-08T14:19:29+00:00",
      "author": "steve6375",
      "content": "![:good:](http://reboot.pro/public/style_emoticons/default/good.gif)\n\n"
    },
    {
      "id": "174537",
      "timestamp": "2013-07-08T17:28:16+00:00",
      "author": "DavidB",
      "content": "1.2 Beta 3 version  \n\nLE: link removed, you can find better version in the next posts..\n\n\u003cbr /\u003e\n\nChanges:  \n\nImprovement: \"VM type\" column replaced with icons.  \nImprovement: when the main window loses focus it will not change the background of even numbered entries.  \nImprovement: the background of the even numbered entries will be changed only if the number of entries is \\\u003e\u003d 5.\n\n"
    },
    {
      "id": "174556",
      "timestamp": "2013-07-09T07:29:30+00:00",
      "author": "DavidB",
      "content": "1.2 Beta 4 version  \n\n[![Attached File](http://reboot.pro/public/style_extra/mime_types/zip.gif)](http://reboot.pro/index.php?s\u003dbcf6541001be69e0378dcd1f2677c0d1\u0026app\u003dcore\u0026module\u003dattach\u0026section\u003dattach\u0026attach_id\u003d14427 \"Download attachment\") [**Virtual machine starter GUI exe.zip**](http://reboot.pro/index.php?s\u003dbcf6541001be69e0378dcd1f2677c0d1\u0026app\u003dcore\u0026module\u003dattach\u0026section\u003dattach\u0026attach_id\u003d14427 \"Download attachment\") **476.31KB** 459 downloads  \n\nChanges:  \n\nImprovement: better icon for VB VMs.  \nImprovement: with Up/Down arrows you can cycle from the beginning of the list if you reached the end or from the end if you reached the beginning.  \nBugfix: sometimes the icon of the VM was not showed.\n\n"
    },
    {
      "id": "174595",
      "timestamp": "2013-07-10T14:22:27+00:00",
      "author": "DavidB",
      "content": "If in a day or two nobody finds a bug or request an improvement, the next version will be the final version ![:D](http://reboot.pro/public/style_emoticons/default/biggrin.png)\n\n"
    },
    {
      "id": "174599",
      "timestamp": "2013-07-10T15:09:02+00:00",
      "author": "Zoso",
      "content": "\u003e If in a day or two nobody finds a bug or request an improvement, the next version will be the final version ![:D](http://reboot.pro/public/style_emoticons/default/biggrin.png)\n\nwhat does that mean? are you getting bored with it now and saying you quit? I would like to test more but I cant do it in \"a day or two\" as I have another big project that is taking alot of time.  \n\ndont be in such a rush LOL its really cool what you are doing and I think it will take time for people to find and start using it but at some point I think it will be a popular tool.  \n\nslow down and keep perfect it.   \n"
    },
    {
      "id": "174600",
      "timestamp": "2013-07-10T15:18:25+00:00",
      "author": "DavidB",
      "content": "Don\u0027t worry, I\u0027m not bored and not in a rush but the thing is most of the users are usually waiting for the final version, because they consider the Beta versions unsafe. Partly they\u0027re right...\n\nOk, I will wait...\n\nOh, btw, have you solved the \"dismount\" problem...?\n\n"
    },
    {
      "id": "174618",
      "timestamp": "2013-07-11T01:56:03+00:00",
      "author": "Zoso",
      "content": "meant to say ...keep perfecting it in my previous post.   \n\n\u003cbr /\u003e\n\nNo, I didnt solve the dismount and that was where I left off. then I went to vmplayer and plop just to get a quick test in on a usb boot something that I was trying to figure out. sorry I can be more specific but I have been working on so many different things at once Im a bit scatter brained right now.  \n\nit started with trying to figure out how to get ewf working in XPx64 and now Im struggling with .VHD booting 7 because I dont want to install it for usage, I just want to reverse engineer the ewf components to try to get them working in XPx64. w7 is all new to me and I do not like one bit so far but in the last few days I went from complete novice to semi advanced user of 7 just trying to get a basic grip on the thing so I can pick up where they left off on XPx64.   \n\nat some point though I will be using your new tool a lot because I like Qemu and VB more than the others and I need the functionality that you are providing with this tool. it will take a while for me to get there though but when I do it looks like VMS will be one of the tools in my top drawer!  \n\nIm not sure that VMS is the best name though is it? I mean, it does that but it is more so USB tool I think. may need USB in the name, no? anyway.. keep up the great work! I think you are onto something.   \n"
    },
    {
      "id": "174619",
      "timestamp": "2013-07-11T02:36:45+00:00",
      "author": "DavidB",
      "content": "Of course I will keep perfecting it. But from time to time I think that\u0027s wise to release final versions instead of a \"forever Beta\"...  \n\nA few days ago I tried VMS in Windows XP x64 SP2. It worked flawlessly.  \nIn the error message about dismounting, VMS is also showing other informations, like \"Possible reason:...\" or \"System message:...\". What does it show on your computer?  \n\nYes, \"VMS\" is not the best name but not the worst either. Somewhere in between... ![:D](http://reboot.pro/public/style_emoticons/default/biggrin.png)\n\n"
    },
    {
      "id": "174620",
      "timestamp": "2013-07-11T02:49:54+00:00",
      "author": "Zoso",
      "content": "I just dloaded your latest stable version so next time I boot up my XPx64 partition I\u0027ll try again and report back.   \n"
    },
    {
      "id": "174634",
      "timestamp": "2013-07-11T14:00:11+00:00",
      "author": "DavidB",
      "content": "Steve, do you like surprises...? ![:D](http://reboot.pro/public/style_emoticons/default/biggrin.png)\n\n"
    },
    {
      "id": "174636",
      "timestamp": "2013-07-11T14:38:59+00:00",
      "author": "steve6375",
      "content": "urm... sometimes.... ![:dubbio:](http://reboot.pro/public/style_emoticons/default/dubbio.gif)\n\ndepends if it is a nice one or a nasty one!\n\n"
    },
    {
      "id": "174638",
      "timestamp": "2013-07-11T14:53:53+00:00",
      "author": "DavidB",
      "content": "1.2 Beta 5 version\n\nLE: link removed, you can find a better version in the next posts...  \n\nChanges:  \n\nImprovement: just one but it\u0027s important. I will let you find what it is... ![:D](http://reboot.pro/public/style_emoticons/default/biggrin.png)\n\n"
    },
    {
      "id": "174640",
      "timestamp": "2013-07-11T14:59:32+00:00",
      "author": "Blackcrack",
      "content": "whoot , were.. a surprice ?? oh, i have hungry \\*bg\\* a chicken or an Turkey ?.. i have biiig hungry \\*bg\\*  \nor maybe a big familiypizzaaa ???? ![:crazyrocker:](http://reboot.pro/public/style_emoticons/default/crazyrocker.gif)  \ncommon, get the surprice.. \\*lol\\* ![:tabletalk:](http://reboot.pro/public/style_emoticons/default/tabletalk.gif) ![:happy_dance:](http://reboot.pro/public/style_emoticons/default/celebrate14.gif)\n\n![:party_time:](http://reboot.pro/public/style_emoticons/default/signsandflags30.gif) ![:happy_dance2:](http://reboot.pro/public/style_emoticons/default/celebrate3.gif) ![:newyear:](http://reboot.pro/public/style_emoticons/default/newyear.gif)\n\nedit :\n\nuhm to late..\n\nwas only a programm, nothing to eat ! humm..\n\n\\*very big grin\\*\n\nedit 2:\n\nthanks \\*bg\\*\n\nbest regards\n\nBlacky\n\n**Edited by Blackcrack, 11 July 2013 - 03:05 PM.**\n"
    },
    {
      "id": "174641",
      "timestamp": "2013-07-11T15:43:43+00:00",
      "author": "steve6375",
      "content": "![:clap:](http://reboot.pro/public/style_emoticons/default/clap.gif) ![:good:](http://reboot.pro/public/style_emoticons/default/good.gif) ![:1st:](http://reboot.pro/public/style_emoticons/default/1st.gif) - great! Now I can leave VB Manager open all the time!\n\nThanks !!!! That is much much better!\n\nNot to look a gift horse in the mouth, **but**does the VMS form have to disappear so soon after clicking \u0027Start\u0027 and ostensibly \u0027nothing happens\u0027 for about 10-15 seconds...\n\nCould you not show some progress report on the form (or maybe a pop-up window) so we know what is happening. It would also be useful for problem reporting too, but the main thing is to provide some feedback to the user of what is going on before the VM actually runs. It would also help the user understand just what VMS does\n\ne.g. progress reporting like...\n\nchecking VBox VM exists..OK\n\nAdding USB drive 1 (WD Passprot 1.8TB) to VM xxx.. OK\n\nAdding USB drive 2 (USB 2GB) to VM xxxx.. OK\n\nChecking if Vbox service is running.. OK\n\ndismounting USB drive xxx..OK\n\ndismounting USB drive yyy..OK\n\nrunning VM xxx...OK\n\nIt would give the user more confidence when running the app for the first time.\n\nP.S. Have a think about the name too. \u0027Virtual Machine Starter for USB drives\u0027 or something like that??\n\n"
    },
    {
      "id": "174642",
      "timestamp": "2013-07-11T16:09:07+00:00",
      "author": "Blackcrack",
      "content": "now we need drivers for booting in usb for WinXP for automatical using the usb as normal storage ... Win7 should work in a usb easy\n\nbut i did not testing it now.. have here only 3x4Gig \\\u0026 3x8gig Gig Sticks therewith i mus use XP.. Win7 is too big..\n\nbut i don\u0027t have usb-stiorage drivers or how does it the PE Win XP ? With an USB-Storage too ?\n\nit should prepare for booting over usb like an pe-System .. .. with usb-storage drivers ? how works it ?\n\nbest regards\n\nBlacky\n\n"
    },
    {
      "id": "174644",
      "timestamp": "2013-07-11T16:26:17+00:00",
      "author": "DavidB",
      "content": "\u003e edit 2:\n\u003e\n\u003e thanks \\*bg\\*\n\u003e\n\u003e best regards\n\u003e\n\u003e Blacky\n\nYou\u0027re welcome.\n\n\u003e ![:clap:](http://reboot.pro/public/style_emoticons/default/clap.gif) ![:good:](http://reboot.pro/public/style_emoticons/default/good.gif) ![:1st:](http://reboot.pro/public/style_emoticons/default/1st.gif) - great! Now I can leave VB Manager open all the time!\n\u003e\n\u003e Thanks !!!! That is much much better!\n\u003e\n\u003e Not to look a gift horse in the mouth, **but**does the VMS form have to disappear so soon after clicking \u0027Start\u0027 and ostensibly \u0027nothing happens\u0027 for about 10-15 seconds...\n\u003e\n\u003e Could you not show some progress report on the form (or maybe a pop-up window) so we know what is happening. It would also be useful for problem reporting too, but the main thing is to provide some feedback to the user of what is going on before the VM actually runs. It would also help the user understand just what VMS does\n\u003e\n\u003e e.g. progress reporting like...\n\u003e\n\u003e checking VBox VM exists..OK\n\u003e\n\u003e Adding USB drive 1 (WD Passprot 1.8TB) to VM xxx.. OK\n\u003e\n\u003e Adding USB drive 2 (USB 2GB) to VM xxxx.. OK\n\u003e\n\u003e Checking if Vbox service is running.. OK\n\u003e\n\u003e dismounting USB drive xxx..OK\n\u003e\n\u003e dismounting USB drive yyy..OK\n\u003e\n\u003e running VM xxx...OK\n\u003e\n\u003e It would give the user more confidence when running the app for the first time.\n\u003e\n\u003e P.S. Have a think about the name too. \u0027Virtual Machine Starter for USB drives\u0027 or something like that??\n\nYou\u0027re welcome.\n\nOn my computer the VM is loading in about 3..4 sec\n\nMost of this time is VB loading the VM, so logging during this stage won\u0027t help much since I can\u0027t show how VB is loading its internal components...\n\nBut I will think about that.\n\nToo long name... Maybe \"VM starter for USB drives\"... Although is not only for USB drives...\n\n"
    },
    {
      "id": "174646",
      "timestamp": "2013-07-11T16:38:10+00:00",
      "author": "Blackcrack",
      "content": "maybe .. VBox-USB-Controller or VBox-USB-Starter .. or something ?\n\nbest regards\n\nBlacky\n\n"
    },
    {
      "id": "174668",
      "timestamp": "2013-07-12T01:15:54+00:00",
      "author": "DavidB",
      "content": "\u003e maybe .. VBox-USB-Controller or VBox-USB-Starter .. or something ?\n\u003e\n\u003e best regards\n\u003e\n\u003e Blacky\n\nNot so bad but one problem: although it\u0027s used mostly with VirtualBox, it works also with Qemu...\n\n"
    },
    {
      "id": "174676",
      "timestamp": "2013-07-12T05:50:29+00:00",
      "author": "Blackcrack",
      "content": "eehhmm right.. Emusb-Controler \\*lol\\* Emulation USB Starter :smile: or QBox-USB-Starter or VEmu-USB-Starter\n\nor maybe instead of \"Starter\" maybe \"Controler\" or \"centre\" .. maby can add other fitures and make it\n\nas a 2nd VBox/QEmu Controling Center .. who support both .. an Gui for QEmu and a gui for VBox with enhancements ...\n\nwho can build by own configurations and works with plugins who can any writeing his own plugin for make it more enhanced / with Extension as plugins ..\n\nby side i have show\n\nthis interresting article :\n\n[http://reboot.pro/to...tall-xp-in-vhd/](http://reboot.pro/topic/18547-vhd-xp-setup-install-xp-in-vhd/ \"\")\n\ninside it is the solver of the \"XP boot from usb\" problem and this should make as installer for easy copy on usb and install behind if it is install XP as usb-trubleshooter for booting on an usb-stick like usb-stick oooorrr.. usb-drive :wink:..\n\ncan make anyone this as installer or \"USB-XP-%placeholder-name%-Tools\" ? \\*bG\\*\n\nfor easy start XP from USB ? [http://reboot.pro/fi...tall-xp-in-vhd/](http://reboot.pro/files/file/315-vhd-xp-setup-install-xp-in-vhd/ \"\")\n\na simply exe for installing the vblogdrivers (as support vor vhd-images for mounting :wink: as hint) and install\n\nthe usb-XP booting fix + the usb-stragedrivers.. like i have see, be it regestry strings and an drivers, this maybe as\n\none single exe-installer file ? For copy on the next shutdown on the usb-stick or usb-hd and installing on an VBox/Qemu instance ? to enable XP it for booting this stick or usb-drive for booting with this XP\n\nbest regards\n\nBlacky\n\n**Edited by Blackcrack, 12 July 2013 - 06:01 AM.**\n"
    },
    {
      "id": "174700",
      "timestamp": "2013-07-12T15:29:40+00:00",
      "author": "DavidB",
      "content": "1.2 Beta 6 version  \n\nLE: link removed, youcan find a better version in the next posts...  \nChanges:  \n\nImprovement: name changed to \"Virtual Machine USB Boot\". So far this seems to be the best name...  \nImprovement: since I implemented drag\u0027n\u0027drop in the list the Up/Down buttons are not so useful anymore so I moved them into the list context menu and assigned them Alt+Up/Down key combinations.  \nImprovement: added Options button + window where you can set a few general options.  \nImprovement: some settings for the entries were moved from Add/Edit into Options: Lock, VirtualBox/Qemu exe path and Method to update the VM cfg file.  \nImprovement: by default it doesn\u0027t ask/show the second drive anymore, only if you set it in Options.  \nImprovement: you can set the default Qemu command line parameters for any new Qemu entry.  \nBugfix: solved a problem with the command line parameters for vboxmanage.exe.  \n\nI\u0027m thinking of moving also \"Wait time for flush data\" from Add/Edit into Options. The only reason against could be: for some (USB) drives the user may change this value to compensate for the drive\u0027s Read/Write speed difference...  \nWhat do you think...?  \n\nA small problem.  \nI thought the last VirtualBox version fixed the fast restart bug. Well, it did, but not 100%. In some situations still crashes when it\u0027s restarted too fast.  \nIf you use the previous method of updating the vbox file it will not crash because it\u0027s waiting for the vboxsvc.exe to close.  \nBut with the vboxmanage method I can\u0027t use the same fix because vboxsvc.exe could be from VirtualBox Manager and not from VirtualBox VM.  \nI will try to find a way to fix it but it\u0027s not that easy...\n\n"
    },
    {
      "id": "174726",
      "timestamp": "2013-07-13T06:05:56+00:00",
      "author": "DavidB",
      "content": "I promised I will think about showing a log window after clicking on Start. And I did.  \n\nIt\u0027s a good idea but implementing it in the current version has some problems: the code is currently designed to use only one thread. But 2 threads are needed: one for the code which configures and starts the VM and one for the log window. This way the user can interact with the log window. Without it, the log window will be rarely painted and can be rarely accessed.  \nNow, I can create the log window in the second thread, which is not a good idea, or I can move the start code in it. It\u0027s a lot of work to do that but, what\u0027s more important, using multiple threads in any (Windows) application is decreasing the stability of that application. That\u0027s because you have to be very careful to not let the threads access resources simultaneously (this will crash the application). Mathematically is impossible to achieve this 100% but you can achieve an acceptable/good percentage. The downside is: this will degrade the overall performance a bit and it\u0027s a pain to code...\n\nPlus the already mentioned problem: most of this time it\u0027s just loading the VirtualBox VM so there will be no message displayed in this \"part\"...  \n\nMaybe in a future version I will implement this but for now the application will display this message when you click on the Start button:  \n\n[![aw5fts.png](http://i44.tinypic.com/aw5fts.png)](http://postimg.org/image/dhcyebt4r/ \"External link\")\n\nBtw, I had to use an external host for the image since the reboot uploader doesn\u0027t seem to work for this image...\n\n"
    },
    {
      "id": "174782",
      "timestamp": "2013-07-14T11:24:13+00:00",
      "author": "DavidB",
      "content": "1.2 Beta 7 version  \n\nLE: link removed, you can find better version in the next posts.  \n\nChanges:  \n\nImprovement: the code which changes the text brightness in a different column was a little improved.  \nImprovement: a flash drive icon was added to the drive column.  \nImprovement: a message informing the user about the delays (after clicking on the Start button) was added.  \nImprovement: when vboxmanage is used to update the VM configuration file, also checks if the VM is already started.  \nImprovement: found a way to minimize the chances of a VB crash when it\u0027s restarted too fast (the VB fast restart bug).  \nBugfix: fixed a bug in the code that extracts the ID and path of the VirtualBox VM from the exe parameters.  \nPlus some other minor bugfixes and improvements...\n\n"
    },
    {
      "id": "174784",
      "timestamp": "2013-07-14T13:25:23+00:00",
      "author": "Blackcrack",
      "content": "tip :  \n\n```\nC:\\\u003eset\nALLUSERSPROFILE\u003dC:\\ProgramData\nAPPDATA\u003dC:\\Users\\blackcrack\\AppData\\Roaming\nCommonProgramFiles\u003dC:\\Program Files (x86)\\Common Files\nCommonProgramFiles(x86)\u003dC:\\Program Files (x86)\\Common Files\nCommonProgramW6432\u003dC:\\Program Files\\Common Files\nCOMPUTERNAME\u003dBLACKYSGATE2\nComSpec\u003dC:\\Windows\\system32\\cmd.exe\nFP_NO_HOST_CHECK\u003dNO\nHOMEDRIVE\u003dC:\nHOMEPATH\u003d\\Users\\blackcrack\nLOCALAPPDATA\u003dC:\\Users\\blackcrack\\AppData\\Local\nLOGONSERVER\u003d\\\\BLACKYSGATE2\nNUMBER_OF_PROCESSORS\u003d4\nOS\u003dWindows_NT\nPath\u003dC:\\Program Files (x86)\\PC Connectivity Solution\\;C:\\Program Files (x86)\\NVIDIA Corporation\\PhysX\\Common;C:\\Windows\\\nsystem32;C:\\Windows;C:\\Windows\\System32\\Wbem;C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\;C:\\Users\\blackcrack\\AppData\\Loc\nal\\Bandizip\\7z\nPATHEXT\u003d.COM;.EXE;.BAT;.CMD;.VBS;.VBE;.JS;.JSE;.WSF;.WSH;.MSC\nPROCESSOR_ARCHITECTURE\u003dx86\nPROCESSOR_ARCHITEW6432\u003dAMD64\nPROCESSOR_IDENTIFIER\u003dAMD64 Family 21 Model 1 Stepping 2, AuthenticAMD\nPROCESSOR_LEVEL\u003d21\nPROCESSOR_REVISION\u003d0102\nProgramData\u003dC:\\ProgramData\nProgramFiles\u003dC:\\Program Files (x86)\nProgramFiles(x86)\u003dC:\\Program Files (x86)\nProgramW6432\u003dC:\\Program Files\nPROMPT\u003d$P$G\nPSModulePath\u003dC:\\Windows\\system32\\WindowsPowerShell\\v1.0\\Modules\\\nPUBLIC\u003dC:\\Users\\Public\nSESSIONNAME\u003dConsole\nSystemDrive\u003dC:\nSystemRoot\u003dC:\\Windows\nTEMP\u003dC:\\Users\\BLACKC~1\\AppData\\Local\\Temp\nTMP\u003dC:\\Users\\BLACKC~1\\AppData\\Local\\Temp\nUSERDOMAIN\u003dblackysgate2\nUSERNAME\u003dblackcrack\nUSERPROFILE\u003dC:\\Users\\blackcrack\nVBOX_INSTALL_PATH\u003dC:\\Program Files\\Oracle\\VirtualBox\\\nwindir\u003dC:\\Windows\nwindows_tracing_flags\u003d3\nwindows_tracing_logfile\u003dC:\\BVTBin\\Tests\\installpackage\\csilogfile.log\n__COMPAT_LAYER\u003dElevateCreateProcess\n\nC:\\\u003e\n```\n\nVBOX_INSTALL_PATH\u003dC:\\\\Program Files\\\\Oracle\\\\VirtualBox\\\\\n\nso gives Variables who you can work there with also :smile:  \nthis can you use to insert in the Options of you program where it is installed the Virtualbox  \nby side can you set the :  \nqemu_INSTALL_PATH\u003dC:\\\\Program Files\\\\Qemu\\\\  \n\ntherewith can you work with %QEMU_INSTALL_PATH% and %VBOX_INSTALL_PATH% ..  \nVBOX_INSTALL_PATH by installed vbox and QEMU_INSTALL_PATH by config of the USer..  \n\nmaybe can you create other variables by setting up own variables like  \n\nadd in the code  \n\nqemu_INSTALL_PATH \u003d QEMU_INSTALLDIR  \nVBOX_INSTALL_PATH \u003d VBOX_INSTALLDIR  \n\nfor having own and changable variables(easy changeable/updatable) in future :wink:  \n\nif have QEmu later own install-path can you remove the variable set  \nand can use from Qemu like them from VBox :wink:  \n\nthe VBox exist now as VBOX_INSTALL_PATH and this can you use for automatic find the VirtualBox.exe :wink:\n\n2. The 2nd drive, maybe make possibily to select an own iso or host-CDrom/DVD/Blueray Drive and USB-drive ?\n\non vbox automatical select the 2.nd drive from VBox or maybe managed full the vboxdrives directly ...\n\non qemu make possible to use the 2nd as iso or Host-CDromdrive, so both selectable iso or drive .. Iso, USB, Host-CDrom/DVD or other ..  \n\nbest regards  \nBlacky\n\n**Edited by Blackcrack, 14 July 2013 - 01:37 PM.**\n"
    },
    {
      "id": "174785",
      "timestamp": "2013-07-14T14:01:04+00:00",
      "author": "steve6375",
      "content": "\u003e 1.2 Beta 7 version  \n\u003e\n\u003e ![attachicon.gif](http://reboot.pro/public/style_images/master/attachicon.gif)[Virtual Machine USB Boot exe.zip](http://reboot.pro/index.php?app\u003dcore\u0026module\u003dattach\u0026section\u003dattach\u0026attach_rel_module\u003dpost\u0026attach_id\u003d14441 \"\")  \n\u003e\n\u003e Changes:  \n\u003e\n\u003e Improvement: the code which changes the text brightness in a different column was a little improved.  \n\u003e Improvement: a flash drive icon was added to the drive column.  \n\u003e Improvement: a message informing the user about the delays (after clicking on the Start button) was added.  \n\u003e Improvement: when vboxmanage is used to update the VM configuration file, also checks if the VM is already started.  \n\u003e Improvement: found a way to minimize the chances of a VB crash when it\u0027s restarted too fast (the VB fast restart bug).  \n\u003e Bugfix: fixed a bug in the code that extracts the ID and path of the VirtualBox VM from the exe parameters.  \n\u003e Plus some other minor bugfixes and improvements...\n\nIs this the portable version? I get no pre-defined VMS entries???\n\n"
    },
    {
      "id": "174786",
      "timestamp": "2013-07-14T14:05:01+00:00",
      "author": "DavidB",
      "content": "\u003e Is this the portable version? I get no pre-defined VMS entries???\n\nNo, it\u0027s the portable version.\n\nIf you have problem with the vml file make sure that it has the same name with the exe and it\u0027s in the same folder.\n\nIf still not working, please send me the vml file.\n\n"
    },
    {
      "id": "174787",
      "timestamp": "2013-07-14T14:12:43+00:00",
      "author": "DavidB",
      "content": "\u003e tip :  \n\u003e\n\u003e ```\n\u003e\n\u003e\n\u003e\n\u003e C:\\\u003eset\n\u003e ALLUSERSPROFILE\u003dC:\\ProgramData\n\u003e APPDATA\u003dC:\\Users\\blackcrack\\AppData\\Roaming\n\u003e CommonProgramFiles\u003dC:\\Program Files (x86)\\Common Files\n\u003e CommonProgramFiles(x86)\u003dC:\\Program Files (x86)\\Common Files\n\u003e CommonProgramW6432\u003dC:\\Program Files\\Common Files\n\u003e COMPUTERNAME\u003dBLACKYSGATE2\n\u003e ComSpec\u003dC:\\Windows\\system32\\cmd.exe\n\u003e FP_NO_HOST_CHECK\u003dNO\n\u003e HOMEDRIVE\u003dC:\n\u003e HOMEPATH\u003d\\Users\\blackcrack\n\u003e LOCALAPPDATA\u003dC:\\Users\\blackcrack\\AppData\\Local\n\u003e LOGONSERVER\u003d\\\\BLACKYSGATE2\n\u003e NUMBER_OF_PROCESSORS\u003d4\n\u003e OS\u003dWindows_NT\n\u003e Path\u003dC:\\Program Files (x86)\\PC Connectivity Solution\\;C:\\Program Files (x86)\\NVIDIA Corporation\\PhysX\\Common;C:\\Windows\\\n\u003e system32;C:\\Windows;C:\\Windows\\System32\\Wbem;C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\;C:\\Users\\blackcrack\\AppData\\Loc\n\u003e al\\Bandizip\\7z\n\u003e PATHEXT\u003d.COM;.EXE;.BAT;.CMD;.VBS;.VBE;.JS;.JSE;.WSF;.WSH;.MSC\n\u003e PROCESSOR_ARCHITECTURE\u003dx86\n\u003e PROCESSOR_ARCHITEW6432\u003dAMD64\n\u003e PROCESSOR_IDENTIFIER\u003dAMD64 Family 21 Model 1 Stepping 2, AuthenticAMD\n\u003e PROCESSOR_LEVEL\u003d21\n\u003e PROCESSOR_REVISION\u003d0102\n\u003e ProgramData\u003dC:\\ProgramData\n\u003e ProgramFiles\u003dC:\\Program Files (x86)\n\u003e ProgramFiles(x86)\u003dC:\\Program Files (x86)\n\u003e ProgramW6432\u003dC:\\Program Files\n\u003e PROMPT\u003d$P$G\n\u003e PSModulePath\u003dC:\\Windows\\system32\\WindowsPowerShell\\v1.0\\Modules\\\n\u003e PUBLIC\u003dC:\\Users\\Public\n\u003e SESSIONNAME\u003dConsole\n\u003e SystemDrive\u003dC:\n\u003e SystemRoot\u003dC:\\Windows\n\u003e TEMP\u003dC:\\Users\\BLACKC~1\\AppData\\Local\\Temp\n\u003e TMP\u003dC:\\Users\\BLACKC~1\\AppData\\Local\\Temp\n\u003e USERDOMAIN\u003dblackysgate2\n\u003e USERNAME\u003dblackcrack\n\u003e USERPROFILE\u003dC:\\Users\\blackcrack\n\u003e VBOX_INSTALL_PATH\u003dC:\\Program Files\\Oracle\\VirtualBox\\\n\u003e windir\u003dC:\\Windows\n\u003e windows_tracing_flags\u003d3\n\u003e windows_tracing_logfile\u003dC:\\BVTBin\\Tests\\installpackage\\csilogfile.log\n\u003e __COMPAT_LAYER\u003dElevateCreateProcess\n\u003e\n\u003e C:\\\u003e\n\u003e ```\n\u003e\n\u003e VBOX_INSTALL_PATH\u003dC:\\\\Program Files\\\\Oracle\\\\VirtualBox\\\\\n\u003e\n\u003e so gives Variables who you can work there with also :smile:  \n\u003e this can you use to insert in the Options of you program where it is installed the Virtualbox  \n\u003e by side can you set the :  \n\u003e qemu_INSTALL_PATH\u003dC:\\\\Program Files\\\\Qemu\\\\  \n\u003e\n\u003e therewith can you work with %QEMU_INSTALL_PATH% and %VBOX_INSTALL_PATH% ..  \n\u003e VBOX_INSTALL_PATH by installed vbox and QEMU_INSTALL_PATH by config of the USer..  \n\u003e\n\u003e maybe can you create other variables by setting up own variables like  \n\u003e\n\u003e add in the code  \n\u003e\n\u003e qemu_INSTALL_PATH \u003d QEMU_INSTALLDIR  \n\u003e VBOX_INSTALL_PATH \u003d VBOX_INSTALLDIR  \n\u003e\n\u003e for having own and changable variables(easy changeable/updatable) in future :wink:  \n\u003e\n\u003e if have QEmu later own install-path can you remove the variable set  \n\u003e and can use from Qemu like them from VBox :wink:  \n\u003e\n\u003e the VBox exist now as VBOX_INSTALL_PATH and this can you use for automatic find the VirtualBox.exe :wink:\n\u003e\n\u003e 2. The 2nd drive, maybe make possibily to select an own iso or host-CDrom/DVD/Blueray Drive and USB-drive ?\n\u003e\n\u003e on vbox automatical select the 2.nd drive from VBox or maybe managed full the vboxdrives directly ...\n\u003e\n\u003e on qemu make possible to use the 2nd as iso or Host-CDromdrive, so both selectable iso or drive .. Iso, USB, Host-CDrom/DVD or other ..  \n\u003e\n\u003e best regards  \n\u003e Blacky\n\nI know about VBOX_INSTALL_PATH, it\u0027s already used (for example if there is no cfg). But thank you.\n\n2. The application is made (for now) to attach and dismount/mount real HDD/USB drives. So things VirtualBox doesn\u0027t know how to do or only know manually.\n\nThere is no gain adding this in the application since you can change/add real/virtual CDROM very easy in VirtualBox Manager.\n\n"
    },
    {
      "id": "174788",
      "timestamp": "2013-07-14T14:26:18+00:00",
      "author": "steve6375",
      "content": "\u003e No, it\u0027s the portable version.\n\u003e\n\u003e If you have problem with the vml file make sure that it has the same name with the exe and it\u0027s in the same folder.\n\u003e\n\u003e If still not working, please send me the vml file.\n\nOK - sorted - renaming vml fixed it. ![:good:](http://reboot.pro/public/style_emoticons/default/good.gif)\n\n"
    },
    {
      "id": "174789",
      "timestamp": "2013-07-14T14:31:51+00:00",
      "author": "Blackcrack",
      "content": "oh prima.. i want reply for this too.. works by me well too.. since the name changing :smile:\n\n"
    },
    {
      "id": "174828",
      "timestamp": "2013-07-15T19:28:47+00:00",
      "author": "DavidB",
      "content": "I\u0027m thinking about changing the icon of the application. The current one doesn\u0027t suggest much \"Virtual Machine\", \"USB\" and \"Boot\".  \nI searched a lot but couldn\u0027t find an icon for all three. I found sometimes for 2 but ugly or not free.  \nAny suggestions...?\n\n"
    },
    {
      "id": "174831",
      "timestamp": "2013-07-15T21:44:44+00:00",
      "author": "steve6375",
      "content": "Maybe a logo of \u0027VMUB\u0027 - it is easier to remember than Virtual Machine USB Boot? Or have a symbol of a USB \u0027three-pronged fork\u0027 inside a computer screen?\n\nI am not the best person to ask as my graphics skills equal my one-handed clapping skills...\n\n"
    },
    {
      "id": "174834",
      "timestamp": "2013-07-15T23:28:49+00:00",
      "author": "DavidB",
      "content": "\u003e Maybe a logo of \u0027VMUB\u0027 - it is easier to remember than Virtual Machine USB Boot? Or have a symbol of a USB \u0027three-pronged fork\u0027 inside a computer screen?\n\nNot a bad idea...\n\n\u003e I am not the best person to ask as my graphics skills equal my one-handed clapping skills...\n\nMine too ![:(](http://reboot.pro/public/style_emoticons/default/sad.png) ![:D](http://reboot.pro/public/style_emoticons/default/biggrin.png)\n\nI find it much easier to code than drawing something...\n\nLet\u0027s try something else: a drawing competition/contest. Whoever designs the best logo/icon wins a 10 year license.\n\nOops, this will not work, it\u0027s free to use ![:D](http://reboot.pro/public/style_emoticons/default/biggrin.png)\n\n"
    },
    {
      "id": "174853",
      "timestamp": "2013-07-16T17:04:58+00:00",
      "author": "DavidB",
      "content": "1.2 Beta 8 version  \n\nLE: link removed, you can find a better version in the next posts...\n\nChanges:  \n\nThe name of the drive(s) added by the application was changed from VMSDrive\\*\\*\\*.vmdk to VMUBDrive\\*\\*\\*.vmdk.  \nA small problem: the already attached VMSDrive\\*\\*\\*.vmdk drives have to be detached and deleted manually.  \nBugfix: a small problem was solved in the code that sets the main window maximized if the application was previously closed in a maximized state.  \nImprovement: the detection of the Qemu installation was improved.  \nBugfix: when the main window was resized the buttons were not 100% symmetrical positioned.\n\n"
    },
    {
      "id": "174862",
      "timestamp": "2013-07-17T10:23:49+00:00",
      "author": "Brito",
      "content": "\u003e Let\u0027s try something else: a drawing competition/contest.\n\u003e\nHi, this is actually possible.\n\nI can announce in the weekly reboot newsletter that you need help with the logo design. In the past, members like TheHive have actually come up with very good designs but would be better to start a new topic to avoid getting this one too long for other folks know what was discussed here.\n\nAlso, why not publishing this project on the downloads arena at \u003chttp://reboot.pro/files\u003e ?\n\n![:cheers:](http://reboot.pro/public/style_emoticons/default/cheers.gif)\n\n"
    },
    {
      "id": "174863",
      "timestamp": "2013-07-17T10:56:48+00:00",
      "author": "DavidB",
      "content": "\u003e Hi, this is actually possible.\n\u003e\n\u003e I can announce in the weekly reboot newsletter that you need help with the logo design. In the past, members like TheHive have actually come up with very good designs but would be better to start a new topic to avoid getting this one too long for other folks know what was discussed here.\n\u003e\n\u003e Also, why not publishing this project on the downloads arena at \u003chttp://reboot.pro/files\u003e ?\n\u003e\n\u003e ![:cheers:](http://reboot.pro/public/style_emoticons/default/cheers.gif)\n\nThank you.\n\nI will think about that...\n\n"
    },
    {
      "id": "174864",
      "timestamp": "2013-07-17T14:34:55+00:00",
      "author": "DavidB",
      "content": "A good friend of mine helped me modify the current icon:\n\n[![Drives-Machine-HD-icon7.png](http://reboot.pro/uploads/monthly_07_2013/post-61891-0-21055900-1374071618_thumb.png)](http://reboot.pro/uploads/monthly_07_2013/post-61891-0-21055900-1374071618.png \"Drives-Machine-HD-icon7.png - Size: 481.08KB\"){#ipb-attach-url-14443-0-24999800-1676066420}\n\n[![Attached File](http://reboot.pro/public/style_extra/mime_types/gif.gif)](http://reboot.pro/index.php?s\u003da18388db2699a2a4ceb0e9b1a65cf7bf\u0026app\u003dcore\u0026module\u003dattach\u0026section\u003dattach\u0026attach_id\u003d14444 \"Download attachment\") [**Drives-Machine-HD-icon7.ico**](http://reboot.pro/index.php?s\u003da18388db2699a2a4ceb0e9b1a65cf7bf\u0026app\u003dcore\u0026module\u003dattach\u0026section\u003dattach\u0026attach_id\u003d14444 \"Download attachment\") **361.4KB** 571 downloads\n\nSeems better, isn\u0027t it, guys...?\n\n"
    },
    {
      "id": "174866",
      "timestamp": "2013-07-17T14:47:04+00:00",
      "author": "Blackcrack",
      "content": "100k\u00275 sweet/nice a fully plugin ![wasserpfeife.gif](http://www.root86.org/images/smilies/wasserpfeife.gif) Image \\*bG\\*\n\nbest regards\n\nBlacky\n\n"
    },
    {
      "id": "174872",
      "timestamp": "2013-07-18T07:27:19+00:00",
      "author": "DavidB",
      "content": "1.2 Beta 9 version  \n\nLE: link removed, you can find a better version in the next posts...\n\nChanges:  \n\nImprovement: the icon was changed. I hope most of you will like it...  \n(VB) Bugfix: Usually a vboxmanage command is carried out in 1..2 sec but I noticed that sometimes it takes longer. VMUB waits about 3 sec then shows a progress window and waits another 12 sec.\n\n"
    },
    {
      "id": "174874",
      "timestamp": "2013-07-18T07:52:08+00:00",
      "author": "Blackcrack",
      "content": "just we are need have only XP-USB-Storage bugfix as exe-installer file and ssd-usb\u0027s with usb3 \\*bG\\* 3gig/s transfear ! 8)\n\nor have anyone a link for some installer xp-usb-storage-bugfixer-singleinstaller ? Or can create someone some files/installer ? \\*please\\*\n\nbest regards\n\nBlacky\n\n"
    },
    {
      "id": "174875",
      "timestamp": "2013-07-18T08:28:54+00:00",
      "author": "DavidB",
      "content": "Sorry, Blackcrack, I can\u0027t help you ![:(](http://reboot.pro/public/style_emoticons/default/sad.png)\n\nNot that I don\u0027t want to, I do, but because I never experimented installing Windows on a flash drive, so I\u0027m totally \"outside\" this subject...\n\nI use Linux instead (for several good reasons).\n\nPlus I don\u0027t have usb3 or ssd on my computer anyway (only usb2 and old HDD) so I can\u0027t test it even if I new how to modify it...\n\n"
    },
    {
      "id": "174876",
      "timestamp": "2013-07-18T08:57:55+00:00",
      "author": "Blackcrack",
      "content": "do not be sad, maby it is an other one who can help you for supporting XP on USB as Independed running XP and not as PEWin..\n\nAn real installed XP have the advantage/benefit that one can install and clean btw customizing anytime and anywere !\n\nthis should be another programmer already worth, that there may be such a \"XP-USB-Storage.exe\" assembles for all and as support for all place it on this tread as support for you too :wink:\n\nthis with the ssd and usb3 it is an driverthing :wink: it is naturaly not support by you, but it can add the drivers on the \"XP-USB-Storage.exe\"\n\nif anyone assembled such an thing :wink:\n\nso, don\u0027t worry, this board is biiii... huuughe :wink: Maybe knows Nuno someone who can backe some\n\nusb for XP Storage driver-bugfix-installer as single file ?\n\n(Nuno, by side, i have became at last a frendship question, and have klick it by side.. but now i don\u0027t find it..gnh..)\n\nbest regards\n\nBlacky\n\n**Edited by Blackcrack, 18 July 2013 - 08:59 AM.**\n"
    },
    {
      "id": "174897",
      "timestamp": "2013-07-19T09:06:35+00:00",
      "author": "DavidB",
      "content": "1.2 final version:\n\n[![Attached File](http://reboot.pro/public/style_extra/mime_types/zip.gif)](http://reboot.pro/index.php?s\u003da18388db2699a2a4ceb0e9b1a65cf7bf\u0026app\u003dcore\u0026module\u003dattach\u0026section\u003dattach\u0026attach_id\u003d14446 \"Download attachment\") [**Virtual Machine USB Boot 1.2 setup.zip**](http://reboot.pro/index.php?s\u003da18388db2699a2a4ceb0e9b1a65cf7bf\u0026app\u003dcore\u0026module\u003dattach\u0026section\u003dattach\u0026attach_id\u003d14446 \"Download attachment\") **956.27KB** 488 downloads\n\n[![Attached File](http://reboot.pro/public/style_extra/mime_types/zip.gif)](http://reboot.pro/index.php?s\u003da18388db2699a2a4ceb0e9b1a65cf7bf\u0026app\u003dcore\u0026module\u003dattach\u0026section\u003dattach\u0026attach_id\u003d14448 \"Download attachment\") [**Virtual Machine USB Boot 1.2 portable.zip**](http://reboot.pro/index.php?s\u003da18388db2699a2a4ceb0e9b1a65cf7bf\u0026app\u003dcore\u0026module\u003dattach\u0026section\u003dattach\u0026attach_id\u003d14448 \"Download attachment\") **627.34KB** 547 downloads\n\n[![Attached File](http://reboot.pro/public/style_extra/mime_types/zip.gif)](http://reboot.pro/index.php?s\u003da18388db2699a2a4ceb0e9b1a65cf7bf\u0026app\u003dcore\u0026module\u003dattach\u0026section\u003dattach\u0026attach_id\u003d14449 \"Download attachment\") [**VirtuaI Machine USB Boot 1.2 sources.zip**](http://reboot.pro/index.php?s\u003da18388db2699a2a4ceb0e9b1a65cf7bf\u0026app\u003dcore\u0026module\u003dattach\u0026section\u003dattach\u0026attach_id\u003d14449 \"Download attachment\") **240.86KB** 477 downloads\n\nChanges: basically is Beta 9 with just some small adjustments.\n\nWhen I will find some time and energy to make a presentation I will publish it at \u003chttp://reboot.pro/files\u003e\n\n"
    },
    {
      "id": "174901",
      "timestamp": "2013-07-19T11:04:38+00:00",
      "author": "Blackcrack",
      "content": "nice ![:1st:](http://reboot.pro/public/style_emoticons/default/1st.gif)\n\nneed only to say in the description maybe to be need a driver/USB-Storage-bugfix-package if used WinXP on usb\n\n(maybe want create anyone it for that :wink: )\n\nif it\u0027s offizially on the File-download and in the Destription is write a need only a fixpack for XP for installing.. because XP it\u0027s realy small and perfectly as win32 NT for usb :smile: by side of Linux i586 :smile:\n\nthank you very mutch for this Final :smile:\n\nbest regards\n\nBlacky\n\n"
    },
    {
      "id": "174916",
      "timestamp": "2013-07-20T00:35:31+00:00",
      "author": "Zoso",
      "content": "hi David, Im trying to figure out how to make VB boot a USB Flashdrive prepared by rufus or Winntsetup with W7.ISO and install W7 to a USB HDD.  \n\nsince W7 refuses to install on USB HDD Im trying to figure out a workaround. I was using .vhd for install but I dont know how to image the VHD and restore that image on USB HDD.  \n\nis there a way your tool can add both USB drives and select boot order to specify which one boots?  \n\nalso do you know if I can make VB think the USB HDD is not a USB like Qemu does?  \n\nI may try it with Qemu and your tool again but from past experience Qemu is very very slow doinga windows install.  \n\nnice job on the icon! I was thinking about a combat boot image with a USB symbol on it LOL but I havnt had my graphics software installed in ages.  \n\nedit: DUH.. I see the latest has exactly what I mentioned (add another USB) testing now..  \n\nedit#2: Dude! its working! installing w7 directly to USB now..   \n"
    },
    {
      "id": "174918",
      "timestamp": "2013-07-20T01:35:07+00:00",
      "author": "DavidB",
      "content": "Hi, Zoso.\n\nI was about to answer when I saw your 2 edits.\n\nGlad that you found how to add the second drive. If later you want to change the boot order you can swap them in the Edit window.\n\nRegarding \"if I can make VB think the USB HDD is not a USB\" I don\u0027t think that would be a problem as long as you don\u0027t check the USB drive in VirtualBox Manager \\\u003e\\\u003e VM Settings \\\u003e\\\u003e USB \\\u003e\\\u003e Add filter from device.\n\n"
    },
    {
      "id": "174919",
      "timestamp": "2013-07-20T02:01:57+00:00",
      "author": "Zoso",
      "content": "installing from USB Flash to USB HDD worked on without a hitch! Im using VB on W7 on this and will test the same procedure on XPx64 later.  \n\n\u003e When I will find some time and energy to make a presentation I will publish it at \u003chttp://reboot.pro/files\u003e\n\nseems to be ready for prime time! its very easy and intuitive program to use.  \n\nmakes VB 10x more useful! Thanks again.   \n"
    },
    {
      "id": "174920",
      "timestamp": "2013-07-20T02:38:51+00:00",
      "author": "DavidB",
      "content": "\u003e installing from USB Flash to USB HDD worked on without a hitch! Im using VB on W7 on this and will test the same procedure on XPx64 later.  \n\u003e\n\u003e \u003cbr /\u003e\n\u003e\n\u003e seems to be ready for prime time! its very easy and intuitive program to use.  \n\u003e\n\u003e makes VB 10x more useful! Thanks again.\n\nYou\u0027re welcome :smile:\n\n"
    },
    {
      "id": "174940",
      "timestamp": "2013-07-20T18:12:35+00:00",
      "author": "DavidB",
      "content": "New version and thread:\n\n[http://reboot.pro/fi...chine-usb-boot/](http://reboot.pro/files/file/339-virtual-machine-usb-boot/ \"\")\n\n[http://reboot.pro/to...-boot/?p\u003d174939](http://reboot.pro/topic/18736-virtual-machine-usb-boot/?p\u003d174939 \"\")\n\n"
    },
    {
      "id": "183921",
      "timestamp": "2014-04-27T14:01:09+00:00",
      "author": "Blackcrack",
      "content": "Hi,  \n\noh nice, a News in an German ComputerNews COM!  \n\n\u003cbr /\u003e\n\n[![img_0001.png](http://www.blackysgate.de/bilder/thumb.php?base\u003d75\u0026file\u003dimages/vm-usb-boot/img_0001.png)](http://www.blackysgate.de/bilder/images/vm-usb-boot/img_0001.png \"External link\") [![img_0002.png](http://www.blackysgate.de/bilder/thumb.php?base\u003d75\u0026file\u003dimages/vm-usb-boot/img_0002.png)](http://www.blackysgate.de/bilder/images/vm-usb-boot/img_0002.png \"External link\")  \n\nbest regards  \nBlacky   \n"
    },
    {
      "id": "183926",
      "timestamp": "2014-04-27T15:16:09+00:00",
      "author": "steve6375",
      "content": "Please add to WishList - A way of starting VBox and specifying the 2nd Hard disk as the boot disk.\n\n**The Problem**\n\nNormally, when booting from a USB drive, the USB drive is hd0 in the BIOS, but once an OS has booted, the internal hard disk is HD0 and the USB drive is seen as 2nd (or later) drive. With VMUB, the first drive is the USB drive in all situations:\n\n**Result**\n\nWhen installing an OS to the VBox virtual hard disk and booting from VMUB in VBox, the boot files are placed on the USB drive by the OS installer (because it is seen as the 1st hard disk). This makes the USB drive unbootable (or at least it doesn\u0027t boot as expected any more) !\n\nIf only VBox had a way of specifying booting from the 2nd hard disk - we could boot set up VBox so that it boots like a normal system\n\nAn alternative would be to have an **option** in VMUB to swap over the two drives - i.e.\n\nhd0 - Vdisk\n\nhd1 - USB vmdk\n\nThen display a message telling the user they must select 2nd drive in VBox BIOS manually as the boot device, in order to boot from USB drive.\n\nP.S. Congratulations DavidB on getting into Com! magazine ![:clap:](http://reboot.pro/public/style_emoticons/default/clap.gif)\n\nP.P.S Only problem is grub4dos USB drive gives a \u0027missing MBR Helper\u0027 if it is not drive 0 when booting in VBox! Is this a bug in VirtualBox BIOS or grub boot code?\n\n"
    },
    {
      "id": "183938",
      "timestamp": "2014-04-27T19:18:09+00:00",
      "author": "eblip",
      "content": "\u003e Please add to WishList - A way of starting VBox and specifying the 2nd Hard disk as the boot disk.\n\u003e\n\u003e **The Problem**\n\u003e\n\u003e Normally, when booting from a USB drive, the USB drive is hd0 in the BIOS, but once an OS has booted, the internal hard disk is HD0 and the USB drive is seen as 2nd (or later) drive. With VMUB, the first drive is the USB drive in all situations:\n\u003e\n\u003e **Result**\n\u003e\n\u003e When installing an OS to the VBox virtual hard disk and booting from VMUB in VBox, the boot files are placed on the USB drive by the OS installer (because it is seen as the 1st hard disk). This makes the USB drive unbootable (or at least it doesn\u0027t boot as expected any more) !\n\u003e\n\u003e If only VBox had a way of specifying booting from the 2nd hard disk - we could boot set up VBox so that it boots like a normal system\n\u003e\n\u003e An alternative would be to have an **option** in VMUB to swap over the two drives - i.e.\n\u003e\n\u003e hd0 - Vdisk\n\u003e\n\u003e hd1 - USB vmdk\n\u003e\n\u003e Then display a message telling the user they must select 2nd drive in VBox BIOS manually as the boot device, in order to boot from USB drive.\n\u003e\n\u003e P.S. Congratulations DavidB on getting into Com! magazine ![:clap:](http://reboot.pro/public/style_emoticons/default/clap.gif)\n\u003e\n\u003e P.P.S Only problem is grub4dos USB drive gives a \u0027missing MBR Helper\u0027 if it is not drive 0 when booting in VBox! Is this a bug in VirtualBox BIOS or grub boot code?\n\nEven though I used the VHD method you recommended over a year ago as a work around for this issue, I\u0027ve always wanted to come back to this post and thank DavidB and everyone else for their amazing work with the vBox USB boot tool. I\u0027ve used it dozens of times and it\u0027s been incrededibly useful.\n\nSo I\u0027d too like to congratulate DavidB on getting some attention to your hard work in the Com! magazine.\n\nSorry it took me so long to express my thanks.\n\nSteve, your work is amazing as well. RMPrepUSB is one of my favorite tools. Keep up the great work.\n\n"
    },
    {
      "id": "189509",
      "timestamp": "2014-12-31T15:12:34+00:00",
      "author": "sebus",
      "content": "Any plans to have\nVirtual Machine USB Boot\n\nported to Mac?\n\nsebus\n\n"
    },
    {
      "id": "189515",
      "timestamp": "2014-12-31T16:41:35+00:00",
      "author": "DavidB",
      "content": "Well, couple of times I tried to port VMUB from Delphi 7 to Lazarus. This way you can compile it to Linux and Mac.  \nThe problem is VMUB uses many API Windows functions which need to be replaced with Linux/Mac functions.  \nBut I couldn\u0027t find any decent help/documentation for Linux/Mac in Lazarus.  \nDelphi has great help files (detailed explanations and examples) plus you can find many sites with informations + many forums.  \nLazarus has poor help files + their forum is not that good. I posted there a few times and... nothing useful.  \n\nJust an example: Total Commander. It was developed in Delphi 2 and recently it was ported into Lazarus (for the 64 bit version). But the author never released a Linux/Mac version (same problems).\n\n"
    },
    {
      "id": "189517",
      "timestamp": "2014-12-31T18:57:19+00:00",
      "author": "sebus",
      "content": "Pity, it would be very handy\n\nsebus\n\n"
    },
    {
      "id": "189518",
      "timestamp": "2014-12-31T19:11:57+00:00",
      "author": "erwan.l",
      "content": "To compile to other platforms you could have a look at deplhi xe or crossfpc.  \nI am currently moving my sources to xe to be able to compile for x64.   \n"
    },
    {
      "id": "189519",
      "timestamp": "2014-12-31T21:11:56+00:00",
      "author": "DavidB",
      "content": "For VMUB it won\u0027t be much improvement if it\u0027s made 64 bit. The main reason is because it\u0027s not using more than 5 MB of RAM.  \nAbout half a year ago I started testing a conversion for Delphi XE5 but I concluded it\u0027s not worth the work.  \nReasons:  \n1. No speed improvement + increased RAM usage. For VMUB anyway, I noticed speed improvements for other apps using a lot of RAM.  \n2. XE5 is about 100 times the size of 7 plus it has a \"heavy\" interface. There is a noticeable drop in the speed and the stability of the OS after installation.  \n3. I don\u0027t have a few thousand Euro to buy a license.  \n4. I don\u0027t even have money to buy a Mac to test. And, since I have an AMD processor, I can\u0027t even use VirtualBox or VMware to emulate one.  \n5. Since you can\u0027t compile for Linux also, the potential \"market\" is only half.  \n6. The Mac source compilation is relatively new (added to the XE versions only in the last few years), so less support, fewer forums.  \n\nAnd Crossfpc has its own limitations...\n\n"
    },
    {
      "id": "207744",
      "timestamp": "2018-09-17T04:07:12+00:00",
      "author": "Gerolf",
      "content": "In post #14, DavidB suggests \"a solution: Using mountvol command to dismount USB drive\u0027s volume(s) before starting the VM and to mount them again after closing the VM. All can be done in a batch file so it will be very easy to use...\"\n\nI tried to write such a script (for booting Qemu, not VBox). Basically it works, but the main problem remains: Writings done to the pendrive from within the virtual machine are still not permanent and thus unvisible to the host system afterwards. Where is my mistake?\n\nBest regards,\n\nGerolf\n\n-------------------\n\nQemuBoot.cmd\n\n```\n@echo off\n:: QemuBoot.cmd revision 1 by Gerolf D. Brettschneider (2018/09/17)\n:: http://reboot.pro/topic/18217-booting-virtualbox-with-usb-workaround/\n\n:main ------------------------------------------------------------------------\nsetlocal\nif \"%1\"\u003d\u003d\"/?\" (echo.\n  echo QemuBoot, called without arguments, will temporarily dismount current\n  echo volume %~d0, map the physical drive it resides on to a virtual hard \n  echo disk and boot the latter in Qemu, setting the virtual machine\u0027s RAM\n  echo size to 512 MiB and searching the Qemu binary ^(from WeilNetz.de or\n  echo RMPrepUSB.com^) in its default location. QemuBoot must be run in ad-\n  echo ministrator mode: Copy it to the target drive and right-click on it.\n  echo.\n  echo Three optional arguments are supported for elevated command prompt:\n  echo %%1: drive letter ^(with colon^) of bootable ^(USB^) drive,\n  echo %%2: Qemu memory size ^(integer^),\n  echo %%3: Qemu binary ^(including path^) \u0026 goto :EOF)\nif \"%1\"\u003d\u003d\"\" (set logdrv\u003d%~d0) else (set logdrv\u003d%1)\nif \"%logdrv%\"\u003d\u003d\"%SystemDrive%\" echo Cannot QemuBoot system drive \u0026\u0026 goto :end\ncall :wwmic %logdrv% physdrv\nif \"%physdrv%\"\u003d\u003d\"0\" echo Cannot QemuBoot physical drive 0 \u0026\u0026 goto :end\nif \"%physdrv%\"\u003d\u003d\"-1\" echo Cannot QemuBoot logical drive %logdrv% \u0026\u0026 goto :end\nREM echo Logical drives:\nREM wmic logicaldisk get caption, description, freespace, size, volumename\nREM echo Physical drives:\nREM wmic diskdrive get caption, deviceID, partitions\nif \"%2\"\u003d\u003d\"\" (set mem\u003d512) else (set mem\u003d%2)\nsetlocal enabledelayedexpansion\n  if \"%~3\"\u003d\u003d\"\" (set bin\u003d\"%ProgramFiles%\\qemu\\qemu-system-x86_64.exe\"\n    if not exist !bin! set bin\u003d\"%ProgramFiles%\\qemu\\qemu-system-i386.exe\"\n    if not exist !bin! set bin\u003d\"%ProgramFiles(x86)%\\RMPrepUSB\\QEMU\\qemu.exe\"\n  ) else (set bin\u003d\"%~3\")\nendlocal \u0026 set bin\u003d%bin%\nif not exist %bin% echo Cannot find Qemu binary. \u0026\u0026 goto :end\necho. \u0026 echo About to QemuBoot physical drive %physdrv%, temporarily\necho dismounting current volume %logdrv% that resides on it. \necho Press Ctrl+C to cancel or any other key to continue . . . \u0026 pause \u003e nul\ncall :wqemu %physdrv% %logdrv% %mem% %bin%\n:end\nset mem\u003d\u0026 set bin\u003d\u0026 set logdrv\u003d\u0026 set physdrv\u003d\nendlocal \u0026 pause\ngoto :EOF\n\n:wqemu :: Wrap \"qemu\" and \"mountvol\" -----------------------------------------\n:: %1: physical drive number, %2: volume letter (with colon), \n:: %3: Qemu memory size (integer), %4: Qemu binary (including path)\nset script\u003d%TMP%\\QB%RANDOM%.cmd\n:: https://stackoverflow.com/questions/4051883/\n::   batch-script-how-to-check-for-admin-rights/27083926#27083926\nnet session \u003enul 2\u003e nul\nif _%errorlevel%\u003d\u003d_0 (  \n (echo @echo off \u0026 echo pushd %TMP%\n  echo set volID\u003d%TMP%\\QB%RANDOM%.tmp\n  REM Save volume ID:\n  echo mountvol %2 /L ^\u003e %%volID%%\n  REM Two ways to dismount the volume (the first ignores other partitions):\n      echo mountvol %2 /P\n  REM echo ^(echo select volume\u003d%2 ^\u0026 echo remove all dismount^) ^| diskpart\n  echo set arg\u003dfile\u003d\\\\.\\PhysicalDrive%1,if\u003dide,index\u003d0,media\u003ddisk,format\u003draw\n  echo %4 -L . -boot c -m %3 -drive %%arg%%  \n  echo set /p test\u003d^\u003c%%volID%%\n  echo mountvol %2 %%test%%\n  echo if exist %%volID%% del %%volID%%\n  echo set arg\u003d\u0026 echo set test\u003d\u0026 echo set volID\u003d\n  echo popd) \u003e %script%  \n  REM echo. \u0026 type %script% \u0026 echo. \u0026 pause\n  echo.\n  echo Volume %logdrv% was unmounted. Please close QEMU before continuing\n  echo and wait for volume %logdrv% to be remounted. Do not cancel this batch\n  echo process now. Otherwise drive %logdrv% remains inaccessible, and it is\n  echo necessary to reassign a drive letter to it in Windows Disk Management.\n  echo. \n  %script%\n  REM start %script%\n  echo Done. \u0026 echo.\n) else (echo. \u0026 echo Please restart QemuBoot in administrator mode.)  \nif exist %script% del %script%\nset script\u003d\ngoto :EOF\n\n:wwmic :: Wrap \"wmic\" to get physical drive number ---------------------------\n:: %1: drive letter with colon, %2: variable name for returned physical drive\n:: https://msfn.org/board/topic/\n::   174825-get-disk-number-from-drive-letter-in-cmd/?\n::     do\u003dfindComment\u0026comment\u003d1112752\nset LDTP\u003dWin32_LogicalDiskToPartition\u0026 set %2\u003d-1\nfor /F \"tokens\u003d2 delims\u003d#,\" %%? in (\n  \u0027wmic Path %LDTP% Get Antecedent^,Dependent ^|find /I \"%1\"\u0027) do (set %2\u003d%%?)\nset LDTP\u003d\ngoto :EOF\n```\n\n\u003cbr /\u003e\n\n"
    },
    {
      "id": "207745",
      "timestamp": "2018-09-17T08:57:03+00:00",
      "author": "Wonko the Sane",
      "content": "I am not sure to understand.\n\nBesides mounting an unmounting, the data seemingly needs to be flushed to the USB device, see post #19 by DavidB.\n\nSo, I believe you need to use \\*something like\\* Uwe Sieber\u0027s FFB:\n\n[https://www.uwe-sieb...ivetools_e.html](https://www.uwe-sieber.de/drivetools_e.html \"External link\")\n\nMaybe that is the issue? ![:unsure:](http://reboot.pro/public/style_emoticons/default/unsure.png)\n\nBut what is the problem using the tool by DavidB?\n\n![:duff:](http://reboot.pro/public/style_emoticons/default/duff.gif)\n\nWonko\n\n"
    },
    {
      "id": "207752",
      "timestamp": "2018-09-17T18:38:11+00:00",
      "author": "Gerolf",
      "content": "I am happy that DavidB provided a working solution for the non-writing problem, but if possible I would prefer a light-weight script using Windows tools that are already present. Does this need a justification? I do not need a GUI for my purposes, I want to understand what happens here, and I am more familiar with scripting languages.\n\nI see that Steve Si tried to flush data to the USB device in his StartFromUSB.cmd script for RMPrepUSB:\n\n```\n...\nREM Flush cache (esp. if NTFS filesystem still writing cache to slow disks)\nsync 2\u003e nul\n...\n```\n\nObviously this does not help as you can see when you stop suppressing the error message generated by sync.exe (at least on Windows 10, 64 bit). DavidB uses this code for flushing (found in start_VM.dpr within \"QEMU Starter source.zip\", post #44):\n\n```\nprocedure FlushToDisk(sDriveLetter: Char);\nvar\n   hDrive: THandle;\nbegin\n   hDrive :\u003d 0;\n   try\n      hDrive :\u003d CreateFile(PAnsiChar(\u0027\\\\.\\\u0027 + sDriveLetter + \u0027:\u0027), GENERIC_READ or\n         GENERIC_WRITE, FILE_SHARE_READ or FILE_SHARE_WRITE, nil,\n         OPEN_EXISTING, 0, 0);\n      FlushFileBuffers(hDrive);\n   finally\n      CloseHandle(hDrive);\n   end;\nend;\n```\n\nI do not understand why this flushing should be required (except for safety) as USB devices by default are not cached (see Device Manager). Moreover, it is not the host machine\u0027s writes to the USB device that always get lost but those of the virtual machine. Okay, I will spend some time investigating this, in the hope I can find a Windows command for flushing, but at the moment I wonder whether DavidB\u0027s dismounting routine does some magic the mountvol or diskpart commands omit:\n\n```\nfunction DismountVolume(ADrive: char): Boolean;\nconst\n   FSCTL_DISMOUNT_VOLUME \u003d (9 shl 16) or (0 shl 14) or (8 shl 2) or 0;\nvar\n   VolumeName: string;\n   BytesReturned: Cardinal;\nbegin\n   Result :\u003d False;\n   VolumeName :\u003d Format(\u0027\\\\.\\%s:\u0027, [ADrive]);\n   SetLength(VolumesHandles, Length(VolumesHandles) + 1);\n   VolumesHandles[High(VolumesHandles)] :\u003d CreateFile(PChar(VolumeName), GENERIC_READ or GENERIC_WRITE,\n      FILE_SHARE_READ or FILE_SHARE_WRITE, nil, OPEN_EXISTING, 0, 0);\n   if VolumesHandles[High(VolumesHandles)] \u003d INVALID_HANDLE_VALUE then\n   begin\n      LastError :\u003d GetLastError;\n      Exit;\n   end;\n   Result :\u003d DeviceIoControl(VolumesHandles[High(VolumesHandles)], FSCTL_DISMOUNT_VOLUME, nil, 0,\n      nil, 0, BytesReturned, nil);\n   if not Result then\n      LastError :\u003d GetLastError;\nend;\n```\n\nAt least I haven\u0027t studied yet what must be known about the FSCTL_DISMOUNT_VOLUME stuff. Is there a kind of device lock if no flushing was done before dismounting?\n\nGerolf\n\n"
    },
    {
      "id": "207753",
      "timestamp": "2018-09-18T01:07:13+00:00",
      "author": "Gerolf",
      "content": "In the meantime I downloaded a newer sync.exe (the one shipped with RMPrepUSB dates from 1999) from live.sysinternals.com. (The new one, called without arguments, doesn\u0027t give an error message and positively lists which volumes are being flushed. The USB volume is missing unless its drive letter is given as argument.) Next I downloaded FFB.exe from uwe-sieber.de. In both cases I tested the 32 and 64 bit versions and also inserted a \"timeout 2\", but results are the same: It doesn\u0027t help. So I\u0027m getting the impression that a missing cache flushing is not the issue.\n\nGerolf\n\n"
    },
    {
      "id": "207754",
      "timestamp": "2018-09-18T09:32:09+00:00",
      "author": "Wonko the Sane",
      "content": "\u003e I am happy that DavidB provided a working solution for the non-writing problem, but if possible I would prefer a light-weight script using Windows tools that are already present. Does this need a justification? I do not need a GUI for my purposes, I want to understand what happens here, and I am more familiar with scripting languages.\n\nOf course you don\u0027t need any justification :smile: and - from my personal point of view - using scripting language is a very good thing, I asked to understand if you had found a particular issue/problem bug in the existing solution, possibly using it under a newish Windows version.\n\n![:duff:](http://reboot.pro/public/style_emoticons/default/duff.gif)\n\nWonko\n\n"
    },
    {
      "id": "207758",
      "timestamp": "2018-09-18T15:06:31+00:00",
      "author": "cdob",
      "content": "\u003e So I\u0027m getting the impression that a missing cache flushing is not the issue.\nNo solution, more questions:  \nDoes win 10 rescan the USB file system, if the USB device is reconnected after qemu run?  \nOr does win 10 restore the file system, before qemu did run?  \n\nWhat happens, if you run mountvol disconnect, qemu, close qemu.  \nDisconnect the USB device physically and reconnect the USB device?  \n\nNext step: run mountvol disconnect, qemu, close qemu,  \nGoto device manager, disable the USB drive and enable the USB drive.  \nWhat happens?   \n"
    },
    {
      "id": "207759",
      "timestamp": "2018-09-18T15:29:00+00:00",
      "author": "Gerolf",
      "content": "Just returning from my jogging tour, and this comes close to what I decided to investigate today. I saw that FFB.exe also offers support for \"-d -f\" switches to \"force dismount\" - but then fails to do this here. So I wonder if there are different states of being dismountable or dismounted a USB device might get into - or if my script, already being too complex, just imposes a kind of nesting error.\n\nGerolf\n\n\u003cbr /\u003e\n\n"
    },
    {
      "id": "207760",
      "timestamp": "2018-09-18T21:36:57+00:00",
      "author": "Gerolf",
      "content": "As you can see in the :wqemu routine, my QemuBoot.cmd script mainly generates a temporary batch file named %TMP%\\\\QB%RANDOM%.cmd that gets executed afterwards. It resolves a few variables for the particular machine it runs on. On my old desktop PC which has several hard disks it looks like this (removing \"@echo off\" at the beginning, a pushd-popd pair, and three variable unsets at the end):\n\n```\nset volID\u003dC:\\Users\\Gerolf\\AppData\\Local\\Temp\\QB884.tmp\nmountvol O: /L \u003e %volID%\nmountvol O: /P\nset arg\u003dfile\u003d\\\\.\\PhysicalDrive7,if\u003dide,index\u003d0,media\u003ddisk,format\u003draw\n\"C:\\Program Files\\qemu\\qemu-system-i386.exe\" -L . -boot c -m 512 -drive %arg%\nset /p test\u003d\u003c%volID%\nmountvol O: %test%\nif exist %volID% del %volID%\n```\n\nSo everything strips down to just eight command lines that can be run as a batch file from the system drive at an elevated command prompt. I see the \"-L .\" must be removed as argument here to let Qemu start. The \"mountvol O: /P\" can be replaced with \"(echo select volume\u003dO: \\\u0026 echo remove all dismount) \\| diskpart\" or \"FFB O: -d -f\", the latter at least working here. But the non-writing error already appears at this point.  \n\nGoing to bed now...\n\nGerolf\n\n"
    },
    {
      "id": "207761",
      "timestamp": "2018-09-18T22:24:30+00:00",
      "author": "steve6375",
      "content": "Presumably the USB drive has only one volume/partition and it is an NTFS volume?\n\n"
    },
    {
      "id": "207763",
      "timestamp": "2018-09-19T01:40:02+00:00",
      "author": "Gerolf",
      "content": "Couldn\u0027t sleep, your questions still being unanswered. Yes, my USB drive has one single NTFS partition, and I made it Grub4DOS bootable using Rufus. The newer versions of Windows 10 again are able to assign drive letters to more than one partition on such a device, I guess, like it was the case in the days of Windows 98/ME, but I havent\u0027t tried this yet. So the \"remove all dismount\" method using diskpart will be the best to deal with this option, and more care must be taken then to reassign multiple drive letters. This would be a problem to solve later.  \n\n\"Does win 10 rescan the USB file system, if the USB device is reconnected after qemu run? Or does win 10 restore the file system, before qemu did run?\" - If I cancel the batch file to kill the Qemu process, my drive O: remains inaccessible, and I have to restore the drive letter using Disk Management; but if I finish Qemu itself, the batch run continues, and \"mountvol O: %test%\" gives access to the drive. I think a rescan takes place then, not a restore, but how could I test? Maybe I do not understand your question. By the way, this mountvol command and the previous \"mountvol O: /P\" are audible, letting the mechanical drives rumble.  \n\nI split up my eight-liner into three parts to follow your suggestion of unplugging or disabling the USB device temporarily. I added pause commands so that I can start these batches via right-clicking in Windows Explorer and still read the command lines and possible error messages (mountvol says \"access denied\" if no administrator privileges are given, dismounts the drive anyhow, but Qemu cannot start then, and remounting fails):\n\nunmount.cmd:\n\n```\nset volID\u003d%TMP%\\QB884.tmp\nmountvol O: /L \u003e %volID%\nmountvol O: /P\nREM (echo select volume\u003dO: \u0026 echo remove all dismount) | diskpart\nREM FFB O: -d -f\npause\n```\n\nqemurun.cmd:\n\n```\nset arg\u003dfile\u003d\\\\.\\PhysicalDrive7,if\u003dide,index\u003d0,media\u003ddisk,format\u003draw\n\"%ProgramFiles%\\qemu\\qemu-system-i386.exe\" -boot c -m 512 -drive %arg%\npause\n```\n\nremount.cmd:\n\n```\nset volID\u003d%TMP%\\QB884.tmp\nset /p test\u003d\u003c%volID%\nmountvol O: %test%\nif exist %volID% del %volID%\npause\n```\n\nNow I can run these batch files one after another and also temporarily unplug or disable the USB device, either before or after executing qemurun.cmd, but whatever I do, I cannot write a file to the USB device from within Qemu. Onto a VHD, I have installed MS-DOS 5.0, which quickly boots up into DOSSHELL. When I press Alt+F4 to exit, a message windows pops up that I had never seen before, saying: \"Initilization File Error. There was an error writing the file DOSSHELL.INI; changes were not saved to disk at this time.\" And now this happens again and again.  \n\nGerolf\n\n"
    },
    {
      "id": "207764",
      "timestamp": "2018-09-19T07:29:34+00:00",
      "author": "Wonko the Sane",
      "content": "... and, if you repeat the attempt with exactly the same stick, the same OS and the same Qemu command, but using the original tool by DavidB it works?\n\n![:duff:](http://reboot.pro/public/style_emoticons/default/duff.gif)\n\nWonko\n\n"
    },
    {
      "id": "207772",
      "timestamp": "2018-09-19T20:53:01+00:00",
      "author": "Gerolf",
      "content": "Yes. I created this MS-DOS 5.0 VHD in VirtualBox, copied it to a USB pendrive, created a MENU.LST entry, and could boot to DOS under Qemu from RMPrepUSB without problems. There was no such error message box when leaving DOSSHELL. I modified AUTOEXEC.BAT and CONFIG.SYS, and everything worked fine and wasn\u0027t forgotten after the next VHD boot.  \n\nAs I did not use RMPrepUSB for anything else than starting Qemu, I tried to find a more direct way to do this, from the scripting level and without the help of RMPrepUSB, but then stumbled over this write lock problem and saw that Steve made use of a binary named start_VM.exe in his StartFromUSB.cmd script.  \n\nFor direct comparison with my other scripts and in order to simplify things, I can take the start_VM.exe that is contained in \"QEMU Starter exe.zip\" (post #44) and place it somewhere within the binary search path, e.g. in the %windir% folder, and create a small wrapper script just providing the parameters start_VM.exe needs:  \n\nstart_VM_run.cmd:\n\n```\nset arg\u003dfile\u003d\\\\.\\PhysicalDrive7,if\u003dide,index\u003d0,media\u003ddisk,format\u003draw\nstart_VM 7 500 \"%ProgramFiles%\\qemu\\qemu-system-i386.exe\" -boot c -m 512 -drive %arg%\npause\n```\n\nI also have to right-click on this script in Windows Explorer and run it as administrator to get Qemu running, but this works as desired. For example, I can type \"COPY CON HELLO.TXT\"\\\u003cEnter\\\u003e and \"HELLO WORLD\"\\\u003cF6\\\u003e\\\u003cEnter\\\u003e at the DOS prompt to create a file. After closing Qemu and finishing the wrapper script, this file can be found in Windows Explorer if the VHD gets attached in Windows Disk Management.  \n\nDoes anybody dare to check out these mini-scripts on his or her own computer? I did not suffer any loss of data during my experiments, except for the DOSSHELL.INI and HELLO.TXT inside the VHD when not using start_VM.exe. Of course the volume letter (O:) and the physical drive number (7) must be corrected for other machines. You won\u0027t tell me that only the Oracle of Delphi knows the solution to this problem, at the price of 411 KiB, will you?\n\nGerolf\n\n"
    },
    {
      "id": "207778",
      "timestamp": "2018-09-20T17:08:58+00:00",
      "author": "Wonko the Sane",
      "content": "So, the issue is not Windows 10 or some other \"peculiar\" settings in your environment, good :smile: (which in this case means bad ![:(](http://reboot.pro/public/style_emoticons/default/sad.png))\n\nI am short of possible ideas, only one that comes to my mind is using instead of mountvol good ol\u0027 dosdev .\n\nBut then probably the volume cannot be re-mounted without removal/insertion or something like mountstorPE or showdrive will be needed? ![:dubbio:](http://reboot.pro/public/style_emoticons/default/dubbio.gif)\n\nSome reference, JFYI:\n\n[http://reboot.pro/to...-line-possible/](http://reboot.pro/topic/10169-resolvedmount-hidden-partition-command-line-possible/ \"\")\n\n![:duff:](http://reboot.pro/public/style_emoticons/default/duff.gif)\n\nWonko\n\n"
    },
    {
      "id": "207802",
      "timestamp": "2018-09-22T21:22:40+00:00",
      "author": "Gerolf",
      "content": "The fifth dismounting alternative then would be \"chkdsk O: /X\" (for my computer), as DavidB suggests in post #13. I\u0027m just taking a closer look at his stat_VM.dpr code (in \"QEMU Starter Sources.zip\", post #44):\n\n```\n...\nvar VolLet: array of Char;\n...\nfor i :\u003d 0 to High(VolLet) do begin\n   FlushToDisk(VolLet[i]);\n   Sleep(WaitTime);\n   if not DisMountVolume(VolLet[i]) then\n      if MessageBox(0, PChar(\u0027Unable to dismount volume \u0027\u0027\u0027 + VolLet[i] + \n        \u0027\u0027\u0027 !\u0027#13#10\u0027Possible reason: \u0027 + SysErrorMessage(LastError) + \n        #13#10\u0027Are you sure you want to continue...?\u0027), \n        PChar(\u0027Warning\u0027), MB_YESNO or MB_ICONWARNING or MB_DEFBUTTON2) \u003d mrNO\n      then Exit; \nend;\n...   \nif CreateProcessW(nil, zAppName, nil, nil, false, CREATE_NEW_CONSOLE or\n   HIGH_PRIORITY_CLASS, nil, PQFolder, StartupInfo, ProcessInfo) then begin\n...\n```\n\nDo I understand right that he flushes and dismounts *all* volumes temporarily before starting a new console process? What would be the abstract algorithm of DavidB\u0027s program?\n\nGerolf\n\n"
    },
    {
      "id": "207810",
      "timestamp": "2018-09-24T21:34:15+00:00",
      "author": "Gerolf",
      "content": "I\u0027m having difficulties to get DavidB\u0027s start_VM.dpr source code compiled in both Delphi 10.2 and Lazarus (FreePascal). What files must actually be present to build this project?\n\nGerolf\n\n"
    },
    {
      "id": "207819",
      "timestamp": "2018-09-28T02:16:59+00:00",
      "author": "Gerolf",
      "content": "With a few modifications I could now compile DavidB\u0027s start_VM console programm on Free Pascal (and it still works, allowing writes to disk from within Qemu):\n\n```\n// start_VM.pas\n// based on start_VM.dpr by DavidB, * converted for FreePascal by Gerolf\n\nprogram start_VM;\n\nuses\n  Windows,\n  SysUtils,\n  // * Dialogs, Classes, Controls, TntSysUtils,\n  // * Math, (required on Delphi)\n  ShellApi;\n\ntype\n  _STORAGE_DEVICE_NUMBER \u003d record\n    DeviceType: DWORD;\n    DeviceNumber: DWORD;\n    PartitionNumber: DWORD;\n  end;\n  STORAGE_DEVICE_NUMBER \u003d _STORAGE_DEVICE_NUMBER;\n  TPWideCharArray \u003d array[0..0] of PWideChar;\n\nconst\n  METHOD_BUFFERED \u003d 0;\n  FILE_ANY_ACCESS \u003d 0;\n  // * FILE_DEVICE_FILE_SYSTEM \u003d $00000009;\n  FILE_DEVICE_MASS_STORAGE \u003d $0000002D;\n  IOCTL_STORAGE_BASE \u003d FILE_DEVICE_MASS_STORAGE;\n  IOCTL_STORAGE_GET_DEVICE_NUMBER \u003d\n    ((IOCTL_STORAGE_BASE shl 16) or (FILE_ANY_ACCESS shl 14) or\n    ($0420 shl 2) or METHOD_BUFFERED);\n\nvar\n  VolumesHandles: array of THandle;\n  LastError: integer;\n\n  procedure FlushToDisk(sDriveLetter: char);\n  var\n    hDrive: THandle;\n  begin\n    hDrive :\u003d 0;\n    try\n      hDrive :\u003d CreateFile(PAnsiChar(\u0027\\\\.\\\u0027 + sDriveLetter + \u0027:\u0027),\n        GENERIC_READ or GENERIC_WRITE, FILE_SHARE_READ or FILE_SHARE_WRITE,\n        nil, OPEN_EXISTING, 0, 0);\n      if FlushFileBuffers(hDrive) then // * FlushFileBuffers(hDrive);\n        writeln(\u0027Flushed drive \u0027 + sDriveLetter + \u0027:\u0027); // *\n    finally\n      FileClose(hDrive); // * CloseHandle(hDrive);\n    end;\n  end;\n\n  function DismountVolume(ADrive: char): boolean;\n  const\n    FSCTL_DISMOUNT_VOLUME \u003d (9 shl 16) or (0 shl 14) or (8 shl 2) or 0;\n  var\n    VolumeName: string;\n    BytesReturned: cardinal \u003d 0;\n  begin\n    Result :\u003d False;\n    VolumeName :\u003d Format(\u0027\\\\.\\%s:\u0027, [ADrive]);\n    SetLength(VolumesHandles, Length(VolumesHandles) + 1);\n    VolumesHandles[High(VolumesHandles)] :\u003d\n      CreateFile(PChar(VolumeName), GENERIC_READ or GENERIC_WRITE,\n      FILE_SHARE_READ or FILE_SHARE_WRITE, nil, OPEN_EXISTING, 0, 0);\n    if VolumesHandles[High(VolumesHandles)] \u003d INVALID_HANDLE_VALUE then\n    begin\n      LastError :\u003d GetLastError;\n      Exit;\n    end\n    else\n      writeln(\u0027Dismounted drive \u0027 + ADrive + \u0027:\u0027); // *\n    Result :\u003d DeviceIoControl(VolumesHandles[High(VolumesHandles)],\n      FSCTL_DISMOUNT_VOLUME, nil, 0, nil, 0, BytesReturned, nil);\n    if not Result then\n      LastError :\u003d GetLastError;\n  end;\n\n  function StrLCopyW(Dest, Source: PWideChar; MaxLen: cardinal): PWideChar;\n  var\n    Count: cardinal;\n  begin\n    Result :\u003d Dest;\n    Count :\u003d 0;\n    while (Count \u003c MaxLen) and (Source^ \u003c\u003e #0) do\n    begin\n      Dest^ :\u003d Source^;\n      Inc(Source);\n      Inc(Dest);\n      Inc(Count);\n    end;\n    Dest^ :\u003d #0;\n  end;\n\n  function StrPCopyW(Dest: PWideChar; const Source: WideString): PWideChar;\n  begin\n    Result :\u003d StrLCopyW(Dest, PWideChar(Source), Length(Source));\n  end;\n\nvar\n  zAppName: array[0..512] of widechar;\n  StartupInfo: TStartupInfo;\n  ProcessInfo: TProcessInformation;\n  Res: DWORD \u003d 0;\n  i, udn, WaitTime: integer;\n  VolLet: array of char;\n  hVolume: THandle;\n  dwBytesReturned: DWORD;\n  sdn: STORAGE_DEVICE_NUMBER;\n  ComLine, QFolder: WideString;\n  NumArgs: PLongint \u003d nil; // * NumArgs: integer \u003d 0;\n  TempArgs: PPWideChar;\n  ParamStrW: array of WideString;\n  ParamCountW: integer;\n  StartInfo: TStartupInfo;\n  PQFolder: PWideChar;\n  ErrorMode: word;\nbegin\n\n  SetLength(ParamStrW, 0);\n  ParamCountW :\u003d -1;\n  TempArgs :\u003d nil;\n  try\n    TempArgs :\u003d CommandLineToArgvW(GetCommandLineW, NumArgs);\n  except;\n  end;\n  if TempArgs \u003c\u003e nil then\n  begin\n    SetLength(ParamStrW, NumArgs^); // * SetLength(ParamStrW, NumArgs);\n    ParamCountW :\u003d NumArgs^ - 1; // * ParamCountW :\u003d NumArgs - 1;\n    try\n      for i :\u003d 0 to NumArgs^ - 1 do // * for i :\u003d 0 to NumArgs - 1 do\n        ParamStrW[i] :\u003d TPWideCharArray(TempArgs^)[i];\n    except;\n    end;\n    try;\n      LocalFree(THandle(TempArgs)); // * Fixme: pointer conversion not portable\n    except;\n    end;\n  end;\n  if ParamCount \u003e ParamCountW then\n  begin\n    SetLength(ParamStrW, ParamCount + 1);\n    for i :\u003d ParamCountW + 1 to ParamCount do\n      ParamStrW[i] :\u003d WideString(ParamStr(i));\n    ParamCountW :\u003d i; // * \n  end;\n\n  if ParamCountW \u003c 3 then\n  begin\n    writeln(\u0027Insufficient command line parameters !\u0027); // *\n    writeln( // *\n      \u0027Please use \"[USB_drive_number] [WaitTime] [QEMUexe] [QEMU_parameters]\"\u0027);\n    writeln(\u0027Press Enter to continue ...\u0027); // *\n    readln; // *\n    // MessageBox(0, \u0027Insufficient command line parameters !\u0027#13#10 +\n    // \u0027Please use \"[USB_drive_number] [WaitTime] [QEMUexe] [QEMU_parameters]\"\u0027,\n    // \u0027Warning\u0027, MB_OK or MB_ICONWARNING);\n    Exit;\n  end;\n\n  udn :\u003d Min(Max(StrToIntDef(ansistring(ParamStrW[1]), 1), 0), 99);\n  WaitTime :\u003d Min(Max(StrToIntDef(ansistring(ParamStrW[2]), 500), 1), 10000);\n\n  ErrorMode :\u003d SetErrorMode(SEM_FailCriticalErrors);\n  SetLength(VolLet, 0);\n  for i :\u003d byte(\u0027C\u0027) to byte(\u0027Z\u0027) do\n  begin\n    case GetDriveType(PChar(char(i) + \u0027:\\\u0027)) of\n      DRIVE_REMOVABLE, DRIVE_FIXED:\n      begin\n        try\n          hVolume :\u003d CreateFile(PAnsiChar(\u0027\\\\.\\\u0027 + char(i) + \u0027:\u0027),\n            0, FILE_SHARE_READ or FILE_SHARE_WRITE, nil, OPEN_EXISTING, 0, 0);\n        except\n          hVolume :\u003d INVALID_HANDLE_VALUE;\n        end;\n        if hVolume \u003c\u003e INVALID_HANDLE_VALUE then\n        begin\n          dwBytesReturned :\u003d 0;\n          if DeviceIoControl(hVolume, IOCTL_STORAGE_GET_DEVICE_NUMBER,\n            nil, 0, @sdn, sizeof(sdn), dwBytesReturned, nil) then\n            if sdn.DeviceNumber \u003d cardinal(udn) then\n            begin\n              SetLength(VolLet, Length(VolLet) + 1);\n              VolLet[High(VolLet)] :\u003d char(i);\n            end;\n        end;\n      end\n      else\n        Continue;\n    end;\n  end;\n  SetErrorMode(ErrorMode);\n\n  SetLength(VolumesHandles, 0);\n\n  for i :\u003d 0 to High(VolLet) do\n  begin\n    FlushToDisk(VolLet[i]);\n    Sleep(WaitTime);\n    if not DisMountVolume(VolLet[i]) then\n    begin // *\n      writeln(\u0027Unable to dismount volume \u0027\u0027\u0027 + VolLet[i] + \u0027\u0027\u0027 !\u0027); // *\n      writeln(\u0027Possible reason: \u0027 + SysErrorMessage(LastError)); // *\n      writeln(\u0027Press Enter to continue ...\u0027); // *\n      readln; // * Fixme: Check answer \u0027y\u0027/\u0027Y\u0027 to continue instead of exiting\n      //    if MessageBox(0, PChar(\u0027Unable to dismount volume \u0027\u0027\u0027 +\n      //      VolLet[i] + \u0027\u0027\u0027 !\u0027#13#10\u0027Possible reason: \u0027 +\n      //      SysErrorMessage(LastError) +\n      //      #13#10\u0027Are you sure you want to continue...?\u0027), PChar(\u0027Warning\u0027),\n      //      MB_YESNO or MB_ICONWARNING or MB_DEFBUTTON2) \u003d mrNo then\n      Exit;\n    end; // *\n  end;\n\n  ComLine :\u003d \u0027\u0027;\n  for i :\u003d 3 to ParamCountW do\n    ComLine :\u003d ComLine + \u0027\"\u0027 + ParamStrW[i] + \u0027\" \u0027;\n    \n  GetStartUpInfo(StartInfo);\n  StrPCopyW(zAppName, ComLine);\n  FillChar(StartupInfo, Sizeof(StartupInfo), #0);\n  StartupInfo.cb :\u003d Sizeof(StartupInfo);\n  StartupInfo.dwFlags :\u003d StartInfo.dwFlags;\n  StartupInfo.wShowWindow :\u003d StartInfo.wShowWindow;\n  // QFolder :\u003d WideExtractFilePath(ParamStrW[3]);\n  QFolder :\u003d ExtractFilePath(ParamStrW[3]); // *\n  if QFolder \u003c\u003e \u0027\u0027 then\n    PQFolder :\u003d PWideChar(QFolder)\n  else\n    PQFolder :\u003d nil;\n  if CreateProcessW(nil, zAppName, nil, nil, False,\n    // CREATE_NEW_CONSOLE or HIGH_PRIORITY_CLASS, * this is not the QEMU process\n    CREATE_NEW_CONSOLE or NORMAL_PRIORITY_CLASS, \n    nil, PQFolder, Windows.StartupInfoW(StartupInfo), ProcessInfo) then\n  begin\n    WaitforSingleObject(ProcessInfo.hProcess, INFINITE);\n    GetExitCodeProcess(ProcessInfo.hProcess, Res);\n    FileClose(ProcessInfo.hProcess); // * CloseHandle (ProcessInfo.hProcess);\n    FileClose(ProcessInfo.hThread); // * CloseHandle(ProcessInfo.hThread);\n  end\n  else\n  begin // *\n    writeln(\u0027Unable to launch QEMU !\u0027);\n    writeln(\u0027Press Enter to continue ...\u0027);\n    readln;\n    //  ShowMessage(\u0027Unable to launch QEMU !\u0027);\n  end; // *\n  for i :\u003d 0 to High(VolumesHandles) do\n    try\n      FileClose(VolumesHandles[i]); // * CloseHandle(VolumesHandles[i]);\n    except;\n    end;\nend.\n```\n\nI would have preferred to post this long code as attachment in a ZIP archive, together with the binary, but I do not see an uploader button. Since I let the error messages go to the console, not to a message box, there is no need to link GUI units any longer, and the binary shrinks to 230 KiB.\n\n\u003cbr /\u003e\n\n"
    },
    {
      "id": "207821",
      "timestamp": "2018-09-28T07:13:16+00:00",
      "author": "Wonko the Sane",
      "content": "\u003e With a few modifications I could now compile DavidB\u0027s start_VM console programm on Free Pascal (and it still works, allowing writes to disk from within Qemu):\n\u003e\n\u003e ```\n\u003e\n\u003e ```\n\u003e\n\u003e I would have preferred to post this long code as attachment in a ZIP archive, together with the binary, but I do not see an uploader button. Since I let the error messages go to the console, not to a message box, there is no need to link GUI units any longer, and the binary shrinks to 230 KiB.\n\nYou need (I seem to remember ) minimum 50 posts (or e-mail, NOT PM Nuno asking to be authorized) in order to be able to add attachments.\n\n![:duff:](http://reboot.pro/public/style_emoticons/default/duff.gif)\n\nWonko\n\n"
    },
    {
      "id": "207831",
      "timestamp": "2018-09-29T23:12:44+00:00",
      "author": "Gerolf",
      "content": "At the time DavidB suggested \"a solution: Using mountvol command to dismount USB drive\u0027s volume(s) before starting the VM and to mount them again after closing the VM. All can be done in a batch file so it will be very easy to use...\" (post #14), he was still running Windows XP.\n\nBut \"Microsoft changed the way programs can directly write to physical drives in Windows Vista and later\", as TheK mentioned in the [LockDismount thread](http://reboot.pro/topic/12413-lockdismount-v0300-update/ \"\") (post #1). Did this impose restrictions to the command processor such that the suggested batch file solution is no longer possible?\n\nTheK\u0027s LockDismount.exe does exactly the same as DavidB\u0027s start_VM.exe. If called from the command line, it requires path to and parameters for the qemu binary and then waits until the virtual machine is closed. LockDismount also allows Qemu guests to write to the USB drive, and it is only 68 KiB large. Sadly TheK did not share the source code.\n\nGerolf\n\n"
    },
    {
      "id": "207833",
      "timestamp": "2018-09-30T01:09:33+00:00",
      "author": "Gerolf",
      "content": "Microsoft gave a little background information on their [blocking of direct write operations to volumes and disks](https://web.archive.org/web/20130507212546/http://msdn.microsoft.com:80/en-us/library/ff551353.aspx \"External link\"):\n\n\"The application needs to lock the volume, dismount the volume, or both, before it can issue DASD \\[direct access to storage devices\\] I/O. This is new to Windows Vista and was done to address potentially malicious techniques. The file system will block all write operations to reserved sections of the disk. In this case, those reserved sections include the MBR and the two FAT areas. To block these areas, you need to lock the volume by sending FSCTL_LOCK_VOLUME. You must issue this structure on the same volume handle that performs the actual write operations. This request can fail if there are open file handles. In this case, the application can force a dismount of the file system by issuing FSCTL_DISMOUNT_VOLUME. However, the volume is not actually dismounted until the file handle is closed. Until then, the application can continue to issue DASD I/O by using the same file handle that is currently open.\"\n\nThat method can be recognized in DavidB\u0027s source code. Is it part of Microsoft\u0027s \"compelling\" safety strategy that this cannot be done on the scripting level using the command line tools shipped with Windows?\n\nGerolf\n\n"
    }
  ]
}