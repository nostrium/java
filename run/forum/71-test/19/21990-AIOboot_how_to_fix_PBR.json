{
  "id": "21990",
  "title": "AIOboot how to fix PBR",
  "isPinned": false,
  "isFirstTopic": false,
  "isLocked": false,
  "tags": [],
  "forumNotes": [
    {
      "id": "210551",
      "timestamp": "2019-04-08T17:01:59+00:00",
      "author": "Raex",
      "content": "I somehow managed to mess up my AIOboot usb. Fortunately I was experimenting to see if I could get Sergei Strelec\u0027s grub4dos menu entry to show up in aioboot menu. Unfortunately while doing so I messed up the PBR for it. Unfortunately I had made the backup for MBR of my usb but not the PBR. Thus now I am unable to boot my usb in legacy mode. It keeps giving me grub error, no such media found.\n\nDownside, my usb still works in UEFI mode, but not in legacy mode.\n\nReason I tried to mess with MBR/PBR was because sergei strelec wouldn\u0027t show me the rest of the options in uefi mode. It only booted the winpe whereas in legacy mode it showed me a grub2 menu listing the other entries it has.\n\n"
    },
    {
      "id": "210556",
      "timestamp": "2019-04-08T18:36:37+00:00",
      "author": "alacran",
      "content": "Try to make new PBR using BootIce: [http://reboot.pro/fi...-bootice-v1332/](http://reboot.pro/files/file/592-bootice-v1332/ \"\")\n\nalacran\n\n"
    },
    {
      "id": "210557",
      "timestamp": "2019-04-08T18:44:09+00:00",
      "author": "Raex",
      "content": "How can I go about doing so without formatting the USB. Any help???\n\n"
    },
    {
      "id": "210558",
      "timestamp": "2019-04-08T18:46:13+00:00",
      "author": "alacran",
      "content": "Using BootIce as I suggested on my previous post you do not need to reformat/repartition your USB.\n\n"
    },
    {
      "id": "210559",
      "timestamp": "2019-04-08T18:54:53+00:00",
      "author": "Raex",
      "content": "\u003e Using BootIce as I suggested on my previous post you do not need to reformat/repartition your USB.\n\nSent you a PM regarding it, I have no idea how to make a new PBR at all. That\u0027s what I was asking help for.\n\n"
    },
    {
      "id": "210560",
      "timestamp": "2019-04-08T19:05:17+00:00",
      "author": "alacran",
      "content": "I think the pictures are clear, just select what kind of MBR or PBR you want and Install/config.  \n\n#### Attached Thumbnails {#attach_wrap}\n\n* [![AIO MBR.png](http://reboot.pro/uploads/monthly_04_2019/post-26560-0-55313800-1554750304_thumb.png)](http://reboot.pro/uploads/monthly_04_2019/post-26560-0-55313800-1554750304.png \"AIO MBR.png - Size: 148.2KB\"){#ipb-attach-url-16590-0-20041100-1676066405}\n* [![AIO PBR.png](http://reboot.pro/uploads/monthly_04_2019/post-26560-0-04319800-1554750315_thumb.png)](http://reboot.pro/uploads/monthly_04_2019/post-26560-0-04319800-1554750315.png \"AIO PBR.png - Size: 186.22KB\"){#ipb-attach-url-16591-0-20050900-1676066405}\n\n"
    },
    {
      "id": "210561",
      "timestamp": "2019-04-08T19:07:32+00:00",
      "author": "Raex",
      "content": "I\u0027m trying to do so but it gives me error. How I messed it up is when I tried to install the Grub4Dos as PBR and it didn\u0027t boot, then I tried to change it back to the BOOTMGR one, but it still gives me the grub error.\n\n"
    },
    {
      "id": "210562",
      "timestamp": "2019-04-08T19:19:53+00:00",
      "author": "alacran",
      "content": "Well if BootIce can\u0027t help you it means your PBR info is damaged, then I think re partition/format is the safer option, hope you have all info to recreate your USB AIO device.\n\n**EDIT:** Before making this post Raex contactected me by PM and I answered this to him:\n\n\u003e Since there are several options you can select when you first create your AIO, I don\u0027t know what to suggest to you, since I don\u0027t know previous status.\n\u003e\n\u003e But I have an idea, if you have another USB stick avalilable just partition/format it with AIO as you did before, then open it with BootIce and see what is your MBR and PBR, eject it and plug your problematic device and try to recreate what you deleted.\n\nAnd this is today [Post](http://reboot.pro/topic/21990-aioboot-how-to-fix-pbr/#entry210705 \"\") 15 from Raex\n\n\u003e I took Alacran\u0027s advice and used another usb through aioboot and then got the pbr through it. I tried several times to recreate it through aioboot but idk why it never created successfully enough to boot at all. After I copied the pbr from the other usb it booted successfully.\n\nNOTE: This post was edited to keep track of solution, since I assume Raex having a very low Post Count can\u0027t make any edit to the thread.\n\nalacran\n\n**Edited by alacran, 15 April 2019 - 01:04 AM.**\n"
    },
    {
      "id": "210563",
      "timestamp": "2019-04-08T19:25:39+00:00",
      "author": "alacran",
      "content": "\u003e Reason I tried to mess with MBR/PBR was because sergei strelec wouldn\u0027t show me the rest of the options in uefi mode. It only booted the winpe whereas in legacy mode it showed me a grub2 menu listing the other entries it has.\n\nIsn\u0027t it a grub4dos menu? If this is the case grub4dos can\u0027t boot anything on UEFI (secure boot) mode, it only works fine on Legacy mode, so nothing to fix then.\n\n"
    },
    {
      "id": "210569",
      "timestamp": "2019-04-09T09:39:00+00:00",
      "author": "Wonko the Sane",
      "content": "\u003e Well if BootIce can\u0027t help you it means your PBR info is damaged, then I think re partition/format is the safer option, hope you have all info to recreate your USB AIO device.\n\nSafer?\n\nIt is a PBR, not brain surgery or rocket science, it can be fixed just fine if needed, it is not like BootIce (which is an excellent tool) is the only and ultimate PBR recovery tool.\n\nOut of curiosity, if your car doesn\u0027t start in the morning, do you check the battery and starter motor connections first or do you directly remove the engine and fit in a new one? ![:dubbio:](http://reboot.pro/public/style_emoticons/default/dubbio.gif)\n\n![:duff:](http://reboot.pro/public/style_emoticons/default/duff.gif)\n\nWonko\n\n"
    },
    {
      "id": "210571",
      "timestamp": "2019-04-09T13:47:43+00:00",
      "author": "Raex",
      "content": "\u003e Safer?\n\u003e\n\u003e It is a PBR, not brain surgery or rocket science, it can be fixed just fine if needed, it is not like BootIce (which is an excellent tool) is the only and ultimate PBR recovery tool.\n\u003e\n\u003e Out of curiosity, if your car doesn\u0027t start in the morning, do you check the battery and starter motor connections first or do you directly remove the engine and fit in a new one? ![:dubbio:](http://reboot.pro/public/style_emoticons/default/dubbio.gif)\n\u003e\n\u003e ![:duff:](http://reboot.pro/public/style_emoticons/default/duff.gif)\n\u003e\n\u003e Wonko\n\nLmao, well considering when you go out in outer space, and there\u0027s a new entity in front of you whom you know nothing about, are you gonna say hi to it first or start attacking at it. Lol in short, when you have lesser knowledge people are bound to do what they can think of at that moment, wouldn\u0027t you agree to it?\n\n\u003e Isn\u0027t it a grub4dos menu? If this is the case grub4dos can\u0027t boot anything on UEFI (secure boot) mode, it only works fine on Legacy mode, so nothing to fix then.\n\nYes it\u0027s grub4dos menu, and damn that really sucks right there. I was hoping to convert the menu to grub2 but had little to no success. Anyways I\u0027ll just leave sergei alone perhaps.\n\n"
    },
    {
      "id": "210573",
      "timestamp": "2019-04-09T16:45:17+00:00",
      "author": "Wonko the Sane",
      "content": "\u003e Lmao, well considering when you go out in outer space, and there\u0027s a new entity in front of you whom you know nothing about, are you gonna say hi to it first or start attacking at it.\n\nI don\u0027t know, probably I would have already seen that entity coming :wink: thus having the time to post on the NASA board ![:w00t:](http://reboot.pro/public/style_emoticons/default/w00t.gif) for advice.\n\nThe point is that I would be expecting that those actually familiar with outer space had some actual solutions to the problem at hand, not a generic \"If the Apollo entity-recognition software didn\u0027t recognize that entity it is safer to nuke him/her/it and everything else in two-three light-years range around it ![:ph34r:](http://reboot.pro/public/style_emoticons/default/scared9.gif) \".\n\nNow, seriously, a PBR can usually be re-built just fine, particularly in your case most probably the BPB (Bios Parameter Block) is just fine as you can access the files on that volume, so it is a matter of making sure of this and then use a simpler tool to write to it \"standard\" code, such as bootsect.exe can do with either the /NT52 or /NT60 switches.\n\nAt this point the PBR should normally be valid and BootIce would recognize it and allow you to further change it to some other code.\n\nIf you want you can dump your current PBR (and being a FAT32 some more sectors), upload it to any free hosting site and post a link to it and I\u0027ll have a look, only to make sure that the data is valid.\n\nI would need the MBR (to check data in the partition table is coherent with the BPB data) and the PBR+15 sectors.\n\nYou can use the HDhacker to dump the data:\n\n[http://dimio.altervi...g/eng/#HDHacker](http://dimio.altervista.org/eng/#HDHacker \"External link\")\n\nYou want first sector of the Physicaldrive (save to mynicembr.bin) and first 16 sectors of the Logicaldrive (save to mybadbadpbr.bin).\n\nThen make a zip or 7z archive, upload to \\*somewhere\\* and post a link.\n\nIs it safe? ![:dubbio:](http://reboot.pro/public/style_emoticons/default/dubbio.gif)\n\n[https://www.imdb.com...uotes/qt0247572](https://www.imdb.com/title/tt0074860/quotes/qt0247572 \"External link\")\n\n![:duff:](http://reboot.pro/public/style_emoticons/default/duff.gif)\n\nWonko\n\n"
    },
    {
      "id": "210587",
      "timestamp": "2019-04-10T05:55:04+00:00",
      "author": "alacran",
      "content": "Here we are talking of an AIO USB stick with some tools installed by means of AIO Boot (wich by the way I translated to Spanish), the program makes all partitioning and formating required, also installs MBR/PBR as required (several options are available) according with your options selected. Then BCDs, grub2 files and config files, and grub4dos files and menu.lst files are involved as boot options and you can go from one menu to the other or back to previous menu, of course the program give you easy options available to edit those menus, config files and BCDs.\n\nSo this is not the main internal HD having problems that of course deserves all possible efforts to recover the valuable info into it (if you don\u0027t have backups).\n\nI have a 16 GB AIO Boot USB for my use and also had problems trying to make it do some more extra things than the available options particularly with VHDs in my case, and I was able to fix the problems once or twice.\n\nBut also have found that many times you waist more time and effort to fix something than if you just format and start from a clean install.\n\nAnd yes after 10 or maybe 15 minutes trying to fix something on the OS, if I can\u0027t find the software source of the problem I do the same with my OSs partitions redeploying my backup.wim(s), as all documents, games, additional programs, Portables, etc. are on another partition and also have backups of them just in case.\n\nSo it is a matter of being practical and do not expend unnecessary time and resources on something that can be easily solved just by remaking it from the beginning (or from backup if any).\n\nalacran\n\n"
    },
    {
      "id": "210593",
      "timestamp": "2019-04-10T08:46:35+00:00",
      "author": "Wonko the Sane",
      "content": "I know :smile:, but what you are saying *now* (correctly BTW ![:thumbsup:](http://reboot.pro/public/style_emoticons/default/thumbsup.gif) ) it is that nuking the whole stuff and start again from scratch can be (in this specific case of a device with contents created by an automated program and not later modified) faster/more practical/easier/more productive/requiring less effort, which has nothing to do with the approach being \"safer\".\n\nThe alternative in the case of a PBR it is pretty much binary, you either (manually with a hex editor or with the help of dedicated tools) fix it (and if it is fixed it is fixed) or you don\u0027t.\n\nBesides, and with all due respect both to you and to the OP, the idea of running again the AIOboot and recreate the thingy *ex novo* is pretty much obvious, I assumed that the OP (for whatever reasons) didn\u0027t want to re-run the AIOboot because he wanted to keep some of the modifications he already made, and then asked for support.\n\n![:duff:](http://reboot.pro/public/style_emoticons/default/duff.gif)\n\nWonko\n\n"
    },
    {
      "id": "210705",
      "timestamp": "2019-04-14T23:21:11+00:00",
      "author": "Raex",
      "content": "Woah, sorry I did not actually got the notifications from this thread again somehow, idk why. Anyways I took Alacran\u0027s advice and used another usb through aioboot and then got the pbr through it. I tried several times to recreate it through aioboot but idk why it never created successfully enough to boot at all. After I copied the pbr from the other usb it booted successfully.\n\n"
    },
    {
      "id": "210707",
      "timestamp": "2019-04-15T00:53:54+00:00",
      "author": "alacran",
      "content": "Then you finally followed the advice from the Private Messenger and made another AIO Boot stick and used it to recreate your damaged PBR.\n\nI\u0027m going to edit my post here where you said was the right answer to make it clear for future readers how it was finally solved, since I assume you having so small Post Count can\u0027t make any editions yet, thanks for informing us how it was solved.\n\nalacran\n\n"
    },
    {
      "id": "210709",
      "timestamp": "2019-04-15T08:51:28+00:00",
      "author": "Wonko the Sane",
      "content": "So after all the PBR was \"fixed\" (and the stick was not \"nuked\"), good :smile:.  \n\n![:duff:](http://reboot.pro/public/style_emoticons/default/duff.gif)  \nWonko   \n"
    },
    {
      "id": "210711",
      "timestamp": "2019-04-15T09:31:53+00:00",
      "author": "Raex",
      "content": "Thanks Alacran, and I actually have some posts left still so I can make the edits.\n\nI just had to extract the PBR from other usb and then import it back to the one which was damaged. As soon as I did that it accepted it and I got the boot menu. I had to add the entries manually though since it had none, because I never loaded the OSes on the other usb and thus had to manually create the entries for individual stuff I had. It was a little tricky but I managed to do that, for the guid I just copied them from the MBR.\n\nAlso, thanks Wonko, lol yeah it wasn\u0027t nuked and I got it fixed eventually haha.\n\n-Raex\n\n"
    },
    {
      "id": "210715",
      "timestamp": "2019-04-15T10:59:32+00:00",
      "author": "Wonko the Sane",
      "content": "As a side-side note (and as a word of warning for the casual passer-by) this worked in this case ONLY because of EITHER:  \n1) the second stick being identical to the first one  \n2) the partition/volume at hand was the ESP (or whatever) that AIOBOOT always creates with the same size and at the same offset on \\*any\\* stick  \nAND:  \n3) the volume serial number (or the hash/checksum of the bootsector) or the UUID isn\u0027t used (actually perused) by any program/distro/whatever on the stick  \nor - if you prefer - it is not generally possible to \"transplant\" a bootsector from one device to another without \"adapting\" the BPB and the volume serial\\[1\\].  \n\n![:duff:](http://reboot.pro/public/style_emoticons/default/duff.gif)  \nWonko  \n\n\\[1\\] the volume serial is actually rarely used, and I don\u0027t want to seem more royalist than the king, but you never know, and it costs nothing (or nearly nothing) to do things as eailproof as possible.   \n"
    }
  ]
}